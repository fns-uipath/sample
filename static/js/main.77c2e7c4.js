/*! For license information please see main.77c2e7c4.js.LICENSE.txt */
(()=>{"use strict";var e={463:(e,t,n)=>{var o=n(791),r=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,n,o,r,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,o){var r=v.hasOwnProperty(t)?v[t]:null;(null!==r?0!==r.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,o){if(null===t||"undefined"===typeof t||function(e,t,n,o){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,o)&&(n=null),o||null===r?function(e){return!!u.call(f,e)||!u.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,o=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);v[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);v[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);v[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),x=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function N(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var L,F=Object.assign;function U(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function H(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var o=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){o=c}e.call(t.prototype)}else{try{throw Error()}catch(c){o=c}e()}}catch(c){if(c&&o&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),i=o.stack.split("\n"),s=r.length-1,a=i.length-1;1<=s&&0<=a&&r[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==i[a]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function q(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case x:return"Portal";case S:return"Profiler";case _:return"StrictMode";case A:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function j(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){o=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=K(e)?e.checked?"true":"false":e.value),(e=o)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;n=j(null!=t.value?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Z(e,t);var n=j(t.value),o=t.type;if(null!=n)"number"===o?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,j(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,o){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&o&&(e[n].defaultSelected=!0)}else{for(n=""+j(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(o&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:j(n)}}function ie(e,t){var n=j(t.value),o=j(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=o&&(e.defaultValue=""+o)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,o){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var o=0===n.indexOf("--"),r=ge(n,t[n],o);"float"===n&&(n="cssFloat"),o?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var me=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ce=null,_e=null;function Se(e){if(e=wr(e)){if("function"!==typeof xe)throw Error(i(280));var t=e.stateNode;t&&(t=xr(t),xe(e.stateNode,e.type,t))}}function Te(e){Ce?_e?_e.push(e):_e=[e]:Ce=e}function Ie(){if(Ce){var e=Ce,t=_e;if(_e=Ce=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Ae(){}var Re=!1;function Pe(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ee(e,t,n)}finally{Re=!1,(null!==Ce||null!==_e)&&(Ae(),Ie())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var o=xr(n);if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){De=!1}function Ne(e,t,n,o,r,i,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Le=!1,Fe=null,Ue=!1,ze=null,He={onError:function(e){Le=!0,Fe=e}};function qe(e,t,n,o,r,i,s,a,l){Le=!1,Fe=null,Ne.apply(He,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function je(e){if(Be(e)!==e)throw Error(i(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,o=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(o=r.return)){n=o;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return je(r),e;if(s===o)return je(r),t;s=s.sibling}throw Error(i(188))}if(n.return!==o.return)n=r,o=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,o=s;break}if(l===o){a=!0,o=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,o=r;break}if(l===o){a=!0,o=s,n=r;break}l=l.sibling}if(!a)throw Error(i(189))}}if(n.alternate!==o)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var $e=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ye=r.unstable_requestPaint,Ze=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,ot=r.unstable_IdlePriority,rt=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var o=0,r=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?o=ut(a):0!==(i&=s)&&(o=ut(i))}else 0!==(s=n&~r)?o=ut(s):0!==i&&(o=ut(i));if(0===o)return 0;if(0!==t&&t!==o&&0===(t&r)&&((r=o&-o)>=(i=t&-t)||16===r&&0!==(4194240&i)))return t;if(0!==(4&o)&&(o|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)r=1<<(n=31-st(t)),o|=e[n],t&=~r;return o}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-st(n),r=1<<o;r&t|e[o]&t&&(e[o]|=t),n&=~r}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,xt,Ct,_t,St,Tt=!1,It=[],Et=null,At=null,Rt=null,Pt=new Map,Ot=new Map,Dt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Lt(e,t,n,o,r,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:i,targetContainers:[r]},null!==t&&(null!==(t=wr(t))&&xt(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=br(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void St(e.priority,(function(){Ct(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wr(n))&&xt(t),e.blockedOn=n,!1;var o=new(n=e.nativeEvent).constructor(n.type,n);we=o,n.target.dispatchEvent(o),we=null,t.shift()}return!0}function zt(e,t,n){Ut(e)&&n.delete(t)}function Ht(){Tt=!1,null!==Et&&Ut(Et)&&(Et=null),null!==At&&Ut(At)&&(At=null),null!==Rt&&Ut(Rt)&&(Rt=null),Pt.forEach(zt),Ot.forEach(zt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ht)))}function Bt(e){function t(t){return qt(t,e)}if(0<It.length){qt(It[0],e);for(var n=1;n<It.length;n++){var o=It[n];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==Et&&qt(Et,e),null!==At&&qt(At,e),null!==Rt&&qt(Rt,e),Pt.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(o=Dt[n]).blockedOn===e&&(o.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Vt=w.ReactCurrentBatchConfig,jt=!0;function Kt(e,t,n,o){var r=bt,i=Vt.transition;Vt.transition=null;try{bt=1,$t(e,t,n,o)}finally{bt=r,Vt.transition=i}}function Gt(e,t,n,o){var r=bt,i=Vt.transition;Vt.transition=null;try{bt=4,$t(e,t,n,o)}finally{bt=r,Vt.transition=i}}function $t(e,t,n,o){if(jt){var r=Qt(e,t,n,o);if(null===r)Ko(e,t,o,Wt,n),Nt(e,o);else if(function(e,t,n,o,r){switch(t){case"focusin":return Et=Lt(Et,e,t,n,o,r),!0;case"dragenter":return At=Lt(At,e,t,n,o,r),!0;case"mouseover":return Rt=Lt(Rt,e,t,n,o,r),!0;case"pointerover":var i=r.pointerId;return Pt.set(i,Lt(Pt.get(i)||null,e,t,n,o,r)),!0;case"gotpointercapture":return i=r.pointerId,Ot.set(i,Lt(Ot.get(i)||null,e,t,n,o,r)),!0}return!1}(r,e,t,n,o))o.stopPropagation();else if(Nt(e,o),4&t&&-1<Mt.indexOf(e)){for(;null!==r;){var i=wr(r);if(null!==i&&kt(i),null===(i=Qt(e,t,n,o))&&Ko(e,t,o,Wt,n),i===r)break;r=i}null!==r&&o.stopPropagation()}else Ko(e,t,o,null,n)}}var Wt=null;function Qt(e,t,n,o){if(Wt=null,null!==(e=br(e=ke(o))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Zt=null,Jt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Jt,o=n.length,r="value"in Zt?Zt.value:Zt.textContent,i=r.length;for(e=0;e<o&&n[e]===r[e];e++);var s=o-e;for(t=1;t<=s&&n[o-t]===r[i-t];t++);return Xt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function rn(e){function t(t,n,o,r,i){for(var s in this._reactName=t,this._targetInst=o,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:on,this.isPropagationStopped=on,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=F({},cn,{view:0,detail:0}),hn=rn(un),pn=F({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=rn(pn),gn=rn(F({},pn,{dataTransfer:0})),vn=rn(F({},un,{relatedTarget:0})),mn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(yn),wn=rn(F({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function Sn(){return _n}var Tn=F({},un,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=rn(Tn),En=rn(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=rn(F({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Rn=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=rn(Pn),Dn=[9,13,27,32],Mn=d&&"CompositionEvent"in window,Nn=null;d&&"documentMode"in document&&(Nn=document.documentMode);var Ln=d&&"TextEvent"in window&&!Nn,Fn=d&&(!Mn||Nn&&8<Nn&&11>=Nn),Un=String.fromCharCode(32),zn=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Kn(e,t,n,o){Te(o),0<(t=$o(t,"onChange")).length&&(n=new dn("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var Gn=null,$n=null;function Wn(e){zo(e,0)}function Qn(e){if($(kr(e)))return e}function Yn(e,t){if("change"===e)return t}var Zn=!1;if(d){var Jn;if(d){var Xn="oninput"in document;if(!Xn){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),Xn="function"===typeof eo.oninput}Jn=Xn}else Jn=!1;Zn=Jn&&(!document.documentMode||9<document.documentMode)}function to(){Gn&&(Gn.detachEvent("onpropertychange",no),$n=Gn=null)}function no(e){if("value"===e.propertyName&&Qn($n)){var t=[];Kn(t,$n,e,ke(e)),Pe(Wn,t)}}function oo(e,t,n){"focusin"===e?(to(),$n=n,(Gn=t).attachEvent("onpropertychange",no)):"focusout"===e&&to()}function ro(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn($n)}function io(e,t){if("click"===e)return Qn(t)}function so(e,t){if("input"===e||"change"===e)return Qn(t)}var ao="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lo(e,t){if(ao(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var r=n[o];if(!u.call(t,r)||!ao(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uo(e,t){var n,o=co(e);for(e=0;o;){if(3===o.nodeType){if(n=e+o.textContent.length,e<=t&&n>=t)return{node:o,offset:t-e};e=n}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=co(o)}}function ho(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ho(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function po(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(o){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function go(e){var t=po(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ho(n.ownerDocument.documentElement,n)){if(null!==o&&fo(n))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,i=Math.min(o.start,r);o=void 0===o.end?i:Math.min(o.end,r),!e.extend&&i>o&&(r=o,o=i,i=r),r=uo(n,i);var s=uo(n,o);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),i>o?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vo=d&&"documentMode"in document&&11>=document.documentMode,mo=null,yo=null,bo=null,wo=!1;function ko(e,t,n){var o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wo||null==mo||mo!==W(o)||("selectionStart"in(o=mo)&&fo(o)?o={start:o.selectionStart,end:o.selectionEnd}:o={anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},bo&&lo(bo,o)||(bo=o,0<(o=$o(yo,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=mo)))}function xo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Co={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},_o={},So={};function To(e){if(_o[e])return _o[e];if(!Co[e])return e;var t,n=Co[e];for(t in n)if(n.hasOwnProperty(t)&&t in So)return _o[e]=n[t];return e}d&&(So=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);var Io=To("animationend"),Eo=To("animationiteration"),Ao=To("animationstart"),Ro=To("transitionend"),Po=new Map,Oo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Do(e,t){Po.set(e,t),l(t,[e])}for(var Mo=0;Mo<Oo.length;Mo++){var No=Oo[Mo];Do(No.toLowerCase(),"on"+(No[0].toUpperCase()+No.slice(1)))}Do(Io,"onAnimationEnd"),Do(Eo,"onAnimationIteration"),Do(Ao,"onAnimationStart"),Do("dblclick","onDoubleClick"),Do("focusin","onFocus"),Do("focusout","onBlur"),Do(Ro,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function Uo(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,o,r,s,a,l,c){if(qe.apply(this,arguments),Le){if(!Le)throw Error(i(198));var d=Fe;Le=!1,Fe=null,Ue||(Ue=!0,ze=d)}}(o,t,void 0,e),e.currentTarget=null}function zo(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var o=e[n],r=o.event;o=o.listeners;e:{var i=void 0;if(t)for(var s=o.length-1;0<=s;s--){var a=o[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;Uo(r,a,c),i=l}else for(s=0;s<o.length;s++){if(l=(a=o[s]).instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;Uo(r,a,c),i=l}}}if(Ue)throw e=ze,Ue=!1,ze=null,e}function Ho(e,t){var n=t[vr];void 0===n&&(n=t[vr]=new Set);var o=e+"__bubble";n.has(o)||(jo(t,e,2,!1),n.add(o))}function qo(e,t,n){var o=0;t&&(o|=4),jo(n,e,o,t)}var Bo="_reactListening"+Math.random().toString(36).slice(2);function Vo(e){if(!e[Bo]){e[Bo]=!0,s.forEach((function(t){"selectionchange"!==t&&(Fo.has(t)||qo(t,!1,e),qo(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bo]||(t[Bo]=!0,qo("selectionchange",!1,t))}}function jo(e,t,n,o){switch(Yt(t)){case 1:var r=Kt;break;case 4:r=Gt;break;default:r=$t}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),o?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Ko(e,t,n,o,r){var i=o;if(0===(1&t)&&0===(2&t)&&null!==o)e:for(;;){if(null===o)return;var s=o.tag;if(3===s||4===s){var a=o.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=o.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=br(a)))return;if(5===(l=s.tag)||6===l){o=i=s;continue e}a=a.parentNode}}o=o.return}Pe((function(){var o=i,r=ke(n),s=[];e:{var a=Po.get(e);if(void 0!==a){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=vn;break;case"focusout":c="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Io:case Eo:case Ao:l=mn;break;case Ro:l=Rn;break;case"scroll":l=hn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==a?a+"Capture":null:a;d=[];for(var p,f=o;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==h&&(null!=(g=Oe(f,h))&&d.push(Go(f,g,p)))),u)break;f=f.return}0<d.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!br(c)&&!c[gr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=o,null!==(c=(c=n.relatedTarget||n.toElement)?br(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=o),l!==c)){if(d=fn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,g="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==l?a:kr(l),p=null==c?a:kr(c),(a=new d(g,f+"leave",l,n,r)).target=u,a.relatedTarget=p,g=null,br(r)===o&&((d=new d(h,f+"enter",c,n,r)).target=p,d.relatedTarget=u,g=d),u=g,l&&c)e:{for(h=c,f=0,p=d=l;p;p=Wo(p))f++;for(p=0,g=h;g;g=Wo(g))p++;for(;0<f-p;)d=Wo(d),f--;for(;0<p-f;)h=Wo(h),p--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Wo(d),h=Wo(h)}d=null}else d=null;null!==l&&Qo(s,a,l,d,!1),null!==c&&null!==u&&Qo(s,u,c,d,!0)}if("select"===(l=(a=o?kr(o):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var v=Yn;else if(jn(a))if(Zn)v=so;else{v=ro;var m=oo}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(v=io);switch(v&&(v=v(e,o))?Kn(s,v,n,r):(m&&m(e,a,o),"focusout"===e&&(m=a._wrapperState)&&m.controlled&&"number"===a.type&&ee(a,"number",a.value)),m=o?kr(o):window,e){case"focusin":(jn(m)||"true"===m.contentEditable)&&(mo=m,yo=o,bo=null);break;case"focusout":bo=yo=mo=null;break;case"mousedown":wo=!0;break;case"contextmenu":case"mouseup":case"dragend":wo=!1,ko(s,n,r);break;case"selectionchange":if(vo)break;case"keydown":case"keyup":ko(s,n,r)}var y;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Hn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):(Jt="value"in(Zt=r)?Zt.value:Zt.textContent,Bn=!0)),0<(m=$o(o,b)).length&&(b=new wn(b,e,null,n,r),s.push({event:b,listeners:m}),y?b.data=y:null!==(y=qn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(zn=!0,Un);case"textInput":return(e=t.data)===Un&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Mn&&Hn(e,t)?(e=en(),Xt=Jt=Zt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(o=$o(o,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:o}),r.data=y))}zo(s,t)}))}function Go(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $o(e,t){for(var n=t+"Capture",o=[];null!==e;){var r=e,i=r.stateNode;5===r.tag&&null!==i&&(r=i,null!=(i=Oe(e,n))&&o.unshift(Go(e,i,r)),null!=(i=Oe(e,t))&&o.push(Go(e,i,r))),e=e.return}return o}function Wo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qo(e,t,n,o,r){for(var i=t._reactName,s=[];null!==n&&n!==o;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===o)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Oe(n,i))&&s.unshift(Go(n,l,a)):r||null!=(l=Oe(n,i))&&s.push(Go(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yo=/\r\n?/g,Zo=/\u0000|\uFFFD/g;function Jo(e){return("string"===typeof e?e:""+e).replace(Yo,"\n").replace(Zo,"")}function Xo(e,t,n){if(t=Jo(t),Jo(e)!==t&&n)throw Error(i(425))}function er(){}var tr=null,nr=null;function or(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rr="function"===typeof setTimeout?setTimeout:void 0,ir="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(lr)}:rr;function lr(e){setTimeout((function(){throw e}))}function cr(e,t){var n=t,o=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===o)return e.removeChild(r),void Bt(t);o--}else"$"!==n&&"$?"!==n&&"$!"!==n||o++;n=r}while(n);Bt(t)}function dr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),pr="__reactFiber$"+hr,fr="__reactProps$"+hr,gr="__reactContainer$"+hr,vr="__reactEvents$"+hr,mr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function br(e){var t=e[pr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[pr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[pr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function wr(e){return!(e=e[pr]||e[gr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function kr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xr(e){return e[fr]||null}var Cr=[],_r=-1;function Sr(e){return{current:e}}function Tr(e){0>_r||(e.current=Cr[_r],Cr[_r]=null,_r--)}function Ir(e,t){_r++,Cr[_r]=e.current,e.current=t}var Er={},Ar=Sr(Er),Rr=Sr(!1),Pr=Er;function Or(e,t){var n=e.type.contextTypes;if(!n)return Er;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r,i={};for(r in n)i[r]=t[r];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mr(){Tr(Rr),Tr(Ar)}function Nr(e,t,n){if(Ar.current!==Er)throw Error(i(168));Ir(Ar,t),Ir(Rr,n)}function Lr(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,"function"!==typeof o.getChildContext)return n;for(var r in o=o.getChildContext())if(!(r in t))throw Error(i(108,V(e)||"Unknown",r));return F({},n,o)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Er,Pr=Ar.current,Ir(Ar,e),Ir(Rr,Rr.current),!0}function Ur(e,t,n){var o=e.stateNode;if(!o)throw Error(i(169));n?(e=Lr(e,t,Pr),o.__reactInternalMemoizedMergedChildContext=e,Tr(Rr),Tr(Ar),Ir(Ar,e)):Tr(Rr),Ir(Rr,n)}var zr=null,Hr=!1,qr=!1;function Br(e){null===zr?zr=[e]:zr.push(e)}function Vr(){if(!qr&&null!==zr){qr=!0;var e=0,t=bt;try{var n=zr;for(bt=1;e<n.length;e++){var o=n[e];do{o=o(!0)}while(null!==o)}zr=null,Hr=!1}catch(r){throw null!==zr&&(zr=zr.slice(e+1)),$e(Xe,Vr),r}finally{bt=t,qr=!1}}return null}var jr=[],Kr=0,Gr=null,$r=0,Wr=[],Qr=0,Yr=null,Zr=1,Jr="";function Xr(e,t){jr[Kr++]=$r,jr[Kr++]=Gr,Gr=e,$r=t}function ei(e,t,n){Wr[Qr++]=Zr,Wr[Qr++]=Jr,Wr[Qr++]=Yr,Yr=e;var o=Zr;e=Jr;var r=32-st(o)-1;o&=~(1<<r),n+=1;var i=32-st(t)+r;if(30<i){var s=r-r%5;i=(o&(1<<s)-1).toString(32),o>>=s,r-=s,Zr=1<<32-st(t)+r|n<<r|o,Jr=i+e}else Zr=1<<i|n<<r|o,Jr=e}function ti(e){null!==e.return&&(Xr(e,1),ei(e,1,0))}function ni(e){for(;e===Gr;)Gr=jr[--Kr],jr[Kr]=null,$r=jr[--Kr],jr[Kr]=null;for(;e===Yr;)Yr=Wr[--Qr],Wr[Qr]=null,Jr=Wr[--Qr],Wr[Qr]=null,Zr=Wr[--Qr],Wr[Qr]=null}var oi=null,ri=null,ii=!1,si=null;function ai(e,t){var n=Oc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oi=e,ri=dr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oi=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yr?{id:Zr,overflow:Jr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Oc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oi=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function di(e){if(ii){var t=ri;if(t){var n=t;if(!li(e,t)){if(ci(e))throw Error(i(418));t=dr(n.nextSibling);var o=oi;t&&li(e,t)?ai(o,n):(e.flags=-4097&e.flags|2,ii=!1,oi=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,oi=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oi=e}function hi(e){if(e!==oi)return!1;if(!ii)return ui(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!or(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw pi(),Error(i(418));for(;t;)ai(e,t),t=dr(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=dr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=oi?dr(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ri;e;)e=dr(e.nextSibling)}function fi(){ri=oi=null,ii=!1}function gi(e){null===si?si=[e]:si.push(e)}var vi=w.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yi=Sr(null),bi=null,wi=null,ki=null;function xi(){ki=wi=bi=null}function Ci(e){var t=yi.current;Tr(yi),e._currentValue=t}function _i(e,t,n){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){bi=e,ki=wi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wa=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(ki!==e)if(e={context:e,memoizedValue:t,next:null},null===wi){if(null===bi)throw Error(i(308));wi=e,bi.dependencies={lanes:0,firstContext:e}}else wi=wi.next=e;return t}var Ii=null;function Ei(e){null===Ii?Ii=[e]:Ii.push(e)}function Ai(e,t,n,o){var r=t.interleaved;return null===r?(n.next=n,Ei(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ri(e,o)}function Ri(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pi=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Di(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ni(e,t,n){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,0!==(2&Al)){var r=o.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),o.pending=t,Ri(e,n)}return null===(r=o.interleaved)?(t.next=t,Ei(o)):(t.next=r.next,r.next=t),o.interleaved=t,Ri(e,n)}function Li(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Fi(e,t){var n=e.updateQueue,o=e.alternate;if(null!==o&&n===(o=o.updateQueue)){var r=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?r=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?r=i=t:i=i.next=t}else r=i=t;return n={baseState:o.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:o.shared,effects:o.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ui(e,t,n,o){var r=e.updateQueue;Pi=!1;var i=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var d=e.alternate;null!==d&&((a=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===a?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=r.baseState;for(s=0,d=c=l=null,a=i;;){var h=a.lane,p=a.eventTime;if((o&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(h=t,p=n,g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(p,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=g.payload)?f.call(p,u,h):f)||void 0===h)break e;u=F({},u,h);break e;case 2:Pi=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===i&&(r.shared.lanes=0);Fl|=s,e.lanes=s,e.memoizedState=u}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],r=o.callback;if(null!==r){if(o.callback=null,o=n,"function"!==typeof r)throw Error(i(191,r));r.call(o)}}}var Hi=(new o.Component).refs;function qi(e,t,n,o){n=null===(n=n(o,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bi={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),i=Mi(o,r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ni(e,i,r))&&(oc(t,e,r,o),Li(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),i=Mi(o,r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ni(e,i,r))&&(oc(t,e,r,o),Li(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),o=nc(e),r=Mi(n,o);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ni(e,r,o))&&(oc(t,e,o,n),Li(t,e,o))}};function Vi(e,t,n,o,r,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lo(n,o)||!lo(r,i))}function ji(e,t,n){var o=!1,r=Er,i=t.contextType;return"object"===typeof i&&null!==i?i=Ti(i):(r=Dr(t)?Pr:Ar.current,i=(o=null!==(o=t.contextTypes)&&void 0!==o)?Or(e,r):Er),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bi,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ki(e,t,n,o){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,o),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&Bi.enqueueReplaceState(t,t.state,null)}function Gi(e,t,n,o){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Hi,Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?r.context=Ti(i):(i=Dr(t)?Pr:Ar.current,r.context=Or(e,i)),r.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(qi(e,t,i,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Bi.enqueueReplaceState(r,r.state,null),Ui(e,n,r,o),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function $i(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var o=n.stateNode}if(!o)throw Error(i(147,e));var r=o,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===Hi&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qi(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,n){if(e){var o=t.deletions;null===o?(t.deletions=[n],t.flags|=16):o.push(n)}}function n(n,o){if(!e)return null;for(;null!==o;)t(n,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function s(t,n,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<n?(t.flags|=2,n):o:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,o){return null===t||6!==t.tag?((t=Uc(n,e.mode,o)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,o){var i=n.type;return i===C?u(e,t,n.props.children,o,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&Qi(i)===t.type)?((o=r(t,n.props)).ref=$i(e,t,n),o.return=e,o):((o=Nc(n.type,n.key,n.props,null,e.mode,o)).ref=$i(e,t,n),o.return=e,o)}function d(e,t,n,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,o)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,o,i){return null===t||7!==t.tag?((t=Lc(n,e.mode,o,i)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Nc(t.type,t.key,t.props,null,e.mode,n)).ref=$i(e,null,t),n.return=e,n;case x:return(t=zc(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||N(t))return(t=Lc(t,e.mode,n,null)).return=e,t;Wi(e,t)}return null}function p(e,t,n,o){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?c(e,t,n,o):null;case x:return n.key===r?d(e,t,n,o):null;case O:return p(e,t,(r=n._init)(n._payload),o)}if(te(n)||N(n))return null!==r?null:u(e,t,n,o,null);Wi(e,n)}return null}function f(e,t,n,o,r){if("string"===typeof o&&""!==o||"number"===typeof o)return l(t,e=e.get(n)||null,""+o,r);if("object"===typeof o&&null!==o){switch(o.$$typeof){case k:return c(t,e=e.get(null===o.key?n:o.key)||null,o,r);case x:return d(t,e=e.get(null===o.key?n:o.key)||null,o,r);case O:return f(e,t,n,(0,o._init)(o._payload),r)}if(te(o)||N(o))return u(t,e=e.get(n)||null,o,r,null);Wi(t,o)}return null}function g(r,i,a,l){for(var c=null,d=null,u=i,g=i=0,v=null;null!==u&&g<a.length;g++){u.index>g?(v=u,u=null):v=u.sibling;var m=p(r,u,a[g],l);if(null===m){null===u&&(u=v);break}e&&u&&null===m.alternate&&t(r,u),i=s(m,i,g),null===d?c=m:d.sibling=m,d=m,u=v}if(g===a.length)return n(r,u),ii&&Xr(r,g),c;if(null===u){for(;g<a.length;g++)null!==(u=h(r,a[g],l))&&(i=s(u,i,g),null===d?c=u:d.sibling=u,d=u);return ii&&Xr(r,g),c}for(u=o(r,u);g<a.length;g++)null!==(v=f(u,r,g,a[g],l))&&(e&&null!==v.alternate&&u.delete(null===v.key?g:v.key),i=s(v,i,g),null===d?c=v:d.sibling=v,d=v);return e&&u.forEach((function(e){return t(r,e)})),ii&&Xr(r,g),c}function v(r,a,l,c){var d=N(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,g=a,v=a=0,m=null,y=l.next();null!==g&&!y.done;v++,y=l.next()){g.index>v?(m=g,g=null):m=g.sibling;var b=p(r,g,y.value,c);if(null===b){null===g&&(g=m);break}e&&g&&null===b.alternate&&t(r,g),a=s(b,a,v),null===u?d=b:u.sibling=b,u=b,g=m}if(y.done)return n(r,g),ii&&Xr(r,v),d;if(null===g){for(;!y.done;v++,y=l.next())null!==(y=h(r,y.value,c))&&(a=s(y,a,v),null===u?d=y:u.sibling=y,u=y);return ii&&Xr(r,v),d}for(g=o(r,g);!y.done;v++,y=l.next())null!==(y=f(g,r,v,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?v:y.key),a=s(y,a,v),null===u?d=y:u.sibling=y,u=y);return e&&g.forEach((function(e){return t(r,e)})),ii&&Xr(r,v),d}return function e(o,i,s,l){if("object"===typeof s&&null!==s&&s.type===C&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case k:e:{for(var c=s.key,d=i;null!==d;){if(d.key===c){if((c=s.type)===C){if(7===d.tag){n(o,d.sibling),(i=r(d,s.props.children)).return=o,o=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===O&&Qi(c)===d.type){n(o,d.sibling),(i=r(d,s.props)).ref=$i(o,d,s),i.return=o,o=i;break e}n(o,d);break}t(o,d),d=d.sibling}s.type===C?((i=Lc(s.props.children,o.mode,l,s.key)).return=o,o=i):((l=Nc(s.type,s.key,s.props,null,o.mode,l)).ref=$i(o,i,s),l.return=o,o=l)}return a(o);case x:e:{for(d=s.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(o,i.sibling),(i=r(i,s.children||[])).return=o,o=i;break e}n(o,i);break}t(o,i),i=i.sibling}(i=zc(s,o.mode,l)).return=o,o=i}return a(o);case O:return e(o,i,(d=s._init)(s._payload),l)}if(te(s))return g(o,i,s,l);if(N(s))return v(o,i,s,l);Wi(o,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(o,i.sibling),(i=r(i,s)).return=o,o=i):(n(o,i),(i=Uc(s,o.mode,l)).return=o,o=i),a(o)):n(o,i)}}var Zi=Yi(!0),Ji=Yi(!1),Xi={},es=Sr(Xi),ts=Sr(Xi),ns=Sr(Xi);function os(e){if(e===Xi)throw Error(i(174));return e}function rs(e,t){switch(Ir(ns,t),Ir(ts,e),Ir(es,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Tr(es),Ir(es,t)}function is(){Tr(es),Tr(ts),Tr(ns)}function ss(e){os(ns.current);var t=os(es.current),n=le(t,e.type);t!==n&&(Ir(ts,e),Ir(es,n))}function as(e){ts.current===e&&(Tr(es),Tr(ts))}var ls=Sr(0);function cs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ds=[];function us(){for(var e=0;e<ds.length;e++)ds[e]._workInProgressVersionPrimary=null;ds.length=0}var hs=w.ReactCurrentDispatcher,ps=w.ReactCurrentBatchConfig,fs=0,gs=null,vs=null,ms=null,ys=!1,bs=!1,ws=0,ks=0;function xs(){throw Error(i(321))}function Cs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ao(e[n],t[n]))return!1;return!0}function _s(e,t,n,o,r,s){if(fs=s,gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?aa:la,e=n(o,r),bs){s=0;do{if(bs=!1,ws=0,25<=s)throw Error(i(301));s+=1,ms=vs=null,t.updateQueue=null,hs.current=ca,e=n(o,r)}while(bs)}if(hs.current=sa,t=null!==vs&&null!==vs.next,fs=0,ms=vs=gs=null,ys=!1,t)throw Error(i(300));return e}function Ss(){var e=0!==ws;return ws=0,e}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ms?gs.memoizedState=ms=e:ms=ms.next=e,ms}function Is(){if(null===vs){var e=gs.alternate;e=null!==e?e.memoizedState:null}else e=vs.next;var t=null===ms?gs.memoizedState:ms.next;if(null!==t)ms=t,vs=e;else{if(null===e)throw Error(i(310));e={memoizedState:(vs=e).memoizedState,baseState:vs.baseState,baseQueue:vs.baseQueue,queue:vs.queue,next:null},null===ms?gs.memoizedState=ms=e:ms=ms.next=e}return ms}function Es(e,t){return"function"===typeof t?t(e):t}function As(e){var t=Is(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=vs,r=o.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}o.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,o=o.baseState;var l=a=null,c=null,d=s;do{var u=d.lane;if((fs&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),o=d.hasEagerState?d.eagerState:e(o,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,a=o):c=c.next=h,gs.lanes|=u,Fl|=u}d=d.next}while(null!==d&&d!==s);null===c?a=o:c.next=l,ao(o,t.memoizedState)||(wa=!0),t.memoizedState=o,t.baseState=a,t.baseQueue=c,n.lastRenderedState=o}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,gs.lanes|=s,Fl|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Rs(e){var t=Is(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);ao(s,t.memoizedState)||(wa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,o]}function Ps(){}function Os(e,t){var n=gs,o=Is(),r=t(),s=!ao(o.memoizedState,r);if(s&&(o.memoizedState=r,wa=!0),o=o.queue,js(Ns.bind(null,n,o,e),[e]),o.getSnapshot!==t||s||null!==ms&&1&ms.memoizedState.tag){if(n.flags|=2048,zs(9,Ms.bind(null,n,o,r,t),void 0,null),null===Rl)throw Error(i(349));0!==(30&fs)||Ds(n,t,r)}return r}function Ds(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ms(e,t,n,o){t.value=n,t.getSnapshot=o,Ls(t)&&Fs(e)}function Ns(e,t,n){return n((function(){Ls(t)&&Fs(e)}))}function Ls(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ao(e,n)}catch(o){return!0}}function Fs(e){var t=Ri(e,1);null!==t&&oc(t,e,1,-1)}function Us(e){var t=Ts();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,gs,e),[t.memoizedState,e]}function zs(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function Hs(){return Is().memoizedState}function qs(e,t,n,o){var r=Ts();gs.flags|=e,r.memoizedState=zs(1|t,n,void 0,void 0===o?null:o)}function Bs(e,t,n,o){var r=Is();o=void 0===o?null:o;var i=void 0;if(null!==vs){var s=vs.memoizedState;if(i=s.destroy,null!==o&&Cs(o,s.deps))return void(r.memoizedState=zs(t,n,i,o))}gs.flags|=e,r.memoizedState=zs(1|t,n,i,o)}function Vs(e,t){return qs(8390656,8,e,t)}function js(e,t){return Bs(2048,8,e,t)}function Ks(e,t){return Bs(4,2,e,t)}function Gs(e,t){return Bs(4,4,e,t)}function $s(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ws(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bs(4,4,$s.bind(null,t,e),n)}function Qs(){}function Ys(e,t){var n=Is();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&Cs(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function Zs(e,t){var n=Is();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&Cs(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function Js(e,t,n){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n):(ao(n,t)||(n=gt(),gs.lanes|=n,Fl|=n,e.baseState=!0),t)}function Xs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var o=ps.transition;ps.transition={};try{e(!1),t()}finally{bt=n,ps.transition=o}}function ea(){return Is().memoizedState}function ta(e,t,n){var o=nc(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},oa(e))ra(t,n);else if(null!==(n=Ai(e,t,n,o))){oc(n,e,o,tc()),ia(n,t,o)}}function na(e,t,n){var o=nc(e),r={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(oa(e))ra(t,r);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(r.hasEagerState=!0,r.eagerState=a,ao(a,s)){var l=t.interleaved;return null===l?(r.next=r,Ei(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ai(e,t,r,o))&&(oc(n,e,o,r=tc()),ia(n,t,o))}}function oa(e){var t=e.alternate;return e===gs||null!==t&&t===gs}function ra(e,t){bs=ys=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ia(e,t,n){if(0!==(4194240&n)){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,yt(e,n)}}var sa={readContext:Ti,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},aa={readContext:Ti,useCallback:function(e,t){return Ts().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:Vs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qs(4194308,4,$s.bind(null,t,e),n)},useLayoutEffect:function(e,t){return qs(4194308,4,e,t)},useInsertionEffect:function(e,t){return qs(4,2,e,t)},useMemo:function(e,t){var n=Ts();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=Ts();return t=void 0!==n?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=ta.bind(null,gs,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},Ts().memoizedState=e},useState:Us,useDebugValue:Qs,useDeferredValue:function(e){return Ts().memoizedState=e},useTransition:function(){var e=Us(!1),t=e[0];return e=Xs.bind(null,e[1]),Ts().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=gs,r=Ts();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Rl)throw Error(i(349));0!==(30&fs)||Ds(o,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Vs(Ns.bind(null,o,s,e),[e]),o.flags|=2048,zs(9,Ms.bind(null,o,s,n,t),void 0,null),n},useId:function(){var e=Ts(),t=Rl.identifierPrefix;if(ii){var n=Jr;t=":"+t+"R"+(n=(Zr&~(1<<32-st(Zr)-1)).toString(32)+n),0<(n=ws++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ks++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Ti,useCallback:Ys,useContext:Ti,useEffect:js,useImperativeHandle:Ws,useInsertionEffect:Ks,useLayoutEffect:Gs,useMemo:Zs,useReducer:As,useRef:Hs,useState:function(){return As(Es)},useDebugValue:Qs,useDeferredValue:function(e){return Js(Is(),vs.memoizedState,e)},useTransition:function(){return[As(Es)[0],Is().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Os,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Ti,useCallback:Ys,useContext:Ti,useEffect:js,useImperativeHandle:Ws,useInsertionEffect:Ks,useLayoutEffect:Gs,useMemo:Zs,useReducer:Rs,useRef:Hs,useState:function(){return Rs(Es)},useDebugValue:Qs,useDeferredValue:function(e){var t=Is();return null===vs?t.memoizedState=e:Js(t,vs.memoizedState,e)},useTransition:function(){return[Rs(Es)[0],Is().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Os,useId:ea,unstable_isNewReconciler:!1};function da(e,t){try{var n="",o=t;do{n+=q(o),o=o.return}while(o);var r=n}catch(i){r="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Mi(-1,n)).tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){Kl||(Kl=!0,Gl=o),ha(0,t)},n}function ga(e,t,n){(n=Mi(-1,n)).tag=3;var o=e.type.getDerivedStateFromError;if("function"===typeof o){var r=t.value;n.payload=function(){return o(r)},n.callback=function(){ha(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof o&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function va(e,t,n){var o=e.pingCache;if(null===o){o=e.pingCache=new pa;var r=new Set;o.set(t,r)}else void 0===(r=o.get(t))&&(r=new Set,o.set(t,r));r.has(n)||(r.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,o,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Mi(-1,1)).tag=2,Ni(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ba=w.ReactCurrentOwner,wa=!1;function ka(e,t,n,o){t.child=null===e?Ji(t,null,n,o):Zi(t,e.child,n,o)}function xa(e,t,n,o,r){n=n.render;var i=t.ref;return Si(t,r),o=_s(e,t,n,o,i,r),n=Ss(),null===e||wa?(ii&&n&&ti(t),t.flags|=1,ka(e,t,o,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ka(e,t,r))}function Ca(e,t,n,o,r){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nc(n.type,null,o,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,_a(e,t,i,o,r))}if(i=e.child,0===(e.lanes&r)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lo)(s,o)&&e.ref===t.ref)return Ka(e,t,r)}return t.flags|=1,(e=Mc(i,o)).ref=t.ref,e.return=t,t.child=e}function _a(e,t,n,o,r){if(null!==e){var i=e.memoizedProps;if(lo(i,o)&&e.ref===t.ref){if(wa=!1,t.pendingProps=o=i,0===(e.lanes&r))return t.lanes=e.lanes,Ka(e,t,r);0!==(131072&e.flags)&&(wa=!0)}}return Ia(e,t,n,o,r)}function Sa(e,t,n){var o=t.pendingProps,r=o.children,i=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ir(Ml,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ir(Ml,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==i?i.baseLanes:n,Ir(Ml,Dl),Dl|=o}else null!==i?(o=i.baseLanes|n,t.memoizedState=null):o=n,Ir(Ml,Dl),Dl|=o;return ka(e,t,r,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ia(e,t,n,o,r){var i=Dr(n)?Pr:Ar.current;return i=Or(t,i),Si(t,r),n=_s(e,t,n,o,i,r),o=Ss(),null===e||wa?(ii&&o&&ti(t),t.flags|=1,ka(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ka(e,t,r))}function Ea(e,t,n,o,r){if(Dr(n)){var i=!0;Fr(t)}else i=!1;if(Si(t,r),null===t.stateNode)ja(e,t),ji(t,n,o),Gi(t,n,o,r),o=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ti(c):c=Or(t,c=Dr(n)?Pr:Ar.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==o||l!==c)&&Ki(t,s,o,c),Pi=!1;var h=t.memoizedState;s.state=h,Ui(t,o,s,r),l=t.memoizedState,a!==o||h!==l||Rr.current||Pi?("function"===typeof d&&(qi(t,n,d,o),l=t.memoizedState),(a=Pi||Vi(t,n,a,o,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),s.props=o,s.state=l,s.context=c,o=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),o=!1)}else{s=t.stateNode,Di(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:mi(t.type,a),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ti(l):l=Or(t,l=Dr(n)?Pr:Ar.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==u||h!==l)&&Ki(t,s,o,l),Pi=!1,h=t.memoizedState,s.state=h,Ui(t,o,s,r);var f=t.memoizedState;a!==u||h!==f||Rr.current||Pi?("function"===typeof p&&(qi(t,n,p,o),f=t.memoizedState),(c=Pi||Vi(t,n,c,o,h,f,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(o,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(o,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=f),s.props=o,s.state=f,s.context=l,o=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),o=!1)}return Aa(e,t,n,o,i,r)}function Aa(e,t,n,o,r,i){Ta(e,t);var s=0!==(128&t.flags);if(!o&&!s)return r&&Ur(t,n,!1),Ka(e,t,i);o=t.stateNode,ba.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&s?(t.child=Zi(t,e.child,null,i),t.child=Zi(t,null,a,i)):ka(e,t,a,i),t.memoizedState=o.state,r&&Ur(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Nr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Nr(0,t.context,!1),rs(e,t.containerInfo)}function Pa(e,t,n,o,r){return fi(),gi(r),t.flags|=256,ka(e,t,n,o),t.child}var Oa,Da,Ma,Na,La={dehydrated:null,treeContext:null,retryLane:0};function Fa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ua(e,t,n){var o,r=t.pendingProps,s=ls.current,a=!1,l=0!==(128&t.flags);if((o=l)||(o=(null===e||null!==e.memoizedState)&&0!==(2&s)),o?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ir(ls,1&s),null===e)return di(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fc(l,r,0,null),e=Lc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Fa(n),t.memoizedState=La,e):za(t,l));if(null!==(s=e.memoizedState)&&null!==(o=s.dehydrated))return function(e,t,n,o,r,s,a){if(n)return 256&t.flags?(t.flags&=-257,Ha(e,t,a,o=ua(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=o.fallback,r=t.mode,o=Fc({mode:"visible",children:o.children},r,0,null),(s=Lc(s,r,a,null)).flags|=2,o.return=t,s.return=t,o.sibling=s,t.child=o,0!==(1&t.mode)&&Zi(t,e.child,null,a),t.child.memoizedState=Fa(a),t.memoizedState=La,s);if(0===(1&t.mode))return Ha(e,t,a,null);if("$!"===r.data){if(o=r.nextSibling&&r.nextSibling.dataset)var l=o.dgst;return o=l,Ha(e,t,a,o=ua(s=Error(i(419)),o,void 0))}if(l=0!==(a&e.childLanes),wa||l){if(null!==(o=Rl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(o.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Ri(e,r),oc(o,e,r,-1))}return vc(),Ha(e,t,a,o=ua(Error(i(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,ri=dr(r.nextSibling),oi=t,ii=!0,si=null,null!==e&&(Wr[Qr++]=Zr,Wr[Qr++]=Jr,Wr[Qr++]=Yr,Zr=e.id,Jr=e.overflow,Yr=t),t=za(t,o.children),t.flags|=4096,t)}(e,t,l,r,o,s,n);if(a){a=r.fallback,l=t.mode,o=(s=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Mc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==o?a=Mc(o,a):(a=Lc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=La,r}return e=(a=e.child).sibling,r=Mc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function za(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ha(e,t,n,o){return null!==o&&gi(o),Zi(t,e.child,null,n),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),_i(e.return,t,n)}function Ba(e,t,n,o,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=o,i.tail=n,i.tailMode=r)}function Va(e,t,n){var o=t.pendingProps,r=o.revealOrder,i=o.tail;if(ka(e,t,o.children,n),0!==(2&(o=ls.current)))o=1&o|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Ir(ls,o),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===cs(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ba(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===cs(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ba(t,!0,n,null,i);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ja(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ka(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function $a(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,o=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=14680064&r.subtreeFlags,o|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=r.subtreeFlags,o|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Wa(e,t,n){var o=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $a(t),null;case 1:case 17:return Dr(t.type)&&Mr(),$a(t),null;case 3:return o=t.stateNode,is(),Tr(Rr),Tr(Ar),us(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==si&&(ac(si),si=null))),Da(e,t),$a(t),null;case 5:as(t);var r=os(ns.current);if(n=t.type,null!==e&&null!=t.stateNode)Ma(e,t,n,o,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(i(166));return $a(t),null}if(e=os(es.current),hi(t)){o=t.stateNode,n=t.type;var s=t.memoizedProps;switch(o[pr]=t,o[fr]=s,e=0!==(1&t.mode),n){case"dialog":Ho("cancel",o),Ho("close",o);break;case"iframe":case"object":case"embed":Ho("load",o);break;case"video":case"audio":for(r=0;r<Lo.length;r++)Ho(Lo[r],o);break;case"source":Ho("error",o);break;case"img":case"image":case"link":Ho("error",o),Ho("load",o);break;case"details":Ho("toggle",o);break;case"input":Y(o,s),Ho("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},Ho("invalid",o);break;case"textarea":re(o,s),Ho("invalid",o)}for(var l in ye(n,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?o.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xo(o.textContent,c,e),r=["children",c]):"number"===typeof c&&o.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xo(o.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ho("scroll",o)}switch(n){case"input":G(o),X(o,s,!0);break;case"textarea":G(o),se(o);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(o.onclick=er)}o=r,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof o.is?e=l.createElement(n,{is:o.is}):(e=l.createElement(n),"select"===n&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,n),e[pr]=t,e[fr]=o,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,o),n){case"dialog":Ho("cancel",e),Ho("close",e),r=o;break;case"iframe":case"object":case"embed":Ho("load",e),r=o;break;case"video":case"audio":for(r=0;r<Lo.length;r++)Ho(Lo[r],e);r=o;break;case"source":Ho("error",e),r=o;break;case"img":case"image":case"link":Ho("error",e),Ho("load",e),r=o;break;case"details":Ho("toggle",e),r=o;break;case"input":Y(e,o),r=Q(e,o),Ho("invalid",e);break;case"option":default:r=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},r=F({},o,{value:void 0}),Ho("invalid",e);break;case"textarea":re(e,o),r=oe(e,o),Ho("invalid",e)}for(s in ye(n,r),c=r)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ve(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Ho("scroll",e):null!=d&&b(e,s,d,l))}switch(n){case"input":G(e),X(e,o,!1);break;case"textarea":G(e),se(e);break;case"option":null!=o.value&&e.setAttribute("value",""+j(o.value));break;case"select":e.multiple=!!o.multiple,null!=(s=o.value)?ne(e,!!o.multiple,s,!1):null!=o.defaultValue&&ne(e,!!o.multiple,o.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=er)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $a(t),null;case 6:if(e&&null!=t.stateNode)Na(e,t,e.memoizedProps,o);else{if("string"!==typeof o&&null===t.stateNode)throw Error(i(166));if(n=os(ns.current),os(es.current),hi(t)){if(o=t.stateNode,n=t.memoizedProps,o[pr]=t,(s=o.nodeValue!==n)&&null!==(e=oi))switch(e.tag){case 3:Xo(o.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xo(o.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(o=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[pr]=t,t.stateNode=o}return $a(t),null;case 13:if(Tr(ls),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))pi(),fi(),t.flags|=98560,s=!1;else if(s=hi(t),null!==o&&null!==o.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[pr]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$a(t),s=!1}else null!==si&&(ac(si),si=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((o=null!==o)!==(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ls.current)?0===Nl&&(Nl=3):vc())),null!==t.updateQueue&&(t.flags|=4),$a(t),null);case 4:return is(),Da(e,t),null===e&&Vo(t.stateNode.containerInfo),$a(t),null;case 10:return Ci(t.type._context),$a(t),null;case 19:if(Tr(ls),null===(s=t.memoizedState))return $a(t),null;if(o=0!==(128&t.flags),null===(l=s.rendering))if(o)Ga(s,!1);else{if(0!==Nl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=cs(e))){for(t.flags|=128,Ga(s,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;null!==n;)e=o,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ir(ls,1&ls.current|2),t.child}e=e.sibling}null!==s.tail&&Ze()>Vl&&(t.flags|=128,o=!0,Ga(s,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=cs(l))){if(t.flags|=128,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ii)return $a(t),null}else 2*Ze()-s.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,o=!0,Ga(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ze(),t.sibling=null,n=ls.current,Ir(ls,o?1&n|2:1&n),t):($a(t),null);case 22:case 23:return hc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&0!==(1&t.mode)?0!==(1073741824&Dl)&&($a(t),6&t.subtreeFlags&&(t.flags|=8192)):$a(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qa(e,t){switch(ni(t),t.tag){case 1:return Dr(t.type)&&Mr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Tr(Rr),Tr(Ar),us(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Tr(ls),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Tr(ls),null;case 4:return is(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Ma=function(e,t,n,o){var r=e.memoizedProps;if(r!==o){e=t.stateNode,os(es.current);var i,s=null;switch(n){case"input":r=Q(e,r),o=Q(e,o),s=[];break;case"select":r=F({},r,{value:void 0}),o=F({},o,{value:void 0}),s=[];break;case"textarea":r=oe(e,r),o=oe(e,o),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof o.onClick&&(e.onclick=er)}for(d in ye(n,o),n=null,r)if(!o.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(a.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in o){var c=o[d];if(l=null!=r?r[d]:void 0,o.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(a.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ho("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Na=function(e,t,n,o){n!==o&&(t.flags|=4)};var Ya=!1,Za=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(o){Sc(e,t,o)}else n.current=null}function tl(e,t,n){try{n()}catch(o){Sc(e,t,o)}}var nl=!1;function ol(e,t,n){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var r=o=o.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,void 0!==i&&tl(t,n,i)}r=r.next}while(r!==o)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pr],delete t[fr],delete t[vr],delete t[mr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=er));else if(4!==o&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==o&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Za||el(n,t);case 6:var o=ul,r=hl;ul=null,pl(e,t,n),hl=r,null!==(ul=o)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),Bt(e)):cr(ul,n.stateNode));break;case 4:o=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,pl(e,t,n),ul=o,hl=r;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(o=n.updateQueue)&&null!==(o=o.lastEffect))){r=o=o.next;do{var i=r,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&tl(n,t,s),r=r.next}while(r!==o)}pl(e,t,n);break;case 1:if(!Za&&(el(n,t),"function"===typeof(o=n.stateNode).componentWillUnmount))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(a){Sc(n,t,a)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Za=(o=Za)||null!==n.memoizedState,pl(e,t,n),Za=o):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var o=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(o,o))}))}}function vl(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var r=n[o];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));fl(s,a,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){Sc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vl(t,e),yl(e),4&o){try{ol(3,e,e.return),rl(3,e)}catch(v){Sc(e,e.return,v)}try{ol(5,e,e.return)}catch(v){Sc(e,e.return,v)}}break;case 1:vl(t,e),yl(e),512&o&&null!==n&&el(n,n.return);break;case 5:if(vl(t,e),yl(e),512&o&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(v){Sc(e,e.return,v)}}if(4&o&&null!=(r=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Z(r,s),be(l,a);var d=be(l,s);for(a=0;a<c.length;a+=2){var u=c[a],h=c[a+1];"style"===u?ve(r,h):"dangerouslySetInnerHTML"===u?ue(r,h):"children"===u?he(r,h):b(r,u,h,d)}switch(l){case"input":J(r,s);break;case"textarea":ie(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(r,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(r,!!s.multiple,s.defaultValue,!0):ne(r,!!s.multiple,s.multiple?[]:"",!1))}r[fr]=s}catch(v){Sc(e,e.return,v)}}break;case 6:if(vl(t,e),yl(e),4&o){if(null===e.stateNode)throw Error(i(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(v){Sc(e,e.return,v)}}break;case 3:if(vl(t,e),yl(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(v){Sc(e,e.return,v)}break;case 4:default:vl(t,e),yl(e);break;case 13:vl(t,e),yl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Bl=Ze())),4&o&&gl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(d=Za)||u,vl(t,e),Za=d):vl(t,e),yl(e),8192&o){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xa=e,u=e.child;null!==u;){for(h=Xa=u;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:ol(4,p,p.return);break;case 1:el(p,p.return);var g=p.stateNode;if("function"===typeof g.componentWillUnmount){o=p,n=p.return;try{t=o,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){Sc(o,n,v)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){xl(h);continue}}null!==f?(f.return=p,Xa=f):xl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{r=h.stateNode,d?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(v){Sc(e,e.return,v)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(v){Sc(e,e.return,v)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vl(t,e),yl(e),4&o&&gl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var o=n;break e}n=n.return}throw Error(i(160))}switch(o.tag){case 5:var r=o.stateNode;32&o.flags&&(he(r,""),o.flags&=-33),dl(e,ll(e),r);break;case 3:case 4:var s=o.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(i(161))}}catch(a){Sc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Xa=e,wl(e,t,n)}function wl(e,t,n){for(var o=0!==(1&e.mode);null!==Xa;){var r=Xa,i=r.child;if(22===r.tag&&o){var s=null!==r.memoizedState||Ya;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Za;a=Ya;var c=Za;if(Ya=s,(Za=l)&&!c)for(Xa=r;null!==Xa;)l=(s=Xa).child,22===s.tag&&null!==s.memoizedState?Cl(r):null!==l?(l.return=s,Xa=l):Cl(r);for(;null!==i;)Xa=i,wl(i,t,n),i=i.sibling;Xa=r,Ya=a,Za=c}kl(e)}else 0!==(8772&r.subtreeFlags)&&null!==i?(i.return=r,Xa=i):kl(e)}}function kl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||rl(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Za)if(null===n)o.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);o.componentDidUpdate(r,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&zi(t,s,o);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(i(163))}Za||512&t.flags&&il(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function xl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Cl(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var o=t.stateNode;if("function"===typeof o.componentDidMount){var r=t.return;try{o.componentDidMount()}catch(l){Sc(t,r,l)}}var i=t.return;try{il(t)}catch(l){Sc(t,i,l)}break;case 5:var s=t.return;try{il(t)}catch(l){Sc(t,s,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var _l,Sl=Math.ceil,Tl=w.ReactCurrentDispatcher,Il=w.ReactCurrentOwner,El=w.ReactCurrentBatchConfig,Al=0,Rl=null,Pl=null,Ol=0,Dl=0,Ml=Sr(0),Nl=0,Ll=null,Fl=0,Ul=0,zl=0,Hl=null,ql=null,Bl=0,Vl=1/0,jl=null,Kl=!1,Gl=null,$l=null,Wl=!1,Ql=null,Yl=0,Zl=0,Jl=null,Xl=-1,ec=0;function tc(){return 0!==(6&Al)?Ze():-1!==Xl?Xl:Xl=Ze()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Ol?Ol&-Ol:null!==vi.transition?(0===ec&&(ec=gt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function oc(e,t,n,o){if(50<Zl)throw Zl=0,Jl=null,Error(i(185));mt(e,n,o),0!==(2&Al)&&e===Rl||(e===Rl&&(0===(2&Al)&&(Ul|=n),4===Nl&&lc(e,Ol)),rc(e,o),1===n&&0===Al&&0===(1&t.mode)&&(Vl=Ze()+500,Hr&&Vr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),a=1<<s,l=r[s];-1===l?0!==(a&n)&&0===(a&o)||(r[s]=pt(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}}(e,t);var o=ht(e,e===Rl?Ol:0);if(0===o)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){Hr=!0,Br(e)}(cc.bind(null,e)):Br(cc.bind(null,e)),ar((function(){0===(6&Al)&&Vr()})),n=null;else{switch(wt(o)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=ot}n=Rc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Xl=-1,ec=0,0!==(6&Al))throw Error(i(327));var n=e.callbackNode;if(Cc()&&e.callbackNode!==n)return null;var o=ht(e,e===Rl?Ol:0);if(0===o)return null;if(0!==(30&o)||0!==(o&e.expiredLanes)||t)t=mc(e,o);else{t=o;var r=Al;Al|=2;var s=gc();for(Rl===e&&Ol===t||(jl=null,Vl=Ze()+500,pc(e,t));;)try{bc();break}catch(l){fc(e,l)}xi(),Tl.current=s,Al=r,null!==Pl?t=0:(Rl=null,Ol=0,t=Nl)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(o=r,t=sc(e,r))),1===t)throw n=Ll,pc(e,0),lc(e,o),rc(e,Ze()),n;if(6===t)lc(e,o);else{if(r=e.current.alternate,0===(30&o)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var o=0;o<n.length;o++){var r=n[o],i=r.getSnapshot;r=r.value;try{if(!ao(i(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=mc(e,o))&&(0!==(s=ft(e))&&(o=s,t=sc(e,s))),1===t))throw n=Ll,pc(e,0),lc(e,o),rc(e,Ze()),n;switch(e.finishedWork=r,e.finishedLanes=o,t){case 0:case 1:throw Error(i(345));case 2:case 5:xc(e,ql,jl);break;case 3:if(lc(e,o),(130023424&o)===o&&10<(t=Bl+500-Ze())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&o)!==o){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=rr(xc.bind(null,e,ql,jl),t);break}xc(e,ql,jl);break;case 4:if(lc(e,o),(4194240&o)===o)break;for(t=e.eventTimes,r=-1;0<o;){var a=31-st(o);s=1<<a,(a=t[a])>r&&(r=a),o&=~s}if(o=r,10<(o=(120>(o=Ze()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Sl(o/1960))-o)){e.timeoutHandle=rr(xc.bind(null,e,ql,jl),o);break}xc(e,ql,jl);break;default:throw Error(i(329))}}}return rc(e,Ze()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Hl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=ql,ql=n,null!==t&&ac(t)),e}function ac(e){null===ql?ql=e:ql.push.apply(ql,e)}function lc(e,t){for(t&=~zl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),o=1<<n;e[n]=-1,t&=~o}}function cc(e){if(0!==(6&Al))throw Error(i(327));Cc();var t=ht(e,0);if(0===(1&t))return rc(e,Ze()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var o=ft(e);0!==o&&(t=o,n=sc(e,o))}if(1===n)throw n=Ll,pc(e,0),lc(e,t),rc(e,Ze()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,ql,jl),rc(e,Ze()),null}function dc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Vl=Ze()+500,Hr&&Vr())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Al)&&Cc();var t=Al;Al|=1;var n=El.transition,o=bt;try{if(El.transition=null,bt=1,e)return e()}finally{bt=o,El.transition=n,0===(6&(Al=t))&&Vr()}}function hc(){Dl=Ml.current,Tr(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ir(n)),null!==Pl)for(n=Pl.return;null!==n;){var o=n;switch(ni(o),o.tag){case 1:null!==(o=o.type.childContextTypes)&&void 0!==o&&Mr();break;case 3:is(),Tr(Rr),Tr(Ar),us();break;case 5:as(o);break;case 4:is();break;case 13:case 19:Tr(ls);break;case 10:Ci(o.type._context);break;case 22:case 23:hc()}n=n.return}if(Rl=e,Pl=e=Mc(e.current,null),Ol=Dl=t,Nl=0,Ll=null,zl=Ul=Fl=0,ql=Hl=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(o=(n=Ii[t]).interleaved)){n.interleaved=null;var r=o.next,i=n.pending;if(null!==i){var s=i.next;i.next=r,o.next=s}n.pending=o}Ii=null}return e}function fc(e,t){for(;;){var n=Pl;try{if(xi(),hs.current=sa,ys){for(var o=gs.memoizedState;null!==o;){var r=o.queue;null!==r&&(r.pending=null),o=o.next}ys=!1}if(fs=0,ms=vs=gs=null,bs=!1,ws=0,Il.current=null,null===n||null===n.return){Nl=1,Ll=t,Pl=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=ma(a);if(null!==f){f.flags&=-257,ya(f,a,l,0,t),1&f.mode&&va(s,d,t),c=d;var g=(t=f).updateQueue;if(null===g){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}if(0===(1&t)){va(s,d,t),vc();break e}c=Error(i(426))}else if(ii&&1&l.mode){var m=ma(a);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ya(m,a,l,0,t),gi(da(c,l));break e}}s=c=da(c,l),4!==Nl&&(Nl=2),null===Hl?Hl=[s]:Hl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Fi(s,fa(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===$l||!$l.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Fi(s,ga(s,l,t));break e}}s=s.return}while(null!==s)}kc(n)}catch(w){t=w,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function gc(){var e=Tl.current;return Tl.current=sa,null===e?sa:e}function vc(){0!==Nl&&3!==Nl&&2!==Nl||(Nl=4),null===Rl||0===(268435455&Fl)&&0===(268435455&Ul)||lc(Rl,Ol)}function mc(e,t){var n=Al;Al|=2;var o=gc();for(Rl===e&&Ol===t||(jl=null,pc(e,t));;)try{yc();break}catch(r){fc(e,r)}if(xi(),Al=n,Tl.current=o,null!==Pl)throw Error(i(261));return Rl=null,Ol=0,Nl}function yc(){for(;null!==Pl;)wc(Pl)}function bc(){for(;null!==Pl&&!Qe();)wc(Pl)}function wc(e){var t=_l(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?kc(e):Pl=t,Il.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wa(n,t,Dl)))return void(Pl=n)}else{if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Nl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Nl&&(Nl=5)}function xc(e,t,n){var o=bt,r=El.transition;try{El.transition=null,bt=1,function(e,t,n,o){do{Cc()}while(null!==Ql);if(0!==(6&Al))throw Error(i(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),i=1<<r;t[r]=0,o[r]=-1,e[r]=-1,n&=~i}}(e,s),e===Rl&&(Pl=Rl=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,Rc(tt,(function(){return Cc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=El.transition,El.transition=null;var a=bt;bt=1;var l=Al;Al|=4,Il.current=null,function(e,t){if(tr=jt,fo(e=po())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var r=o.anchorOffset,s=o.focusNode;o=o.focusOffset;try{n.nodeType,s.nodeType}catch(k){n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(l=a+r),h!==s||0!==o&&3!==h.nodeType||(c=a+o),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++d===r&&(l=a),p===s&&++u===o&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nr={focusedElem:e,selectionRange:n},jt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var v=g.memoizedProps,m=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?v:mi(t.type,v),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(k){Sc(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}g=nl,nl=!1}(e,n),ml(n,e),go(nr),jt=!!tr,nr=tr=null,e.current=n,bl(n,e,r),Ye(),Al=l,bt=a,El.transition=s}else e.current=n;if(Wl&&(Wl=!1,Ql=e,Yl=r),s=e.pendingLanes,0===s&&($l=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ze()),null!==t)for(o=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],o(r.value,{componentStack:r.stack,digest:r.digest});if(Kl)throw Kl=!1,e=Gl,Gl=null,e;0!==(1&Yl)&&0!==e.tag&&Cc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Zl++:(Zl=0,Jl=e):Zl=0,Vr()}(e,t,n,o)}finally{El.transition=r,bt=o}return null}function Cc(){if(null!==Ql){var e=wt(Yl),t=El.transition,n=bt;try{if(El.transition=null,bt=16>e?16:e,null===Ql)var o=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Al))throw Error(i(331));var r=Al;for(Al|=4,Xa=e.current;null!==Xa;){var s=Xa,a=s.child;if(0!==(16&Xa.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xa=d;null!==Xa;){var u=Xa;switch(u.tag){case 0:case 11:case 15:ol(8,u,s)}var h=u.child;if(null!==h)h.return=u,Xa=h;else for(;null!==Xa;){var p=(u=Xa).sibling,f=u.return;if(sl(u),u===d){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var g=s.alternate;if(null!==g){var v=g.child;if(null!==v){g.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(null!==v)}}Xa=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(s=Xa).flags))switch(s.tag){case 0:case 11:case 15:ol(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Xa=y;break e}Xa=s.return}}var b=e.current;for(Xa=b;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=b;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(x){Sc(l,l.return,x)}if(l===a){Xa=null;break e}var k=l.sibling;if(null!==k){k.return=l.return,Xa=k;break e}Xa=l.return}}if(Al=r,Vr(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(x){}o=!0}return o}finally{bt=n,El.transition=t}}return!1}function _c(e,t,n){e=Ni(e,t=fa(0,t=da(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var o=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof o.componentDidCatch&&(null===$l||!$l.has(o))){t=Ni(t,e=ga(t,e=da(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),rc(t,e));break}}t=t.return}}function Tc(e,t,n){var o=e.pingCache;null!==o&&o.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Ol&n)===n&&(4===Nl||3===Nl&&(130023424&Ol)===Ol&&500>Ze()-Bl?pc(e,0):zl|=n),rc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Ri(e,t))&&(mt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(i(314))}null!==o&&o.delete(t),Ic(e,n)}function Rc(e,t){return $e(e,t)}function Pc(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oc(e,t,n,o){return new Pc(e,t,n,o)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Oc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nc(e,t,n,o,r,s){var a=2;if(o=e,"function"===typeof e)Dc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case C:return Lc(n.children,r,s,t);case _:a=8,r|=8;break;case S:return(e=Oc(12,n,t,2|r)).elementType=S,e.lanes=s,e;case A:return(e=Oc(13,n,t,r)).elementType=A,e.lanes=s,e;case R:return(e=Oc(19,n,t,r)).elementType=R,e.lanes=s,e;case D:return Fc(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case I:a=9;break e;case E:a=11;break e;case P:a=14;break e;case O:a=16,o=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Oc(a,n,t,r)).elementType=e,t.type=o,t.lanes=s,t}function Lc(e,t,n,o){return(e=Oc(7,e,o,t)).lanes=n,e}function Fc(e,t,n,o){return(e=Oc(22,e,o,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Oc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Oc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hc(e,t,n,o,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=o,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function qc(e,t,n,o,r,i,s,a,l){return e=new Hc(e,t,n,a,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Oc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Bc(e){if(!e)return Er;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Dr(n))return Lr(e,n,t)}return t}function Vc(e,t,n,o,r,i,s,a,l){return(e=qc(n,o,!0,e,0,i,0,a,l)).context=Bc(null),n=e.current,(i=Mi(o=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,Ni(n,i,r),e.current.lanes=r,mt(e,r,o),rc(e,o),e}function jc(e,t,n,o){var r=t.current,i=tc(),s=nc(r);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Mi(i,s)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Ni(r,t,s))&&(oc(e,r,s,i),Li(e,r,s)),s}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function $c(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Rr.current)wa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),fi();break;case 5:ss(t);break;case 1:Dr(t.type)&&Fr(t);break;case 4:rs(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,r=t.memoizedProps.value;Ir(yi,o._currentValue),o._currentValue=r;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(Ir(ls,1&ls.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ua(e,t,n):(Ir(ls,1&ls.current),null!==(e=Ka(e,t,n))?e.sibling:null);Ir(ls,1&ls.current);break;case 19:if(o=0!==(n&t.childLanes),0!==(128&e.flags)){if(o)return Va(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ir(ls,ls.current),o)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return Ka(e,t,n)}(e,t,n);wa=0!==(131072&e.flags)}else wa=!1,ii&&0!==(1048576&t.flags)&&ei(t,$r,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;ja(e,t),e=t.pendingProps;var r=Or(t,Ar.current);Si(t,n),r=_s(null,t,o,e,r,n);var s=Ss();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(o)?(s=!0,Fr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Oi(t),r.updater=Bi,t.stateNode=r,r._reactInternals=t,Gi(t,o,e,n),t=Aa(null,t,o,!0,s,n)):(t.tag=0,ii&&s&&ti(t),ka(null,t,r,n),t=t.child),t;case 16:o=t.elementType;e:{switch(ja(e,t),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===P)return 14}return 2}(o),e=mi(o,e),r){case 0:t=Ia(null,t,o,e,n);break e;case 1:t=Ea(null,t,o,e,n);break e;case 11:t=xa(null,t,o,e,n);break e;case 14:t=Ca(null,t,o,mi(o.type,e),n);break e}throw Error(i(306,o,""))}return t;case 0:return o=t.type,r=t.pendingProps,Ia(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 1:return o=t.type,r=t.pendingProps,Ea(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 3:e:{if(Ra(t),null===e)throw Error(i(387));o=t.pendingProps,r=(s=t.memoizedState).element,Di(e,t),Ui(t,o,null,n);var a=t.memoizedState;if(o=a.element,s.isDehydrated){if(s={element:o,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Pa(e,t,o,n,r=da(Error(i(423)),t));break e}if(o!==r){t=Pa(e,t,o,n,r=da(Error(i(424)),t));break e}for(ri=dr(t.stateNode.containerInfo.firstChild),oi=t,ii=!0,si=null,n=Ji(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),o===r){t=Ka(e,t,n);break e}ka(e,t,o,n)}t=t.child}return t;case 5:return ss(t),null===e&&di(t),o=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,or(o,r)?a=null:null!==s&&or(o,s)&&(t.flags|=32),Ta(e,t),ka(e,t,a,n),t.child;case 6:return null===e&&di(t),null;case 13:return Ua(e,t,n);case 4:return rs(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=Zi(t,null,o,n):ka(e,t,o,n),t.child;case 11:return o=t.type,r=t.pendingProps,xa(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 7:return ka(e,t,t.pendingProps,n),t.child;case 8:case 12:return ka(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,Ir(yi,o._currentValue),o._currentValue=a,null!==s)if(ao(s.value,a)){if(s.children===r.children&&!Rr.current){t=Ka(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===o){if(1===s.tag){(c=Mi(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),_i(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(i(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),_i(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}ka(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,o=t.pendingProps.children,Si(t,n),o=o(r=Ti(r)),t.flags|=1,ka(e,t,o,n),t.child;case 14:return r=mi(o=t.type,t.pendingProps),Ca(e,t,o,r=mi(o.type,r),n);case 15:return _a(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,r=t.pendingProps,r=t.elementType===o?r:mi(o,r),ja(e,t),t.tag=1,Dr(o)?(e=!0,Fr(t)):e=!1,Si(t,n),ji(t,o,r),Gi(t,o,r,n),Aa(null,t,o,!0,e,n);case 19:return Va(e,t,n);case 22:return Sa(e,t,n)}throw Error(i(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function ed(e,t,n,o,r){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof r){var a=r;r=function(){var e=Kc(s);a.call(e)}}jc(t,s,e,r)}else s=function(e,t,n,o,r){if(r){if("function"===typeof o){var i=o;o=function(){var e=Kc(s);i.call(e)}}var s=Vc(t,o,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[gr]=s.current,Vo(8===e.nodeType?e.parentNode:e),uc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof o){var a=o;o=function(){var e=Kc(l);a.call(e)}}var l=qc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[gr]=l.current,Vo(8===e.nodeType?e.parentNode:e),uc((function(){jc(t,l,n,o)})),l}(n,t,e,r,o);return Kc(s)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));jc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){jc(null,e,null,null)})),t[gr]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ze()),0===(6&Al)&&(Vl=Ze()+500,Vr()))}break;case 13:uc((function(){var t=Ri(e,1);if(null!==t){var n=tc();oc(t,e,1,n)}})),$c(e,1)}},xt=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)oc(t,e,134217728,tc());$c(e,134217728)}},Ct=function(e){if(13===e.tag){var t=nc(e),n=Ri(e,t);if(null!==n)oc(n,e,t,tc());$c(e,t)}},_t=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var r=xr(o);if(!r)throw Error(i(90));$(o),J(o,r)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=dc,Ae=uc;var td={usingClientEntryPoint:!1,Events:[wr,kr,xr,Te,Ie,dc]},nd={findFiberByHostInstance:br,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},od={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{rt=rd.inject(od),it=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zc(t))throw Error(i(200));return function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==o?null:""+o,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zc(e))throw Error(i(299));var n=!1,o="",r=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=qc(e,1,!1,null,0,n,0,o,r),e[gr]=t.current,Vo(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zc(e))throw Error(i(405));var o=null!=n&&n.hydratedSources||null,r=!1,s="",a=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,r,0,s,a),e[gr]=t.current,Vo(e),o)for(e=0;e<o.length;e++)r=(r=(n=o[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[gr]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return ed(e,t,n,!1,o)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{var o=n(164);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},164:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{var o=n(791),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,i={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,o)&&!l.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:r,type:e,key:c,ref:d,props:i,_owner:a.current}}t.jsx=c,t.jsxs=c},117:(e,t)=>{var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||f}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var w=b.prototype=new y;w.constructor=b,g(w,m.prototype),w.isPureReactComponent=!0;var k=Array.isArray,x=Object.prototype.hasOwnProperty,C={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,o){var r,i={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,r)&&!_.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(1===l)i.children=o;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===i[r]&&(i[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:a,props:i,_owner:C.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,r,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case o:l=!0}}if(l)return s=s(l=e),e=""===i?"."+E(l,0):i,k(s)?(r="",null!=e&&(r=e.replace(I,"$&/")+"/"),A(s,t,r,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",k(e))for(var c=0;c<e.length;c++){var d=i+E(a=e[c],c);l+=A(a,t,r,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(a=e.next()).done;)l+=A(a=a.value,t,r,d=i+E(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var o=[],r=0;return A(e,o,"","",(function(e){return t.call(n,e,r++)})),o}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},M={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:C};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=r,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=C.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!_.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=o;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{e.exports=n(117)},184:(e,t,n)=>{e.exports=n(374)},813:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,r=e[o];if(!(0<i(r,t)))break e;e[o]=t,e[n]=r,n=o}}function o(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,r=e.length,s=r>>>1;o<s;){var a=2*(o+1)-1,l=e[a],c=a+1,d=e[c];if(0>i(l,n))c<r&&0>i(d,l)?(e[o]=d,e[c]=n,o=c):(e[o]=l,e[a]=n,o=a);else{if(!(c<r&&0>i(d,n)))break e;e[o]=d,e[c]=n,o=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,h=null,p=3,f=!1,g=!1,v=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=o(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=o(d)}}function k(e){if(v=!1,w(e),!g)if(null!==o(c))g=!0,D(x);else{var t=o(d);null!==t&&M(k,t.startTime-e)}}function x(e,n){g=!1,v&&(v=!1,y(T),T=-1),f=!0;var i=p;try{for(w(n),h=o(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===o(c)&&r(c),w(n)}else r(c);h=o(c)}if(null!==h)var l=!0;else{var u=o(d);null!==u&&M(k,u.startTime-n),l=!1}return l}finally{h=null,p=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,_=!1,S=null,T=-1,I=5,E=-1;function A(){return!(t.unstable_now()-E<I)}function R(){if(null!==S){var e=t.unstable_now();E=e;var n=!0;try{n=S(!0,e)}finally{n?C():(_=!1,S=null)}}else _=!1}if("function"===typeof b)C=function(){b(R)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,O=P.port2;P.port1.onmessage=R,C=function(){O.postMessage(null)}}else C=function(){m(R,0)};function D(e){S=e,_||(_=!0,C())}function M(e,n){T=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,D(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>s?(e.sortIndex=i,n(d,e),null===o(c)&&e===o(d)&&(v?(y(T),T=-1):v=!0,M(k,i-s))):(e.sortIndex=a,n(c,e),g||f||(g=!0,D(x))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:(e,t,n)=>{e.exports=n(813)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,o)=>(n.f[o](e,t),t)),[])),n.u=e=>"static/js/"+e+".ca7d866e.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="rpa-react-app:";n.l=(o,r,i,s)=>{if(e[o])e[o].push(r);else{var a,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+i){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+i),a.src=o),e[o]=[r];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var r=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={179:0};n.f.j=(t,o)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var i=new Promise(((n,o)=>r=e[t]=[n,o]));o.push(r[2]=i);var s=n.p+n.u(t),a=new Error;n.l(s,(o=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,o)=>{var r,i,s=o[0],a=o[1],l=o[2],c=0;if(s.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(o);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},o=self.webpackChunkrpa_react_app=self.webpackChunkrpa_react_app||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{var e=n(791),t=n(250);const o="https://graph.microsoft.com",r=new Set([o,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"]);function i(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function s(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var a;!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(a||(a={}));class l{constructor(e){if(this.requests=new Map,"undefined"!==typeof e){const t=l.requestLimit;if(e.length>t){const e=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(t));throw e.name="Limit Exceeded Error",e}for(const n of e)this.addRequest(n)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let r=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==r.value[1].id)return!1;r=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];let r;if(void 0===o.dependsOn||0===o.dependsOn.length)r=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;r=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&r!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===r||e.dependsOn[0]!==r))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(e){return s(this,void 0,void 0,(function*(){const t={url:""},n=new RegExp("^https?://");t.url=n.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const o={};return e.headers.forEach(((e,t)=>{o[t]=e})),Object.keys(o).length&&(t.headers=o),e.method!==a.PATCH&&e.method!==a.POST&&e.method!==a.PUT||(t.body=yield l.getRequestBody(e)),t}))}static getRequestBody(e){return s(this,void 0,void 0,(function*(){let t,n=!1;try{const o=e.clone();t=yield o.json(),n=!0}catch(o){}if(!n)try{if("undefined"!==typeof Blob){const n=yield e.blob(),o=new FileReader;t=yield new Promise((e=>{o.addEventListener("load",(()=>{const t=o.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])}),!1),o.readAsDataURL(n)}))}else if("undefined"!==typeof Buffer){t=(yield e.buffer()).toString("base64")}n=!0}catch(o){}return t}))}addRequest(e){const t=l.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(t));throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error("Adding request with duplicate id ".concat(e.id,", Make the id of the requests unique"));throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let o=n.next();for(;!o.done;){const t=o.value[1].dependsOn;if("undefined"!==typeof t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete o.value[1].dependsOn}o=n.next()}return t}getContent(){return s(this,void 0,void 0,(function*(){const e=[],t={requests:e},n=this.requests.entries();let o=n.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!l.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],r=yield l.getRequestData(t.request);if(void 0!==r.body&&(void 0===r.headers||void 0===r.headers["content-type"])){const e=new Error("Content-type header is not mentioned for request #".concat(t.id,", For request having body, Content-type header should be mentioned"));throw e.name="Invalid Content-type header",e}r.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(r.dependsOn=t.dependsOn),e.push(r),o=n.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw t.name="Invalid Dependent",t}if("undefined"!==typeof t&&!this.requests.has(t)){const e=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw e.name="Invalid Dependency",e}if("undefined"!==typeof t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let o,r=n.next();for(;!r.done&&r.value[1].id!==e;)o=r,r=n.next();if("undefined"===typeof o){const e=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===r.value[1].dependsOn&&(r.value[1].dependsOn=[]),-1!==r.value[1].dependsOn.indexOf(t)){const n=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw n.name="Duplicate Dependency",n}r.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if("undefined"===typeof n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if("undefined"!==typeof t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}l.requestLimit=20;const c=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class d extends Error{constructor(e){super(e),Object.setPrototypeOf(this,d.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new d,t.customError=e),t}}const u=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],h=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"===typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(n){throw new Error("Unable to stringify the content")}return e},p=e=>g(e),f=(e,t)=>(t.forEach((e=>v(e))),g(e,t)),g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let r="";if(-1!==o)return-1!==n&&n<o?(r=e.substring(0,n),t.has(r)):(r=e.substring(0,o),t.has(r))}return!1},v=e=>{if(-1!==e.indexOf("/"))throw new d("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class m{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const y=(e,t,n)=>{let o=null;if("undefined"!==typeof Request&&e instanceof Request)o=e.headers.get(n);else if("undefined"!==typeof t&&void 0!==t.headers)if("undefined"!==typeof Headers&&t.headers instanceof Headers)o=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,r=e.length;t<r;t++)if(e[t][0]===n){o=e[t][1];break}}else void 0!==t.headers[n]&&(o=t.headers[n]);return o},b=(e,t,n,o)=>{if("undefined"!==typeof Request&&e instanceof Request)e.headers.set(n,o);else if("undefined"!==typeof t)if(void 0===t.headers)t.headers=new Headers({[n]:o});else if("undefined"!==typeof Headers&&t.headers instanceof Headers)t.headers.set(n,o);else if(t.headers instanceof Array){let e=0;const r=t.headers.length;for(;e<r;e++){const r=t.headers[e];if(r[0]===n){r[1]=o;break}}e===r&&t.headers.push([n,o])}else Object.assign(t.headers,{[n]:o})},w=(e,t,n,o)=>{"undefined"!==typeof Request&&e instanceof Request?e.headers.append(n,o):"undefined"!==typeof t&&(void 0===t.headers?t.headers=new Headers({[n]:o}):"undefined"!==typeof Headers&&t.headers instanceof Headers?t.headers.append(n,o):t.headers instanceof Array?t.headers.push([n,o]):void 0===t.headers?t.headers={[n]:o}:void 0===t.headers[n]?t.headers[n]=o:t.headers[n]+=", ".concat(o))};class k{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var x;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(x||(x={}));class C{constructor(){this.featureUsage=x.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof m?n=e.middlewareControl.getMiddlewareOptions(C):e.middlewareControl=new m,"undefined"===typeof n&&(n=new C,e.middlewareControl.setMiddlewareOptions(C,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class _{constructor(e){this.authenticationProvider=e}execute(e){return s(this,void 0,void 0,(function*(){const t="string"===typeof e.request?e.request:e.request.url;if(p(t)||e.customHosts&&f(t,e.customHosts)){let t,n,o;e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(k)),t&&(n=t.authenticationProvider,o=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const r=yield n.getAccessToken(o),i="Bearer ".concat(r);w(e.request,e.options,_.AUTHORIZATION_HEADER,i),C.updateFeatureUsageFlag(e,x.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[_.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}_.AUTHORIZATION_HEADER="Authorization";class S{execute(e){return s(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class T{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_DELAY,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T.DEFAULT_MAX_RETRIES,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T.defaultShouldRetry;if(e>T.MAX_DELAY&&t>T.MAX_MAX_RETRIES){const e=new Error("Delay and MaxRetries should not be more than ".concat(T.MAX_DELAY," and ").concat(T.MAX_MAX_RETRIES));throw e.name="MaxLimitExceeded",e}if(e>T.MAX_DELAY){const e=new Error("Delay should not be more than ".concat(T.MAX_DELAY));throw e.name="MaxLimitExceeded",e}if(t>T.MAX_MAX_RETRIES){const e=new Error("MaxRetries should not be more than ".concat(T.MAX_MAX_RETRIES));throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,T.MAX_DELAY),this.maxRetries=Math.min(t,T.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return T.MAX_DELAY}}T.DEFAULT_DELAY=3,T.DEFAULT_MAX_RETRIES=3,T.MAX_DELAY=180,T.MAX_MAX_RETRIES=10,T.defaultShouldRetry=()=>!0;class I{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new T;this.options=e}isRetry(e){return-1!==I.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const n="string"===typeof e?t.method:e.method;if(n===a.PUT||n===a.PATCH||n===a.POST){if("application/octet-stream"===y(e,t,"Content-Type"))return!1}return!0}getDelay(e,t,n){const o=()=>Number(Math.random().toFixed(3)),r=void 0!==e.headers?e.headers.get(I.RETRY_AFTER_HEADER):null;let i;return i=null!==r?Number.isNaN(Number(r))?Math.round((new Date(r).getTime()-Date.now())/1e3):Number(r):t>=2?this.getExponentialBackOffTime(t)+n+o():n+o(),Math.min(i,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return s(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),"undefined"===typeof t&&(t=Object.assign(new T,this.options)),t}executeWithRetry(e,t,n){return s(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<n.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response)){++t,b(e.request,e.options,I.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,n.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,n)}}))}execute(e){return s(this,void 0,void 0,(function*(){const t=this.getOptions(e);return C.updateFeatureUsageFlag(e,x.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}I.RETRY_STATUS_CODES=[429,503,504],I.RETRY_ATTEMPT_HEADER="Retry-Attempt",I.RETRY_AFTER_HEADER="Retry-After";class E{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.DEFAULT_MAX_REDIRECTS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.defaultShouldRedirect;if(e>E.MAX_MAX_REDIRECTS){const e=new Error("MaxRedirects should not be more than ".concat(E.MAX_MAX_REDIRECTS));throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}E.DEFAULT_MAX_REDIRECTS=5,E.MAX_MAX_REDIRECTS=20,E.defaultShouldRedirect=()=>!0;class A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new E;this.options=e}isRedirect(e){return-1!==A.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(A.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(A.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=n.exec(e);let r,i;null!==o&&(r=o[0]);const s=n.exec(t);return null!==s&&(i=s[0]),"undefined"!==typeof r&&"undefined"!==typeof i&&r!==i}updateRequestUrl(e,t){return s(this,void 0,void 0,(function*(){var n,o;t.request="string"===typeof t.request?e:yield(n=e,o=t.request,s(void 0,void 0,void 0,(function*(){const e=o.headers.get("Content-Type")?yield o.blob():yield Promise.resolve(void 0),{method:t,headers:r,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:d,integrity:u,keepalive:h,signal:p}=o;return new Request(n,{method:t,headers:r,body:e,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:d,integrity:u,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(E)),"undefined"===typeof t&&(t=Object.assign(new E,this.options)),t}executeWithRedirect(e,t,n){return s(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const o=e.response;if(t<n.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&n.shouldRedirect(o)){if(++t,o.status===A.STATUS_CODE_SEE_OTHER)e.options.method=a.GET,delete e.options.body;else{const t=this.getLocationHeader(o);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(o.url,t)&&delete e.options.headers[A.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,n)}}))}execute(e){return s(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=A.MANUAL_REDIRECT,C.updateFeatureUsageFlag(e,x.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}A.REDIRECT_STATUS_CODES=[301,302,303,307,308],A.STATUS_CODE_SEE_OTHER=303,A.LOCATION_HEADER="Location",A.AUTHORIZATION_HEADER="Authorization",A.MANUAL_REDIRECT="manual";class R{execute(e){return s(this,void 0,void 0,(function*(){const t="string"===typeof e.request?e.request:e.request.url;if(p(t)||e.customHosts&&f(t,e.customHosts)){let t=y(e.request,e.options,R.CLIENT_REQUEST_ID_HEADER);t||(t=(()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e})(),b(e.request,e.options,R.CLIENT_REQUEST_ID_HEADER,t));let n,o="".concat(R.PRODUCT_NAME,"/").concat("3.0.2");if(e.middlewareControl instanceof m&&(n=e.middlewareControl.getMiddlewareOptions(C)),n){const e=n.getFeatureUsage();o+=" (".concat(R.FEATURE_USAGE_STRING,"=").concat(e,")")}w(e.request,e.options,R.SDK_VERSION_HEADER,o)}else delete e.options.headers[R.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[R.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}R.CLIENT_REQUEST_ID_HEADER="client-request-id",R.SDK_VERSION_HEADER="SdkVersion",R.PRODUCT_NAME="graph-js",R.FEATURE_USAGE_STRING="featureUsage";var P;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(P||(P={}));var O,D,M,N;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(O||(O={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(D||(D={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(M||(M={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(N||(N={}));class L{static parseDocumentResponse(e,t){return"undefined"!==typeof DOMParser?new Promise(((n,o)=>{e.text().then((e=>{try{const o=(new DOMParser).parseFromString(e,t);n(o)}catch(r){o(r)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return s(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let n;const o=e.headers.get("Content-type");switch(t){case O.ARRAYBUFFER:n=yield e.arrayBuffer();break;case O.BLOB:n=yield e.blob();break;case O.DOCUMENT:n=yield L.parseDocumentResponse(e,D.TEXT_XML);break;case O.JSON:n=yield e.json();break;case O.STREAM:n=yield Promise.resolve(e.body);break;case O.TEXT:n=yield e.text();break;default:if(null!==o){const t=o.split(";")[0];n=new RegExp(N.DOCUMENT).test(t)?yield L.parseDocumentResponse(e,t):new RegExp(N.IMAGE).test(t)?e.blob():t===M.TEXT_PLAIN?yield e.text():t===M.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else n=Promise.resolve(e.body)}return n}))}static getResponse(e,t,n){return s(this,void 0,void 0,(function*(){if(t===O.RAW)return Promise.resolve(e);{const o=yield L.convertResponse(e,t);if(!e.ok)throw o;if("function"!==typeof n)return o;n(null,o)}}))}}class F{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.minValue=e,this.maxValue=t}}class U{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new U(e,t.get("location"))}}class z{constructor(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new d("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,o.rangeSize||(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=n,this.nextRange=new F(0,this.options.rangeSize-1)}static createUploadSession(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(this,void 0,void 0,(function*(){const r=yield e.api(t).headers(o).post(n);return{url:r.uploadUrl,expiry:new Date(r.expirationDateTime),isCancelled:!1}}))}parseRange(e){const t=e[0];if("undefined"===typeof t||""===t)return new F;const n=t.split("-"),o=parseInt(n[0],10);let r=parseInt(n[1],10);return Number.isNaN(r)&&(r=this.file.size-1),new F(o,r)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new F(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new d("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return s(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),o=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!o)throw new d("Something went wrong! Large file upload slice response is null.");const r=yield L.getResponse(o);if(201===o.status||200===o.status&&r.id){return U.CreateUploadResult(r,o.headers)}const i={expirationDateTime:r.expirationDateTime||r.ExpirationDateTime,nextExpectedRanges:r.NextExpectedRanges||r.nextExpectedRanges};this.updateTaskStatus(i),e&&e.progress&&e.progress(t,e.extraCallbackParam)}}))}uploadSlice(e,t,n){return s(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(n),"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,n){return s(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(n),"Content-Type":"application/octet-stream"}).responseType(O.RAW).put(e)}))}cancel(){return s(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(O.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return s(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return s(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class H{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new d("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5242880;const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n};class B extends z{constructor(e,t,n,o){super(e,t,n,o)}static constructCreateSessionUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.DEFAULT_UPLOAD_PATH;return e=e.trim(),t=t.trim(),""===t&&(t="/"),"/"!==t[0]&&(t="/".concat(t)),"/"!==t[t.length-1]&&(t="".concat(t,"/")),"/me/drive/root:".concat(t.split("/").map((e=>encodeURIComponent(e))).join("/")).concat(encodeURIComponent(e),":/createUploadSession")}static getFileInfo(e,t){let n,o;if("undefined"!==typeof Blob&&e instanceof Blob)n=new File([e],t),o=n.size;else if("undefined"!==typeof File&&e instanceof File)n=e,o=n.size;else if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array){const t=e;o=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:o}}static create(e,t,n){return s(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const o=n.fileName,r=B.getFileInfo(t,o),i=new H(r.content,o,r.size);return this.createTaskWithFileObject(e,i,n)}))}static createTaskWithFileObject(e,t,n){return s(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const o=B.constructCreateSessionUrl(n.fileName,n.path),r={fileName:n.fileName,fileDescription:n.fileDescription,conflictBehavior:n.conflictBehavior},i=yield B.createUploadSession(e,o,r),s=q(n.rangeSize);return new B(e,t,i,{rangeSize:s,uploadEventHandlers:n.uploadEventHandlers})}))}static createUploadSession(e,t,n){const o=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return s(this,void 0,void 0,(function*(){const r={item:{"@microsoft.graph.conflictBehavior":(null===n||void 0===n?void 0:n.conflictBehavior)||"rename",name:null===n||void 0===n?void 0:n.fileName,description:null===n||void 0===n?void 0:n.fileDescription}};return o.createUploadSession.call(this,e,t,r)}))}commit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rename";return s(this,void 0,void 0,(function*(){const n={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(n)}))}}B.DEFAULT_UPLOAD_PATH="/";class V{constructor(e){this.provider=e}getAccessToken(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((n,o)=>s(this,void 0,void 0,(function*(){if(o)e(o);else{if(!n){n=new d("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const e=yield d.setGraphClientError(n);t(e)}}))))}))}))}}class j extends Error{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>2?arguments[2]:void 0;super((arguments.length>1?arguments[1]:void 0)||t&&t.message),Object.setPrototypeOf(this,j.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=t?t.stack:this.stack}}class K{static constructError(e,t){const n=new j(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n}static constructErrorFromResponse(e,t){const n=e.error,o=new j(t,n.message);return o.code=n.code,void 0!==n.innerError&&(o.requestId=n.innerError["request-id"],o.date=new Date(n.innerError.date)),o.body=JSON.stringify(n),o}static getError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0;return s(this,void 0,void 0,(function*(){let o;if(e&&e.error?o=K.constructErrorFromResponse(e,t):e instanceof Error?o=K.constructError(e,t):(o=new j(t),o.body=e),"function"!==typeof n)return o;n(o,null)}))}}class G{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];n.length>1&&"string"===typeof t?o=Array.prototype.slice.call(n):"string"===typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/\/+$/,""),n=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,o)=>[t(e),n(o)].join("/")))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"===typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(n,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==u.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],o=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");if(-1===t)return!1;return!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,n){var o;return s(this,void 0,void 0,(function*(){let r;const i=new m(this._middlewareOptions);this.updateRequestOptions(t);const s=null===(o=this.config)||void 0===o?void 0:o.customHosts;try{r=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i,customHosts:s})).response;return yield L.getResponse(r,this._responseType,n)}catch(a){if(a instanceof d)throw a;let e;r&&(e=r.status);throw yield K.getError(a,e,n)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:a.GET};return yield this.send(t,n,e)}))}post(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),o={method:a.POST,body:h(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers),yield this.send(n,o,t)}))}create(e,t){return s(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const o={method:a.PUT,body:h(e)};return yield this.send(n,o,t)}))}patch(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const o={method:a.PATCH,body:h(e)};return yield this.send(n,o,t)}))}update(e,t){return s(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:a.DELETE};return yield this.send(t,n,e)}))}del(e){return s(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:a.GET};return this.responseType(O.STREAM),yield this.send(t,n,e)}))}putStream(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),o={method:a.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(n,o,t)}))}}class ${constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t||!t.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...t)}setMiddleware(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}parseMiddleWareArray(e){e.forEach(((t,n)=>{n<e.length-1&&t.setNext(e[n+1])})),this.middleware=e[0]}sendRequest(e){return s(this,void 0,void 0,(function*(){if("string"===typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class W{static createWithAuthenticationProvider(e){const t=new _(e),n=new I(new T),o=new R,r=new S;if(t.setNext(n),"object"===typeof process){const e=new A(new E);n.setNext(e),e.setNext(o)}else n.setNext(o);return o.setNext(r),W.createWithMiddleware(t)}static createWithMiddleware(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new $(...t)}}class Q{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"===typeof Promise&&"undefined"===typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"===typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"===typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.config[n]=e[n]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=W.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new $(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new V(e[n]):e[n]);return Q.initWithMiddleware(t)}static initWithMiddleware(e){return new Q(e)}api(e){return new G(this.httpClient,this.config,e)}}class Y{}var Z=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class J{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}class X{get isMultiAccountSupportedAndEnabled(){return!1}set baseURL(e){if(!ae(e))throw new Error("".concat(e," is not a valid Graph URL endpoint."));this._baseURL=e}get baseURL(){return this._baseURL}set customHosts(e){this._customHosts=e}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(e){this._isIncrementalConsentDisabled=e}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new J,this._activeAccountChangedDispatcher=new J,this._baseURL=o,this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=te.Loading}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}setActiveAccount(e){this.fireActiveAccountChanged()}onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}removeActiveAccountChangedHandler(e){this._activeAccountChangedDispatcher.remove(e)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.getAccessToken({scopes:t})}}var ee,te;!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(ee||(ee={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(te||(te={}));var ne,oe=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class re{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),e&&(e.onStateChanged(this.handleProviderStateChanged),e.isMultiAccountSupportedAndEnabled&&e.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=e,this._eventDispatcher.fire(ne.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static onActiveAccountChanged(e){this._activeAccountChangedDispatcher.add(e)}static removeActiveAccountChangedListener(e){this._activeAccountChangedDispatcher.remove(e)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return oe(this,void 0,void 0,(function*(){try{const e=yield this.client.api("me").get();if(null===e||void 0===e?void 0:e.id)return e}catch(e){}return null}))}static getCacheId(){var e;return oe(this,void 0,void 0,(function*(){if(this._cacheId)return this._cacheId;if((null===(e=re.globalProvider)||void 0===e?void 0:e.state)===te.SignedIn&&!this._cacheId){if(this.client)try{this._cacheId=yield this.createCacheId()}catch(t){}}return this._cacheId}))}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return oe(this,void 0,void 0,(function*(){if(re.globalProvider.isMultiAccountSupportedAndEnabled){const e=this.createCacheIdWithAccountDetails();if(e)return e}return yield this.createCacheIdWithUserDetails()}))}static createCacheIdWithUserDetails(){return oe(this,void 0,void 0,(function*(){const e=yield this.me();return(null===e||void 0===e?void 0:e.id)?e.id+"-"+e.userPrincipalName:null}))}static createCacheIdWithAccountDetails(){const e=re.globalProvider.getActiveAccount();return e.tenantId&&e.id?e.tenantId+e.id:null}static get client(){return re.globalProvider&&re.globalProvider.state===te.SignedIn?re.globalProvider.graph.client:null}}re._eventDispatcher=new J,re._activeAccountChangedDispatcher=new J,re.handleProviderStateChanged=()=>{re.globalProvider&&re.globalProvider.state===te.SignedIn||(re._mePromise=null),re._eventDispatcher.fire(ne.ProviderStateChanged)},re.handleActiveAccountChanged=()=>{re.unsetCacheId(),re._activeAccountChangedDispatcher.fire(null)},function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(ne||(ne={}));const ie=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o={scopes:t};return re.globalProvider.isIncrementalConsentDisabled?[]:[new k(void 0,o)]},se=function(){const e=arguments.length<=0?void 0:arguments[0];let t=e;for(let n=1;n<arguments.length;++n){const e=n<0||arguments.length<=n?void 0:arguments[n];t.setNext&&t.setNext(e),t=e}return e},ae=e=>{try{const t=new URL(e).origin;if(r.has(t))return t}catch(t){return}};class le{constructor(e,t,n,o){this.resource=n.startsWith("/")?n:"/".concat(n),this.method=o,this.index=e,this.id=t}}var ce=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class de{static get baseUrl(){return"https://graph.microsoft.com"}constructor(e){this.graph=e,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(e,t,n,o){const r=this.nextIndex++,i=new le(r,e,t,"GET");i.headers=o,this.allRequests.push(i),this.requestsQueue.push(r),n&&(this.scopes=this.scopes.concat(n))}executeNext(){return ce(this,void 0,void 0,(function*(){const e=new Map;var t;if(this.retryAfter&&(yield(t=1e3*this.retryAfter,Z(void 0,void 0,void 0,(function*(){return new Promise((e=>{setTimeout(e,t)}))}))),this.retryAfter=0),!this.hasRequests)return e;const n=this.requestsQueue.splice(0,20),o=new l;for(const l of n.map((e=>this.allRequests[e])))o.addRequest({id:l.index.toString(),request:new Request(de.baseUrl+l.resource,{method:l.method,headers:l.headers})});const r=this.scopes.length?ie(...this.scopes):[],i=this.graph.api("$batch").middlewareOptions(r),s=yield o.getContent(),a=yield i.post(s);for(const l of a.responses){const t=new Y,n=parseInt(l.id,10),o=this.allRequests[n];if(t.id=o.id,t.index=o.index,t.headers=l.headers,200===l.status)"string"===typeof l.body?l.headers["Content-Type"].includes("image/jpeg")?t.content="data:image/jpeg;base64,"+l.body:l.headers["Content-Type"].includes("image/pjpeg")?t.content="data:image/pjpeg;base64,"+l.body:l.headers["Content-Type"].includes("image/png")&&(t.content="data:image/png;base64,"+l.body):t.content=l.body,e.set(o.id,t);else if(429===l.status){this.requestsQueue.unshift(n);const e=l.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(e,10)||1)}}return e}))}executeAll(){return ce(this,void 0,void 0,(function*(){const e=new Map;for(;this.hasRequests;){const t=yield this.executeNext();for(const[n,o]of t)e.set(n,o)}return e}))}}class ue{constructor(e){this.componentName="string"===typeof e?e:e.tagName.toLowerCase()}}var he=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class pe{constructor(e,t){this._packageVersion=e,this._providerName=t}execute(e){var t;return he(this,void 0,void 0,(function*(){try{if("string"===typeof e.request)if(ae(e.request)){const t=[],n=e.middlewareControl.getMiddlewareOptions(ue);if(n){const e="".concat(n.componentName,"/").concat(this._packageVersion);t.push(e)}if(this._providerName){const e="".concat(this._providerName,"/").concat(this._packageVersion);t.push(e)}const o="mgt/".concat(this._packageVersion);t.push(o),t.push(y(e.request,e.options,"SdkVersion"));const r=t.join(", ");b(e.request,e.options,"SdkVersion",r)}else null===(t=null===e||void 0===e?void 0:e.options)||void 0===t||delete t.headers.SdkVersion}catch(n){}return yield this._nextMiddleware.execute(e)}))}setNext(e){this._nextMiddleware=e}}const fe="3.1.3";const ge=new class{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(e){return e&&!this._disambiguation&&(this._disambiguation=e),this}get prefix(){return this._disambiguation?"".concat(this.defaultPrefix,"-").concat(this._disambiguation):this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return Boolean(this._disambiguation)}normalize(e){return this.isDisambiguated?e.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):e}};class ve{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"v1.0";this._client=e,this._version=t}forComponent(e){const t=new ve(this._client,this._version);return t.setComponent(e),t}api(e){let t=this._client.api(e).version(this._version);return this._componentName&&(t.middlewareOptions=e=>(t._middlewareOptions=t._middlewareOptions.concat(e),t),t=t.middlewareOptions([new ue(this._componentName)])),t}createBatch(){return new de(this)}setComponent(e){this._componentName=e instanceof Element?ge.normalize(e.tagName):e}}class me extends ve{static fromGraph(e){const t=new me(e.client);return t.setComponent(e.componentName),t}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beta")}forComponent(e){const t=new me(this.client);return this.setComponent(e),t}}const ye=window,be=ye.ShadowRoot&&(void 0===ye.ShadyCSS||ye.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,we=Symbol(),ke=new WeakMap;class xe{constructor(e,t,n){if(this._$cssResult$=!0,n!==we)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(be&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=ke.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&ke.set(t,e))}return e}toString(){return this.cssText}}const Ce=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const r=1===e.length?e[0]:n.reduce(((t,n,o)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[o+1]),e[0]);return new xe(r,e,we)},_e=be?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return(e=>new xe("string"==typeof e?e:e+"",void 0,we))(t)})(e):e;var Se;const Te=window,Ie=Te.trustedTypes,Ee=Ie?Ie.emptyScript:"",Ae=Te.reactiveElementPolyfillSupport,Re={toAttribute(e,t){switch(t){case Boolean:e=e?Ee:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},Pe=(e,t)=>t!==e&&(t==t||e==e),Oe={attribute:!0,type:String,converter:Re,reflect:!1,hasChanged:Pe},De="finalized";class Me extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const o=this._$Ep(n,t);void 0!==o&&(this._$Ev.set(o,n),e.push(o))})),e}static createProperty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Oe;if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,o=this.getPropertyDescriptor(e,n,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(o){const r=this[e];this[t]=o,this.requestUpdate(e,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||Oe}static finalize(){if(this.hasOwnProperty(De))return!1;this[De]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(_e(e))}else void 0!==e&&t.push(_e(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{be?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const n=document.createElement("style"),o=ye.litNonce;void 0!==o&&n.setAttribute("nonce",o),n.textContent=t.cssText,e.appendChild(n)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oe;var o;const r=this.constructor._$Ep(e,n);if(void 0!==r&&!0===n.reflect){const i=(void 0!==(null===(o=n.converter)||void 0===o?void 0:o.toAttribute)?n.converter:Re).toAttribute(t,n.type);this._$El=e,null==i?this.removeAttribute(r):this.setAttribute(r,i),this._$El=null}}_$AK(e,t){var n;const o=this.constructor,r=o._$Ev.get(e);if(void 0!==r&&this._$El!==r){const e=o.getPropertyOptions(r),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:Re;this._$El=r,this[r]=i.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let o=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||Pe)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var Ne;Me[De]=!0,Me.elementProperties=new Map,Me.elementStyles=[],Me.shadowRootOptions={mode:"open"},null==Ae||Ae({ReactiveElement:Me}),(null!==(Se=Te.reactiveElementVersions)&&void 0!==Se?Se:Te.reactiveElementVersions=[]).push("1.6.3");const Le=window,Fe=Le.trustedTypes,Ue=Fe?Fe.createPolicy("lit-html",{createHTML:e=>e}):void 0,ze="$lit$",He="lit$".concat((Math.random()+"").slice(9),"$"),qe="?"+He,Be="<".concat(qe,">"),Ve=document,je=()=>Ve.createComment(""),Ke=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Ge=Array.isArray,$e=e=>Ge(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),We="[ \t\n\f\r]",Qe=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ye=/-->/g,Ze=/>/g,Je=RegExp(">|".concat(We,"(?:([^\\s\"'>=/]+)(").concat(We,"*=").concat(We,"*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)"),"g"),Xe=/'/g,et=/"/g,tt=/^(?:script|style|textarea|title)$/i,nt=e=>function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return{_$litType$:e,strings:t,values:o}},ot=nt(1),rt=(nt(2),Symbol.for("lit-noChange")),it=Symbol.for("lit-nothing"),st=new WeakMap,at=Ve.createTreeWalker(Ve,129,null,!1);function lt(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==Ue?Ue.createHTML(t):t}const ct=(e,t)=>{const n=e.length-1,o=[];let r,i=2===t?"<svg>":"",s=Qe;for(let a=0;a<n;a++){const t=e[a];let n,l,c=-1,d=0;for(;d<t.length&&(s.lastIndex=d,l=s.exec(t),null!==l);)d=s.lastIndex,s===Qe?"!--"===l[1]?s=Ye:void 0!==l[1]?s=Ze:void 0!==l[2]?(tt.test(l[2])&&(r=RegExp("</"+l[2],"g")),s=Je):void 0!==l[3]&&(s=Je):s===Je?">"===l[0]?(s=null!=r?r:Qe,c=-1):void 0===l[1]?c=-2:(c=s.lastIndex-l[2].length,n=l[1],s=void 0===l[3]?Je:'"'===l[3]?et:Xe):s===et||s===Xe?s=Je:s===Ye||s===Ze?s=Qe:(s=Je,r=void 0);const u=s===Je&&e[a+1].startsWith("/>")?" ":"";i+=s===Qe?t+Be:c>=0?(o.push(n),t.slice(0,c)+ze+t.slice(c)+He+u):t+He+(-2===c?(o.push(void 0),a):u)}return[lt(e,i+(e[n]||"<?>")+(2===t?"</svg>":"")),o]};class dt{constructor(e,t){let n,{strings:o,_$litType$:r}=e;this.parts=[];let i=0,s=0;const a=o.length-1,l=this.parts,[c,d]=ct(o,r);if(this.el=dt.createElement(c,t),at.currentNode=this.el.content,2===r){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(n=at.nextNode())&&l.length<a;){if(1===n.nodeType){if(n.hasAttributes()){const e=[];for(const t of n.getAttributeNames())if(t.endsWith(ze)||t.startsWith(He)){const o=d[s++];if(e.push(t),void 0!==o){const e=n.getAttribute(o.toLowerCase()+ze).split(He),t=/([.?@])?(.*)/.exec(o);l.push({type:1,index:i,name:t[2],strings:e,ctor:"."===t[1]?gt:"?"===t[1]?mt:"@"===t[1]?yt:ft})}else l.push({type:6,index:i})}for(const t of e)n.removeAttribute(t)}if(tt.test(n.tagName)){const e=n.textContent.split(He),t=e.length-1;if(t>0){n.textContent=Fe?Fe.emptyScript:"";for(let o=0;o<t;o++)n.append(e[o],je()),at.nextNode(),l.push({type:2,index:++i});n.append(e[t],je())}}}else if(8===n.nodeType)if(n.data===qe)l.push({type:2,index:i});else{let e=-1;for(;-1!==(e=n.data.indexOf(He,e+1));)l.push({type:7,index:i}),e+=He.length-1}i++}}static createElement(e,t){const n=Ve.createElement("template");return n.innerHTML=e,n}}function ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3?arguments[3]:void 0;var r,i,s,a;if(t===rt)return t;let l=void 0!==o?null===(r=n._$Co)||void 0===r?void 0:r[o]:n._$Cl;const c=Ke(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(i=null==l?void 0:l._$AO)||void 0===i||i.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,n,o)),void 0!==o?(null!==(s=(a=n)._$Co)&&void 0!==s?s:a._$Co=[])[o]=l:n._$Cl=l),void 0!==l&&(t=ut(e,l._$AS(e,t.values),l,o)),t}class ht{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:n},parts:o}=this._$AD,r=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:Ve).importNode(n,!0);at.currentNode=r;let i=at.nextNode(),s=0,a=0,l=o[0];for(;void 0!==l;){if(s===l.index){let t;2===l.type?t=new pt(i,i.nextSibling,this,e):1===l.type?t=new l.ctor(i,l.name,l.strings,this,e):6===l.type&&(t=new bt(i,this,e)),this._$AV.push(t),l=o[++a]}s!==(null==l?void 0:l.index)&&(i=at.nextNode(),s++)}return at.currentNode=Ve,r}v(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class pt{constructor(e,t,n,o){var r;this.type=2,this._$AH=it,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=o,this._$Cp=null===(r=null==o?void 0:o.isConnected)||void 0===r||r}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e){e=ut(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),Ke(e)?e===it||null==e||""===e?(this._$AH!==it&&this._$AR(),this._$AH=it):e!==this._$AH&&e!==rt&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):$e(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==it&&Ke(this._$AH)?this._$AA.nextSibling.data=e:this.$(Ve.createTextNode(e)),this._$AH=e}g(e){var t;const{values:n,_$litType$:o}=e,r="number"==typeof o?this._$AC(e):(void 0===o.el&&(o.el=dt.createElement(lt(o.h,o.h[0]),this.options)),o);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===r)this._$AH.v(n);else{const e=new ht(r,this),t=e.u(this.options);e.v(n),this.$(t),this._$AH=e}}_$AC(e){let t=st.get(e.strings);return void 0===t&&st.set(e.strings,t=new dt(e)),t}T(e){Ge(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,o=0;for(const r of e)o===t.length?t.push(n=new pt(this.k(je()),this.k(je()),this,this.options)):n=t[o],n._$AI(r),o++;o<t.length&&(this._$AR(n&&n._$AB.nextSibling,o),t.length=o)}_$AR(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,t=arguments.length>1?arguments[1]:void 0;var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class ft{constructor(e,t,n,o,r){this.type=1,this._$AH=it,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=r,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=it}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;const r=this.strings;let i=!1;if(void 0===r)e=ut(this,e,t,0),i=!Ke(e)||e!==this._$AH&&e!==rt,i&&(this._$AH=e);else{const o=e;let s,a;for(e=r[0],s=0;s<r.length-1;s++)a=ut(this,o[n+s],t,s),a===rt&&(a=this._$AH[s]),i||(i=!Ke(a)||a!==this._$AH[s]),a===it?e=it:e!==it&&(e+=(null!=a?a:"")+r[s+1]),this._$AH[s]=a}i&&!o&&this.j(e)}j(e){e===it?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class gt extends ft{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===it?void 0:e}}const vt=Fe?Fe.emptyScript:"";class mt extends ft{constructor(){super(...arguments),this.type=4}j(e){e&&e!==it?this.element.setAttribute(this.name,vt):this.element.removeAttribute(this.name)}}class yt extends ft{constructor(e,t,n,o,r){super(e,t,n,o,r),this.type=5}_$AI(e){var t;if((e=null!==(t=ut(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==t?t:it)===rt)return;const n=this._$AH,o=e===it&&n!==it||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,r=e!==it&&(n===it||o);o&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$AH.handleEvent(e)}}class bt{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){ut(this,e)}}const wt={O:ze,P:He,A:qe,C:1,M:ct,L:ht,R:$e,D:ut,I:pt,V:ft,H:mt,N:yt,U:gt,F:bt},kt=Le.litHtmlPolyfillSupport;null==kt||kt(dt,pt),(null!==(Ne=Le.litHtmlVersions)&&void 0!==Ne?Ne:Le.litHtmlVersions=[]).push("2.8.0");var xt,Ct;class _t extends Me{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const n=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=n.firstChild),n}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{var o,r;const i=null!==(o=null==n?void 0:n.renderBefore)&&void 0!==o?o:t;let s=i._$litPart$;if(void 0===s){const e=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;i._$litPart$=s=new pt(t.insertBefore(je(),e),e,void 0,null!=n?n:{})}return s._$AI(e),s})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return rt}}_t.finalized=!0,_t._$litElement$=!0,null===(xt=globalThis.litElementHydrateSupport)||void 0===xt||xt.call(globalThis,{LitElement:_t});const St=globalThis.litElementPolyfillSupport;null==St||St({LitElement:_t});(null!==(Ct=globalThis.litElementVersions)&&void 0!==Ct?Ct:globalThis.litElementVersions=[]).push("3.3.3");const Tt=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(n){n.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(n){n.createProperty(t.key,e)}},It=(e,t,n)=>{t.constructor.createProperty(n,e)};function Et(e){return(t,n)=>void 0!==n?It(e,t,n):Tt(e,t)}function At(e){return Et({...e,state:!0})}var Rt;null===(Rt=window.HTMLSlotElement)||void 0===Rt||Rt.prototype.assignedElements;class Pt{static get strings(){return this._strings}static set strings(e){this._strings=e,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var e,t;switch((null===(e=document.body)||void 0===e?void 0:e.getAttribute("dir"))||(null===(t=document.documentElement)||void 0===t?void 0:t.getAttribute("dir"))){case"rtl":return"rtl";case"auto":return"auto";default:return"ltr"}}static onStringsUpdated(e){this._stringsEventDispatcher.add(e)}static removeOnStringsUpdated(e){this._stringsEventDispatcher.remove(e)}static onDirectionUpdated(e){this._directionEventDispatcher.add(e),this.initDirection()}static removeOnDirectionUpdated(e){this._directionEventDispatcher.remove(e)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{"dir"===e.attributeName&&this._directionEventDispatcher.fire(null)}))}));const e={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,e),this.mutationObserver.observe(document.documentElement,e)}static updateStringsForTag(e,t){var n;if((e=e.toLowerCase()).startsWith("mgt-")&&(e=e.substring(4)),this._strings&&t){for(const e of Object.entries(t)){const n=this._strings[e[0]];"string"===typeof n&&(t[e[0]]=n)}if(null===(n=this._strings._components)||void 0===n?void 0:n[e]){const n=this._strings._components[e];for(const e of Object.keys(n))t[e]&&(t[e]=n[e])}}return t}}Pt._stringsEventDispatcher=new J,Pt._directionEventDispatcher=new J,Pt._isDirectionInit=!1;var Ot,Dt=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Mt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Nt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e.mobile="",e.tablet="tablet",e.desktop="desktop"}(Ot||(Ot={}));class Lt extends _t{static get packageVersion(){return fe}get mediaQuery(){return this.offsetWidth<768?Ot.mobile:this.offsetWidth<1200?Ot.tablet:Ot.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.setLoadingState=e=>{this._isLoadingState!==e&&(this._isLoadingState=e,this.requestUpdate("isLoadingState"))},this.handleProviderUpdates=()=>{this.requestStateUpdate()},this.handleActiveAccountUpdates=()=>{this.clearState(),this.requestStateUpdate()},this.handleLocalizationChanged=()=>{Pt.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()},this.handleDirectionChanged=()=>{this.direction=Pt.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),Pt.onStringsUpdated(this.handleLocalizationChanged),Pt.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),Pt.removeOnStringsUpdated(this.handleLocalizationChanged),Pt.removeOnDirectionUpdated(this.handleDirectionChanged),re.removeProviderUpdatedListener(this.handleProviderUpdates),re.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(e){super.firstUpdated(e),this._isFirstUpdated=!0,re.onProviderUpdated(this.handleProviderUpdates),re.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(e,t){const n=new CustomEvent(e,{bubbles:arguments.length>2&&void 0!==arguments[2]&&arguments[2],cancelable:arguments.length>3&&void 0!==arguments[3]&&arguments[3],composed:arguments.length>4&&void 0!==arguments[4]&&arguments[4],detail:t});return this.dispatchEvent(n)}updated(e){super.updated(e);const t=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(t)}requestStateUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Nt(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!e&&(yield this._currentLoadStatePromise);const t=re.globalProvider;if(!t)return Promise.resolve();if(t.state!==te.SignedOut){if(t.state===te.Loading)return Promise.resolve();{const t=new Promise(((n,o)=>Nt(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),n()}catch(r){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),o(r)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&e?this._currentLoadStatePromise.then((()=>t)):t}))))}}else this.clearState()}))}}Dt([At(),Mt("design:type",String)],Lt.prototype,"direction",void 0);var Ft=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ut=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};class zt extends Lt{constructor(){super(...arguments),this.stateChangedHandler=()=>{this.fireCustomEvent("onStateChanged",this.provider.state)}}get provider(){return this._provider}set provider(e){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=e,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(e){super.firstUpdated(e);let t=!1;if(this.dependsOn){let e=this.dependsOn;for(;e;){if(e.isAvailable){t=!0;break}e=e.dependsOn}}!t&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}}function Ht(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Ft([Et({attribute:"depends-on",converter:e=>document.querySelector(e),type:String}),Ut("design:type",zt)],zt.prototype,"dependsOn",void 0),Ft([Et({attribute:"base-url",type:String}),Ut("design:type",String)],zt.prototype,"baseUrl",void 0),Ft([Et({attribute:"custom-hosts",type:String,converter:e=>e.split(",").map((e=>e.trim()))}),Ut("design:type",Array)],zt.prototype,"customHosts",void 0);const qt=(e,t)=>Bt(e,t,new Set),Bt=(e,t,n)=>{const o=Object.prototype.toString.call(e),r=Object.prototype.toString.call(t);if("object"===typeof e&&"object"===typeof t&&o===r&&"[object Object]"===o&&!n.has(e)){n.add(e);for(const o in e)if(!Bt(e[o],t[o],n))return!1;for(const n in t)if(!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}if(Array.isArray(e)&&Array.isArray(t)&&!n.has(e)){if(n.add(e),e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(!Bt(e[o],t[o],n))return!1;return!0}return e===t},Vt=(e,t)=>{if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;if(0===e.length)return!0;const n=new Set(e);for(const o of t)if(!n.has(o))return!1;return!0};class jt{static renderTemplate(e,t,n){var o;let r;if(t.$parentTemplateContext&&(n=Object.assign(Object.assign({},n),{$parent:t.$parentTemplateContext})),null===(o=t.content)||void 0===o?void 0:o.childNodes.length){const o=t.content.cloneNode(!0);r=this.renderNode(o,e,n)}else if(t.childNodes.length){const o=document.createElement("div");for(const e of t.childNodes)o.appendChild(this.simpleCloneNode(e));r=this.renderNode(o,e,n)}r&&e.appendChild(r)}static setBindingSyntax(e,t){this._startExpression=e,this._endExpression=t;const n=this.escapeRegex(this._startExpression),o=this.escapeRegex(this._endExpression);this._expression=new RegExp("".concat(n,"\\s*([$\\w\\.,'\"\\s()\\[\\]]+)\\s*").concat(o),"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(e){if(!e)return null;const t=e.cloneNode(!1);for(const n of e.childNodes){const e=this.simpleCloneNode(n);e&&t.appendChild(e)}return t}static expandExpressionsAsString(e,t){return e.replace(this.expression,((e,n)=>{const o=this.evalInContext(n||this.trimExpression(e),t);return o?"object"===typeof o?JSON.stringify(o):o.toString():""}))}static renderNode(e,t,n){if("#text"===e.nodeName)return e.textContent=this.expandExpressionsAsString(e.textContent,n),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=n,e;const o=e;if(o.attributes)for(const a of o.attributes)if("data-props"===a.name){const e=this.trimExpression(a.value);for(const r of e.split(",")){const e=r.trim().split(":");if(2===e.length){const r=e[0].trim(),i=this.evalInContext(e[1].trim(),n);r.startsWith("@")?"function"===typeof i&&o.addEventListener(r.substring(1),(e=>i(e,n,t))):o[r]=i}}}else o.setAttribute(a.name,this.expandExpressionsAsString(a.value,n));const r=[],i=[];let s=!1;for(const a of e.childNodes){const e=a;let o=!1;if(e.dataset){let l=!1;if(e.dataset.if){const t=e.dataset.if;this.evalBoolInContext(this.trimExpression(t),n)?(e.removeAttribute("data-if"),s=!0,o=!0):(i.push(e),l=!0)}else"undefined"!==typeof e.dataset.else&&(s?(i.push(e),l=!0):e.removeAttribute("data-else"));e.dataset.for&&!l?r.push(e):l||this.renderNode(a,t,n)}else this.renderNode(a,t,n);o||"#text"===a.nodeName||(s=!1)}for(const a of i)o.removeChild(a);for(const a of r){const e=a.dataset.for,r=this.trimExpression(e).split(/\s(in|of)\s/i);if(3===r.length){const e=r[0].trim(),i=r[2].trim(),s=this.evalInContext(i,n);if(Array.isArray(s)){a.removeAttribute("data-for");for(let r=0;r<s.length;r++){const i=Object.assign({$index:r},n);i[e]=s[r];const l=a.cloneNode(!0);this.renderNode(l,t,i),o.insertBefore(l,a)}}o.removeChild(a)}}return e}static evalBoolInContext(e,t){return t=Object.assign(Object.assign({},t),this.globalContext),new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){t=Object.assign(Object.assign({},t),this.globalContext);const n=new Function("with(this) { return "+e+";}");let o;try{o=n.call(t)}catch(r){}return o}static trimExpression(e){return(e=e.trim()).startsWith(this._startExpression)&&e.endsWith(this._endExpression)&&(e=(e=e.substr(this._startExpression.length,e.length-this._startExpression.length-this._endExpression.length)).trim()),e}}var Kt,Gt;jt._globalContext={};var $t=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Wt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};class Qt extends Lt{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,n){if(!this.hasTemplate(e))return null;n=n||e,this._slotNamesAddedDuringRender.push(n),this._renderedSlots=!0;const o=ot(Kt||(Kt=Ht(["\n      <slot name=","></slot>\n    "])),n),r=Object.assign(Object.assign({},t),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,n)){const{context:e,slot:t}=this._renderedTemplates[n];if(qt(e,r))return o;this.removeChild(t)}const i=document.createElement("div");i.slot=n,i.dataset.generated="template",jt.renderTemplate(i,this.templates[e],r),this.appendChild(i),this._renderedTemplates[n]={context:r,slot:i};const s={templateType:e,context:r,element:i};return this.fireCustomEvent("templateRendered",s),o}hasTemplate(e){var t;return Boolean(null===(t=this.templates)||void 0===t?void 0:t[e])}getTemplates(){const e={};for(let t=0;t<this.children.length;t++){const n=this.children[t];if("TEMPLATE"===n.nodeName){const o=n;o.dataset.type?e[o.dataset.type]=o:e.default=o,o.templateOrder=t}}return e}renderError(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):ot(Gt||(Gt=Ht(['\n      <div class="error">\n        ',"\n      </div>\n    "])),this.error)}removeUnusedSlottedElements(){var e;if(this._renderedSlots){for(let t=0;t<this.children.length;t++){const n=this.children[t];(null===(e=n.dataset)||void 0===e?void 0:e.generated)&&!this._slotNamesAddedDuringRender.includes(n.slot)&&(this.removeChild(n),delete this._renderedTemplates[n.slot],t--)}this._renderedSlots=!1}}}$t([Et({attribute:!1}),Wt("design:type",Object)],Qt.prototype,"templateContext",void 0),$t([At(),Wt("design:type",Object)],Qt.prototype,"error",void 0);const Yt=(e,t)=>t.some((t=>e instanceof t));let Zt,Jt;const Xt=new WeakMap,en=new WeakMap,tn=new WeakMap,nn=new WeakMap,on=new WeakMap;let rn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return en.get(e);if("objectStoreNames"===t)return e.objectStoreNames||tn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ln(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function sn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Jt||(Jt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.apply(cn(this),n),ln(Xt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return ln(e.apply(cn(this),n))}:function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];const i=e.call(cn(this),t,...o);return tn.set(i,t.sort?t.sort():[t]),ln(i)}}function an(e){return"function"===typeof e?sn(e):(e instanceof IDBTransaction&&function(e){if(en.has(e))return;const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=()=>{t(),o()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)}));en.set(e,t)}(e),Yt(e,Zt||(Zt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,rn):e)}function ln(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("success",r),e.removeEventListener("error",i)},r=()=>{t(ln(e.result)),o()},i=()=>{n(e.error),o()};e.addEventListener("success",r),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&Xt.set(t,e)})).catch((()=>{})),on.set(t,e),t}(e);if(nn.has(e))return nn.get(e);const t=an(e);return t!==e&&(nn.set(e,t),on.set(t,e)),t}const cn=e=>on.get(e);const dn=["get","getKey","getAll","getAllKeys","count"],un=["put","add","delete","clear"],hn=new Map;function pn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(hn.get(t))return hn.get(t);const n=t.replace(/FromIndex$/,""),o=t!==n,r=un.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!r&&!dn.includes(n))return;const i=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return o&&(i=i.index(a.shift())),(await Promise.all([i[n](...a),r&&t.done]))[0]};return hn.set(t,i),i}var fn;fn=e=>({...e,get:(t,n,o)=>pn(t,n)||e.get(t,n,o),has:(t,n)=>!!pn(t,n)||e.has(t,n)}),rn=fn(rn);var gn=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class vn{constructor(e,t){if(!(t in e.stores))throw Error('"store" must be defined in the "schema"');this.schema=e,this.store=t}getValue(e){return gn(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,e)}catch(t){return null}}))}putValue(e,t){return gn(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},t),{timeCached:Date.now()}),e)}catch(n){return}}))}clearStore(){return gn(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).clear(this.store)}catch(e){return}}))}getDBName(){return gn(this,void 0,void 0,(function*(){const e=yield re.getCacheId();if(e)return"mgt-".concat(this.schema.name)+"-".concat(e)}))}getDb(){return gn(this,void 0,void 0,(function*(){const e=yield this.getDBName();if(e)return function(e,t){let{blocked:n,upgrade:o,blocking:r,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=ln(s);return o&&s.addEventListener("upgradeneeded",(e=>{o(ln(s.result),e.oldVersion,e.newVersion,ln(s.transaction))})),n&&s.addEventListener("blocked",(()=>n())),a.then((e=>{i&&e.addEventListener("close",(()=>i())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}(e,this.schema.version,{upgrade:(t,n,o,r)=>{const i=JSON.parse(localStorage.getItem(yn))||[];i.includes(e)||i.push(e),localStorage.setItem(yn,JSON.stringify(i));for(const e in this.schema.stores)Object.prototype.hasOwnProperty.call(this.schema.stores,e)&&!t.objectStoreNames.contains(e)&&t.createObjectStore(e)}})}))}}var mn=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const yn="mgt-db-list";class bn{static getCache(e,t){const n="".concat(e.name,"/").concat(t);return this.isInitialized||this.init(),this.cacheStore.has(t)||this.cacheStore.set(n,new vn(e,t)),this.cacheStore.get(n)}static clearCacheById(e){const t=[],n=JSON.parse(localStorage.getItem(yn));if(n){const o=[];n.forEach((n=>{n.includes(e)?t.push(new Promise(((e,t)=>{const o=indexedDB.deleteDatabase(n);o.onsuccess=()=>e(),o.onerror=()=>{console.error("\ud83e\udd92: ".concat(o.error.name," occurred deleting cache: ").concat(n),o.error.message),t()}}))):o.push(n)})),o.length>0?localStorage.setItem(yn,JSON.stringify(o)):localStorage.removeItem(yn)}return Promise.all(t)}static get config(){return this.cacheConfig}static init(){let e;re.globalProvider&&(e=re.globalProvider.state),re.onProviderUpdated((()=>mn(this,void 0,void 0,(function*(){if(e===te.SignedIn&&re.globalProvider.state===te.SignedOut){const e=yield re.getCacheId();null!==e&&(yield this.clearCacheById(e))}e=re.globalProvider.state})))),this.isInitialized=!0}}bn.cacheStore=new Map,bn.isInitialized=!1,bn.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class wn{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(e){this._microsoftTeamsLib=e}static get isAvailable(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}static executeDeepLink(e,t){const n=this.microsoftTeamsLib;n.initialize(),n.executeDeepLink(e,t)}}var kn=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class xn{get value(){return this._value}get hasNext(){return Boolean(this._nextLink)}static create(e,t,n){return kn(this,void 0,void 0,(function*(){const o=yield t.get();if(null===o||void 0===o?void 0:o.value){const t=new xn;return t._graph=e,t._value=o.value,t._nextLink=o["@odata.nextLink"],t._version=n||e.version,t}return null}))}static createFromValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=new xn;return o._graph=e,o._value=t,o._nextLink=n,o._version=e.version,o}get nextLink(){return this._nextLink||""}next(){var e;return kn(this,void 0,void 0,(function*(){if(this._nextLink){const t=this._nextLink.split(this._version)[1],n=yield this._graph.api(t).version(this._version).get();if(null===(e=null===n||void 0===n?void 0:n.value)||void 0===e?void 0:e.length)return this._value=this._value.concat(n.value),this._nextLink=n["@odata.nextLink"],n.value}return null}))}}const Cn=new WeakMap,_n=(e,t,n)=>{const o=[];for(const r of e)o.push(r.replace(t,n));return o},Sn=function(e){if(ge.isDisambiguated){let t=Cn.get(e);if(!t){const n=new RegExp("(</?)mgt-(?!"+ge.disambiguation+"-)"),o="$1".concat(ge.prefix,"-");t=Object.assign(_n(e,n,o),{raw:_n(e.raw,n,o)}),Cn.set(e,t)}e=t}for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return ot(e,...n)},Tn=e=>{const t="".concat(ge.prefix,"-").concat(e),n=customElements.get(t),o=e=>e.packageVersion||" Unknown likely <3.0.0";return n?e=>(console.error("\ud83e\udd92: Tag name ".concat(t," is already defined using class ").concat(n.name," version ").concat(o(n),"\n"),"Currently registering class ".concat(e.name," with version ").concat(o(e),"\n"),"Please use the disambiguation feature to define a unique tag name for this component see: https://github.com/microsoftgraph/microsoft-graph-toolkit/tree/main/packages/mgt-components#disambiguation"),e):(e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:n,elements:o}=t;return{kind:n,elements:o,finisher(t){customElements.define(e,t)}}})(e,t))(t)};var In=n(164);const En=new Set(["children","wcType"]);class An extends e.Component{get element(){return this._element}getTag(){let e;return"function"===typeof this.props.wcType?e=this.props.wcType.name.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase():"string"===typeof this.props.wcType&&(e=this.props.wcType),e}render(){const t=this.getTag();if(!t)throw'"wcType" must be set!';const n={};for(const e of Object.keys(this.props))e&&!0===this.props[e]&&(n[e]=!0);return e.createElement(t,Object.assign(Object.assign({},n),{ref:e=>this.setRef(e)}),this.props.children)}setRef(e){e?(e!==this._element&&this.cleanUp(),this._element=e,this.syncProps(this.props)):this.cleanUp(),this.props.innerRef&&("function"===typeof this.props.innerRef?this.props.innerRef(e):this.props.innerRef.current=e)}cleanUp(){if(this._element){for(const e in this.props)this.props.hasOwnProperty(e)&&this.isEventProp(e,this.props[e])&&this.removeEventListener(e,this.props[e]);this._element=null}}componentDidUpdate(e){const t={};for(const n in this.props)this.props.hasOwnProperty(n)&&(e[n]&&e[n]===this.props[n]||(t[n]=this.props[n],e[n]&&this.isEventProp(n,e[n])&&this.removeEventListener(n,e[n])));for(const n in e)e.hasOwnProperty(n)&&!this.props[n]&&this.isEventProp(n,e[n])&&this.removeEventListener(n,e[n]);this.syncProps(t)}syncProps(e){if(this._element)for(const t in e)En.has(t)||(this.isEventProp(t,e[t])&&this.addEventListener(t,e[t]),this._element[t]=e[t])}isEventProp(e,t){return e&&"function"===typeof t}addEventListener(e,t){let n=e;n.match(/^on[A-Z]/gm)&&(n=n.substring(2).toLowerCase()),this._element.addEventListener(n,t)}removeEventListener(e,t){let n=e;n.match(/^on[A-Z]/gm)&&(n=n.substring(2).toLowerCase()),this._element.removeEventListener(n,t)}}class Rn extends An{constructor(t){super(t),this.handleTemplateRendered=t=>{if(!this._templates)return;const n=t.detail.templateType,o=t.detail.context,r=t.detail.element;let i=this._templates[n];i&&(i=e.cloneElement(i,{dataContext:o}),In.render(i,r))}}getTag(){let e=super.getTag();const t="".concat(ge.prefix,"-");return e.startsWith(t)||(e=t+e),e}render(){const t=this.getTag();if(!t)throw new Error('"wcType" must be set!');this.processTemplates(this.props.children);const n=[];if(this._templates)for(const o in this._templates)if(Object.prototype.hasOwnProperty.call(this._templates,o)){const t=e.createElement("template",{key:o,"data-type":o},null);n.push(t)}return e.createElement(t,{ref:e=>this.setRef(e)},n)}setRef(e){e&&e.addEventListener("templateRendered",this.handleTemplateRendered),super.setRef(e)}cleanUp(){this.element&&(this.element.removeEventListener("templateRendered",this.handleTemplateRendered),super.cleanUp())}processTemplates(t){if(!t)return;const n={};e.Children.forEach(t,(e=>{var t;const o=e,r=null===(t=null===o||void 0===o?void 0:o.props)||void 0===t?void 0:t.template;r?n[r]=o:n.default=o})),this._templates=n}}const Pn=t=>{const n=e.forwardRef(((n,o)=>e.createElement(Rn,Object.assign({wcType:t,innerRef:o},n))));return n},On=Pn("agenda"),Dn=(Pn("file"),Pn("file-list"),Pn("get"),Pn("login"));Pn("people"),Pn("people-picker"),Pn("person"),Pn("person-card"),Pn("picker"),Pn("search-box"),Pn("search-results"),Pn("spinner"),Pn("tasks"),Pn("taxonomy-picker"),Pn("teams-channel-picker"),Pn("theme-toggle"),Pn("todo");var Mn;const Nn=[Ce(Mn||(Mn=Ht(["\n\n"])))],Ln=document.createElement("style");Ln.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");\n}\n")),document.head.appendChild(Ln);const Fn=document.createElement("style");Fn.innerHTML=Nn.toString(),document.head.appendChild(Fn);const Un=1,zn=2,Hn=e=>function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return{_$litDirective$:e,values:n}};class qn{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}const Bn=Hn(class extends qn{constructor(e){var t;if(super(e),e.type!==Un||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,t){let[n]=t;var o,r;if(void 0===this.it){this.it=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in n)n[e]&&!(null===(o=this.nt)||void 0===o?void 0:o.has(e))&&this.it.add(e);return this.render(n)}const i=e.element.classList;this.it.forEach((e=>{e in n||(i.remove(e),this.it.delete(e))}));for(const s in n){const e=!!n[s];e===this.it.has(s)||(null===(r=this.nt)||void 0===r?void 0:r.has(s))||(e?(i.add(s),this.it.add(s)):(i.remove(s),this.it.delete(s)))}return rt}}),Vn=e=>{const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return e.toLocaleString("default",{hour:"numeric",minute:"numeric"});const o=new Date(n);if(o.setDate(t.getDate()-t.getDay()),e>=o)return e.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const r=new Date(o);return r.setDate(o.getDate()-7),e>=r?e.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):e.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},jn=e=>{switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}},Kn=(e,t)=>{let n;return function(){window.clearTimeout(n),n=window.setTimeout((()=>e.apply(this,arguments)),t)}},Gn=e=>new Promise(((t,n)=>{const o=new FileReader;o.onerror=n,o.onload=()=>{t(o.result)},o.readAsDataURL(e)})),$n=e=>e.startsWith("[")?e.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():e,Wn=e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),Qn=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";const n=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,o)).toFixed(n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o])},Yn=e=>(e&&(e=null===(e=null===(e=null===e||void 0===e?void 0:e.replace(/<ddd\/>/gi,"..."))||void 0===e?void 0:e.replace(/<c0>/gi,"<b>"))||void 0===e?void 0:e.replace(/<\/c0>/gi,"</b>")),e),Zn=e=>null===e||void 0===e?void 0:e.replace(/\.[^/.]+$/,""),Jn=e=>new URL(e).pathname.split("/").pop().replace(/-/g," "),Xn=()=>bn.config.response.isEnabled&&bn.config.isEnabled,eo={name:"presence",stores:{presence:"presence"},version:2},to={name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:3},no={name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:2},oo={name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:3},ro={name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:5},io={name:"responses",stores:{responses:"responses"},version:2},so={name:"search",stores:{responses:"responses"},version:2},ao={name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:2},lo={name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:2};var co,uo,ho=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e.person="person",e.group="group"}(co||(co={})),function(e){e.any="any",e.user="user",e.contact="contact"}(uo||(uo={}));const po=()=>bn.config.people.invalidationPeriod||bn.config.defaultInvalidationPeriod,fo=()=>bn.config.people.isEnabled&&bn.config.isEnabled,go=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:uo.any,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return ho(void 0,void 0,void 0,(function*(){const i="".concat(t,":").concat(n,":").concat(o);let s;if(fo()){const e=oo,t=oo.stores.peopleQuery;s=bn.getCache(e,t);const n=fo()?yield s.getValue(i):null;if(n&&po()>Date.now()-n.timeCached)return n.results.map((e=>JSON.parse(e)))}let a,l="personType/class eq 'Person'";o!==uo.any&&(o===uo.user?l+="and personType/subclass eq 'OrganizationUser'":l+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==r&&(l+="".concat(l," and ").concat(r));try{let r=e.api("/me/people").search('"'+t+'"').top(n).filter(l).middlewareOptions(ie("people.read"));if(o!==uo.contact&&(r=r.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),a=yield r.get(),fo()&&a){const e={maxResults:n,results:null};e.results=a.value.map((e=>JSON.stringify(e))),yield s.putValue(i,e)}}catch(c){}return null===a||void 0===a?void 0:a.value}))},vo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uo.any,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return ho(void 0,void 0,void 0,(function*(){let r;const i="".concat(n||"*:".concat(t),":").concat(o);if(fo()){r=bn.getCache(oo,oo.stores.peopleQuery);const e=yield r.getValue(i);if(e&&po()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let s,a="personType/class eq 'Person'";t!==uo.any&&(t===uo.user?a+="and personType/subclass eq 'OrganizationUser'":a+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),n&&(a+=" and ".concat(n));try{let n=e.api("/me/people").middlewareOptions(ie("people.read")).top(o).filter(a);t!==uo.contact&&(n=n.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),s=yield n.get(),fo()&&s&&(yield r.putValue(i,{maxResults:10,results:s.value.map((e=>JSON.stringify(e)))}))}catch(Ye){}return s?s.value:null}))},mo=e=>{var t,n;const o=e,r=e,i=e;return r.mail?$n(r.mail):(null===(t=o.scoredEmailAddresses)||void 0===t?void 0:t.length)?$n(o.scoredEmailAddresses[0].address):(null===(n=i.emailAddresses)||void 0===n?void 0:n.length)?$n(i.emailAddresses[0].address):null},yo=(e,t)=>ho(void 0,void 0,void 0,(function*(){let n;if(fo()){n=bn.getCache(oo,oo.stores.contacts);const e=yield n.getValue(t);if(e&&po()>Date.now()-e.timeCached)return JSON.parse(e.person)}const o="".concat(t.replace(/#/g,"%2523")),r=yield e.api("/me/contacts").filter("emailAddresses/any(a:a/address eq '".concat(o,"')")).middlewareOptions(ie("contacts.read")).get();return fo()&&r&&(yield n.putValue(t,{person:JSON.stringify(r.value)})),r?r.value:null}));var bo=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const wo=()=>bn.config.users.invalidationPeriod||bn.config.defaultInvalidationPeriod,ko=()=>bn.config.users.isEnabled&&bn.config.isEnabled,xo=(e,t)=>bo(void 0,void 0,void 0,(function*(){let n;if(ko()){n=bn.getCache(to,to.stores.users);const e=yield n.getValue("me");if(e&&wo()>Date.now()-e.timeCached){const n=JSON.parse(e.user),o=t?t.filter((e=>!Object.keys(n).includes(e))):null;if(!o||o.length<=1)return n}}let o="me";t&&(o=o+"?$select="+t.toString());const r=yield e.api(o).middlewareOptions(ie("user.read")).get();return ko()&&(yield n.putValue("me",{user:JSON.stringify(r)})),r})),Co=(e,t,n)=>bo(void 0,void 0,void 0,(function*(){let o;if(ko()){o=bn.getCache(to,to.stores.users);const e=yield o.getValue(t);if(e&&wo()>Date.now()-e.timeCached){const t=e.user?JSON.parse(e.user):null,o=n&&t?n.filter((e=>!Object.keys(t).includes(e))):null;if(!o||o.length<=1)return t}}let r,i="/users/".concat(t);n&&(i=i+"?$select="+n.toString());try{r=yield e.api(i).middlewareOptions(ie("user.readbasic.all")).get()}catch(Ye){}return ko()&&(yield o.putValue(t,{user:JSON.stringify(r)})),r})),_o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0;return bo(void 0,void 0,void 0,(function*(){if(!t||0===t.length)return[];const i=e.createBatch(),s={},a={},l=[];let c;n=n.toLowerCase(),ko()&&(c=bn.getCache(to,to.stores.users));for(const r of t){s[r]=null;let t,d,u="/users/".concat(r);if(ko()&&(d=yield c.getValue(r)),(null===d||void 0===d?void 0:d.user)&&wo()>Date.now()-d.timeCached)if(t=JSON.parse(null===d||void 0===d?void 0:d.user),n){if(t){const e=t.displayName;(null===e||void 0===e?void 0:e.toLowerCase().includes(n))&&(a[r]=t)}}else t?s[r]=t:(i.get(r,u,["user.readbasic.all"]),l.push(r));else""!==r&&("me"===r.toString()?s[r]=yield xo(e):(u="/users/".concat(r),o&&(u+="".concat(u,"?$filter=").concat(o)),i.get(r,u,["user.readbasic.all"]),l.push(r)))}try{if(i.hasRequests){const e=yield i.executeAll();for(const o of t){const t=e.get(o);if(null===t||void 0===t?void 0:t.content){const e=t.content;if(n){((null===e||void 0===e?void 0:e.displayName.toLowerCase())||"").includes(n)&&(a[o]=e)}else s[o]=e;ko()&&(yield c.putValue(o,{user:JSON.stringify(e)}))}else{const e=r.find((e=>Object.values(e).includes(o)));e&&(s[o]=e)}}}return n&&Object.keys(a).length?Promise.all(Object.values(a)):Promise.all(Object.values(s))}catch(Ye){try{return t.filter((e=>l.includes(e))).forEach((t=>{s[t]=Co(e,t)})),ko()&&(yield Promise.all(t.filter((e=>l.includes(e))).map((e=>bo(void 0,void 0,void 0,(function*(){return yield c.putValue(e,{user:JSON.stringify(yield s[e])})})))))),Promise.all(Object.values(s))}catch(d){return[]}}}))},So=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return bo(void 0,void 0,void 0,(function*(){const r={maxResults:n,results:null},i="".concat(t,":").concat(n,":").concat(o);let s;if(ko()){s=bn.getCache(to,to.stores.usersQuery);const e=yield s.getValue(i);if(e&&wo()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}const a="".concat(t.replace(/#/g,"%2523")),l=e.api("users").header("ConsistencyLevel","eventual").count(!0).search('"displayName:'.concat(a,'" OR "mail:').concat(a,'"'));let c;""!==o&&l.filter(o);try{c=yield l.top(n).middlewareOptions(ie("User.ReadBasic.All")).get()}catch(d){}return ko()&&c&&(r.results=c.value.map((e=>JSON.stringify(e))),yield s.putValue(t,r)),c?c.value:null}))},To=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:co.person,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";return bo(void 0,void 0,void 0,(function*(){const l={maxResults:o,results:null};let c;const d="".concat(n||"*",":").concat(t||"*",":").concat(o,":").concat(r,":").concat(i,":").concat(s);if(ko()){c=bn.getCache(to,to.stores.usersQuery);const e=yield c.getValue(d);if(e&&wo()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let u="";t&&(u="startswith(displayName,'".concat(t,"') or startswith(givenName,'").concat(t,"') or startswith(surname,'").concat(t,"') or startswith(mail,'").concat(t,"') or startswith(userPrincipalName,'").concat(t,"')"));let h="/groups/".concat(n,"/").concat(i?"transitiveMembers":"members");r===co.person?h+="/microsoft.graph.user":r===co.group&&(h+="/microsoft.graph.group",t&&(u="startswith(displayName,'".concat(t,"') or startswith(mail,'").concat(t,"')"))),s&&(u+=t?" and ".concat(s):s),a&&(u+=t?" and ".concat(a):a);const p=yield e.api(h).count(!0).top(o).filter(u).header("ConsistencyLevel","eventual").middlewareOptions(ie("GroupMember.Read.All")).get();return ko()&&p&&(l.results=p.value.map((e=>JSON.stringify(e))),yield c.putValue(d,l)),p?p.value:null}))},Io=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:co.person,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return bo(void 0,void 0,void 0,(function*(){const a=[];for(const l of n)try{const n=yield To(e,t,l,o,r,i,s);a.push(...n)}catch(Ye){continue}return a}))};var Eo=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const Ao=()=>bn.config.photos.invalidationPeriod||bn.config.defaultInvalidationPeriod,Ro=()=>bn.config.photos.isEnabled&&bn.config.isEnabled,Po=(e,t,n)=>Eo(void 0,void 0,void 0,(function*(){try{const o=yield e.api("".concat(t,"/photo/$value")).responseType(O.RAW).middlewareOptions(ie(...n)).get();if(404===o.status)return{eTag:null,photo:null};if(!o.ok)return null;const r=o["@odata.mediaEtag"];return{eTag:r,photo:yield Gn(yield o.blob())}}catch(o){return null}})),Oo=(e,t)=>Eo(void 0,void 0,void 0,(function*(){let n,o;return Ro()&&(n=bn.getCache(no,no.stores.contacts),o=yield n.getValue(t),o&&Ao()>Date.now()-o.timeCached)?o.photo:(o=yield Po(e,"me/contacts/".concat(t),["contacts.read"]),Ro()&&o&&(yield n.putValue(t,o)),o?o.photo:null)})),Do=(e,t)=>Eo(void 0,void 0,void 0,(function*(){let n,o;if(Ro()){if(n=bn.getCache(no,no.stores.users),o=yield n.getValue(t),o&&Ao()>Date.now()-o.timeCached)return o.photo;if(o)try{const n=yield e.api("users/".concat(t,"/photo")).get();n&&(n["@odata.mediaEtag"]!==o.eTag||null===n["@odata.mediaEtag"]&&null===o.eTag)&&(o=null)}catch(r){return null}}return o=o||(yield Po(e,"users/".concat(t),["user.readbasic.all"])),Ro()&&o&&(yield n.putValue(t,o)),o?o.photo:null})),Mo=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Eo(void 0,void 0,void 0,(function*(){if("personType"in t&&"OrganizationUser"!==t.personType.subclass){if("PersonalContact"===t.personType.subclass&&n){const n=mo(t),o=yield yo(e,n);if((null===o||void 0===o?void 0:o.length)&&o[0].id)return yield Oo(e,o[0].id)}return null}if(t.userPrincipalName||t.id){const n=t.userPrincipalName||t.id;return yield Do(e,n)}if(t.id){const n=yield Do(e,t.id);if(n)return n}const o=mo(t);if(o){const t=yield So(e,o,1);if(null===t||void 0===t?void 0:t.length)return yield Do(e,t[0].id);if(n){const t=yield yo(e,o);if(null===t||void 0===t?void 0:t.length)return yield Oo(e,t[0].id)}}return null}))},No=(e,t,n)=>Eo(void 0,void 0,void 0,(function*(){const o=bn.getCache(no,t);yield o.putValue(e,n)}));var Lo=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const Fo=()=>bn.config.presence.invalidationPeriod||bn.config.defaultInvalidationPeriod,Uo=()=>bn.config.presence.isEnabled&&bn.config.isEnabled,zo=(e,t)=>Lo(void 0,void 0,void 0,(function*(){let n;if(Uo()){n=bn.getCache(eo,eo.stores.presence);const e=yield n.getValue(t||"me");if(e&&Fo()>Date.now()-e.timeCached)return JSON.parse(e.presence)}const o=t?["presence.read.all"]:["presence.read"],r=t?"/users/".concat(t,"/presence"):"/me/presence",i=yield e.api(r).middlewareOptions(ie(...o)).get();return Uo()&&(yield n.putValue(t||"me",{presence:JSON.stringify(i)})),i})),Ho=e=>{const t=e;return t.statusCode&&"code"in t&&"body"in t&&t.date&&"message"in t&&"name"in t&&"requestId"in t};var qo=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const Bo=(e,t,n)=>qo(void 0,void 0,void 0,(function*(){let o,r,i,s=null;const a=t?"users/".concat(t):"me",l=a+(n?"?$select=".concat(n.toString()):""),c=t?["user.readbasic.all"]:["user.read"];if(ko()){const e=bn.getCache(to,to.stores.users);if(i=yield e.getValue(t||"me"),i&&wo()>Date.now()-i.timeCached){if(s=i.user?JSON.parse(i.user):null,null!==s&&n){n.filter((e=>!Object.keys(s).includes(e))).length>=1&&(s=null,i=null)}}else i=null}if(Ro())if(r=yield((e,t)=>Eo(void 0,void 0,void 0,(function*(){const n=bn.getCache(no,t);return yield n.getValue(e)})))(t||"me",no.stores.users),r&&Ao()>Date.now()-r.timeCached)o=r.photo;else if(r)try{const n=yield e.api("".concat(a,"/photo")).get();(null===n||void 0===n?void 0:n["@odata.mediaEtag"])&&n["@odata.mediaEtag"]===r.eTag?(yield No(t||"me",no.stores.users,r),o=r.photo):r=null}catch(d){Ho(d)&&("ErrorItemNotFound"!==d.code&&"ImageNotFound"!==d.code||(yield No(t||"me",no.stores.users,{eTag:null,photo:null})))}if(r||i)if(r){if(!i)try{const n=yield e.api(l).middlewareOptions(ie(...c)).get();if(n){if(ko()){const e=bn.getCache(to,to.stores.users);yield e.putValue(t||"me",{user:JSON.stringify(n)})}s=n}}catch(Ye){}}else try{const n=yield Po(e,a,c);n&&(Ro()&&(yield No(t||"me",no.stores.users,{eTag:n.eTag,photo:n.photo})),o=n.photo)}catch(Ye){}else{let r;const i=e.createBatch();t?(i.get("user","/users/".concat(t).concat(n?"?$select="+n.toString():""),["user.readbasic.all"]),i.get("photo","users/".concat(t,"/photo/$value"),["user.readbasic.all"])):(i.get("user","me",["user.read"]),i.get("photo","me/photo/$value",["user.read"]));const a=yield i.executeAll(),l=a.get("photo");l&&(r=l.headers.ETag,o=l.content);const c=a.get("user");if(c&&(s=c.content),ko()){const e=bn.getCache(to,to.stores.users);yield e.putValue(t||"me",{user:JSON.stringify(s)})}Ro()&&(yield No(t||"me",no.stores.users,{eTag:r,photo:o}))}return s&&(s.personImage=o),s}));var Vo,jo,Ko,Go,$o,Wo,Qo,Yo,Zo,Jo,Xo,er,tr,nr,or,rr,ir,sr,ar,lr,cr,dr,ur,hr,pr,fr,gr,vr,mr,yr,br,wr,kr,xr,Cr,_r,Sr,Tr,Ir,Er,Ar,Rr,Pr,Or,Dr,Mr,Nr,Lr,Fr,Ur,zr,Hr,qr,Br,Vr,jr,Kr,Gr,$r,Wr,Qr,Yr,Zr,Jr,Xr;!function(e){e[e.image=2]="image",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines",e[e.fourlines=6]="fourlines"}(Vo||(Vo={})),function(e){e[e.ArrowDown=0]="ArrowDown",e[e.TeamSeparator=1]="TeamSeparator",e[e.Search=2]="Search",e[e.SkypeArrow=3]="SkypeArrow",e[e.SmallEmail=4]="SmallEmail",e[e.SmallEmailHovered=5]="SmallEmailHovered",e[e.SmallChat=6]="SmallChat",e[e.SmallChatHovered=7]="SmallChatHovered",e[e.Video=8]="Video",e[e.VideoHovered=9]="VideoHovered",e[e.ExpandDown=10]="ExpandDown",e[e.Overview=11]="Overview",e[e.Send=12]="Send",e[e.Contact=13]="Contact",e[e.Copy=14]="Copy",e[e.Phone=15]="Phone",e[e.CellPhone=16]="CellPhone",e[e.Chat=17]="Chat",e[e.Call=18]="Call",e[e.CallHovered=19]="CallHovered",e[e.Confirmation=20]="Confirmation",e[e.Department=21]="Department",e[e.Email=22]="Email",e[e.OfficeLocation=23]="OfficeLocation",e[e.Person=24]="Person",e[e.Messages=25]="Messages",e[e.Organization=26]="Organization",e[e.ExpandRight=27]="ExpandRight",e[e.Profile=28]="Profile",e[e.Birthday=29]="Birthday",e[e.File=30]="File",e[e.Files=31]="Files",e[e.Back=32]="Back",e[e.Close=33]="Close",e[e.Upload=34]="Upload",e[e.FileCloud=35]="FileCloud",e[e.DragFile=36]="DragFile",e[e.Cancel=37]="Cancel",e[e.CheckMark=38]="CheckMark",e[e.Success=39]="Success",e[e.Fail=40]="Fail",e[e.SelectAccount=41]="SelectAccount",e[e.News=42]="News",e[e.DoubleBookmark=43]="DoubleBookmark",e[e.ChevronLeft=44]="ChevronLeft",e[e.ChevronRight=45]="ChevronRight",e[e.Event=46]="Event",e[e.BookOpen=47]="BookOpen",e[e.FileOuter=48]="FileOuter",e[e.BookQuestion=49]="BookQuestion",e[e.Globe=50]="Globe",e[e.Delete=51]="Delete",e[e.Add=52]="Add",e[e.Calendar=53]="Calendar",e[e.Planner=54]="Planner",e[e.Milestone=55]="Milestone",e[e.PersonAdd=56]="PersonAdd",e[e.PresenceAvailable=57]="PresenceAvailable",e[e.PresenceOofAvailable=58]="PresenceOofAvailable",e[e.PresenceBusy=59]="PresenceBusy",e[e.PresenceOofBusy=60]="PresenceOofBusy",e[e.PresenceDnd=61]="PresenceDnd",e[e.PresenceOofDnd=62]="PresenceOofDnd",e[e.PresenceAway=63]="PresenceAway",e[e.PresenceOofAway=64]="PresenceOofAway",e[e.PresenceOffline=65]="PresenceOffline",e[e.PresenceStatusUnknown=66]="PresenceStatusUnknown"}(Xr||(Xr={}));const ei=(e,t)=>{switch(e){case Xr.ArrowDown:return ot(jo||(jo=Ht(['\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />\n        </svg>\n      '])));case Xr.TeamSeparator:return ot(Ko||(Ko=Ht(['\n        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            fill-rule="evenodd"\n            clip-rule="evenodd"\n            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"\n            fill=',"\n          />\n        </svg>\n      "])),t);case Xr.Search:return ot(Go||(Go=Ht(['\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="currentColor"/>\n        </svg>'])));case Xr.SkypeArrow:return ot($o||($o=Ht(['\n        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"\n            fill="#B4009E"\n          />\n        </svg>\n      '])));case Xr.SmallEmail:return ot(Wo||(Wo=Ht(['\n        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path class="filled" d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="currentColor"/>\n          <path class="regular" d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="currentColor"/>\n        </svg>\n      '])));case Xr.SmallChat:return ot(Qo||(Qo=Ht(['\n        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path class="filled" d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="currentColor"/>\n          <path class="regular" d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="currentColor"/>\n        </svg>\n      '])));case Xr.Video:return ot(Yo||(Yo=Ht(['\n        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path class="filled" d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="currentColor"/>\n          <path class="regular" d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="currentColor"/>\n        </svg>\n      '])));case Xr.ExpandDown:return ot(Zo||(Zo=Ht(['\n        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M14 1L7.5 7L1 1" stroke="currentColor" />\n        </svg>\n      '])));case Xr.Overview:return ot(Jo||(Jo=Ht(['\n        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Send:return ot(Xo||(Xo=Ht(['\n        <svg xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"\n          />\n        </svg>\n      '])));case Xr.Contact:return ot(er||(er=Ht(['\n        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Call:return ot(tr||(tr=Ht(['\n        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path class="filled" d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="currentColor"/>\n          <path class="regular" d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="currentColor"/>\n        </svg>\n      '])));case Xr.Confirmation:return ot(nr||(nr=Ht(['\n      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>\n      </svg>\n      '])));case Xr.Copy:return ot(or||(or=Ht(['\n        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"\n          />\n        </svg>\n      '])));case Xr.Phone:return ot(rr||(rr=Ht(['\n        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">\n            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="','"></path>\n        </svg>\n      '])),t);case Xr.CellPhone:return ot(ir||(ir=Ht(['\n        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Chat:return ot(sr||(sr=Ht(['\n        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Department:return ot(ar||(ar=Ht(['\n        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Email:return ot(lr||(lr=Ht(['\n        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.OfficeLocation:return ot(cr||(cr=Ht(['\n        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <title>Location icon</title>\n          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Birthday:return ot(dr||(dr=Ht(['\n        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Person:return ot(ur||(ur=Ht(['\n        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Messages:return ot(hr||(hr=Ht(['\n        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Organization:return ot(pr||(pr=Ht(['\n        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.ExpandRight:return ot(fr||(fr=Ht(['\n        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />\n        </svg>\n      '])));case Xr.Profile:return ot(gr||(gr=Ht(['\n        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.File:return ot(vr||(vr=Ht(['\n        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path\n            opacity="0.64"\n            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"\n            fill="#605E5C"\n          />\n          <path\n            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"\n            fill="white"\n          />\n          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />\n        </svg>\n      '])));case Xr.Files:return ot(mr||(mr=Ht(['\n        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>\n        </svg>\n      '])));case Xr.Back:return ot(yr||(yr=Ht(['\n        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"\n          />\n        </svg>\n      '])));case Xr.Close:return ot(br||(br=Ht(['\n        <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="currentColor"/>\n        </svg>\n     '])));case Xr.Upload:return ot(wr||(wr=Ht(['\n        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>\n        </svg>\n      '])));case Xr.FileCloud:return ot(kr||(kr=Ht(['\n        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"\n          />\n        </svg>\n      '])));case Xr.DragFile:return ot(xr||(xr=Ht(['\n        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">\n          <path\n            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"\n          />\n        </svg>\n      '])));case Xr.Cancel:return ot(Cr||(Cr=Ht(['\n        <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z" fill="currentColor"/>\n        </svg>\n     '])));case Xr.Success:return ot(_r||(_r=Ht(['\n        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>\n          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>\n        </svg>\n      '])));case Xr.CheckMark:return ot(Sr||(Sr=Ht(['\n      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path class="filled" d="M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z" fill="currentColor"/>\n        <path class="regular" d="M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z" fill="currentColor"/>\n      </svg>\n      '])));case Xr.Fail:return ot(Tr||(Tr=Ht(['\n        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>\n          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />\n        </svg>\n      '])));case Xr.SelectAccount:return ot(Ir||(Ir=Ht(['\n    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">\n      <path fill=',' d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>\n    </svg>\n  '])),t);case Xr.News:return ot(Er||(Er=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n        <path d="M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z" fill="none" />\n      </svg>\n      '])));case Xr.DoubleBookmark:return ot(Ar||(Ar=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z" fill="none" />\n        </svg>\n      '])));case Xr.ChevronLeft:return ot(Rr||(Rr=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z" fill="none" />\n        </svg>'])));case Xr.ChevronRight:return ot(Pr||(Pr=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z" fill="currentColor" />\n        </svg>'])));case Xr.Delete:return ot(Or||(Or=Ht(['\n        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z" fill="currentColor"/>\n        </svg>\n    '])));case Xr.Add:return ot(Dr||(Dr=Ht(['\n        <svg width="16" height="15" viewBox="0 0 16 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z" fill="','"/>\n        </svg>'])),t);case Xr.Calendar:return ot(Mr||(Mr=Ht(['\n        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z" fill=',"/>\n        </svg>\n    "])),t);case Xr.Planner:return ot(Nr||(Nr=Ht(['\n        <svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n          <path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z" fill="','"/>\n        </svg>'])),t);case Xr.Milestone:return ot(Lr||(Lr=Ht(['\n        <svg width="24" height="24" fill="','" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n          <path d="M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z" fill="','"/>\n        </svg>'])),t,t);case Xr.PersonAdd:return ot(Fr||(Fr=Ht(['\n        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">\n          <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>\n          <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>\n          <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>\n        </svg>'])));case Xr.Event:return ot(Ur||(Ur=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z" fill="none" />\n        </svg>\n      '])));case Xr.BookOpen:return ot(zr||(zr=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z" fill="none" />\n        </svg>\n      '])));case Xr.FileOuter:return ot(Hr||(Hr=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z" fill="none" />\n        </svg>\n      '])));case Xr.BookQuestion:return ot(qr||(qr=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z" fill="none" />\n        </svg>\n      '])));case Xr.Globe:return ot(Br||(Br=Ht(['\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">\n          <path d="M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z" />\n        </svg>\n      '])));case Xr.PresenceAvailable:return ot(Vr||(Vr=Ht(['\n        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z" fill="#13a10e"></path>\n        </svg>'])));case Xr.PresenceOofAvailable:return ot(jr||(jr=Ht(['\n        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n            <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z" fill="#13a10e"></path>\n        </svg>'])));case Xr.PresenceBusy:return ot(Kr||(Kr=Ht(['\n        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z" fill="#d13438"></path>\n        </svg>'])));case Xr.PresenceOofBusy:return ot(Gr||(Gr=Ht(['\n        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>\n        </svg>\n      '])));case Xr.PresenceDnd:return ot($r||($r=Ht(['\n        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z" fill="#d13438"></path>\n        </svg>'])));case Xr.PresenceOofDnd:return ot(Wr||(Wr=Ht(['\n        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z" fill="#d13438"></path>\n        </svg>'])));case Xr.PresenceAway:return ot(Qr||(Qr=Ht(['\n        <svg fill="#eaa300" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z" fill="#eaa300"></path>\n        </svg>'])));case Xr.PresenceOofAway:return ot(Yr||(Yr=Ht(['\n        <svg fill="#c239b3" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z" fill="#c239b3"></path>\n        </svg>'])));case Xr.PresenceOffline:return ot(Zr||(Zr=Ht(['\n        <svg fill="#929292" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z" fill="#929292"></path>\n        </svg>'])));case Xr.PresenceStatusUnknown:return ot(Jr||(Jr=Ht(['\n        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>\n        </svg>'])))}},ti=()=>void 0!==window.getWindowSegments;var ni;const oi=[Ce(ni||(ni=Ht(["\n.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow-y:auto;overflow-x:hidden}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow-y:auto;overflow-x:hidden}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}\n"])))];var ri,ii,si,ai,li=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ci=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let di=class extends Lt{static get styles(){return oi}get isOpen(){return this._isOpen}set isOpen(e){const t=this._isOpen;t!==e&&(this._isOpen=e,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const e=this._flyout;!this.isOpen&&e&&(e.style.width=null,e.style.setProperty("--mgt-flyout-set-width",null),e.style.setProperty("--mgt-flyout-set-height",null),e.style.maxHeight=null,e.style.top=null,e.style.left=null,e.style.bottom=null)})),this.requestUpdate("isOpen",t),this.dispatchEvent(new Event(e?"opened":"closed")))}get _edgePadding(){return 24}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.handleWindowEvent=e=>{const t=this._flyout;if(t)if(e.composedPath){const n=e.composedPath();if(n.includes(t)||"pointerdown"===e.type&&n.includes(this))return}else{let n=e.target;for(;n;)if(n=n.parentElement,n===t||"pointerdown"===e.type&&n===this)return}this.close()},this.handleResize=()=>{this.close()},this.handleKeyUp=e=>{"Escape"===e.key&&this.close()},this.handleFlyoutWheel=e=>{e.preventDefault()},this.avoidHidingAnchor=!0,this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(e){super.updated(e),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const e={root:!0,visible:this.isOpen},t=this.renderAnchor();let n=null;if(this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),this.isOpen||this._renderedOnce){this._renderedOnce=!0;const e=Bn({flyout:!0,small:this._smallView});n=ot(ri||(ri=Ht(["\n        <div class="," @wheel=",">\n          ","\n        </div>\n      "])),e,this.handleFlyoutWheel,this.renderFlyout())}return ot(ii||(ii=Ht(["\n      <div class=",'>\n        <div class="anchor">\n          ','\n        </div>\n        <div class="scout-top"></div>\n        <div class="scout-bottom"></div>\n        ',"\n      </div>\n    "])),Bn(e),t,n)}renderAnchor(){return ot(si||(si=Ht(['\n      <slot name="anchor"></slot>\n    '])))}renderFlyout(){return ot(ai||(ai=Ht(['\n      <slot name="flyout"></slot>\n    '])))}updateFlyout(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.isOpen)return;const t=this._anchor,n=this._flyout;if(n&&t){const o=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let r,i,s,a=0,l=0;const c=n.getBoundingClientRect(),d=t.getBoundingClientRect(),u=this._topScout.getBoundingClientRect(),h=this._bottomScout.getBoundingClientRect(),p={height:this._windowHeight,left:0,top:0,width:o};if(ti()){const e=(ti()?window:null).getWindowSegments();let t;const n=d.left+d.width/2,o=d.top+d.height/2;for(const r of e)if(n>=r.left&&o>=r.top){t=r;break}t&&(p.left=t.left,p.top=t.top,p.width=t.width,p.height=t.height)}c.width+2*this._edgePadding>p.width?c.width>p.width?(s=p.width,a=0):a=(p.width-c.width)/2:a=d.left+c.width+this._edgePadding>p.width?d.left-(d.left+c.width+this._edgePadding-p.width):d.left<this._edgePadding?this._edgePadding:d.left;const f=p.height-(d.top+d.height),g=d.top;this.avoidHidingAnchor?f<=c.height?g<c.height?g>f?(r=p.height-d.top,i=g):(l=d.bottom,i=f):(r=p.height-d.top,i=g):(l=d.bottom,i=f):c.height+2*this._edgePadding>p.height?c.height>=p.height?(i=p.height,l=0):l=(p.height-c.height)/2:l=d.top+d.height+c.height+this._edgePadding>p.height?p.height-c.height-this._edgePadding:Math.max(d.top+d.height,this._edgePadding),0===u.top&&0===u.left||(a-=u.left,"undefined"!==typeof r?r+=h.top-this._windowHeight:l-=u.top),"rtl"===this.direction?a>100&&this.offsetLeft>100&&(n.style.left="".concat(p.width-a+c.left-c.width-30,"px")):n.style.left="".concat(a+p.left,"px"),"undefined"!==typeof r?(n.style.top="unset",n.style.bottom="".concat(r,"px")):(n.style.bottom="unset",n.style.top="".concat(l+p.top,"px")),s&&(n.style.width="".concat(s,"px"),n.style.setProperty("--mgt-flyout-set-width","".concat(s,"px")),window.requestAnimationFrame((()=>this.updateFlyout()))),i?(n.style.maxHeight="".concat(i,"px"),n.style.setProperty("--mgt-flyout-set-height","".concat(i,"px"))):(n.style.maxHeight=null,n.style.setProperty("--mgt-flyout-set-height","unset")),e&&window.requestAnimationFrame((()=>this.updateFlyout(!1)))}}setupWindowEvents(e){e&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}};var ui,hi;li([Et({attribute:"light-dismiss",type:Boolean}),ci("design:type",Boolean)],di.prototype,"isLightDismiss",void 0),li([Et({attribute:null,type:Boolean}),ci("design:type",Boolean)],di.prototype,"avoidHidingAnchor",void 0),li([Et({attribute:"isOpen",type:Boolean}),ci("design:type",Boolean),ci("design:paramtypes",[Boolean])],di.prototype,"isOpen",null),di=li([Tn("flyout"),ci("design:paramtypes",[])],di),function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(ui||(ui={}));const pi=[Ce(hi||(hi=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0;--person-avatar-size:72px}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0)}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0;--person-avatar-size:72px}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0)}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}\n'])))];var fi,gi;!function(e){e[e.avatar=2]="avatar",e[e.oneline=3]="oneline",e[e.twolines=4]="twolines",e[e.threelines=5]="threelines",e[e.fourlines=6]="fourlines"}(fi||(fi={})),function(e){e.photo="photo",e.initials="initials"}(gi||(gi={}));const vi=Object.assign(Object.assign({},{Available:"Available",Away:"Away",BeRightBack:"Be right back",Busy:"Busy",DoNotDisturb:"Do not disturb",InACall:"In a call",InAConferenceCall:"In a conference call",Inactive:"Inactive",InAMeeting:"In a meeting",Offline:"Offline",OffWork:"Off work",OutOfOffice:"Out of office",PresenceUnknown:"Presence unknown",Presenting:"Presenting",UrgentInterruptionsOnly:"Urgent interruptions only"}),{photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"}),mi=e=>"personType"in e||"userType"in e,yi=e=>null!=e?e:it;var bi,wi,ki,xi,Ci,_i,Si,Ti,Ii,Ei,Ai,Ri,Pi,Oi,Di,Mi,Ni,Li,Fi,Ui,zi,Hi,qi,Bi,Vi,ji=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ki=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Gi=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const $i=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id","userType"];let Wi=Vi=class extends Qt{static get styles(){return pi}get strings(){return vi}get personQuery(){return this._personQuery}set personQuery(e){e!==this._personQuery&&(this._personQuery=e,this.personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.personDetailsInternal||this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetailsInternal=null,this.requestStateUpdate())}get usage(){return this._usage}set usage(e){e!==this._usage&&(this._usage=e,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(e){this._personDetailsInternal!==e&&(this._personDetailsInternal=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(e){if(e===this._personImage)return;this._isInvalidImageSrc=!e;const t=this._personImage;this._personImage=e,this.requestUpdate("personImage",t)}get avatarType(){return this._avatarType}set avatarType(e){e!==this._avatarType&&(this._avatarType=e,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(e){if(e===this._personPresence)return;const t=this._personPresence;this._personPresence=e,this.requestUpdate("personPresence",t)}static get requiredScopes(){const e=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return Vi.config.useContactApis&&e.push("contacts.read"),e}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this._mouseLeaveTimeout=-1,this._mouseEnterTimeout=-1,this.handleMouseClick=e=>{const t=e.target;this.personCardInteraction===ui.click&&t.tagName!=="".concat(ge.prefix,"-PERSON-CARD").toUpperCase()&&this.showPersonCard()},this.handleKeyDown=e=>{e&&"Enter"===e.key&&this.showPersonCard()},this.handleMouseEnter=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===ui.hover&&(this._mouseEnterTimeout=window.setTimeout(this.showPersonCard,500))},this.handleMouseLeave=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=window.setTimeout(this.hidePersonCard,500)},this.hidePersonCard=()=>{const e=this.flyout;e&&e.close();const t=this.querySelector(".mgt-person-card")||this.renderRoot.querySelector(".mgt-person-card");t&&(t.isExpanded=!1,t.clearHistory())},this.showPersonCard=()=>{this._personCardShouldRender||(this._personCardShouldRender=!0);const e=this.flyout;e&&e.open()},this.personCardInteraction=ui.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=Vo.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType=gi.photo,this.verticalLayout=!1}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();const e=this.personDetails||this.personDetailsInternal||this.fallbackDetails,t=this.getImage(),n=this.personPresence||this._fetchedPresence;if(!e&&!t)return this.renderNoData();!(null===e||void 0===e?void 0:e.personImage)&&t&&(e.personImage=t);let o=this.renderTemplate("default",{person:e,personImage:t,personPresence:n});if(!o){const r=this.renderDetails(e,n),i=this.renderAvatar(e,t,n);o=ot(bi||(bi=Ht(["\n        ","\n        ","\n      "])),i,r)}this.personCardInteraction!==ui.none&&(o=this.renderFlyout(o,e,t,n));const r=Bn({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:"auto"!==this.avatarSize&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return ot(wi||(wi=Ht(['\n      <div\n        class="','"\n        dir=',"\n        @click=","\n        @mouseenter=","\n        @mouseleave=","\n        @keydown=",'\n        tabindex="','"\n      >\n        ',"\n      </div>\n    "])),r,this.direction,this.handleMouseClick,this.handleMouseEnter,this.handleMouseLeave,this.handleKeyDown,yi(this.personCardInteraction!==ui.none?"0":void 0),o)}renderLoading(){return this.renderTemplate("loading",null)||ot(ki||(ki=Ht([""])))}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const e=this.renderTemplate("no-data",null);if(e)return e;const t={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return ot(xi||(xi=Ht(["\n       <i class=","></i>\n     "])),Bn(t))}renderPersonIcon(){return ei(Xr.Person)}renderImage(e,t){var n;const o="".concat(this.strings.photoFor," ").concat(e.displayName),r=t&&!this._isInvalidImageSrc&&this.avatarType===gi.photo,i=this.avatarType===gi.photo&&this.view===Vo.image,s=null!==(n=(null===e||void 0===e?void 0:e.displayName)||mo(e))&&void 0!==n?n:void 0,a=ot(Ci||(Ci=Ht(['<img\n      title="','"\n      alt=',"\n      src=","\n      @error="," />"])),yi(i?s:void 0),o,t,(()=>this._isInvalidImageSrc=!0)),l=e?this.getInitials(e):"",c=null===l||void 0===l?void 0:l.length,d=Bn({initials:c&&!r,"contact-icon":!c}),u=ot(_i||(_i=Ht(["<i>","</i>"])),this.renderPersonIcon()),h=ot(Si||(Si=Ht(['\n      <span \n        title="','"\n        role="','"\n        class="','"\n      >\n        ',"\n      </span>\n"])),yi(this.view===Vo.image?s:void 0),yi(this.view===Vo.image?void 0:"presentation"),d,c?l:u);return r?a:h}renderPresence(e){var t;if(!this.showPresence||!e)return ot(Ti||(Ti=Ht([""])));let n;const{activity:o,availability:r}=e;switch(r){case"Available":case"AvailableIdle":if("OutOfOffice"===o)n=ei(Xr.PresenceOofAvailable);else n=ei(Xr.PresenceAvailable);break;case"Busy":case"BusyIdle":switch(o){case"OutOfOffice":case"OnACall":n=ei(Xr.PresenceOofBusy);break;default:n=ei(Xr.PresenceBusy)}break;case"DoNotDisturb":if("OutOfOffice"===o)n=ei(Xr.PresenceOofDnd);else n=ei(Xr.PresenceDnd);break;case"Away":if("OutOfOffice"===o)n=ei(Xr.PresenceOofAway);else n=ei(Xr.PresenceAway);break;case"BeRightBack":n=ei(Xr.PresenceAway);break;case"Offline":switch(o){case"Offline":n=ei(Xr.PresenceOffline);break;case"OutOfOffice":case"OffWork":n=ei(Xr.PresenceOofAway);break;default:n=ei(Xr.PresenceStatusUnknown)}break;default:n=ei(Xr.PresenceStatusUnknown)}const i=Bn({"presence-wrapper":!0,noline:this.isNoLine(),oneline:this.isOneLine()}),s=null!==(t=this.strings[o])&&void 0!==t?t:it;return ot(Ii||(Ii=Ht(['\n      <span\n        class="','"\n        title="','"\n        aria-label="','"\n        role="img">\n          ',"\n      </span>\n    "])),i,s,s,n)}renderAvatar(e,t,n){let o="";if((!t||this._isInvalidImageSrc||this._avatarType===gi.initials)&&e?o="".concat(this.strings.initials," ").concat(this.getInitials(e)):(o=e&&e.displayName||"",""!==o&&(o="".concat(this.strings.photoFor," ").concat(o))),""===o){const t=mo(e);null!==t&&(o="".concat(this.strings.emailAddress," ").concat(t))}const r=this.renderImage(e,t),i=this.renderPresence(n);return ot(Ei||(Ei=Ht(['\n      <div class="avatar-wrapper">\n        ',"\n        ","\n      </div>\n    "])),r,i)}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(e,t){if(!e||this.view===Vo.image||this.view===fi.avatar)return ot(Ai||(Ai=Ht([""])));const n=e;t&&(n.presenceActivity=null===t||void 0===t?void 0:t.activity,n.presenceAvailability=null===t||void 0===t?void 0:t.availability);const o=[];if(this.view>Vo.image){const e=this.getTextFromProperty(n,this.line1Property);if(this.hasTemplate("line1")){const t=this.renderTemplate("line1",{person:n});o.push(ot(Ri||(Ri=Ht(['\n           <div class="line1" @click=',' role="presentation" aria-label="','">',"</div>\n         "])),(()=>this.handleLine1Clicked()),e,t))}else e&&o.push(ot(Pi||(Pi=Ht(['\n             <div class="line1" @click=',' role="presentation" aria-label="','">',"</div>\n           "])),(()=>this.handleLine1Clicked()),e,e))}if(this.view>Vo.oneline){const e=this.getTextFromProperty(n,this.line2Property);if(this.hasTemplate("line2")){const t=this.renderTemplate("line2",{person:n});o.push(ot(Oi||(Oi=Ht(['\n           <div class="line2" @click=',' role="presentation" aria-label="','">',"</div>\n         "])),(()=>this.handleLine2Clicked()),e,t))}else e&&o.push(ot(Di||(Di=Ht(['\n             <div class="line2" @click=',' role="presentation" aria-label="','">',"</div>\n           "])),(()=>this.handleLine2Clicked()),e,e))}if(this.view>Vo.twolines){const e=this.getTextFromProperty(n,this.line3Property);if(this.hasTemplate("line3")){const t=this.renderTemplate("line3",{person:n});o.push(ot(Mi||(Mi=Ht(['\n           <div class="line3" @click=',' role="presentation" aria-label="','">',"</div>\n         "])),(()=>this.handleLine3Clicked()),e,t))}else e&&o.push(ot(Ni||(Ni=Ht(['\n             <div class="line3" @click=',' role="presentation" aria-label="','">',"</div>\n           "])),(()=>this.handleLine3Clicked()),e,e))}if(this.view>Vo.threelines){const e=this.getTextFromProperty(n,this.line4Property);if(this.hasTemplate("line4")){const t=this.renderTemplate("line4",{person:n});o.push(ot(Li||(Li=Ht(['\n          <div class="line4" @click=',' role="presentation" aria-label="','">',"</div>\n        "])),(()=>this.handleLine4Clicked()),e,t))}else e&&o.push(ot(Fi||(Fi=Ht(['\n            <div class="line4" @click=',' role="presentation" aria-label="','">',"</div>\n          "])),(()=>this.handleLine4Clicked()),e,e))}const r=Bn({"details-wrapper":!0,vertical:this.isVertical()});return ot(Ui||(Ui=Ht(['\n      <div class="','">\n        ',"\n      </div>\n    "])),r,o)}renderFlyout(e,t,n,o){const r=this._personCardShouldRender?ot(zi||(zi=Ht(['\n           <div slot="flyout" data-testid="flyout-slot">\n             ',"\n           </div>"])),this.renderFlyoutContent(t,n,o)):ot(Hi||(Hi=Ht([""]))),i=Bn({vertical:this.isVertical()});return Sn(qi||(qi=Ht(['\n      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=','>\n        <div slot="anchor" class="','">',"</div>\n        ","\n      </mgt-flyout>"])),!1,i,e,r)}renderFlyoutContent(e,t,n){return this.renderTemplate("person-card",{person:e,personImage:t})||Sn(Bi||(Bi=Ht(['\n        <mgt-person-card\n          class="mgt-person-card"\n          lock-tab-navigation\n          .personDetails=',"\n          .personImage=","\n          .personPresence=","\n          .showPresence=",">\n        </mgt-person-card>"])),e,t,n,this.showPresence)}loadState(){return Gi(this,void 0,void 0,(function*(){const e=re.globalProvider;if(!e||e.state===te.Loading)return;if(e&&e.state===te.SignedOut)return void(this.personDetailsInternal=null);const t=e.graph.forComponent(this);this.fallbackDetails&&(this.line2Property="email"),this.verticalLayout&&this.view<Vo.fourlines&&(this.line2Property="email");let n=[...$i,this.line1Property,this.line2Property,this.line3Property,this.line4Property];n=n.filter((e=>"email"!==e));let o=this.personDetailsInternal||this.personDetails||this.fallbackDetails;if(o){if(!o.personImage&&this.fetchImage&&this._avatarType===gi.photo&&!this.personImage&&!this._fetchedImage){let e;e="groupTypes"in o?yield((e,t)=>Eo(void 0,void 0,void 0,(function*(){let n,o;const r=t.id;if(Ro()){if(o=bn.getCache(no,no.stores.groups),n=yield o.getValue(r),n&&Ao()>Date.now()-n.timeCached)return n.photo;if(n)try{const t=yield e.api("groups/".concat(r,"/photo")).get();t&&(t["@odata.mediaEtag"]!==n.eTag||null===t["@odata.mediaEtag"]&&null===n.eTag)&&(n=null)}catch(i){return null}}return n=n||(yield Po(e,"groups/".concat(r),["user.readbasic.all"])),Ro()&&n&&(yield o.putValue(r,n)),n?n.photo:null})))(t,o):yield Mo(t,o,Vi.config.useContactApis),e&&(o.personImage=e,this._fetchedImage=e)}}else if(this.userId||"me"===this.personQuery){let e;e=this._avatarType!==gi.photo||this.disableImageFetch?"me"===this.personQuery?yield xo(t,n):yield Co(t,this.userId,n):yield Bo(t,this.userId,n),this.personDetailsInternal=e,this.personDetails=e,this._fetchedImage=this.getImage()}else if(this.personQuery){let e=yield go(t,this.personQuery,1);if(e&&0!==e.length||(e=(yield So(t,this.personQuery,1))||[]),(null===e||void 0===e?void 0:e.length)&&(this.personDetailsInternal=e[0],this.personDetails=e[0],this._avatarType===gi.photo&&!this.disableImageFetch)){const n=yield Mo(t,e[0],Vi.config.useContactApis);n&&(this.personDetailsInternal.personImage=n,this.personDetails.personImage=n,this._fetchedImage=n)}}const r={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(o=this.personDetailsInternal||this.personDetails,o){const e="me"!==this.personQuery?null===o||void 0===o?void 0:o.id:null;this._fetchedPresence=yield zo(t,e)}else this._fetchedPresence=r}catch(Ye){this._fetchedPresence=r}}))}getInitials(e){var t,n,o,r,i,s;if(e||(e=this.personDetailsInternal),"initials"in e)return e.initials;let a="";if(mi(e)&&(a+=null!==(o=null===(n=null===(t=e.givenName)||void 0===t?void 0:t[0])||void 0===n?void 0:n.toUpperCase())&&void 0!==o?o:"",a+=null!==(s=null===(i=null===(r=e.surname)||void 0===r?void 0:r[0])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:""),!a&&e.displayName){const t=e.displayName.split(/\s+/);for(let e=0;e<2&&e<t.length;e++)t[e][0]&&this.isLetter(t[e][0])&&(a+=t[e][0].toUpperCase())}return a}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const e=this.personDetailsInternal||this.personDetails;return(null===e||void 0===e?void 0:e.personImage)?e.personImage:null}isLetter(e){try{return e.match(new RegExp("\\p{L}","u"))}catch(t){return e.toLowerCase()!==e.toUpperCase()}}getTextFromProperty(e,t){if(!t||0===t.length)return null;const n=t.trim().split(",");let o,r=0;for(;!o&&r<n.length;){const t=n[r].trim();switch(t){case"mail":case"email":o=mo(e);break;default:o=e[t]}r++}return o}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>Vo.oneline}isNoLine(){return this.view<Vo.oneline}isOneLine(){return this.view===Vo.oneline}isTwoLines(){return this.view===Vo.twolines}isThreeLines(){return this.view===Vo.threelines}isFourLines(){return this.view===Vo.fourlines}isVertical(){return this.verticalLayout}};var Qi;Wi.config={useContactApis:!0},ji([Et({attribute:"person-query"}),Ki("design:type",String),Ki("design:paramtypes",[String])],Wi.prototype,"personQuery",null),ji([Et({attribute:"fallback-details",type:Object}),Ki("design:type",Object),Ki("design:paramtypes",[Object])],Wi.prototype,"fallbackDetails",null),ji([Et({attribute:"user-id"}),Ki("design:type",String),Ki("design:paramtypes",[String])],Wi.prototype,"userId",null),ji([Et({attribute:"usage"}),Ki("design:type",String),Ki("design:paramtypes",[String])],Wi.prototype,"usage",null),ji([Et({attribute:"show-presence",type:Boolean}),Ki("design:type",Boolean)],Wi.prototype,"showPresence",void 0),ji([Et({attribute:"avatar-size",type:String}),Ki("design:type",String)],Wi.prototype,"avatarSize",void 0),ji([At(),Ki("design:type",Object),Ki("design:paramtypes",[Object])],Wi.prototype,"personDetailsInternal",null),ji([Et({attribute:"person-details",type:Object}),Ki("design:type",Object),Ki("design:paramtypes",[Object])],Wi.prototype,"personDetails",null),ji([Et({attribute:"person-image",type:String}),Ki("design:type",String),Ki("design:paramtypes",[String])],Wi.prototype,"personImage",null),ji([Et({attribute:"fetch-image",type:Boolean}),Ki("design:type",Boolean)],Wi.prototype,"fetchImage",void 0),ji([Et({attribute:"disable-image-fetch",type:Boolean}),Ki("design:type",Boolean)],Wi.prototype,"disableImageFetch",void 0),ji([Et({attribute:"vertical-layout",type:Boolean}),Ki("design:type",Boolean)],Wi.prototype,"verticalLayout",void 0),ji([Et({attribute:"avatar-type",converter:e=>"initials"===(e=e.toLowerCase())?gi.initials:gi.photo}),Ki("design:type",String),Ki("design:paramtypes",[String])],Wi.prototype,"avatarType",null),ji([Et({attribute:"person-presence",type:Object}),Ki("design:type",Object),Ki("design:paramtypes",[Object])],Wi.prototype,"personPresence",null),ji([Et({attribute:"person-card",converter:e=>(e=e.toLowerCase(),"undefined"===typeof ui[e]?ui.none:ui[e])}),Ki("design:type",Number)],Wi.prototype,"personCardInteraction",void 0),ji([Et({attribute:"line1-property"}),Ki("design:type",String)],Wi.prototype,"line1Property",void 0),ji([Et({attribute:"line2-property"}),Ki("design:type",String)],Wi.prototype,"line2Property",void 0),ji([Et({attribute:"line3-property"}),Ki("design:type",String)],Wi.prototype,"line3Property",void 0),ji([Et({attribute:"line4-property"}),Ki("design:type",String)],Wi.prototype,"line4Property",void 0),ji([Et({converter:e=>e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Vo[e]?Vo.image:Vo[e]):Vo.image}),Ki("design:type",Number)],Wi.prototype,"view",void 0),ji([At(),Ki("design:type",String)],Wi.prototype,"_fetchedImage",void 0),ji([At(),Ki("design:type",Object)],Wi.prototype,"_fetchedPresence",void 0),ji([At(),Ki("design:type",Boolean)],Wi.prototype,"_isInvalidImageSrc",void 0),ji([At(),Ki("design:type",Boolean)],Wi.prototype,"_personCardShouldRender",void 0),Wi=Vi=ji([Tn("person"),Ki("design:paramtypes",[])],Wi);const Yi=[Ce(Qi||(Qi=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n'])))];var Zi=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const Ji=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"calendars.read";return Zi(void 0,void 0,void 0,(function*(){const o=e.api(t).middlewareOptions(ie(n)).orderby("start/dateTime");return xn.create(e,o)}))},{I:Xi}=wt,es=()=>document.createComment(""),ts=(e,t,n)=>{var o;const r=e._$AA.parentNode,i=void 0===t?e._$AB:t._$AA;if(void 0===n){const t=r.insertBefore(es(),i),o=r.insertBefore(es(),i);n=new Xi(t,o,e,e.options)}else{const t=n._$AB.nextSibling,s=n._$AM,a=s!==e;if(a){let t;null===(o=n._$AQ)||void 0===o||o.call(n,e),n._$AM=e,void 0!==n._$AP&&(t=e._$AU)!==s._$AU&&n._$AP(t)}if(t!==i||a){let e=n._$AA;for(;e!==t;){const t=e.nextSibling;r.insertBefore(e,i),e=t}}}return n},ns=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return e._$AI(t,n),e},os={},rs=e=>{var t;null===(t=e._$AP)||void 0===t||t.call(e,!1,!0);let n=e._$AA;const o=e._$AB.nextSibling;for(;n!==o;){const e=n.nextSibling;n.remove(),n=e}},is=(e,t,n)=>{const o=new Map;for(let r=t;r<=n;r++)o.set(e[r],r);return o},ss=Hn(class extends qn{constructor(e){if(super(e),e.type!==zn)throw Error("repeat() can only be used in text expressions")}ct(e,t,n){let o;void 0===n?n=t:void 0!==t&&(o=t);const r=[],i=[];let s=0;for(const a of e)r[s]=o?o(a,s):s,i[s]=n(a,s),s++;return{values:i,keys:r}}render(e,t,n){return this.ct(e,t,n).values}update(e,t){let[n,o,r]=t;var i;const s=(e=>e._$AH)(e),{values:a,keys:l}=this.ct(n,o,r);if(!Array.isArray(s))return this.ut=l,a;const c=null!==(i=this.ut)&&void 0!==i?i:this.ut=[],d=[];let u,h,p=0,f=s.length-1,g=0,v=a.length-1;for(;p<=f&&g<=v;)if(null===s[p])p++;else if(null===s[f])f--;else if(c[p]===l[g])d[g]=ns(s[p],a[g]),p++,g++;else if(c[f]===l[v])d[v]=ns(s[f],a[v]),f--,v--;else if(c[p]===l[v])d[v]=ns(s[p],a[v]),ts(e,d[v+1],s[p]),p++,v--;else if(c[f]===l[g])d[g]=ns(s[f],a[g]),ts(e,s[p],s[f]),f--,g++;else if(void 0===u&&(u=is(l,g,v),h=is(c,p,f)),u.has(c[p]))if(u.has(c[f])){const t=h.get(l[g]),n=void 0!==t?s[t]:null;if(null===n){const t=ts(e,s[p]);ns(t,a[g]),d[g]=t}else d[g]=ns(n,a[g]),ts(e,s[p],n),s[t]=null;g++}else rs(s[f]),f--;else rs(s[p]),p++;for(;g<=v;){const t=ts(e,d[v+1]);ns(t,a[g]),d[g++]=t}for(;p<=f;){const e=s[p++];null!==e&&rs(e)}return this.ut=l,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:os;e._$AH=t}(e,d),rt}});var as;const ls=[Ce(as||(as=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n'])))];var cs,ds,us,hs,ps,fs,gs=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},vs=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ms=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(t){i(t)}}function a(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};let ys=class extends Qt{static get styles(){return ls}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){Vt(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(e){Vt(this._peopleQueries,e)||(this._peopleQueries=e,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(e){this._resource!==e&&(this._resource=e,this.requestStateUpdate(!0))}get version(){return this._version}set version(e){this._version!==e&&(this._version=e,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(e){e!==this._fallbackDetails&&(this._fallbackDetails=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...Wi.requiredScopes])]}constructor(){super(),this.personCardInteraction=ui.hover,this.scopes=[],this._peoplePresence={},this._version="v1.0",this._arrowKeyLocation=-1,this.handleKeyDown=e=>{const t=this.shadowRoot.querySelector(".people-list");let n;const o=null===t||void 0===t?void 0:t.children;for(const s of o){const e=s;e.setAttribute("tabindex","-1"),e.blur()}const r=t.childElementCount,i=e.key;if("ArrowRight"===i)this._arrowKeyLocation=(this._arrowKeyLocation+1+r)%r;else if("ArrowLeft"===i)this._arrowKeyLocation=(this._arrowKeyLocation-1+r)%r;else if("Tab"===i||"Escape"===i)this._arrowKeyLocation=-1,t.blur();else if(["Enter","space"," "].includes(i)&&this.personCardInteraction!==ui.none){const e=o[this._arrowKeyLocation].querySelector("mgt-person");e&&e.showPersonCard()}this._arrowKeyLocation>-1&&(n=o[this._arrowKeyLocation],n.setAttribute("tabindex","1"),n.focus())},this.showMax=3}clearState(){this.people=null}requestStateUpdate(e){return e&&(this.people=null),super.requestStateUpdate(e)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||ot(cs||(cs=Ht([""])))}renderPeople(){const e=this.people.slice(0,this.showMax).filter((e=>e));return ot(ds||(ds=Ht(['\n      <ul\n        tabindex="0"\n        class="people-list"\n        aria-label="people"\n        @keydown=',">\n        ","\n        ","\n      </ul>\n    "])),this.handleKeyDown,ss(e,(e=>e.id?e.id:e.displayName),(e=>ot(us||(us=Ht(['\n            <li tabindex="-1" class="people-person">\n              ',"\n            </li>\n          "])),this.renderPerson(e)))),this.people.length>this.showMax?this.renderOverflow():null)}renderOverflow(){const e=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:e,max:this.showMax,people:this.people})||ot(hs||(hs=Ht(['\n        <li tabindex="-1" aria-label="and ',' more attendees" class="overflow"><span>+',"</span></li>\n      "])),e,e)}renderPerson(e){let t={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(t=this._peoplePresence[e.id]);return this.renderTemplate("person",{person:e},e.id)||Sn(ps||(ps=Ht(["\n        <mgt-person\n          .personDetails=","\n          .fetchImage=","\n          .avatarSize=","\n          .personCardInteraction=","\n          .showPresence=","\n          .personPresence=","\n          .usage=","\n        ></mgt-person>\n      "])),e,!0,"small",this.personCardInteraction,this.showPresence,t,"people")}renderNoData(){return this.renderTemplate("no-data",null)||ot(fs||(fs=Ht([""])))}loadState(){return ms(this,void 0,void 0,(function*(){if(!this.people){const e=re.globalProvider;if(e&&e.state===te.SignedIn){const t=e.graph.forComponent(this);this.groupId?this.people=yield To(t,null,this.groupId,this.showMax,co.person):this.userIds||this.peopleQueries?this.people=this.userIds?yield _o(t,this.userIds,"","",this._fallbackDetails):yield((e,t,n)=>bo(void 0,void 0,void 0,(function*(){var o;if(!t||0===t.length)return[];const r=e.createBatch(),i=[];let s,a;ko()&&(a=bn.getCache(to,to.stores.usersQuery));for(const e of t)if(ko()&&(s=yield a.getValue(e)),ko()&&(null===s||void 0===s?void 0:s.results[0])&&wo()>Date.now()-s.timeCached){const e=JSON.parse(s.results[0]);i.push(e)}else r.get(e,'/me/people?$search="'.concat(e,'"'),["people.read"],{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});if(r.hasRequests)try{const e=yield r.executeAll();for(const r of t){const t=e.get(r);if((null===(o=null===t||void 0===t?void 0:t.content)||void 0===o?void 0:o.value)&&t.content.value.length>0)i.push(t.content.value[0]),ko()&&(yield a.putValue(r,{maxResults:1,results:[JSON.stringify(t.content.value[0])]}));else{const e=n.find((e=>Object.values(e).includes(r)));e&&i.push(e)}}return i}catch(Ye){try{return Promise.all(t.filter((e=>e&&""!==e)).map((t=>bo(void 0,void 0,void 0,(function*(){const n=yield go(e,t,1);if(null===n||void 0===n?void 0:n.length)return ko()&&(yield a.putValue(t,{maxResults:1,results:[JSON.stringify(n[0])]})),n[0]})))))}catch(l){return[]}}return i})))(t,this.peopleQueries,this._fallbackDetails):this.resource?this.people=yield((e,t,n,o)=>ho(void 0,void 0,void 0,(function*(){var r;let i;const s="".concat(t).concat(n);if(fo()){i=bn.getCache(oo,oo.stores.peopleQuery);const e=yield i.getValue(s);if(e&&po()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}let a=e.api(n).version(t);(null===o||void 0===o?void 0:o.length)&&(a=a.middlewareOptions(ie(...o)));let l=yield a.get();if(l&&Array.isArray(l.value)&&l["@odata.nextLink"]){let n=l;for(;null===n||void 0===n?void 0:n["@odata.nextLink"];){const o=n["@odata.nextLink"].split(t)[1];n=yield e.client.api(o).version(t).get(),(null===(r=null===n||void 0===n?void 0:n.value)||void 0===r?void 0:r.length)&&(n.value=l.value.concat(n.value),l=n)}}if(fo()&&l){const e={results:null};Array.isArray(l.value)?e.results=l.value.map((e=>JSON.stringify(e))):e.results=[JSON.stringify(l)],yield i.putValue(s,e)}return null===l||void 0===l?void 0:l.value})))(t,this.version,this.resource,this.scopes):this.people=yield vo(t),this.showPresence?this._peoplePresence=yield((e,t)=>Lo(void 0,void 0,void 0,(function*(){if(!t||0===t.length)return{};const n={},o=[],r=["presence.read.all"];let i;Uo()&&(i=bn.getCache(eo,eo.stores.presence));for(const e of t)if(null===e||void 0===e?void 0:e.id){const t=e.id;let r;n[t]=null,Uo()&&(r=yield i.getValue(t)),Uo()&&r&&Fo()>Date.now()-r.timeCached?n[t]=JSON.parse(r.presence):o.push(t)}try{if(o.length>0){const t=yield e.api("/communications/getPresencesByUserId").middlewareOptions(ie(...r)).post({ids:o});for(const e of t.value)n[e.id]=e,Uo()&&(yield i.putValue(e.id,{presence:JSON.stringify(e)}))}return n}catch(Ye){try{const o=yield Promise.all(t.filter((e=>(null===e||void 0===e?void 0:e.id)&&!n[e.id]&&"personType"in e&&"OrganizationUser"===e.personType.subclass)).map((t=>zo(e,t.id))));for(const e of o)n[e.id]=e;return n}catch(s){return null}}})))(t,this.people):this._peoplePresence=null}}}))}};gs([Et({attribute:"group-id",type:String}),vs("design:type",String),vs("design:paramtypes",[Object])],ys.prototype,"groupId",null),gs([Et({attribute:"user-ids",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),vs("design:type",Array),vs("design:paramtypes",[Array])],ys.prototype,"userIds",null),gs([Et({attribute:"people",type:Object}),vs("design:type",Array)],ys.prototype,"people",void 0),gs([Et({attribute:"people-queries",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),vs("design:type",Array),vs("design:paramtypes",[Array])],ys.prototype,"peopleQueries",null),gs([Et({attribute:"show-max",type:Number}),vs("design:type",Number)],ys.prototype,"showMax",void 0),gs([Et({attribute:"show-presence",type:Boolean}),vs("design:type",Boolean)],ys.prototype,"showPresence",void 0),gs([Et({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),"undefined"===typeof ui[e]?ui.hover:ui[e])}),vs("design:type",Number)],ys.prototype,"personCardInteraction",void 0),gs([Et({attribute:"resource",type:String}),vs("design:type",String),vs("design:paramtypes",[Object])],ys.prototype,"resource",null),gs([Et({attribute:"version",type:String}),vs("design:type",String),vs("design:paramtypes",[Object])],ys.prototype,"version",null),gs([Et({attribute:"scopes",converter:e=>e?e.toLowerCase().split(","):null,reflect:!0}),vs("design:type",Array)],ys.prototype,"scopes",void 0),gs([Et({attribute:"fallback-details",type:Array}),vs("design:type",Array),vs("design:paramtypes",[Array])],ys.prototype,"fallbackDetails",null),gs([At(),vs("design:type",Object)],ys.prototype,"_arrowKeyLocation",void 0),ys=gs([Tn("people"),vs("design:paramtypes",[])],ys);const bs=function(){if("undefined"!==typeof globalThis)return globalThis;if("undefined"!==typeof global)return global;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;try{return new Function("return this")()}catch(e){return{}}}();void 0===bs.trustedTypes&&(bs.trustedTypes={createPolicy:(e,t)=>t});const ws={configurable:!1,enumerable:!1,writable:!1};void 0===bs.FAST&&Reflect.defineProperty(bs,"FAST",Object.assign({value:Object.create(null)},ws));const ks=bs.FAST;if(void 0===ks.getById){const e=Object.create(null);Reflect.defineProperty(ks,"getById",Object.assign({value(t,n){let o=e[t];return void 0===o&&(o=n?e[t]=n():null),o}},ws))}const xs=Object.freeze([]);function Cs(){const e=new WeakMap;return function(t){let n=e.get(t);if(void 0===n){let o=Reflect.getPrototypeOf(t);for(;void 0===n&&null!==o;)n=e.get(o),o=Reflect.getPrototypeOf(o);n=void 0===n?[]:n.slice(0),e.set(t,n)}return n}}const _s=bs.FAST.getById(1,(()=>{const e=[],t=[];function n(){if(t.length)throw t.shift()}function o(e){try{e.call()}catch(o){t.push(o),setTimeout(n,0)}}function r(){let t=0;for(;t<e.length;)if(o(e[t]),t++,t>1024){for(let n=0,o=e.length-t;n<o;n++)e[n]=e[n+t];e.length-=t,t=0}e.length=0}return Object.freeze({enqueue:function(t){e.length<1&&bs.requestAnimationFrame(r),e.push(t)},process:r})})),Ss=bs.trustedTypes.createPolicy("fast-html",{createHTML:e=>e});let Ts=Ss;const Is="fast-".concat(Math.random().toString(36).substring(2,8)),Es="".concat(Is,"{"),As="}".concat(Is),Rs=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(e){if(Ts!==Ss)throw new Error("The HTML policy can only be set once.");Ts=e},createHTML:e=>Ts.createHTML(e),isMarker:e=>e&&8===e.nodeType&&e.data.startsWith(Is),extractDirectiveIndexFromMarker:e=>parseInt(e.data.replace("".concat(Is,":"),"")),createInterpolationPlaceholder:e=>"".concat(Es).concat(e).concat(As),createCustomAttributePlaceholder(e,t){return"".concat(e,'="').concat(this.createInterpolationPlaceholder(t),'"')},createBlockPlaceholder:e=>"\x3c!--".concat(Is,":").concat(e,"--\x3e"),queueUpdate:_s.enqueue,processUpdates:_s.process,nextUpdate:()=>new Promise(_s.enqueue),setAttribute(e,t,n){null===n||void 0===n?e.removeAttribute(t):e.setAttribute(t,n)},setBooleanAttribute(e,t,n){n?e.setAttribute(t,""):e.removeAttribute(t)},removeChildNodes(e){for(let t=e.firstChild;null!==t;t=e.firstChild)e.removeChild(t)},createTemplateWalker:e=>document.createTreeWalker(e,133,null,!1)});class Ps{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=e,this.sub1=t}has(e){return void 0===this.spillover?this.sub1===e||this.sub2===e:-1!==this.spillover.indexOf(e)}subscribe(e){const t=this.spillover;if(void 0===t){if(this.has(e))return;if(void 0===this.sub1)return void(this.sub1=e);if(void 0===this.sub2)return void(this.sub2=e);this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else{-1===t.indexOf(e)&&t.push(e)}}unsubscribe(e){const t=this.spillover;if(void 0===t)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}notify(e){const t=this.spillover,n=this.source;if(void 0===t){const t=this.sub1,o=this.sub2;void 0!==t&&t.handleChange(n,e),void 0!==o&&o.handleChange(n,e)}else for(let o=0,r=t.length;o<r;++o)t[o].handleChange(n,e)}}class Os{constructor(e){this.subscribers={},this.sourceSubscribers=null,this.source=e}notify(e){var t;const n=this.subscribers[e];void 0!==n&&n.notify(e),null===(t=this.sourceSubscribers)||void 0===t||t.notify(e)}subscribe(e,t){var n;if(t){let n=this.subscribers[t];void 0===n&&(this.subscribers[t]=n=new Ps(this.source)),n.subscribe(e)}else this.sourceSubscribers=null!==(n=this.sourceSubscribers)&&void 0!==n?n:new Ps(this.source),this.sourceSubscribers.subscribe(e)}unsubscribe(e,t){var n;if(t){const n=this.subscribers[t];void 0!==n&&n.unsubscribe(e)}else null===(n=this.sourceSubscribers)||void 0===n||n.unsubscribe(e)}}const Ds=ks.getById(2,(()=>{const e=/(:|&&|\|\||if)/,t=new WeakMap,n=Rs.queueUpdate;let o,r=e=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function i(e){let n=e.$fastController||t.get(e);return void 0===n&&(Array.isArray(e)?n=r(e):t.set(e,n=new Os(e))),n}const s=Cs();class a{constructor(e){this.name=e,this.field="_".concat(e),this.callback="".concat(e,"Changed")}getValue(e){return void 0!==o&&o.watch(e,this.name),e[this.field]}setValue(e,t){const n=this.field,o=e[n];if(o!==t){e[n]=t;const r=e[this.callback];"function"===typeof r&&r.call(e,o,t),i(e).notify(this.name)}}}class l extends Ps{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e,t),this.binding=e,this.isVolatileBinding=n,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(e,t){this.needsRefresh&&null!==this.last&&this.disconnect();const n=o;o=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const r=this.binding(e,t);return o=n,r}disconnect(){if(null!==this.last){let e=this.first;for(;void 0!==e;)e.notifier.unsubscribe(this,e.propertyName),e=e.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(e,t){const n=this.last,r=i(e),s=null===n?this.first:{};if(s.propertySource=e,s.propertyName=t,s.notifier=r,r.subscribe(this,t),null!==n){if(!this.needsRefresh){let t;o=void 0,t=n.propertySource[n.propertyName],o=this,e===t&&(this.needsRefresh=!0)}n.next=s}this.last=s}handleChange(){this.needsQueue&&(this.needsQueue=!1,n(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let e=this.first;return{next:()=>{const t=e;return void 0===t?{value:void 0,done:!0}:(e=e.next,{value:t,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(e){r=e},getNotifier:i,track(e,t){void 0!==o&&o.watch(e,t)},trackVolatile(){void 0!==o&&(o.needsRefresh=!0)},notify(e,t){i(e).notify(t)},defineProperty(e,t){"string"===typeof t&&(t=new a(t)),s(e).push(t),Reflect.defineProperty(e,t.name,{enumerable:!0,get:function(){return t.getValue(this)},set:function(e){t.setValue(this,e)}})},getAccessors:s,binding(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.isVolatileBinding(e);return new l(e,t,n)},isVolatileBinding:t=>e.test(t.toString())})}));function Ms(e,t){Ds.defineProperty(e,t)}const Ns=ks.getById(3,(()=>{let e=null;return{get:()=>e,set(t){e=t}}}));class Ls{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return Ns.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(e){Ns.set(e)}}Ds.defineProperty(Ls.prototype,"index"),Ds.defineProperty(Ls.prototype,"length");const Fs=Object.seal(new Ls);class Us{constructor(){this.targets=new WeakSet}addStylesTo(e){this.targets.add(e)}removeStylesFrom(e){this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.behaviors=null===this.behaviors?t:this.behaviors.concat(t),this}}function zs(e){return e.map((e=>e instanceof Us?zs(e.styles):[e])).reduce(((e,t)=>e.concat(t)),[])}function Hs(e){return e.map((e=>e instanceof Us?e.behaviors:null)).reduce(((e,t)=>null===t?e:(null===e&&(e=[]),e.concat(t))),null)}Us.create=(()=>{if(Rs.supportsAdoptedStyleSheets){const e=new Map;return t=>new Vs(t,e)}return e=>new Ks(e)})();let qs=(e,t)=>{e.adoptedStyleSheets=[...e.adoptedStyleSheets,...t]},Bs=(e,t)=>{e.adoptedStyleSheets=e.adoptedStyleSheets.filter((e=>-1===t.indexOf(e)))};if(Rs.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),qs=(e,t)=>{e.adoptedStyleSheets.push(...t)},Bs=(e,t)=>{for(const n of t){const t=e.adoptedStyleSheets.indexOf(n);-1!==t&&e.adoptedStyleSheets.splice(t,1)}}}catch(sL){}class Vs extends Us{constructor(e,t){super(),this.styles=e,this.styleSheetCache=t,this._styleSheets=void 0,this.behaviors=Hs(e)}get styleSheets(){if(void 0===this._styleSheets){const e=this.styles,t=this.styleSheetCache;this._styleSheets=zs(e).map((e=>{if(e instanceof CSSStyleSheet)return e;let n=t.get(e);return void 0===n&&(n=new CSSStyleSheet,n.replaceSync(e),t.set(e,n)),n}))}return this._styleSheets}addStylesTo(e){qs(e,this.styleSheets),super.addStylesTo(e)}removeStylesFrom(e){Bs(e,this.styleSheets),super.removeStylesFrom(e)}}let js=0;class Ks extends Us{constructor(e){super(),this.styles=e,this.behaviors=null,this.behaviors=Hs(e),this.styleSheets=zs(e),this.styleClass="fast-style-class-".concat(++js)}addStylesTo(e){const t=this.styleSheets,n=this.styleClass;e=this.normalizeTarget(e);for(let o=0;o<t.length;o++){const r=document.createElement("style");r.innerHTML=t[o],r.className=n,e.append(r)}super.addStylesTo(e)}removeStylesFrom(e){const t=(e=this.normalizeTarget(e)).querySelectorAll(".".concat(this.styleClass));for(let n=0,o=t.length;n<o;++n)e.removeChild(t[n]);super.removeStylesFrom(e)}isAttachedTo(e){return super.isAttachedTo(this.normalizeTarget(e))}normalizeTarget(e){return e===document?document.body:e}}const Gs=Object.freeze({locate:Cs()}),$s={toView:e=>e?"true":"false",fromView:e=>null!==e&&void 0!==e&&"false"!==e&&!1!==e&&0!==e},Ws={toView(e){if(null===e||void 0===e)return null;const t=1*e;return isNaN(t)?null:t.toString()},fromView(e){if(null===e||void 0===e)return null;const t=1*e;return isNaN(t)?null:t}};class Qs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.toLowerCase(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"reflect",r=arguments.length>4?arguments[4]:void 0;this.guards=new Set,this.Owner=e,this.name=t,this.attribute=n,this.mode=o,this.converter=r,this.fieldName="_".concat(t),this.callbackName="".concat(t,"Changed"),this.hasCallback=this.callbackName in e.prototype,"boolean"===o&&void 0===r&&(this.converter=$s)}setValue(e,t){const n=e[this.fieldName],o=this.converter;void 0!==o&&(t=o.fromView(t)),n!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](n,t),e.$fastController.notify(this.name))}getValue(e){return Ds.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){const t=this.mode,n=this.guards;n.has(e)||"fromView"===t||Rs.queueUpdate((()=>{n.add(e);const o=e[this.fieldName];switch(t){case"reflect":const t=this.converter;Rs.setAttribute(e,this.attribute,void 0!==t?t.toView(o):o);break;case"boolean":Rs.setBooleanAttribute(e,this.attribute,o)}n.delete(e)}))}static collect(e){const t=[];for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];o.push(Gs.locate(e));for(let i=0,s=o.length;i<s;++i){const n=o[i];if(void 0!==n)for(let o=0,r=n.length;o<r;++o){const r=n[o];"string"===typeof r?t.push(new Qs(e,r)):t.push(new Qs(e,r.property,r.attribute,r.mode,r.converter))}}return t}}function Ys(e,t){let n;function o(e,t){arguments.length>1&&(n.property=t),Gs.locate(e.constructor).push(n)}return arguments.length>1?(n={},void o(e,t)):(n=void 0===e?{}:e,o)}const Zs={mode:"open"},Js={},Xs=ks.getById(4,(()=>{const e=new Map;return Object.freeze({register:t=>!e.has(t.type)&&(e.set(t.type,t),!0),getByType:t=>e.get(t)})}));class ea{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.definition;"string"===typeof t&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;const n=Qs.collect(e,t.attributes),o=new Array(n.length),r={},i={};for(let s=0,a=n.length;s<a;++s){const e=n[s];o[s]=e.attribute,r[e.name]=e,i[e.attribute]=e}this.attributes=n,this.observedAttributes=o,this.propertyLookup=r,this.attributeLookup=i,this.shadowOptions=void 0===t.shadowOptions?Zs:null===t.shadowOptions?void 0:Object.assign(Object.assign({},Zs),t.shadowOptions),this.elementOptions=void 0===t.elementOptions?Js:Object.assign(Object.assign({},Js),t.elementOptions),this.styles=void 0===t.styles?void 0:Array.isArray(t.styles)?Us.create(t.styles):t.styles instanceof Us?t.styles:Us.create([t.styles])}get isDefined(){return!!Xs.getByType(this.type)}define(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:customElements;const t=this.type;if(Xs.register(this)){const e=this.attributes,n=t.prototype;for(let t=0,o=e.length;t<o;++t)Ds.defineProperty(n,e[t]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}}ea.forType=Xs.getByType;function ta(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}const na=new WeakMap,oa={bubbles:!0,composed:!0,cancelable:!0};function ra(e){return e.shadowRoot||na.get(e)||null}class ia extends Os{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;const n=t.shadowOptions;if(void 0!==n){const t=e.attachShadow(n);"closed"===n.mode&&na.set(e,t)}const o=Ds.getAccessors(e);if(o.length>0){const t=this.boundObservables=Object.create(null);for(let n=0,r=o.length;n<r;++n){const r=o[n].name,i=e[r];void 0!==i&&(delete e[r],t[r]=i)}}}get isConnected(){return Ds.track(this,"isConnected"),this._isConnected}setIsConnected(e){this._isConnected=e,Ds.notify(this,"isConnected")}get template(){return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){return this._styles}set styles(e){this._styles!==e&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=e,this.needsInitialization||null===e||this.addStyles(e))}addStyles(e){const t=ra(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.append(e);else if(!e.isAttachedTo(t)){const n=e.behaviors;e.addStylesTo(t),null!==n&&this.addBehaviors(n)}}removeStyles(e){const t=ra(this.element)||this.element.getRootNode();if(e instanceof HTMLStyleElement)t.removeChild(e);else if(e.isAttachedTo(t)){const n=e.behaviors;e.removeStylesFrom(t),null!==n&&this.removeBehaviors(n)}}addBehaviors(e){const t=this.behaviors||(this.behaviors=new Map),n=e.length,o=[];for(let r=0;r<n;++r){const n=e[r];t.has(n)?t.set(n,t.get(n)+1):(t.set(n,1),o.push(n))}if(this._isConnected){const e=this.element;for(let t=0;t<o.length;++t)o[t].bind(e,Fs)}}removeBehaviors(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.behaviors;if(null===n)return;const o=e.length,r=[];for(let i=0;i<o;++i){const o=e[i];if(n.has(o)){const e=n.get(o)-1;0===e||t?n.delete(o)&&r.push(o):n.set(o,e)}}if(this._isConnected){const e=this.element;for(let t=0;t<r.length;++t)r[t].unbind(e)}}onConnectedCallback(){if(this._isConnected)return;const e=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(e,Fs);const t=this.behaviors;if(null!==t)for(const[n]of t)n.bind(e,Fs);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const e=this.view;null!==e&&e.unbind();const t=this.behaviors;if(null!==t){const e=this.element;for(const[n]of t)n.unbind(e)}}onAttributeChangedCallback(e,t,n){const o=this.definition.attributeLookup[e];void 0!==o&&o.onAttributeChangedCallback(this.element,n)}emit(e,t,n){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},oa),n)))}finishInitialization(){const e=this.element,t=this.boundObservables;if(null!==t){const n=Object.keys(t);for(let o=0,r=n.length;o<r;++o){const r=n[o];e[r]=t[r]}this.boundObservables=null}const n=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():n.template&&(this._template=n.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():n.styles&&(this._styles=n.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(e){const t=this.element,n=ra(t)||t;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||Rs.removeChildNodes(n),e&&(this.view=e.render(t,n,t))}static forCustomElement(e){const t=e.$fastController;if(void 0!==t)return t;const n=ea.forType(e.constructor);if(void 0===n)throw new Error("Missing FASTElement definition.");return e.$fastController=new ia(e,n)}}function sa(e){return class extends e{constructor(){super(),ia.forCustomElement(this)}$emit(e,t,n){return this.$fastController.emit(e,t,n)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,n){this.$fastController.onAttributeChangedCallback(e,t,n)}}}const aa=Object.assign(sa(HTMLElement),{from:e=>sa(e),define:(e,t)=>new ea(e,t).define().type});const la=new Map;"metadata"in Reflect||(Reflect.metadata=function(e,t){return function(n){Reflect.defineMetadata(e,t,n)}},Reflect.defineMetadata=function(e,t,n){let o=la.get(n);void 0===o&&la.set(n,o=new Map),o.set(e,t)},Reflect.getOwnMetadata=function(e,t){const n=la.get(t);if(void 0!==n)return n.get(e)});class ca{constructor(e,t){this.container=e,this.key=t}instance(e){return this.registerResolver(0,e)}singleton(e){return this.registerResolver(1,e)}transient(e){return this.registerResolver(2,e)}callback(e){return this.registerResolver(3,e)}cachedCallback(e){return this.registerResolver(3,Na(e))}aliasTo(e){return this.registerResolver(5,e)}registerResolver(e,t){const{container:n,key:o}=this;return this.container=this.key=void 0,n.registerResolver(o,new Ca(o,e,t))}}function da(e){const t=e.slice(),n=Object.keys(e),o=n.length;let r;for(let i=0;i<o;++i)r=n[i],Va(r)||(t[r]=e[r]);return t}const ua=Object.freeze({none(e){throw Error("".concat(e.toString()," not registered, did you forget to add @singleton()?"))},singleton:e=>new Ca(e,1,e),transient:e=>new Ca(e,2,e)}),ha=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:ua.singleton})}),pa=new Map;function fa(e){return t=>Reflect.getOwnMetadata(e,t)}let ga=null;const va=Object.freeze({createContainer:e=>new Da(null,Object.assign({},ha.default,e)),findResponsibleContainer(e){const t=e.$$container$$;return t&&t.responsibleForOwnerRequests?t:va.findParentContainer(e)},findParentContainer(e){const t=new CustomEvent(Pa,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return e.dispatchEvent(t),t.detail.container||va.getOrCreateDOMContainer()},getOrCreateDOMContainer:(e,t)=>e?e.$$container$$||new Da(e,Object.assign({},ha.default,t,{parentLocator:va.findParentContainer})):ga||(ga=new Da(null,Object.assign({},ha.default,t,{parentLocator:()=>null}))),getDesignParamtypes:fa("design:paramtypes"),getAnnotationParamtypes:fa("di:paramtypes"),getOrCreateAnnotationParamTypes(e){let t=this.getAnnotationParamtypes(e);return void 0===t&&Reflect.defineMetadata("di:paramtypes",t=[],e),t},getDependencies(e){let t=pa.get(e);if(void 0===t){const n=e.inject;if(void 0===n){const n=va.getDesignParamtypes(e),o=va.getAnnotationParamtypes(e);if(void 0===n)if(void 0===o){const n=Object.getPrototypeOf(e);t="function"===typeof n&&n!==Function.prototype?da(va.getDependencies(n)):[]}else t=da(o);else if(void 0===o)t=da(n);else{t=da(n);let e,r=o.length;for(let n=0;n<r;++n)e=o[n],void 0!==e&&(t[n]=e);const i=Object.keys(o);let s;r=i.length;for(let n=0;n<r;++n)s=i[n],Va(s)||(t[s]=o[s])}}else t=da(n);pa.set(e,t)}return t},defineProperty(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="$di_".concat(t);Reflect.defineProperty(e,t,{get:function(){let e=this[r];if(void 0===e){const i=this instanceof HTMLElement?va.findResponsibleContainer(this):va.getOrCreateDOMContainer();if(e=i.get(n),this[r]=e,o&&this instanceof aa){const o=this.$fastController,i=()=>{va.findResponsibleContainer(this).get(n)!==this[r]&&(this[r]=e,o.notify(t))};o.subscribe({handleChange:i},"isConnected")}}return e}})},createInterface(e,t){const n="function"===typeof e?e:t,o="string"===typeof e?e:e&&"friendlyName"in e&&e.friendlyName||za,r="string"!==typeof e&&(e&&"respectConnection"in e&&e.respectConnection||!1),i=function(e,t,n){if(null==e||void 0!==new.target)throw new Error("No registration for interface: '".concat(i.friendlyName,"'"));if(t)va.defineProperty(e,t,i,r);else{va.getOrCreateAnnotationParamTypes(e)[n]=i}};return i.$isInterface=!0,i.friendlyName=null==o?"(anonymous)":o,null!=n&&(i.register=function(e,t){return n(new ca(e,null!==t&&void 0!==t?t:i))}),i.toString=function(){return"InterfaceSymbol<".concat(i.friendlyName,">")},i},inject(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,o){if("number"===typeof o){const n=va.getOrCreateAnnotationParamTypes(e),r=t[0];void 0!==r&&(n[o]=r)}else if(n)va.defineProperty(e,n,t[0]);else{const n=o?va.getOrCreateAnnotationParamTypes(o.value):va.getOrCreateAnnotationParamTypes(e);let r;for(let e=0;e<t.length;++e)r=t[e],void 0!==r&&(n[e]=r)}}},transient:e=>(e.register=function(t){return La.transient(e,e).register(t)},e.registerInRequestor=!1,e),singleton(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ba;return e.register=function(t){return La.singleton(e,e).register(t)},e.registerInRequestor=t.scoped,e}}),ma=va.createInterface("Container");function ya(e){return function(t){const n=function(e,t,o){va.inject(n)(e,t,o)};return n.$isResolver=!0,n.resolve=function(n,o){return e(t,n,o)},n}}va.inject;const ba={scoped:!1};wa=(e,t,n,o)=>n.getAll(e,o);var wa;ya(((e,t,n)=>()=>n.get(e))),ya(((e,t,n)=>n.has(e,!0)?n.get(e):void 0));function ka(e,t,n){va.inject(ka)(e,t,n)}ka.$isResolver=!0,ka.resolve=()=>{};ya(((e,t,n)=>{const o=xa(e,t),r=new Ca(e,0,o);return n.registerResolver(e,r),o})),ya(((e,t,n)=>xa(e,t)));function xa(e,t){return t.getFactory(e).construct(t)}class Ca{constructor(e,t,n){this.key=e,this.strategy=t,this.state=n,this.resolving=!1}get $isResolver(){return!0}register(e){return e.registerResolver(this.key,this)}resolve(e,t){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error("Cyclic dependency found: ".concat(this.state.name));return this.resolving=!0,this.state=e.getFactory(this.state).construct(t),this.strategy=0,this.resolving=!1,this.state;case 2:{const n=e.getFactory(this.state);if(null===n)throw new Error("Resolver for ".concat(String(this.key)," returned a null factory"));return n.construct(t)}case 3:return this.state(e,t,this);case 4:return this.state[0].resolve(e,t);case 5:return t.get(this.state);default:throw new Error("Invalid resolver strategy specified: ".concat(this.strategy,"."))}}getFactory(e){var t,n,o;switch(this.strategy){case 1:case 2:return e.getFactory(this.state);case 5:return null!==(o=null===(n=null===(t=e.getResolver(this.state))||void 0===t?void 0:t.getFactory)||void 0===n?void 0:n.call(t,e))&&void 0!==o?o:null;default:return null}}}function _a(e){return this.get(e)}function Sa(e,t){return t(e)}class Ta{constructor(e,t){this.Type=e,this.dependencies=t,this.transformers=null}construct(e,t){let n;return n=void 0===t?new this.Type(...this.dependencies.map(_a,e)):new this.Type(...this.dependencies.map(_a,e),...t),null==this.transformers?n:this.transformers.reduce(Sa,n)}registerTransformer(e){(this.transformers||(this.transformers=[])).push(e)}}const Ia={$isResolver:!0,resolve:(e,t)=>t};function Ea(e){return"function"===typeof e.register}function Aa(e){return function(e){return Ea(e)&&"boolean"===typeof e.registerInRequestor}(e)&&e.registerInRequestor}const Ra=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),Pa="__DI_LOCATE_PARENT__",Oa=new Map;class Da{constructor(e,t){this.owner=e,this.config=t,this._parent=void 0,this.registerDepth=0,this.context=null,null!==e&&(e.$$container$$=this),this.resolvers=new Map,this.resolvers.set(ma,Ia),e instanceof Node&&e.addEventListener(Pa,(e=>{e.composedPath()[0]!==this.owner&&(e.detail.container=this,e.stopImmediatePropagation())}))}get parent(){return void 0===this._parent&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return null===this.parent?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(e){this.context=e;for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return this.register(...n),this.context=null,this}register(){if(100===++this.registerDepth)throw new Error("Unable to autoregister dependency");let e,t,n,o,r;const i=this.context;for(let s=0,a=arguments.length;s<a;++s)if(e=s<0||arguments.length<=s?void 0:arguments[s],Ha(e))if(Ea(e))e.register(this,i);else if(void 0!==e.prototype)La.singleton(e,e).register(this);else for(t=Object.keys(e),o=0,r=t.length;o<r;++o)n=e[t[o]],Ha(n)&&(Ea(n)?n.register(this,i):this.register(n));return--this.registerDepth,this}registerResolver(e,t){Fa(e);const n=this.resolvers,o=n.get(e);return null==o?n.set(e,t):o instanceof Ca&&4===o.strategy?o.state.push(t):n.set(e,new Ca(e,4,[o,t])),t}registerTransformer(e,t){const n=this.getResolver(e);if(null==n)return!1;if(n.getFactory){const e=n.getFactory(this);return null!=e&&(e.registerTransformer(t),!0)}return!1}getResolver(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Fa(e),void 0!==e.resolve)return e;let n,o=this;for(;null!=o;){if(n=o.resolvers.get(e),null!=n)return n;if(null==o.parent){const n=Aa(e)?this:o;return t?this.jitRegister(e,n):null}o=o.parent}return null}has(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!this.resolvers.has(e)||!(!t||null==this.parent)&&this.parent.has(e,!0)}get(e){if(Fa(e),e.$isResolver)return e.resolve(this,this);let t,n=this;for(;null!=n;){if(t=n.resolvers.get(e),null!=t)return t.resolve(n,this);if(null==n.parent){const o=Aa(e)?this:n;return t=this.jitRegister(e,o),t.resolve(n,this)}n=n.parent}throw new Error("Unable to resolve key: ".concat(String(e)))}getAll(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Fa(e);const n=this;let o,r=n;if(t){let t=xs;for(;null!=r;)o=r.resolvers.get(e),null!=o&&(t=t.concat(Ua(o,r,n))),r=r.parent;return t}for(;null!=r;){if(o=r.resolvers.get(e),null!=o)return Ua(o,r,n);if(r=r.parent,null==r)return xs}return xs}getFactory(e){let t=Oa.get(e);if(void 0===t){if(qa(e))throw new Error("".concat(e.name," is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver."));Oa.set(e,t=new Ta(e,va.getDependencies(e)))}return t}registerFactory(e,t){Oa.set(e,t)}createChild(e){return new Da(null,Object.assign({},this.config,e,{parentLocator:()=>this}))}jitRegister(e,t){if("function"!==typeof e)throw new Error("Attempted to jitRegister something that is not a constructor: '".concat(e,"'. Did you forget to register this dependency?"));if(Ra.has(e.name))throw new Error("Attempted to jitRegister an intrinsic type: ".concat(e.name,". Did you forget to add @inject(Key)"));if(Ea(e)){const n=e.register(t);if(!(n instanceof Object)||null==n.resolve){const n=t.resolvers.get(e);if(void 0!=n)return n;throw new Error("A valid resolver was not returned from the static register method")}return n}if(e.$isInterface)throw new Error("Attempted to jitRegister an interface: ".concat(e.friendlyName));{const n=this.config.defaultResolver(e,t);return t.resolvers.set(e,n),n}}}const Ma=new WeakMap;function Na(e){return function(t,n,o){if(Ma.has(o))return Ma.get(o);const r=e(t,n,o);return Ma.set(o,r),r}}const La=Object.freeze({instance:(e,t)=>new Ca(e,0,t),singleton:(e,t)=>new Ca(e,1,t),transient:(e,t)=>new Ca(e,2,t),callback:(e,t)=>new Ca(e,3,t),cachedCallback:(e,t)=>new Ca(e,3,Na(t)),aliasTo:(e,t)=>new Ca(t,5,e)});function Fa(e){if(null===e||void 0===e)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function Ua(e,t,n){if(e instanceof Ca&&4===e.strategy){const o=e.state;let r=o.length;const i=new Array(r);for(;r--;)i[r]=o[r].resolve(t,n);return i}return[e.resolve(t,n)]}const za="(anonymous)";function Ha(e){return"object"===typeof e&&null!==e||"function"===typeof e}const qa=function(){const e=new WeakMap;let t=!1,n="",o=0;return function(r){return t=e.get(r),void 0===t&&(n=r.toString(),o=n.length,t=o>=29&&o<=100&&125===n.charCodeAt(o-1)&&n.charCodeAt(o-2)<=32&&93===n.charCodeAt(o-3)&&101===n.charCodeAt(o-4)&&100===n.charCodeAt(o-5)&&111===n.charCodeAt(o-6)&&99===n.charCodeAt(o-7)&&32===n.charCodeAt(o-8)&&101===n.charCodeAt(o-9)&&118===n.charCodeAt(o-10)&&105===n.charCodeAt(o-11)&&116===n.charCodeAt(o-12)&&97===n.charCodeAt(o-13)&&110===n.charCodeAt(o-14)&&88===n.charCodeAt(o-15),e.set(r,t)),t}}(),Ba={};function Va(e){switch(typeof e){case"number":return e>=0&&(0|e)===e;case"string":{const t=Ba[e];if(void 0!==t)return t;const n=e.length;if(0===n)return Ba[e]=!1;let o=0;for(let r=0;r<n;++r)if(o=e.charCodeAt(r),0===r&&48===o&&n>1||o<48||o>57)return Ba[e]=!1;return Ba[e]=!0}default:return!1}}function ja(e){return"".concat(e.toLowerCase(),":presentation")}const Ka=new Map,Ga=Object.freeze({define(e,t,n){const o=ja(e);void 0===Ka.get(o)?Ka.set(o,t):Ka.set(o,!1),n.register(La.instance(o,t))},forTag(e,t){const n=ja(e),o=Ka.get(n);if(!1===o){return va.findResponsibleContainer(t).get(n)}return o||null}});class $a{constructor(e,t){this.template=e||null,this.styles=void 0===t?null:Array.isArray(t)?Us.create(t):t instanceof Us?t:Us.create([t])}applyTo(e){const t=e.$fastController;null===t.template&&(t.template=this.template),null===t.styles&&(t.styles=this.styles)}}class Wa extends aa{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return void 0===this._presentation&&(this._presentation=Ga.forTag(this.tagName,this)),this._presentation}templateChanged(){void 0!==this.template&&(this.$fastController.template=this.template)}stylesChanged(){void 0!==this.styles&&(this.$fastController.styles=this.styles)}connectedCallback(){null!==this.$presentation&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(e){var t=this;return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Ya(t===Wa?class extends Wa{}:t,e,n)}}}function Qa(e,t,n){return"function"===typeof e?e(t,n):e}ta([Ms],Wa.prototype,"template",void 0),ta([Ms],Wa.prototype,"styles",void 0);class Ya{constructor(e,t,n){this.type=e,this.elementDefinition=t,this.overrideDefinition=n,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(e,t){const n=this.definition,o=this.overrideDefinition,r=n.prefix||t.elementPrefix,i="".concat(r,"-").concat(n.baseName);t.tryDefineElement({name:i,type:this.type,baseClass:this.elementDefinition.baseClass,callback:e=>{const t=new $a(Qa(n.template,e,n),Qa(n.styles,e,n));e.definePresentation(t);let r=Qa(n.shadowOptions,e,n);e.shadowRootMode&&(r?o.shadowOptions||(r.mode=e.shadowRootMode):null!==r&&(r={mode:e.shadowRootMode})),e.defineElement({elementOptions:Qa(n.elementOptions,e,n),shadowOptions:r,attributes:Qa(n.attributes,e,n)})}})}}class Za{createCSS(){return""}createBehavior(){}}function Ja(e){const t=e.parentElement;if(t)return t;{const t=e.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}const Xa=document.createElement("div");class el{setProperty(e,t){Rs.queueUpdate((()=>this.target.setProperty(e,t)))}removeProperty(e){Rs.queueUpdate((()=>this.target.removeProperty(e)))}}class tl extends el{constructor(){super();const e=new CSSStyleSheet;this.target=e.cssRules[e.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}}class nl extends el{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);const{sheet:e}=this.style;if(e){const t=e.insertRule(":root{}",e.cssRules.length);this.target=e.cssRules[t].style}}}class ol{constructor(e){this.store=new Map,this.target=null;const t=e.$fastController;this.style=document.createElement("style"),t.addStyles(this.style),Ds.getNotifier(t).subscribe(this,"isConnected"),this.handleChange(t,"isConnected")}targetChanged(){if(null!==this.target)for(const[e,t]of this.store.entries())this.target.setProperty(e,t)}setProperty(e,t){this.store.set(e,t),Rs.queueUpdate((()=>{null!==this.target&&this.target.setProperty(e,t)}))}removeProperty(e){this.store.delete(e),Rs.queueUpdate((()=>{null!==this.target&&this.target.removeProperty(e)}))}handleChange(e,t){const{sheet:n}=this.style;if(n){const e=n.insertRule(":host{}",n.cssRules.length);this.target=n.cssRules[e].style}else this.target=null}}ta([Ms],ol.prototype,"target",void 0);class rl{constructor(e){this.target=e.style}setProperty(e,t){Rs.queueUpdate((()=>this.target.setProperty(e,t)))}removeProperty(e){Rs.queueUpdate((()=>this.target.removeProperty(e)))}}class il{setProperty(e,t){il.properties[e]=t;for(const n of il.roots.values())ll.getOrCreate(il.normalizeRoot(n)).setProperty(e,t)}removeProperty(e){delete il.properties[e];for(const t of il.roots.values())ll.getOrCreate(il.normalizeRoot(t)).removeProperty(e)}static registerRoot(e){const{roots:t}=il;if(!t.has(e)){t.add(e);const n=ll.getOrCreate(this.normalizeRoot(e));for(const e in il.properties)n.setProperty(e,il.properties[e])}}static unregisterRoot(e){const{roots:t}=il;if(t.has(e)){t.delete(e);const n=ll.getOrCreate(il.normalizeRoot(e));for(const e in il.properties)n.removeProperty(e)}}static normalizeRoot(e){return e===Xa?document:e}}il.roots=new Set,il.properties={};const sl=new WeakMap,al=Rs.supportsAdoptedStyleSheets?class extends el{constructor(e){super();const t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":host{}")].style,e.$fastController.addStyles(Us.create([t]))}}:ol,ll=Object.freeze({getOrCreate(e){if(sl.has(e))return sl.get(e);let t;return e===Xa?t=new il:e instanceof Document?t=Rs.supportsAdoptedStyleSheets?new tl:new nl:t=e instanceof aa?new al(e):new rl(e),sl.set(e,t),t}});class cl extends Za{constructor(e){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=e.name,null!==e.cssCustomPropertyName&&(this.cssCustomProperty="--".concat(e.cssCustomPropertyName),this.cssVar="var(".concat(this.cssCustomProperty,")")),this.id=cl.uniqueId(),cl.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(e){return new cl({name:"string"===typeof e?e:e.name,cssCustomPropertyName:"string"===typeof e?e:void 0===e.cssCustomPropertyName?e.name:e.cssCustomPropertyName})}static isCSSDesignToken(e){return"string"===typeof e.cssCustomProperty}static isDerivedDesignTokenValue(e){return"function"===typeof e}static getTokenById(e){return cl.tokensById.get(e)}getOrCreateSubscriberSet(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return this.subscribers.get(e)||this.subscribers.set(e,new Set)&&this.subscribers.get(e)}createCSS(){return this.cssVar||""}getValueFor(e){const t=fl.getOrCreate(e).get(this);if(void 0!==t)return t;throw new Error('Value could not be retrieved for token named "'.concat(this.name,'". Ensure the value is set for ').concat(e," or an ancestor of ").concat(e,"."))}setValueFor(e,t){return this._appliedTo.add(e),t instanceof cl&&(t=this.alias(t)),fl.getOrCreate(e).set(this,t),this}deleteValueFor(e){return this._appliedTo.delete(e),fl.existsFor(e)&&fl.getOrCreate(e).delete(this),this}withDefault(e){return this.setValueFor(Xa,e),this}subscribe(e,t){const n=this.getOrCreateSubscriberSet(t);t&&!fl.existsFor(t)&&fl.getOrCreate(t),n.has(e)||n.add(e)}unsubscribe(e,t){const n=this.subscribers.get(t||this);n&&n.has(e)&&n.delete(e)}notify(e){const t=Object.freeze({token:this,target:e});this.subscribers.has(this)&&this.subscribers.get(this).forEach((e=>e.handleChange(t))),this.subscribers.has(e)&&this.subscribers.get(e).forEach((e=>e.handleChange(t)))}alias(e){return t=>e.getValueFor(t)}}cl.uniqueId=(()=>{let e=0;return()=>(e++,e.toString(16))})(),cl.tokensById=new Map;class dl{constructor(e,t,n){this.source=e,this.token=t,this.node=n,this.dependencies=new Set,this.observer=Ds.binding(e,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,Fs))}}class ul{constructor(){this.values=new Map}set(e,t){this.values.get(e)!==t&&(this.values.set(e,t),Ds.getNotifier(this).notify(e.id))}get(e){return Ds.track(this,e.id),this.values.get(e)}delete(e){this.values.delete(e)}all(){return this.values.entries()}}const hl=new WeakMap,pl=new WeakMap;class fl{constructor(e){this.target=e,this.store=new ul,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(e,t)=>{const n=cl.getTokenById(t);if(n&&(n.notify(this.target),cl.isCSSDesignToken(n))){const t=this.parent,o=this.isReflecting(n);if(t){const r=t.get(n),i=e.get(n);r===i||o?r===i&&o&&this.stopReflectToCSS(n):this.reflectToCSS(n)}else o||this.reflectToCSS(n)}}},hl.set(e,this),Ds.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),e instanceof aa?e.$fastController.addBehaviors([this]):e.isConnected&&this.bind()}static getOrCreate(e){return hl.get(e)||new fl(e)}static existsFor(e){return hl.has(e)}static findParent(e){if(Xa!==e.target){let t=Ja(e.target);for(;null!==t;){if(hl.has(t))return hl.get(t);t=Ja(t)}return fl.getOrCreate(Xa)}return null}static findClosestAssignedNode(e,t){let n=t;do{if(n.has(e))return n;n=n.parent?n.parent:n.target!==Xa?fl.getOrCreate(Xa):null}while(null!==n);return null}get parent(){return pl.get(this)||null}has(e){return this.assignedValues.has(e)}get(e){const t=this.store.get(e);if(void 0!==t)return t;const n=this.getRaw(e);return void 0!==n?(this.hydrate(e,n),this.get(e)):void 0}getRaw(e){var t;return this.assignedValues.has(e)?this.assignedValues.get(e):null===(t=fl.findClosestAssignedNode(e,this))||void 0===t?void 0:t.getRaw(e)}set(e,t){cl.isDerivedDesignTokenValue(this.assignedValues.get(e))&&this.tearDownBindingObserver(e),this.assignedValues.set(e,t),cl.isDerivedDesignTokenValue(t)?this.setupBindingObserver(e,t):this.store.set(e,t)}delete(e){this.assignedValues.delete(e),this.tearDownBindingObserver(e);const t=this.getRaw(e);t?this.hydrate(e,t):this.store.delete(e)}bind(){const e=fl.findParent(this);e&&e.appendChild(this);for(const t of this.assignedValues.keys())t.notify(this.target)}unbind(){if(this.parent){pl.get(this).removeChild(this)}}appendChild(e){e.parent&&pl.get(e).removeChild(e);const t=this.children.filter((t=>e.contains(t)));pl.set(e,this),this.children.push(e),t.forEach((t=>e.appendChild(t))),Ds.getNotifier(this.store).subscribe(e);for(const[n,o]of this.store.all())e.hydrate(n,this.bindingObservers.has(n)?this.getRaw(n):o)}removeChild(e){const t=this.children.indexOf(e);return-1!==t&&this.children.splice(t,1),Ds.getNotifier(this.store).unsubscribe(e),e.parent===this&&pl.delete(e)}contains(e){return function(e,t){let n=t;for(;null!==n;){if(n===e)return!0;n=Ja(n)}return!1}(this.target,e.target)}reflectToCSS(e){this.isReflecting(e)||(this.reflecting.add(e),fl.cssCustomPropertyReflector.startReflection(e,this.target))}stopReflectToCSS(e){this.isReflecting(e)&&(this.reflecting.delete(e),fl.cssCustomPropertyReflector.stopReflection(e,this.target))}isReflecting(e){return this.reflecting.has(e)}handleChange(e,t){const n=cl.getTokenById(t);n&&this.hydrate(n,this.getRaw(n))}hydrate(e,t){if(!this.has(e)){const n=this.bindingObservers.get(e);cl.isDerivedDesignTokenValue(t)?n?n.source!==t&&(this.tearDownBindingObserver(e),this.setupBindingObserver(e,t)):this.setupBindingObserver(e,t):(n&&this.tearDownBindingObserver(e),this.store.set(e,t))}}setupBindingObserver(e,t){const n=new dl(t,e,this);return this.bindingObservers.set(e,n),n}tearDownBindingObserver(e){return!!this.bindingObservers.has(e)&&(this.bindingObservers.get(e).disconnect(),this.bindingObservers.delete(e),!0)}}fl.cssCustomPropertyReflector=new class{startReflection(e,t){e.subscribe(this,t),this.handleChange({token:e,target:t})}stopReflection(e,t){e.unsubscribe(this,t),this.remove(e,t)}handleChange(e){const{token:t,target:n}=e;this.add(t,n)}add(e,t){ll.getOrCreate(t).setProperty(e.cssCustomProperty,this.resolveCSSValue(fl.getOrCreate(t).get(e)))}remove(e,t){ll.getOrCreate(t).removeProperty(e.cssCustomProperty)}resolveCSSValue(e){return e&&"function"===typeof e.createCSS?e.createCSS():e}},ta([Ms],fl.prototype,"children",void 0);const gl=Object.freeze({create:function(e){return cl.from(e)},notifyConnection:e=>!(!e.isConnected||!fl.existsFor(e))&&(fl.getOrCreate(e).bind(),!0),notifyDisconnection:e=>!(e.isConnected||!fl.existsFor(e))&&(fl.getOrCreate(e).unbind(),!0),registerRoot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa;il.registerRoot(e)},unregisterRoot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa;il.unregisterRoot(e)}}),vl=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),ml=new Map,yl=new Map;let bl=null;const wl=va.createInterface((e=>e.cachedCallback((e=>(null===bl&&(bl=new xl(null,e)),bl))))),kl=Object.freeze({tagFor:e=>yl.get(e),responsibleFor(e){const t=e.$$designSystem$$;if(t)return t;return va.findResponsibleContainer(e).get(wl)},getOrCreate(e){if(!e)return null===bl&&(bl=va.getOrCreateDOMContainer().get(wl)),bl;const t=e.$$designSystem$$;if(t)return t;const n=va.getOrCreateDOMContainer(e);if(n.has(wl,!1))return n.get(wl);{const t=new xl(e,n);return n.register(La.instance(wl,t)),t}}});class xl{constructor(e,t){this.owner=e,this.container=t,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>vl.definitionCallbackOnly,null!==e&&(e.$$designSystem$$=this)}withPrefix(e){return this.prefix=e,this}withShadowRootMode(e){return this.shadowRootMode=e,this}withElementDisambiguation(e){return this.disambiguate=e,this}withDesignTokenRoot(e){return this.designTokenRoot=e,this}register(){const e=this.container,t=[],n=this.disambiguate,o=this.shadowRootMode,r={elementPrefix:this.prefix,tryDefineElement(r,i,s){const a=function(e,t,n){return"string"===typeof e?{name:e,type:t,callback:n}:e}(r,i,s),{name:l,callback:c,baseClass:d}=a;let{type:u}=a,h=l,p=ml.get(h),f=!0;for(;p;){const e=n(h,u,p);switch(e){case vl.ignoreDuplicate:return;case vl.definitionCallbackOnly:f=!1,p=void 0;break;default:h=e,p=ml.get(h)}}f&&((yl.has(u)||u===Wa)&&(u=class extends u{}),ml.set(h,u),yl.set(u,h),d&&yl.set(d,h)),t.push(new Cl(e,h,u,o,c,f))}};this.designTokensInitialized||(this.designTokensInitialized=!0,null!==this.designTokenRoot&&gl.registerRoot(this.designTokenRoot));for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];e.registerWithContext(r,...s);for(const l of t)l.callback(l),l.willDefine&&null!==l.definition&&l.definition.define();return this}}class Cl{constructor(e,t,n,o,r,i){this.container=e,this.name=t,this.type=n,this.shadowRootMode=o,this.callback=r,this.willDefine=i,this.definition=null}definePresentation(e){Ga.define(this.name,e,this.container)}defineElement(e){this.definition=new ea(this.type,Object.assign(Object.assign({},e),{name:this.name}))}tagFor(e){return kl.tagFor(e)}}const _l=kl.getOrCreate(Sl).withPrefix("fluent");var Sl;const Tl=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(null===t||void 0===t?void 0:t.length)for(const o of t)_l.register(o())};class Il extends Wa{}class El{constructor(){this.targetIndex=0}}class Al extends El{constructor(){super(...arguments),this.createPlaceholder=Rs.createInterpolationPlaceholder}}class Rl extends El{constructor(e,t,n){super(),this.name=e,this.behavior=t,this.options=n}createPlaceholder(e){return Rs.createCustomAttributePlaceholder(this.name,e)}createBehavior(e){return new this.behavior(e,this.options)}}function Pl(e,t){this.source=e,this.context=t,null===this.bindingObserver&&(this.bindingObserver=Ds.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(e,t))}function Ol(e,t){this.source=e,this.context=t,this.target.addEventListener(this.targetName,this)}function Dl(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function Ml(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const e=this.target.$fastView;void 0!==e&&e.isComposed&&(e.unbind(),e.needsBindOnly=!0)}function Nl(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function Ll(e){Rs.setAttribute(this.target,this.targetName,e)}function Fl(e){Rs.setBooleanAttribute(this.target,this.targetName,e)}function Ul(e){if(null!==e&&void 0!==e||(e=""),e.create){this.target.textContent="";let t=this.target.$fastView;void 0===t?t=e.create():this.target.$fastTemplate!==e&&(t.isComposed&&(t.remove(),t.unbind()),t=e.create()),t.isComposed?t.needsBindOnly&&(t.needsBindOnly=!1,t.bind(this.source,this.context)):(t.isComposed=!0,t.bind(this.source,this.context),t.insertBefore(this.target),this.target.$fastView=t,this.target.$fastTemplate=e)}else{const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.isComposed=!1,t.remove(),t.needsBindOnly?t.needsBindOnly=!1:t.unbind()),this.target.textContent=e}}function zl(e){this.target[this.targetName]=e}function Hl(e){const t=this.classVersions||Object.create(null),n=this.target;let o=this.version||0;if(null!==e&&void 0!==e&&e.length){const r=e.split(/\s+/);for(let e=0,i=r.length;e<i;++e){const i=r[e];""!==i&&(t[i]=o,n.classList.add(i))}}if(this.classVersions=t,this.version=o+1,0!==o){o-=1;for(const e in t)t[e]===o&&n.classList.remove(e)}}class ql extends Al{constructor(e){super(),this.binding=e,this.bind=Pl,this.unbind=Dl,this.updateTarget=Ll,this.isBindingVolatile=Ds.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,void 0!==e)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=zl,"innerHTML"===this.cleanedTargetName){const e=this.binding;this.binding=(t,n)=>Rs.createHTML(e(t,n))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=Fl;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=Ol,this.unbind=Nl;break;default:this.cleanedTargetName=e,"class"===e&&(this.updateTarget=Hl)}}targetAtContent(){this.updateTarget=Ul,this.unbind=Ml}createBehavior(e){return new Bl(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class Bl{constructor(e,t,n,o,r,i,s){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=n,this.bind=o,this.unbind=r,this.updateTarget=i,this.targetName=s}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){Ls.setEvent(e);const t=this.binding(this.source,this.context);Ls.setEvent(null),!0!==t&&e.preventDefault()}}let Vl=null;class jl{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){Vl=this}static borrow(e){const t=Vl||new jl;return t.directives=e,t.reset(),Vl=null,t}}function Kl(e){if(1===e.length)return e[0];let t;const n=e.length,o=e.map((e=>"string"===typeof e?()=>e:(t=e.targetName||t,e.binding))),r=new ql(((e,t)=>{let r="";for(let i=0;i<n;++i)r+=o[i](e,t);return r}));return r.targetName=t,r}const Gl=As.length;function $l(e,t){const n=t.split(Es);if(1===n.length)return null;const o=[];for(let r=0,i=n.length;r<i;++r){const t=n[r],i=t.indexOf(As);let s;if(-1===i)s=t;else{const n=parseInt(t.substring(0,i));o.push(e.directives[n]),s=t.substring(i+Gl)}""!==s&&o.push(s)}return o}function Wl(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=t.attributes;for(let r=0,i=o.length;r<i;++r){const s=o[r],a=s.value,l=$l(e,a);let c=null;null===l?n&&(c=new ql((()=>a)),c.targetName=s.name):c=Kl(l),null!==c&&(t.removeAttributeNode(s),r--,i--,e.addFactory(c))}}function Ql(e,t,n){const o=$l(e,t.textContent);if(null!==o){let r=t;for(let i=0,s=o.length;i<s;++i){const s=o[i],a=0===i?t:r.parentNode.insertBefore(document.createTextNode(""),r.nextSibling);"string"===typeof s?a.textContent=s:(a.textContent=" ",e.captureContentBinding(s)),r=a,e.targetIndex++,a!==t&&n.nextNode()}e.targetIndex--}}const Yl=document.createRange();class Zl{constructor(e,t){this.fragment=e,this.behaviors=t,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{const t=this.lastChild;if(e.previousSibling===t)return;const n=e.parentNode;let o,r=this.firstChild;for(;r!==t;)o=r.nextSibling,n.insertBefore(r,e),r=o;n.insertBefore(t,e)}}remove(){const e=this.fragment,t=this.lastChild;let n,o=this.firstChild;for(;o!==t;)n=o.nextSibling,e.appendChild(o),o=n;e.appendChild(t)}dispose(){const e=this.firstChild.parentNode,t=this.lastChild;let n,o=this.firstChild;for(;o!==t;)n=o.nextSibling,e.removeChild(o),o=n;e.removeChild(t);const r=this.behaviors,i=this.source;for(let s=0,a=r.length;s<a;++s)r[s].unbind(i)}bind(e,t){const n=this.behaviors;if(this.source!==e)if(null!==this.source){const o=this.source;this.source=e,this.context=t;for(let r=0,i=n.length;r<i;++r){const i=n[r];i.unbind(o),i.bind(e,t)}}else{this.source=e,this.context=t;for(let o=0,r=n.length;o<r;++o)n[o].bind(e,t)}}unbind(){if(null===this.source)return;const e=this.behaviors,t=this.source;for(let n=0,o=e.length;n<o;++n)e[n].unbind(t);this.source=null}static disposeContiguousBatch(e){if(0!==e.length){Yl.setStartBefore(e[0].firstChild),Yl.setEndAfter(e[e.length-1].lastChild),Yl.deleteContents();for(let t=0,n=e.length;t<n;++t){const n=e[t],o=n.behaviors,r=n.source;for(let e=0,t=o.length;e<t;++e)o[e].unbind(r)}}}}class Jl{constructor(e,t){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=e,this.directives=t}create(e){if(null===this.fragment){let e;const t=this.html;if("string"===typeof t){e=document.createElement("template"),e.innerHTML=Rs.createHTML(t);const n=e.content.firstElementChild;null!==n&&"TEMPLATE"===n.tagName&&(e=n)}else e=t;const n=function(e,t){const n=e.content;document.adoptNode(n);const o=jl.borrow(t);Wl(o,e,!0);const r=o.behaviorFactories;o.reset();const i=Rs.createTemplateWalker(n);let s;for(;s=i.nextNode();)switch(o.targetIndex++,s.nodeType){case 1:Wl(o,s);break;case 3:Ql(o,s,i);break;case 8:Rs.isMarker(s)&&o.addFactory(t[Rs.extractDirectiveIndexFromMarker(s)])}let a=0;(Rs.isMarker(n.firstChild)||1===n.childNodes.length&&t.length)&&(n.insertBefore(document.createComment(""),n.firstChild),a=-1);const l=o.behaviorFactories;return o.release(),{fragment:n,viewBehaviorFactories:l,hostBehaviorFactories:r,targetOffset:a}}(e,this.directives);this.fragment=n.fragment,this.viewBehaviorFactories=n.viewBehaviorFactories,this.hostBehaviorFactories=n.hostBehaviorFactories,this.targetOffset=n.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const t=this.fragment.cloneNode(!0),n=this.viewBehaviorFactories,o=new Array(this.behaviorCount),r=Rs.createTemplateWalker(t);let i=0,s=this.targetOffset,a=r.nextNode();for(let l=n.length;i<l;++i){const e=n[i],t=e.targetIndex;for(;null!==a;){if(s===t){o[i]=e.createBehavior(a);break}a=r.nextNode(),s++}}if(this.hasHostBehaviors){const t=this.hostBehaviorFactories;for(let n=0,r=t.length;n<r;++n,++i)o[i]=t[n].createBehavior(e)}return new Zl(t,o)}render(e,t,n){"string"===typeof t&&(t=document.getElementById(t)),void 0===n&&(n=t);const o=this.create(n);return o.bind(e,Fs),o.appendTo(t),o}}const Xl=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function ec(e){const t=[];let n="";for(let o=0,r=e.length-1;o<r;++o){const r=e[o];let i=o+1<1||arguments.length<=o+1?void 0:arguments[o+1];if(n+=r,i instanceof Jl){const e=i;i=()=>e}if("function"===typeof i&&(i=new ql(i)),i instanceof Al){const e=Xl.exec(r);null!==e&&(i.targetName=e[2])}i instanceof El?(n+=i.createPlaceholder(t.length),t.push(i)):n+=i}return n+=e[e.length-1],new Jl(n,t)}var tc;function nc(e,t,n){return isNaN(e)||e<=t?t:e>=n?n:e}function oc(e,t,n){return isNaN(e)||e<=t?0:e>=n?1:e/(n-t)}function rc(e,t,n){return isNaN(e)?t:t+e*(n-t)}function ic(e,t,n){return isNaN(e)||e<=0?t:e>=1?n:t+e*(n-t)}Math.PI;function sc(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}class ac{constructor(e,t,n,o){this.r=e,this.g=t,this.b=n,this.a="number"!==typeof o||isNaN(o)?1:o}static fromObject(e){return!e||isNaN(e.r)||isNaN(e.g)||isNaN(e.b)?null:new ac(e.r,e.g,e.b,e.a)}equalValue(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return"rgb(".concat(Math.round(rc(this.r,0,255)),",").concat(Math.round(rc(this.g,0,255)),",").concat(Math.round(rc(this.b,0,255)),")")}toStringWebRGBA(){return"rgba(".concat(Math.round(rc(this.r,0,255)),",").concat(Math.round(rc(this.g,0,255)),",").concat(Math.round(rc(this.b,0,255)),",").concat(nc(this.a,0,1),")")}roundToPrecision(e){return new ac(sc(this.r,e),sc(this.g,e),sc(this.b,e),sc(this.a,e))}clamp(){return new ac(nc(this.r,0,1),nc(this.g,0,1),nc(this.b,0,1),nc(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(e){return function(e){const t=Math.round(nc(e,0,255)).toString(16);return 1===t.length?"0"+t:t}(rc(e,0,255))}}const lc=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i;function cc(e){const t=lc.exec(e);if(null===t)return null;let n=t[1];if(3===n.length){const e=n.charAt(0),t=n.charAt(1),o=n.charAt(2);n=e.concat(e,t,t,o,o)}const o=parseInt(n,16);return isNaN(o)?null:new ac(oc((16711680&o)>>>16,0,255),oc((65280&o)>>>8,0,255),oc(255&o,0,255),1)}var dc;!function(e){e.ltr="ltr",e.rtl="rtl"}(dc||(dc={}));class uc{constructor(e,t,n){this.h=e,this.s=t,this.l=n}static fromObject(e){return!e||isNaN(e.h)||isNaN(e.s)||isNaN(e.l)?null:new uc(e.h,e.s,e.l)}equalValue(e){return this.h===e.h&&this.s===e.s&&this.l===e.l}roundToPrecision(e){return new uc(sc(this.h,e),sc(this.s,e),sc(this.l,e))}toObject(){return{h:this.h,s:this.s,l:this.l}}}class hc{constructor(e,t,n){this.l=e,this.a=t,this.b=n}static fromObject(e){return!e||isNaN(e.l)||isNaN(e.a)||isNaN(e.b)?null:new hc(e.l,e.a,e.b)}equalValue(e){return this.l===e.l&&this.a===e.a&&this.b===e.b}roundToPrecision(e){return new hc(sc(this.l,e),sc(this.a,e),sc(this.b,e))}toObject(){return{l:this.l,a:this.a,b:this.b}}}hc.epsilon=216/24389,hc.kappa=24389/27;class pc{constructor(e,t,n){this.x=e,this.y=t,this.z=n}static fromObject(e){return!e||isNaN(e.x)||isNaN(e.y)||isNaN(e.z)?null:new pc(e.x,e.y,e.z)}equalValue(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}roundToPrecision(e){return new pc(sc(this.x,e),sc(this.y,e),sc(this.z,e))}toObject(){return{x:this.x,y:this.y,z:this.z}}}function fc(e){function t(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return function(e){return.2126*e.r+.7152*e.g+.0722*e.b}(new ac(t(e.r),t(e.g),t(e.b),1))}pc.whitePoint=new pc(.95047,1,1.08883);function gc(e,t,n){return n-t===0?0:(e-t)/(n-t)}function vc(e,t,n){return(gc(e.r,t.r,n.r)+gc(e.g,t.g,n.g)+gc(e.b,t.b,n.b))/3}function mc(e){const t=Math.max(e.r,e.g,e.b),n=Math.min(e.r,e.g,e.b),o=t-n;let r=0;0!==o&&(r=t===e.r?(e.g-e.b)/o%6*60:t===e.g?60*((e.b-e.r)/o+2):60*((e.r-e.g)/o+4)),r<0&&(r+=360);const i=(t+n)/2;let s=0;return 0!==o&&(s=o/(1-Math.abs(2*i-1))),new uc(r,s,i)}function yc(e){return function(e){function t(e){return e>hc.epsilon?Math.pow(e,1/3):(hc.kappa*e+16)/116}const n=t(e.x/pc.whitePoint.x),o=t(e.y/pc.whitePoint.y),r=t(e.z/pc.whitePoint.z);return new hc(116*o-16,500*(n-o),200*(o-r))}(function(e){function t(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}const n=t(e.r),o=t(e.g),r=t(e.b);return new pc(.4124564*n+.3575761*o+.1804375*r,.2126729*n+.7151522*o+.072175*r,.0193339*n+.119192*o+.9503041*r)}(e))}function bc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;function n(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}const o=n(3.2404542*e.x-1.5371385*e.y-.4985314*e.z),r=n(-.969266*e.x+1.8760108*e.y+.041556*e.z),i=n(.0556434*e.x-.2040259*e.y+1.0572252*e.z);return new ac(o,r,i,t)}(function(e){const t=(e.l+16)/116,n=t+e.a/500,o=t-e.b/200,r=Math.pow(n,3),i=Math.pow(t,3),s=Math.pow(o,3);let a=0;a=r>hc.epsilon?r:(116*n-16)/hc.kappa;let l=0;l=e.l>hc.epsilon*hc.kappa?i:e.l/hc.kappa;let c=0;return c=s>hc.epsilon?s:(116*o-16)/hc.kappa,a=pc.whitePoint.x*a,l=pc.whitePoint.y*l,c=pc.whitePoint.z*c,new pc(a,l,c)}(e),t)}function wc(e,t,n){return isNaN(e)||e<=0?t:e>=1?n:new ac(ic(e,t.r,n.r),ic(e,t.g,n.g),ic(e,t.b,n.b),ic(e,t.a,n.a))}var kc;function xc(e,t){const n=e.relativeLuminance>t.relativeLuminance?e:t,o=e.relativeLuminance>t.relativeLuminance?t:e;return(n.relativeLuminance+.05)/(o.relativeLuminance+.05)}!function(e){e[e.RGB=0]="RGB",e[e.HSL=1]="HSL",e[e.HSV=2]="HSV",e[e.XYZ=3]="XYZ",e[e.LAB=4]="LAB",e[e.LCH=5]="LCH"}(kc||(kc={}));const Cc=Object.freeze({create:(e,t,n)=>new _c(e,t,n),from:e=>new _c(e.r,e.g,e.b)});class _c extends ac{constructor(e,t,n){super(e,t,n,1),this.toColorString=this.toStringHexRGB,this.contrast=xc.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=fc(this)}static fromObject(e){return new _c(e.r,e.g,e.b)}}function Sc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;if(o===n)return e[n];const r=Math.floor((o-n)/2)+n;return t(e[r])?Sc(e,t,n,r):Sc(e,t,r+1,o)}const Tc=(-.1+Math.sqrt(.21))/2;function Ic(e){return e.relativeLuminance<=Tc}function Ec(e){return Ic(e)?-1:1}const Ac={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};const Rc=Object.freeze({create:function(e,t,n){return"number"===typeof e?Rc.from(Cc.create(e,t,n)):Rc.from(e)},from:function(e,t){return function(e){const t={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(const n in t)if(typeof t[n]!==typeof e[n])return!1;return!0}(e)?Pc.from(e,t):Pc.from(Cc.create(e.r,e.g,e.b),t)}});class Pc{constructor(e,t){this.closestIndexCache=new Map,this.source=e,this.swatches=t,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(e,t,n,o){void 0===n&&(n=this.closestIndexOf(e));let r=this.swatches;const i=this.lastIndex;let s=n;void 0===o&&(o=Ec(e));return-1===o&&(r=this.reversedSwatches,s=i-s),Sc(r,(n=>xc(e,n)>=t),s,i)}get(e){return this.swatches[e]||this.swatches[nc(e,0,this.lastIndex)]}closestIndexOf(e){if(this.closestIndexCache.has(e.relativeLuminance))return this.closestIndexCache.get(e.relativeLuminance);let t=this.swatches.indexOf(e);if(-1!==t)return this.closestIndexCache.set(e.relativeLuminance,t),t;const n=this.swatches.reduce(((t,n)=>Math.abs(n.relativeLuminance-e.relativeLuminance)<Math.abs(t.relativeLuminance-e.relativeLuminance)?n:t));return t=this.swatches.indexOf(n),this.closestIndexCache.set(e.relativeLuminance,t),t}static saturationBump(e,t){const n=mc(e).s,o=mc(t);if(o.s<n){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=(1-Math.abs(2*e.l-1))*e.s,o=n*(1-Math.abs(e.h/60%2-1)),r=e.l-n/2;let i=0,s=0,a=0;return e.h<60?(i=n,s=o,a=0):e.h<120?(i=o,s=n,a=0):e.h<180?(i=0,s=n,a=o):e.h<240?(i=0,s=o,a=n):e.h<300?(i=o,s=0,a=n):e.h<360&&(i=n,s=0,a=o),new ac(i+r,s+r,a+r,t)}(new uc(o.h,n,o.l))}return t}static ramp(e){const t=e/100;return t>.5?(t-.5)/.5:2*t}static createHighResolutionPalette(e){const t=[],n=yc(ac.fromObject(e).roundToPrecision(4)),o=bc(new hc(0,n.a,n.b)).clamp().roundToPrecision(4),r=bc(new hc(50,n.a,n.b)).clamp().roundToPrecision(4),i=bc(new hc(100,n.a,n.b)).clamp().roundToPrecision(4),s=new ac(0,0,0),a=new ac(1,1,1),l=i.equalValue(a)?0:14,c=o.equalValue(s)?0:14;for(let d=100+l;d>=0-c;d-=.5){let e;if(d<0){e=wc(d/c+1,s,o)}else if(d<=50)e=wc(Pc.ramp(d),o,r);else if(d<=100)e=wc(Pc.ramp(d),r,i);else{e=wc((d-100)/l,i,a)}e=Pc.saturationBump(r,e).roundToPrecision(4),t.push(Cc.from(e))}return new Pc(e,t)}static adjustEnd(e,t,n,o){const r=-1===o?t.swatches:t.reversedSwatches,i=e=>{const n=t.closestIndexOf(e);return 1===o?t.lastIndex-n:n};1===o&&n.reverse();const s=e(n[n.length-2]);if(sc(xc(n[n.length-1],n[n.length-2]),2)<s){n.pop();const e=i(t.colorContrast(r[t.lastIndex],s,void 0,o))-i(n[n.length-2]);let a=1;for(let o=n.length-e-1;o<n.length;o++){const e=i(n[o]),s=o===n.length-1?t.lastIndex:e+a;n[o]=r[s],a++}}1===o&&n.reverse()}static createColorPaletteByContrast(e,t){const n=Pc.createHighResolutionPalette(e),o=e=>sc(t.stepContrast+t.stepContrast*(1-e.relativeLuminance)*t.stepContrastRamp,2),r=[];let i=t.preserveSource?e:n.swatches[0];r.push(i);do{const e=o(i);i=n.colorContrast(i,e,void 0,1),r.push(i)}while(i.relativeLuminance>0);if(t.preserveSource){i=e;do{const e=o(i);i=n.colorContrast(i,e,void 0,-1),r.unshift(i)}while(i.relativeLuminance<1)}return this.adjustEnd(o,n,r,-1),t.preserveSource&&this.adjustEnd(o,n,r,1),r}static from(e,t){const n=void 0===t?Ac:Object.assign(Object.assign({},Ac),t);return new Pc(e,Object.freeze(Pc.createColorPaletteByContrast(e,n)))}}const Oc=Cc.create(1,1,1),Dc=Cc.create(0,0,0),Mc=Cc.create(.5,.5,.5),Nc=cc("#0078D4"),Lc=Cc.create(Nc.r,Nc.g,Nc.b);function Fc(e,t,n,o,r){const i=e=>e.contrast(Oc)>=r?Oc:Dc,s=i(e),a=i(t);return{rest:s,hover:a,active:s.relativeLuminance===a.relativeLuminance?s:i(n),focus:i(o)}}var Uc;!function(e){e[e.Burn=0]="Burn",e[e.Color=1]="Color",e[e.Darken=2]="Darken",e[e.Dodge=3]="Dodge",e[e.Lighten=4]="Lighten",e[e.Multiply=5]="Multiply",e[e.Overlay=6]="Overlay",e[e.Screen=7]="Screen"}(Uc||(Uc={}));class zc{constructor(e,t,n,o){this.toColorString=()=>this.cssGradient,this.contrast=xc.bind(null,this),this.createCSS=this.toColorString,this.color=new ac(e,t,n),this.cssGradient=o,this.relativeLuminance=fc(this.color),this.r=e,this.g=t,this.b=n}static fromObject(e,t){return new zc(e.r,e.g,e.b,t)}}const Hc=new ac(0,0,0),qc=new ac(1,1,1);function Bc(e,t,n,o,r,i,s,a){let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:10,c=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const d=e.closestIndexOf(t);function u(n){if(c){const o=e.closestIndexOf(t),r=e.get(o),i=n.relativeLuminance<t.relativeLuminance?Hc:qc,s=function(e,t){let n=0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!==o?n=vc(e,t,o):(o=new ac(0,0,0,1),n=vc(e,t,o),n<=0&&(o=new ac(1,1,1,1),n=vc(e,t,o))),n=Math.round(1e3*n)/1e3,new ac(o.r,o.g,o.b,n)}(cc(n.toColorString()),cc(r.toColorString()),i).roundToPrecision(2),a=function(e,t){if(t.a>=1)return t;if(t.a<=0)return new ac(e.r,e.g,e.b,1);const n=t.a*t.r+(1-t.a)*e.r,o=t.a*t.g+(1-t.a)*e.g,r=t.a*t.b+(1-t.a)*e.b;return new ac(n,o,r,1)}(cc(t.toColorString()),s);return Cc.from(a)}return n}void 0===a&&(a=Ec(t));const h=d+a*n,p=h+a*(o-n),f=h+a*(r-n),g=h+a*(i-n),v=-1===a?0:100-l,m=-1===a?l:100;function y(t,n){const o=e.get(t);if(n){const n=e.get(t+a*s),r=-1===a?n:o,i=-1===a?o:n,l="linear-gradient(".concat(u(r).toColorString()," ").concat(v,"%, ").concat(u(i).toColorString()," ").concat(m,"%)");return zc.fromObject(r,l)}return u(o)}return{rest:y(h,!0),hover:y(p,!0),active:y(f,!1),focus:y(g,!0)}}function Vc(e,t,n,o,r,i,s,a){null!==a&&void 0!==a||(a=Ec(t));const l=e.closestIndexOf(e.colorContrast(t,n));return{rest:e.get(l+a*o),hover:e.get(l+a*r),active:e.get(l+a*i),focus:e.get(l+a*s)}}function jc(e,t,n,o,r,i,s){const a=e.closestIndexOf(t);return null!==s&&void 0!==s||(s=Ec(t)),{rest:e.get(a+s*n),hover:e.get(a+s*o),active:e.get(a+s*r),focus:e.get(a+s*i)}}function Kc(e,t,n,o,r,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:void 0;return Ic(t)?jc(e,t,a,l,c,d,u):jc(e,t,n,o,r,i,s)}var Gc;function $c(e,t){return e.closestIndexOf((n=t,Cc.create(n,n,n)));var n}function Wc(e,t,n){return e.get($c(e,t)+-1*n)}!function(e){e[e.LightMode=.98]="LightMode",e[e.DarkMode=.15]="DarkMode"}(Gc||(Gc={}));const{create:Qc}=gl;function Yc(e){return gl.create({name:e,cssCustomPropertyName:null})}const Zc=Qc("direction").withDefault(dc.ltr),Jc=Qc("disabled-opacity").withDefault(.3),Xc=Qc("base-height-multiplier").withDefault(8),ed=(Qc("base-horizontal-spacing-multiplier").withDefault(3),Qc("density").withDefault(0)),td=Qc("design-unit").withDefault(4),nd=Qc("control-corner-radius").withDefault(4),od=Qc("layer-corner-radius").withDefault(8),rd=Qc("stroke-width").withDefault(1),id=Qc("focus-stroke-width").withDefault(2),sd=Qc("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),ad=Qc("font-weight").withDefault(400);function ld(e){return t=>{const n=e.getValueFor(t),o=ad.getValueFor(t);if(n.endsWith("px")){const e=Number.parseFloat(n.replace("px",""));if(e<=12)return'"wght" '.concat(o,', "opsz" 8');if(e>24)return'"wght" '.concat(o,', "opsz" 36')}return'"wght" '.concat(o,', "opsz" 10.5')}}const cd=Qc("type-ramp-base-font-size").withDefault("14px"),dd=Qc("type-ramp-base-line-height").withDefault("20px"),ud=Qc("type-ramp-base-font-variations").withDefault(ld(cd)),hd=Qc("type-ramp-minus-1-font-size").withDefault("12px"),pd=Qc("type-ramp-minus-1-line-height").withDefault("16px"),fd=Qc("type-ramp-minus-1-font-variations").withDefault(ld(hd)),gd=Qc("type-ramp-minus-2-font-size").withDefault("10px"),vd=Qc("type-ramp-minus-2-line-height").withDefault("14px"),md=Qc("type-ramp-minus-2-font-variations").withDefault(ld(gd)),yd=Qc("type-ramp-plus-1-font-size").withDefault("16px"),bd=Qc("type-ramp-plus-1-line-height").withDefault("22px"),wd=Qc("type-ramp-plus-1-font-variations").withDefault(ld(yd)),kd=Qc("type-ramp-plus-2-font-size").withDefault("20px"),xd=Qc("type-ramp-plus-2-line-height").withDefault("26px"),Cd=Qc("type-ramp-plus-2-font-variations").withDefault(ld(kd)),_d=Qc("type-ramp-plus-3-font-size").withDefault("24px"),Sd=Qc("type-ramp-plus-3-line-height").withDefault("32px"),Td=Qc("type-ramp-plus-3-font-variations").withDefault(ld(_d)),Id=Qc("type-ramp-plus-4-font-size").withDefault("28px"),Ed=Qc("type-ramp-plus-4-line-height").withDefault("36px"),Ad=Qc("type-ramp-plus-4-font-variations").withDefault(ld(Id)),Rd=Qc("type-ramp-plus-5-font-size").withDefault("32px"),Pd=Qc("type-ramp-plus-5-line-height").withDefault("40px"),Od=Qc("type-ramp-plus-5-font-variations").withDefault(ld(Rd)),Dd=Qc("type-ramp-plus-6-font-size").withDefault("40px"),Md=Qc("type-ramp-plus-6-line-height").withDefault("52px"),Nd=Qc("type-ramp-plus-6-font-variations").withDefault(ld(Dd)),Ld=Qc("base-layer-luminance").withDefault(Gc.LightMode),Fd=Yc("accent-fill-rest-delta").withDefault(0),Ud=Yc("accent-fill-hover-delta").withDefault(-2),zd=Yc("accent-fill-active-delta").withDefault(-5),Hd=Yc("accent-fill-focus-delta").withDefault(0),qd=Yc("accent-foreground-rest-delta").withDefault(0),Bd=Yc("accent-foreground-hover-delta").withDefault(3),Vd=Yc("accent-foreground-active-delta").withDefault(-8),jd=Yc("accent-foreground-focus-delta").withDefault(0),Kd=Yc("neutral-fill-rest-delta").withDefault(-1),Gd=Yc("neutral-fill-hover-delta").withDefault(1),$d=Yc("neutral-fill-active-delta").withDefault(0),Wd=Yc("neutral-fill-focus-delta").withDefault(0),Qd=Yc("neutral-fill-input-rest-delta").withDefault(-1),Yd=Yc("neutral-fill-input-hover-delta").withDefault(1),Zd=Yc("neutral-fill-input-active-delta").withDefault(0),Jd=Yc("neutral-fill-input-focus-delta").withDefault(-2),Xd=Yc("neutral-fill-input-alt-rest-delta").withDefault(2),eu=Yc("neutral-fill-input-alt-hover-delta").withDefault(4),tu=Yc("neutral-fill-input-alt-active-delta").withDefault(6),nu=Yc("neutral-fill-input-alt-focus-delta").withDefault(2),ou=Yc("neutral-fill-layer-rest-delta").withDefault(-2),ru=Yc("neutral-fill-layer-hover-delta").withDefault(-3),iu=Yc("neutral-fill-layer-active-delta").withDefault(-3),su=Yc("neutral-fill-layer-alt-rest-delta").withDefault(-1),au=Yc("neutral-fill-secondary-rest-delta").withDefault(3),lu=Yc("neutral-fill-secondary-hover-delta").withDefault(2),cu=Yc("neutral-fill-secondary-active-delta").withDefault(1),du=Yc("neutral-fill-secondary-focus-delta").withDefault(3),uu=Yc("neutral-fill-stealth-rest-delta").withDefault(0),hu=Yc("neutral-fill-stealth-hover-delta").withDefault(3),pu=Yc("neutral-fill-stealth-active-delta").withDefault(2),fu=Yc("neutral-fill-stealth-focus-delta").withDefault(0),gu=Yc("neutral-fill-strong-rest-delta").withDefault(0),vu=Yc("neutral-fill-strong-hover-delta").withDefault(8),mu=Yc("neutral-fill-strong-active-delta").withDefault(-5),yu=Yc("neutral-fill-strong-focus-delta").withDefault(0),bu=Yc("neutral-stroke-rest-delta").withDefault(8),wu=Yc("neutral-stroke-hover-delta").withDefault(12),ku=Yc("neutral-stroke-active-delta").withDefault(6),xu=Yc("neutral-stroke-focus-delta").withDefault(8),Cu=Yc("neutral-stroke-control-rest-delta").withDefault(3),_u=Yc("neutral-stroke-control-hover-delta").withDefault(5),Su=Yc("neutral-stroke-control-active-delta").withDefault(5),Tu=Yc("neutral-stroke-control-focus-delta").withDefault(5),Iu=Yc("neutral-stroke-divider-rest-delta").withDefault(4),Eu=Yc("neutral-stroke-layer-rest-delta").withDefault(3),Au=Yc("neutral-stroke-layer-hover-delta").withDefault(3),Ru=Yc("neutral-stroke-layer-active-delta").withDefault(3),Pu=Yc("neutral-stroke-strong-hover-delta").withDefault(0),Ou=Yc("neutral-stroke-strong-active-delta").withDefault(0),Du=Yc("neutral-stroke-strong-focus-delta").withDefault(0),Mu=Qc("neutral-base-color").withDefault(Mc),Nu=Yc("neutral-palette").withDefault((e=>Rc.from(Mu.getValueFor(e)))),Lu=Qc("accent-base-color").withDefault(Lc),Fu=Yc("accent-palette").withDefault((e=>Rc.from(Lu.getValueFor(e)))),Uu=Yc("neutral-layer-card-container-recipe").withDefault({evaluate:e=>Wc(Nu.getValueFor(e),Ld.getValueFor(e),ou.getValueFor(e))}),zu=(Qc("neutral-layer-card-container").withDefault((e=>Uu.getValueFor(e).evaluate(e))),Yc("neutral-layer-floating-recipe").withDefault({evaluate:e=>function(e,t,n){return e.get($c(e,t)+n)}(Nu.getValueFor(e),Ld.getValueFor(e),ou.getValueFor(e))})),Hu=Qc("neutral-layer-floating").withDefault((e=>zu.getValueFor(e).evaluate(e))),qu=Yc("neutral-layer-1-recipe").withDefault({evaluate:e=>function(e,t){return e.get($c(e,t))}(Nu.getValueFor(e),Ld.getValueFor(e))}),Bu=Qc("neutral-layer-1").withDefault((e=>qu.getValueFor(e).evaluate(e))),Vu=Yc("neutral-layer-2-recipe").withDefault({evaluate:e=>Wc(Nu.getValueFor(e),Ld.getValueFor(e),ou.getValueFor(e))}),ju=(Qc("neutral-layer-2").withDefault((e=>Vu.getValueFor(e).evaluate(e))),Yc("neutral-layer-3-recipe").withDefault({evaluate:e=>function(e,t,n){return e.get($c(e,t)+-1*n*2)}(Nu.getValueFor(e),Ld.getValueFor(e),ou.getValueFor(e))})),Ku=(Qc("neutral-layer-3").withDefault((e=>ju.getValueFor(e).evaluate(e))),Yc("neutral-layer-4-recipe").withDefault({evaluate:e=>function(e,t,n){return e.get($c(e,t)+-1*n*3)}(Nu.getValueFor(e),Ld.getValueFor(e),ou.getValueFor(e))})),Gu=(Qc("neutral-layer-4").withDefault((e=>Ku.getValueFor(e).evaluate(e))),Qc("fill-color").withDefault((e=>Bu.getValueFor(e))));var $u;!function(e){e[e.normal=4.5]="normal",e[e.large=3]="large"}($u||($u={}));const Wu=Yc("accent-fill-recipe").withDefault({evaluate:(e,t)=>function(e,t,n,o,r,i,s){let a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,d=arguments.length>10?arguments[10]:void 0,u=arguments.length>11?arguments[11]:void 0,h=arguments.length>12?arguments[12]:void 0,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:void 0;return Ic(t)?Vc(e,t,l,c,d,u,h,p):Vc(e,t,n,o,r,i,s,a)}(Fu.getValueFor(e),t||Gu.getValueFor(e),5,Fd.getValueFor(e),Ud.getValueFor(e),zd.getValueFor(e),Hd.getValueFor(e),void 0,8,Fd.getValueFor(e),Ud.getValueFor(e),zd.getValueFor(e),Hd.getValueFor(e),void 0)}),Qu=Qc("accent-fill-rest").withDefault((e=>Wu.getValueFor(e).evaluate(e).rest)),Yu=Qc("accent-fill-hover").withDefault((e=>Wu.getValueFor(e).evaluate(e).hover)),Zu=Qc("accent-fill-active").withDefault((e=>Wu.getValueFor(e).evaluate(e).active)),Ju=Qc("accent-fill-focus").withDefault((e=>Wu.getValueFor(e).evaluate(e).focus)),Xu=Yc("foreground-on-accent-recipe").withDefault({evaluate:e=>Fc(Qu.getValueFor(e),Yu.getValueFor(e),Zu.getValueFor(e),Ju.getValueFor(e),$u.normal)}),eh=Qc("foreground-on-accent-rest").withDefault((e=>Xu.getValueFor(e).evaluate(e).rest)),th=Qc("foreground-on-accent-hover").withDefault((e=>Xu.getValueFor(e).evaluate(e).hover)),nh=Qc("foreground-on-accent-active").withDefault((e=>Xu.getValueFor(e).evaluate(e).active)),oh=Qc("foreground-on-accent-focus").withDefault((e=>Xu.getValueFor(e).evaluate(e).focus)),rh=Yc("accent-foreground-recipe").withDefault({evaluate:(e,t)=>Vc(Fu.getValueFor(e),t||Gu.getValueFor(e),9.5,qd.getValueFor(e),Bd.getValueFor(e),Vd.getValueFor(e),jd.getValueFor(e))}),ih=Qc("accent-foreground-rest").withDefault((e=>rh.getValueFor(e).evaluate(e).rest)),sh=Qc("accent-foreground-hover").withDefault((e=>rh.getValueFor(e).evaluate(e).hover)),ah=Qc("accent-foreground-active").withDefault((e=>rh.getValueFor(e).evaluate(e).active)),lh=Qc("accent-foreground-focus").withDefault((e=>rh.getValueFor(e).evaluate(e).focus)),ch=Yc("accent-stroke-control-recipe").withDefault({evaluate:(e,t)=>Bc(Nu.getValueFor(e),t||Gu.getValueFor(e),-3,-3,-3,-3,10,1,void 0,!0)}),dh=Qc("accent-stroke-control-rest").withDefault((e=>ch.getValueFor(e).evaluate(e,Qu.getValueFor(e)).rest)),uh=Qc("accent-stroke-control-hover").withDefault((e=>ch.getValueFor(e).evaluate(e,Yu.getValueFor(e)).hover)),hh=Qc("accent-stroke-control-active").withDefault((e=>ch.getValueFor(e).evaluate(e,Zu.getValueFor(e)).active)),ph=Qc("accent-stroke-control-focus").withDefault((e=>ch.getValueFor(e).evaluate(e,Ju.getValueFor(e)).focus)),fh=Yc("neutral-fill-recipe").withDefault({evaluate:(e,t)=>Kc(Nu.getValueFor(e),t||Gu.getValueFor(e),Kd.getValueFor(e),Gd.getValueFor(e),$d.getValueFor(e),Wd.getValueFor(e),void 0,2,3,1,2,void 0)}),gh=Qc("neutral-fill-rest").withDefault((e=>fh.getValueFor(e).evaluate(e).rest)),vh=Qc("neutral-fill-hover").withDefault((e=>fh.getValueFor(e).evaluate(e).hover)),mh=Qc("neutral-fill-active").withDefault((e=>fh.getValueFor(e).evaluate(e).active)),yh=(Qc("neutral-fill-focus").withDefault((e=>fh.getValueFor(e).evaluate(e).focus)),Yc("neutral-fill-input-recipe").withDefault({evaluate:(e,t)=>Kc(Nu.getValueFor(e),t||Gu.getValueFor(e),Qd.getValueFor(e),Yd.getValueFor(e),Zd.getValueFor(e),Jd.getValueFor(e),void 0,2,3,1,0,void 0)})),bh=Qc("neutral-fill-input-rest").withDefault((e=>yh.getValueFor(e).evaluate(e).rest)),wh=Qc("neutral-fill-input-hover").withDefault((e=>yh.getValueFor(e).evaluate(e).hover)),kh=(Qc("neutral-fill-input-active").withDefault((e=>yh.getValueFor(e).evaluate(e).active)),Qc("neutral-fill-input-focus").withDefault((e=>yh.getValueFor(e).evaluate(e).focus))),xh=Yc("neutral-fill-input-alt-recipe").withDefault({evaluate:(e,t)=>Kc(Nu.getValueFor(e),t||Gu.getValueFor(e),Xd.getValueFor(e),eu.getValueFor(e),tu.getValueFor(e),nu.getValueFor(e),1,Xd.getValueFor(e),Xd.getValueFor(e)-eu.getValueFor(e),Xd.getValueFor(e)-tu.getValueFor(e),nu.getValueFor(e),1)}),Ch=Qc("neutral-fill-input-alt-rest").withDefault((e=>xh.getValueFor(e).evaluate(e).rest)),_h=Qc("neutral-fill-input-alt-hover").withDefault((e=>xh.getValueFor(e).evaluate(e).hover)),Sh=Qc("neutral-fill-input-alt-active").withDefault((e=>xh.getValueFor(e).evaluate(e).active)),Th=Qc("neutral-fill-input-alt-focus").withDefault((e=>xh.getValueFor(e).evaluate(e).focus)),Ih=Yc("neutral-fill-layer-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),ou.getValueFor(e),ru.getValueFor(e),iu.getValueFor(e),ou.getValueFor(e),1)}),Eh=(Qc("neutral-fill-layer-rest").withDefault((e=>Ih.getValueFor(e).evaluate(e).rest)),Qc("neutral-fill-layer-hover").withDefault((e=>Ih.getValueFor(e).evaluate(e).hover)),Qc("neutral-fill-layer-active").withDefault((e=>Ih.getValueFor(e).evaluate(e).active)),Yc("neutral-fill-layer-alt-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),su.getValueFor(e),su.getValueFor(e),su.getValueFor(e),su.getValueFor(e))})),Ah=(Qc("neutral-fill-layer-alt-rest").withDefault((e=>Eh.getValueFor(e).evaluate(e).rest)),Yc("neutral-fill-secondary-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),au.getValueFor(e),lu.getValueFor(e),cu.getValueFor(e),du.getValueFor(e))})),Rh=Qc("neutral-fill-secondary-rest").withDefault((e=>Ah.getValueFor(e).evaluate(e).rest)),Ph=Qc("neutral-fill-secondary-hover").withDefault((e=>Ah.getValueFor(e).evaluate(e).hover)),Oh=Qc("neutral-fill-secondary-active").withDefault((e=>Ah.getValueFor(e).evaluate(e).active)),Dh=Qc("neutral-fill-secondary-focus").withDefault((e=>Ah.getValueFor(e).evaluate(e).focus)),Mh=Yc("neutral-fill-stealth-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),uu.getValueFor(e),hu.getValueFor(e),pu.getValueFor(e),fu.getValueFor(e))}),Nh=Qc("neutral-fill-stealth-rest").withDefault((e=>Mh.getValueFor(e).evaluate(e).rest)),Lh=Qc("neutral-fill-stealth-hover").withDefault((e=>Mh.getValueFor(e).evaluate(e).hover)),Fh=Qc("neutral-fill-stealth-active").withDefault((e=>Mh.getValueFor(e).evaluate(e).active)),Uh=Qc("neutral-fill-stealth-focus").withDefault((e=>Mh.getValueFor(e).evaluate(e).focus)),zh=Yc("neutral-fill-strong-recipe").withDefault({evaluate:(e,t)=>Vc(Nu.getValueFor(e),t||Gu.getValueFor(e),4.5,gu.getValueFor(e),vu.getValueFor(e),mu.getValueFor(e),yu.getValueFor(e))}),Hh=(Qc("neutral-fill-strong-rest").withDefault((e=>zh.getValueFor(e).evaluate(e).rest)),Qc("neutral-fill-strong-hover").withDefault((e=>zh.getValueFor(e).evaluate(e).hover)),Qc("neutral-fill-strong-active").withDefault((e=>zh.getValueFor(e).evaluate(e).active)),Qc("neutral-fill-strong-focus").withDefault((e=>zh.getValueFor(e).evaluate(e).focus)),Yc("neutral-foreground-recipe").withDefault({evaluate:(e,t)=>Vc(Nu.getValueFor(e),t||Gu.getValueFor(e),16,0,-19,-30,0)})),qh=Qc("neutral-foreground-rest").withDefault((e=>Hh.getValueFor(e).evaluate(e).rest)),Bh=Qc("neutral-foreground-hover").withDefault((e=>Hh.getValueFor(e).evaluate(e).hover)),Vh=Qc("neutral-foreground-active").withDefault((e=>Hh.getValueFor(e).evaluate(e).active)),jh=(Qc("neutral-foreground-focus").withDefault((e=>Hh.getValueFor(e).evaluate(e).focus)),Yc("neutral-foreground-hint-recipe").withDefault({evaluate:(e,t)=>function(e,t,n){return e.colorContrast(t,n)}(Nu.getValueFor(e),t||Gu.getValueFor(e),4.5)})),Kh=Qc("neutral-foreground-hint").withDefault((e=>jh.getValueFor(e).evaluate(e))),Gh=Yc("neutral-stroke-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),bu.getValueFor(e),wu.getValueFor(e),ku.getValueFor(e),xu.getValueFor(e))}),$h=Qc("neutral-stroke-rest").withDefault((e=>Gh.getValueFor(e).evaluate(e).rest)),Wh=Qc("neutral-stroke-hover").withDefault((e=>Gh.getValueFor(e).evaluate(e).hover)),Qh=Qc("neutral-stroke-active").withDefault((e=>Gh.getValueFor(e).evaluate(e).active)),Yh=(Qc("neutral-stroke-focus").withDefault((e=>Gh.getValueFor(e).evaluate(e).focus)),Yc("neutral-stroke-control-recipe").withDefault({evaluate:(e,t)=>Bc(Nu.getValueFor(e),t||Gu.getValueFor(e),Cu.getValueFor(e),_u.getValueFor(e),Su.getValueFor(e),Tu.getValueFor(e),5)})),Zh=Qc("neutral-stroke-control-rest").withDefault((e=>Yh.getValueFor(e).evaluate(e).rest)),Jh=Qc("neutral-stroke-control-hover").withDefault((e=>Yh.getValueFor(e).evaluate(e).hover)),Xh=Qc("neutral-stroke-control-active").withDefault((e=>Yh.getValueFor(e).evaluate(e).active)),ep=(Qc("neutral-stroke-control-focus").withDefault((e=>Yh.getValueFor(e).evaluate(e).focus)),Yc("neutral-stroke-divider-recipe").withDefault({evaluate:(e,t)=>function(e,t,n){return e.get(e.closestIndexOf(t)+Ec(t)*n)}(Nu.getValueFor(e),t||Gu.getValueFor(e),Iu.getValueFor(e))})),tp=Qc("neutral-stroke-divider-rest").withDefault((e=>ep.getValueFor(e).evaluate(e))),np=Yc("neutral-stroke-input-recipe").withDefault({evaluate:(e,t)=>function(e,t,n,o,r,i,s,a){const l=e.closestIndexOf(t),c=Ec(t),d=l+c*n,u=d+c*(o-n),h=d+c*(r-n),p=d+c*(i-n),f="calc(100% - ".concat(a,")");function g(t,n){const o=e.get(t);if(n){const n=e.get(t+c*s),r="linear-gradient(".concat(o.toColorString()," ").concat(f,", ").concat(n.toColorString()," ").concat(f,", ").concat(n.toColorString(),")");return zc.fromObject(o,r)}return o}return{rest:g(d,!0),hover:g(u,!0),active:g(h,!1),focus:g(p,!0)}}(Nu.getValueFor(e),t||Gu.getValueFor(e),Cu.getValueFor(e),_u.getValueFor(e),Su.getValueFor(e),Tu.getValueFor(e),20,rd.getValueFor(e)+"px")}),op=Qc("neutral-stroke-input-rest").withDefault((e=>np.getValueFor(e).evaluate(e).rest)),rp=Qc("neutral-stroke-input-hover").withDefault((e=>np.getValueFor(e).evaluate(e).hover)),ip=(Qc("neutral-stroke-input-active").withDefault((e=>np.getValueFor(e).evaluate(e).active)),Qc("neutral-stroke-input-focus").withDefault((e=>np.getValueFor(e).evaluate(e).focus)),Yc("neutral-stroke-layer-recipe").withDefault({evaluate:(e,t)=>jc(Nu.getValueFor(e),t||Gu.getValueFor(e),Eu.getValueFor(e),Au.getValueFor(e),Ru.getValueFor(e),Eu.getValueFor(e))})),sp=Qc("neutral-stroke-layer-rest").withDefault((e=>ip.getValueFor(e).evaluate(e).rest)),ap=(Qc("neutral-stroke-layer-hover").withDefault((e=>ip.getValueFor(e).evaluate(e).hover)),Qc("neutral-stroke-layer-active").withDefault((e=>ip.getValueFor(e).evaluate(e).active)),Yc("neutral-stroke-strong-recipe").withDefault({evaluate:(e,t)=>Vc(Nu.getValueFor(e),t||Gu.getValueFor(e),5.5,0,Pu.getValueFor(e),Ou.getValueFor(e),Du.getValueFor(e))})),lp=Qc("neutral-stroke-strong-rest").withDefault((e=>ap.getValueFor(e).evaluate(e).rest)),cp=Qc("neutral-stroke-strong-hover").withDefault((e=>ap.getValueFor(e).evaluate(e).hover)),dp=Qc("neutral-stroke-strong-active").withDefault((e=>ap.getValueFor(e).evaluate(e).active)),up=(Qc("neutral-stroke-strong-focus").withDefault((e=>ap.getValueFor(e).evaluate(e).focus)),Yc("focus-stroke-outer-recipe").withDefault({evaluate:e=>(Nu.getValueFor(e),Ic(Gu.getValueFor(e))?Oc:Dc)})),hp=Qc("focus-stroke-outer").withDefault((e=>up.getValueFor(e).evaluate(e))),pp=Yc("focus-stroke-inner-recipe").withDefault({evaluate:e=>{return Fu.getValueFor(e),t=Gu.getValueFor(e),hp.getValueFor(e),Ic(t)?Dc:Oc;var t}}),fp=Qc("focus-stroke-inner").withDefault((e=>pp.getValueFor(e).evaluate(e))),gp=Yc("foreground-on-accent-large-recipe").withDefault({evaluate:e=>Fc(Qu.getValueFor(e),Yu.getValueFor(e),Zu.getValueFor(e),Ju.getValueFor(e),$u.large)}),vp=(Qc("foreground-on-accent-rest-large").withDefault((e=>gp.getValueFor(e).evaluate(e).rest)),Qc("foreground-on-accent-hover-large").withDefault((e=>gp.getValueFor(e).evaluate(e,Yu.getValueFor(e)).hover)),Qc("foreground-on-accent-active-large").withDefault((e=>gp.getValueFor(e).evaluate(e,Zu.getValueFor(e)).active)),Qc("foreground-on-accent-focus-large").withDefault((e=>gp.getValueFor(e).evaluate(e,Ju.getValueFor(e)).focus)),Qc("neutral-fill-inverse-rest-delta").withDefault(0)),mp=Qc("neutral-fill-inverse-hover-delta").withDefault(-3),yp=Qc("neutral-fill-inverse-active-delta").withDefault(7),bp=Qc("neutral-fill-inverse-focus-delta").withDefault(0);const wp=Yc("neutral-fill-inverse-recipe").withDefault({evaluate:(e,t)=>function(e,t,n,o,r,i){const s=Ec(t),a=e.closestIndexOf(e.colorContrast(t,14)),l=a+s*Math.abs(n-o);let c,d;return(1===s?n<o:s*n>s*o)?(c=a,d=l):(c=l,d=a),{rest:e.get(c),hover:e.get(d),active:e.get(c+s*r),focus:e.get(c+s*i)}}(Nu.getValueFor(e),t||Gu.getValueFor(e),vp.getValueFor(e),mp.getValueFor(e),yp.getValueFor(e),bp.getValueFor(e))});Qc("neutral-fill-inverse-rest").withDefault((e=>wp.getValueFor(e).evaluate(e).rest)),Qc("neutral-fill-inverse-hover").withDefault((e=>wp.getValueFor(e).evaluate(e).hover)),Qc("neutral-fill-inverse-active").withDefault((e=>wp.getValueFor(e).evaluate(e).active)),Qc("neutral-fill-inverse-focus").withDefault((e=>wp.getValueFor(e).evaluate(e).focus));function kp(e,t){const n=[];let o="";const r=[];for(let i=0,s=e.length-1;i<s;++i){o+=e[i];let s=t[i];if(s instanceof Za){const e=s.createBehavior();s=s.createCSS(),e&&r.push(e)}s instanceof Us||s instanceof CSSStyleSheet?(""!==o.trim()&&(n.push(o),o=""),n.push(s)):o+=s}return o+=e[e.length-1],""!==o.trim()&&n.push(o),{styles:n,behaviors:r}}function xp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const{styles:r,behaviors:i}=kp(e,n),s=Us.create(r);return i.length&&s.withBehaviors(...i),s}class Cp extends Za{constructor(e,t){super(),this.behaviors=t,this.css="";const n=e.reduce(((e,t)=>("string"===typeof t?this.css+=t:e.push(t),e)),[]);n.length&&(this.styles=Us.create(n))}createBehavior(){return this}createCSS(){return this.css}bind(e){this.styles&&e.$fastController.addStyles(this.styles),this.behaviors.length&&e.$fastController.addBehaviors(this.behaviors)}unbind(e){this.styles&&e.$fastController.removeStyles(this.styles),this.behaviors.length&&e.$fastController.removeBehaviors(this.behaviors)}}function _p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const{styles:r,behaviors:i}=kp(e,n);return new Cp(r,i)}function Sp(e){return"".concat(":host([hidden]){display:none}",":host{display:").concat(e,"}")}class Tp{constructor(e){this.listenerCache=new WeakMap,this.query=e}bind(e){const{query:t}=this,n=this.constructListener(e);n.bind(t)(),t.addListener(n),this.listenerCache.set(e,n)}unbind(e){const t=this.listenerCache.get(e);t&&(this.query.removeListener(t),this.listenerCache.delete(e))}}class Ip extends Tp{constructor(e,t){super(e),this.styles=t}static with(e){return t=>new Ip(e,t)}constructListener(e){let t=!1;const n=this.styles;return function(){const{matches:o}=this;o&&!t?(e.$fastController.addStyles(n),t=o):!o&&t&&(e.$fastController.removeStyles(n),t=o)}}unbind(e){super.unbind(e),e.$fastController.removeStyles(this.styles)}}const Ep=Ip.with(window.matchMedia("(forced-colors)"));Ip.with(window.matchMedia("(prefers-color-scheme: dark)")),Ip.with(window.matchMedia("(prefers-color-scheme: light)"));var Ap;!function(e){e.Canvas="Canvas",e.CanvasText="CanvasText",e.LinkText="LinkText",e.VisitedText="VisitedText",e.ActiveText="ActiveText",e.ButtonFace="ButtonFace",e.ButtonText="ButtonText",e.Field="Field",e.FieldText="FieldText",e.Highlight="Highlight",e.HighlightText="HighlightText",e.GrayText="GrayText"}(Ap||(Ap={}));"box-shadow: ".concat("0 0 2px rgba(0, 0, 0, 0.14)",", ").concat("0 calc(var(--elevation) * 0.5px) calc((var(--elevation) * 1px)) rgba(0, 0, 0, 0.2)",";");const Rp=gl.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(e,t,n)=>{let o=.12,r=.14;t>16&&(o=.2,r=.24);const i="0 0 2px rgba(0, 0, 0, ".concat(o,")"),s="0 calc(".concat(t," * 0.5px) calc((").concat(t," * 1px)) rgba(0, 0, 0, ").concat(r,")");return"".concat(i,", ").concat(s)}}),Pp=gl.create("elevation-shadow-card-rest-size").withDefault(4),Op=gl.create("elevation-shadow-card-hover-size").withDefault(8),Dp=gl.create("elevation-shadow-card-active-size").withDefault(0),Mp=gl.create("elevation-shadow-card-focus-size").withDefault(8),Np=gl.create("elevation-shadow-card-rest").withDefault((e=>Rp.getValueFor(e).evaluate(e,Pp.getValueFor(e)))),Lp=(gl.create("elevation-shadow-card-hover").withDefault((e=>Rp.getValueFor(e).evaluate(e,Op.getValueFor(e)))),gl.create("elevation-shadow-card-active").withDefault((e=>Rp.getValueFor(e).evaluate(e,Dp.getValueFor(e)))),gl.create("elevation-shadow-card-focus").withDefault((e=>Rp.getValueFor(e).evaluate(e,Mp.getValueFor(e)))),gl.create("elevation-shadow-tooltip-size").withDefault(16)),Fp=gl.create("elevation-shadow-tooltip").withDefault((e=>Rp.getValueFor(e).evaluate(e,Lp.getValueFor(e)))),Up=gl.create("elevation-shadow-flyout-size").withDefault(32),zp=gl.create("elevation-shadow-flyout").withDefault((e=>Rp.getValueFor(e).evaluate(e,Up.getValueFor(e)))),Hp=gl.create("elevation-shadow-dialog-size").withDefault(128),qp=gl.create("elevation-shadow-dialog").withDefault((e=>Rp.getValueFor(e).evaluate(e,Hp.getValueFor(e))));var Bp,Vp;class jp extends Il{cardFillColorChanged(e,t){if(t){const e=cc(t);null!==e&&(this.neutralPaletteSource=t,Gu.setValueFor(this,Cc.create(e.r,e.g,e.b)))}}neutralPaletteSourceChanged(e,t){if(t){const e=cc(t),n=Cc.create(e.r,e.g,e.b);Nu.setValueFor(this,Rc.create(n))}}handleChange(e,t){this.cardFillColor||Gu.setValueFor(this,(t=>Ih.getValueFor(t).evaluate(t,Gu.getValueFor(e)).rest))}connectedCallback(){super.connectedCallback();const e=Ja(this);if(e){const t=Ds.getNotifier(e);t.subscribe(this,"fillColor"),t.subscribe(this,"neutralPalette"),this.handleChange(e,"fillColor")}}}i([Ys({attribute:"card-fill-color",mode:"fromView"})],jp.prototype,"cardFillColor",void 0),i([Ys({attribute:"neutral-palette-source",mode:"fromView"})],jp.prototype,"neutralPaletteSource",void 0);const Kp=jp.compose({baseName:"card",baseClass:Il,template:(e,t)=>ec(tc||(tc=Ht(["\n    <slot></slot>\n"]))),styles:(e,t)=>xp(Bp||(Bp=Ht(["\n    "," :host {\n      display: block;\n      contain: content;\n      height: var(--card-height, 100%);\n      width: var(--card-width, 100%);\n      box-sizing: border-box;\n      background: ",";\n      color: ",";\n      border: calc("," * 1px) solid ",";\n      border-radius: calc("," * 1px);\n      box-shadow: ",";\n    }\n\n    :host {\n      content-visibility: auto;\n    }\n  "])),Sp("block"),Gu,qh,rd,sp,od,Np).withBehaviors(Ep(xp(Vp||(Vp=Ht(["\n        :host {\n          background: ",";\n          color: ",";\n        }\n      "])),Ap.Canvas,Ap.CanvasText)))});var Gp,$p,Wp,Qp,Yp,Zp,Jp,Xp,ef,tf,nf,of,rf,sf,af=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},lf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},cf=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Kp);let df=class extends Qt{constructor(){super(...arguments),this._days=3,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return Yi}get date(){return this._date}set date(e){this._date!==e&&(this._date=e,this.reloadState())}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.reloadState())}get days(){return this._days}set days(e){this._days!==e&&(this._days=e,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(e){this._eventQuery!==e&&(this._eventQuery=e,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(e){this._preferredTimezone!==e&&(this._preferredTimezone=e,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...ys.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;const n={agenda:!0,grouped:this.groupByDay};return ot(Gp||(Gp=Ht(["\n      <div dir=",' class="','">\n        ',"\n        ","\n      </div>\n    "])),this.direction,Bn(n),this.groupByDay?this.renderGroups(e):this.renderEvents(e),this.isLoadingState?this.renderLoading():ot($p||($p=Ht([""]))))}reload(){return cf(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||ot(Wp||(Wp=Ht(['\n        <fluent-card class="event event-loading">\n          <div class="event-time-container">\n            <div class="event-time-loading loading-element"></div>\n          </div>\n          <div class="event-details-container">\n            <div class="event-subject-loading loading-element"></div>\n            <div class="event-location-container">\n              <div class="event-location-icon-loading loading-element"></div>\n              <div class="event-location-loading loading-element"></div>\n            </div>\n            <div class="event-location-container">\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n              <div class="event-attendee-loading loading-element"></div>\n            </div>\n          </div>\n        </fluent-card>'])))}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||ot(Qp||(Qp=Ht([""])))}renderEvent(e){this._isNarrow=this.offsetWidth<600;const t={narrow:this._isNarrow};return ot(Yp||(Yp=Ht(['\n      <fluent-card class="','">\n        <div class="','">\n          <div class="event-time" aria-label="','">','</div>\n        </div>\n        <div class="','">\n          '," "," ",'\n        </div>\n        <div class="event-other-container">',"</div>\n      </fluent-card>\n    "])),Bn(Object.assign({event:!0},t)),Bn(Object.assign({"event-time-container":!0},t)),this.getEventTimeString(e),this.getEventTimeString(e),Bn(Object.assign({"event-details-container":!0},t)),this.renderTitle(e),this.renderLocation(e),this.renderAttendees(e),this.renderOther(e))}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||ot(Zp||(Zp=Ht(['\n        <div class="header" aria-label="','">',"</div>\n      "])),e,e)}renderTitle(e){return ot(Jp||(Jp=Ht(["\n      <div\n        aria-label=",'\n        class="','"\n      >\n        ',"\n      </div>"])),e.subject,Bn({"event-subject":!0,narrow:this._isNarrow}),e.subject)}renderLocation(e){return e.location.displayName?ot(Xp||(Xp=Ht(['\n      <div class="event-location-container">\n        <div class="event-location-icon">','</div>\n        <div class="event-location" aria-label="','">',"</div>\n      </div>\n    "])),ei(Xr.OfficeLocation),e.location.displayName,e.location.displayName):null}renderAttendees(e){return e.attendees.length?Sn(ef||(ef=Ht(['\n      <mgt-people\n        show-max="5"\n        show-presence\n        class="event-attendees"\n        .peopleQueries=',"\n      ></mgt-people>\n    "])),e.attendees.map((e=>e.emailAddress.address))):null}renderOther(e){return this.hasTemplate("event-other")?ot(tf||(tf=Ht(["\n          ","\n        "])),this.renderTemplate("event-other",{event:e},e.id+"-other")):null}renderGroups(e){const t={};return e.forEach((e=>{var n;let o=null===(n=null===e||void 0===e?void 0:e.start)||void 0===n?void 0:n.dateTime;"UTC"===e.end.timeZone&&(o+="Z");const r=this.getDateHeaderFromDateTimeString(o);t[r]=t[r]||[],t[r].push(e)})),ot(nf||(nf=Ht(["\n      ","\n    "])),Object.keys(t).map((e=>ot(of||(of=Ht(['\n            <div class="group">'," ","</div>\n          "])),this.renderHeader(e),this.renderEvents(t[e])))))}renderEvents(e){return ot(rf||(rf=Ht(["\n        ",""])),e.map((e=>ot(sf||(sf=Ht(['\n              <div\n                class="event-container"\n                tabindex="0"\n                @focus=',">\n                ","\n              </div>"])),(()=>this.eventClicked(e)),this.renderTemplate("event",{event:e},e.id)||this.renderEvent(e)))))}loadState(){return cf(this,void 0,void 0,(function*(){if(this.events)return;const e=yield this.loadEvents();(null===e||void 0===e?void 0:e.length)>0&&(this.events=e)}))}reloadState(){return cf(this,void 0,void 0,(function*(){this.events=null,yield this.requestStateUpdate(!0)}))}eventClicked(e){this.fireCustomEvent("eventClick",e)}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;"UTC"===e.start.timeZone&&(t+="Z");let n=e.end.dateTime;"UTC"===e.end.timeZone&&(n+="Z");const o=this.prettyPrintTimeFromDateTime(new Date(t)),r=this.prettyPrintTimeFromDateTime(new Date(n));return"".concat(o," - ").concat(r)}loadEvents(){return cf(this,void 0,void 0,(function*(){const e=re.globalProvider;let t=[];if((null===e||void 0===e?void 0:e.state)===te.SignedIn){const o=e.graph.forComponent(this);if(this.eventQuery)try{const e=this.eventQuery.split("|");let n,r;e.length>1?(r=e[0].trim(),n=e[1].trim()):r=this.eventQuery;const i=yield Ji(o,r,n);if(null===i||void 0===i?void 0:i.value)for(t=i.value;i.hasNext;)yield i.next(),t=i.value}catch(sL){}else{const e=this.date?new Date(this.date):new Date,r=new Date(e.getTime());r.setDate(e.getDate()+this.days);try{const n=yield((e,t,n,o)=>Zi(void 0,void 0,void 0,(function*(){const r="startdatetime=".concat(t.toISOString()),i="enddatetime=".concat(n.toISOString());let s;return s=o?"groups/".concat(o,"/calendar"):"me",s+="/calendarview?".concat(r,"&").concat(i),Ji(e,s)})))(o,e,r,this.groupId);if(null===n||void 0===n?void 0:n.value)for(t=n.value;n.hasNext;)yield n.next(),t=n.value}catch(n){}}}return t}))}prettyPrintTimeFromDateTime(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}};var uf;af([Et({attribute:"date",type:String}),lf("design:type",String),lf("design:paramtypes",[Object])],df.prototype,"date",null),af([Et({attribute:"group-id",type:String}),lf("design:type",String),lf("design:paramtypes",[Object])],df.prototype,"groupId",null),af([Et({attribute:"days",type:Number}),lf("design:type",Number),lf("design:paramtypes",[Object])],df.prototype,"days",null),af([Et({attribute:"event-query",type:String}),lf("design:type",String),lf("design:paramtypes",[Object])],df.prototype,"eventQuery",null),af([Et({attribute:"events",type:Array}),lf("design:type",Array)],df.prototype,"events",void 0),af([Et({attribute:"show-max",type:Number}),lf("design:type",Number)],df.prototype,"showMax",void 0),af([Et({attribute:"group-by-day",type:Boolean}),lf("design:type",Boolean)],df.prototype,"groupByDay",void 0),af([Et({attribute:"preferred-timezone",type:String}),lf("design:type",String),lf("design:paramtypes",[Object])],df.prototype,"preferredTimezone",null),af([Et({attribute:!1}),lf("design:type",Boolean)],df.prototype,"_isNarrow",void 0),df=af([Tn("agenda")],df);const hf=[Ce(uf||(uf=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}\n'])))];var pf=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const ff=()=>pf(void 0,void 0,void 0,(function*(){const e=bn.getCache(lo,lo.stores.fileLists);yield e.clearStore()})),gf=()=>bn.config.files.invalidationPeriod||bn.config.defaultInvalidationPeriod,vf=()=>bn.config.files.isEnabled&&bn.config.isEnabled,mf=()=>bn.config.fileLists.isEnabled&&bn.config.isEnabled,yf=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ao.stores.fileQueries,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"files.read";return pf(void 0,void 0,void 0,(function*(){const r=bn.getCache(ao,n),i=yield Cf(r,t);if(i)return i;let s;try{s=yield e.api(t).middlewareOptions(ie(o)).get(),vf()&&(yield r.putValue(t,{file:JSON.stringify(s)}))}catch(a){}return s||null}))},bf=(e,t,n,o,r)=>pf(void 0,void 0,void 0,(function*(){let i;const s=bn.getCache(lo,n),a=yield _f(s,n,"".concat(t,":").concat(r));if(a)return i=xf(e,a.files,a.nextLink),i;let l;try{if(l=e.api(t).middlewareOptions(ie(...o)),r&&l.top(r),i=yield kf(e,l),mf()){const e=i.nextLink;yield s.putValue(t,{files:i.value.map((e=>JSON.stringify(e))),nextLink:e})}}catch(c){}return i||null})),wf=(e,t,n)=>pf(void 0,void 0,void 0,(function*(){if(!t)return[];const o=t.value,r=e.createBatch(),i=[];for(const e of o){const t=e.resourceReference.id;""!==t&&r.get(t,t,n)}try{const e=yield r.executeAll();for(const t of o){const n=e.get(t.resourceReference.id);(null===n||void 0===n?void 0:n.content)&&i.push(n.content)}return i}catch(Ye){try{return Promise.all(o.filter((e=>Boolean(e.resourceReference.id))).map((t=>pf(void 0,void 0,void 0,(function*(){return yield e.api(t.resourceReference.id).middlewareOptions(ie(...n)).get()})))))}catch(sL){return[]}}})),kf=(e,t)=>pf(void 0,void 0,void 0,(function*(){return xn.create(e,t)})),xf=(e,t,n)=>xn.createFromValue(e,t.map((e=>JSON.parse(e))),n),Cf=(e,t)=>pf(void 0,void 0,void 0,(function*(){if(vf()){const n=yield e.getValue(t);if(n&&gf()>Date.now()-n.timeCached)return JSON.parse(n.file)}return null})),_f=(e,t,n)=>pf(void 0,void 0,void 0,(function*(){if(e||(e=bn.getCache(lo,t)),mf()){const t=yield e.getValue(n);if(t&&(bn.config.fileLists.invalidationPeriod||bn.config.defaultInvalidationPeriod)>Date.now()-t.timeCached)return t}return null})),Sf=e=>pf(void 0,void 0,void 0,(function*(){const t=e.nextLink;if(e.hasNext&&(yield e.next()),mf()){const n=bn.getCache(lo,lo.stores.fileLists),o=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(t)[3];yield n.putValue(o,{files:e.value.map((e=>JSON.stringify(e))),nextLink:t})}})),Tf=(e,t,n,o,r)=>pf(void 0,void 0,void 0,(function*(){try{const s="files.readwrite",a={"Content-Length":n,"Content-Range":o};let l;try{l=yield e.client.api(t).middlewareOptions(ie(s)).headers(a).put(r)}catch(i){}return l||null}catch(sL){return null}})),If={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},Ef="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",Af={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var Rf,Pf,Of,Df,Mf,Nf,Lf,Ff,Uf,zf,Hf,qf,Bf=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Vf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},jf=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};let Kf=class extends Qt{static get styles(){return hf}get strings(){return Af}get fileQuery(){return this._fileQuery}set fileQuery(e){e!==this._fileQuery&&(this._fileQuery=e,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate())}get listId(){return this._listId}set listId(e){e!==this._listId&&(this._listId=e,this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(e){e!==this._insightId&&(this._insightId=e,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(e){e!==this._fileDetails&&(this._fileDetails=e,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(e){e!==this._fileIcon&&(this._fileIcon=e,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=Vo.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const e=this.driveItem;let t;if(t=this.renderTemplate("default",{file:e}),!t){const n=this.renderDetails(e),o=this.renderFileTypeIcon();t=ot(Rf||(Rf=Ht(['\n        <div class="item">\n          '," ","\n        </div>"])),o,n)}return t}renderLoading(){return this.renderTemplate("loading",null)||ot(Pf||(Pf=Ht([""])))}renderNoData(){return this.renderTemplate("no-data",null)||ot(Of||(Of=Ht([""])))}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return ot(Df||(Df=Ht([""])));let e;if(this.fileIcon)e=this.fileIcon;else{const r=/(?:\.([^.]+))?$/,i=void 0===this.driveItem.package&&void 0===this.driveItem.folder?r.exec(this.driveItem.name)[1]?r.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder";t=i,n=48,o="svg",e=Object.keys(If).find((e=>If[e]===t))?"".concat(Ef,"/").concat(n.toString(),"/").concat(t,".").concat(o):"jpg"===t||"png"===t?(t="photo","".concat(Ef,"/").concat(n.toString(),"/").concat(t,".").concat(o)):null}var t,n,o;return ot(Mf||(Mf=Ht(['\n      <div class="item__file-type-icon">\n        ',"\n      </div>\n    "])),e?ot(Nf||(Nf=Ht(["\n              <img src=",' alt="File icon" />\n            '])),e):ot(Lf||(Lf=Ht(["\n              ","\n            "])),ei(Xr.File)))}renderDetails(e){if(!e||this.view===Vo.image)return ot(Ff||(Ff=Ht([""])));const t=[];if(this.view>Vo.image){const n=this.getTextFromProperty(e,this.line1Property);n&&t.push(ot(Uf||(Uf=Ht(['\n          <div class="line1" aria-label="','">',"</div>\n        "])),n,n))}if(this.view>Vo.oneline){const n=this.getTextFromProperty(e,this.line2Property);n&&t.push(ot(zf||(zf=Ht(['\n          <div class="line2" aria-label="','">',"</div>\n        "])),n,n))}if(this.view>Vo.twolines){const n=this.getTextFromProperty(e,this.line3Property);n&&t.push(ot(Hf||(Hf=Ht(['\n          <div class="line3" aria-label="','">',"</div>\n        "])),n,n))}return ot(qf||(qf=Ht(['\n      <div class="item__details">\n        ',"\n      </div>\n    "])),t)}loadState(){return jf(this,void 0,void 0,(function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const e=re.globalProvider;if(!e||e.state===te.Loading)return;if(e.state===te.SignedOut)return void(this.driveItem=null);const t=e.graph.forComponent(this);let n;const o=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId;this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?n=null:this.fileQuery?n=yield yf(t,this.fileQuery):this.itemId&&o?n=yield((e,t)=>pf(void 0,void 0,void 0,(function*(){const n="/me/drive/items/".concat(t);return yf(e,n,ao.stores.userFiles)})))(t,this.itemId):this.itemPath&&o?n=yield((e,t)=>pf(void 0,void 0,void 0,(function*(){const n="/me/drive/root:/".concat(t);return yf(e,n,ao.stores.userFiles)})))(t,this.itemPath):this.userId?this.itemId?n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/users/".concat(t,"/drive/items/").concat(n);return yf(e,o,ao.stores.userFiles)})))(t,this.userId,this.itemId):this.itemPath?n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/users/".concat(t,"/drive/root:/").concat(n);return yf(e,o,ao.stores.userFiles)})))(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(n=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/users/".concat(t,"/insights/").concat(n,"/").concat(o,"/resource");return yf(e,r,ao.stores.insightFiles,"sites.read.all")})))(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/drives/".concat(t,"/items/").concat(n);return yf(e,o,ao.stores.driveFiles)})))(t,this.driveId,this.itemId):this.itemPath&&(n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/drives/".concat(t,"/root:/").concat(n);return yf(e,o,ao.stores.driveFiles)})))(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/sites/".concat(t,"/drive/items/").concat(n);return yf(e,o,ao.stores.siteFiles)})))(t,this.siteId,this.itemId):this.itemPath&&(n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/sites/".concat(t,"/drive/root:/").concat(n);return yf(e,o,ao.stores.siteFiles)})))(t,this.siteId,this.itemPath)):this.listId?n=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/sites/".concat(t,"/lists/").concat(n,"/items/").concat(o,"/driveItem");return yf(e,r,ao.stores.siteFiles)})))(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/groups/".concat(t,"/drive/items/").concat(n);return yf(e,o,ao.stores.groupFiles)})))(t,this.groupId,this.itemId):this.itemPath&&(n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/groups/".concat(t,"/drive/root:/").concat(n);return yf(e,o,ao.stores.groupFiles)})))(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/me/insights/".concat(t,"/").concat(n,"/resource");return yf(e,o,ao.stores.insightFiles,"sites.read.all")})))(t,this.insightType,this.insightId)),this.driveItem=n}))}getTextFromProperty(e,t){if(!t||0===t.length)return null;const n=t.trim().split(",");let o,r=0;for(;!o&&r<n.length;){const t=n[r].trim();switch(t){case"size":{let t="0";e.size&&(t=Qn(e.size)),o="".concat(this.strings.sizeSubtitle,": ").concat(t);break}case"lastModifiedDateTime":{let t,n;if(e.lastModifiedDateTime){const o=new Date(e.lastModifiedDateTime);t=Vn(o),n="".concat(this.strings.modifiedSubtitle," ").concat(t)}else n="";o=n;break}default:o=e[t]}r++}return o}};Bf([Et({attribute:"file-query"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"fileQuery",null),Bf([Et({attribute:"site-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"siteId",null),Bf([Et({attribute:"drive-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"driveId",null),Bf([Et({attribute:"group-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"groupId",null),Bf([Et({attribute:"list-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"listId",null),Bf([Et({attribute:"user-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"userId",null),Bf([Et({attribute:"item-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"itemId",null),Bf([Et({attribute:"item-path"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"itemPath",null),Bf([Et({attribute:"insight-type"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"insightType",null),Bf([Et({attribute:"insight-id"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"insightId",null),Bf([Et({type:Object}),Vf("design:type",Object),Vf("design:paramtypes",[Object])],Kf.prototype,"fileDetails",null),Bf([Et({attribute:"file-icon"}),Vf("design:type",String),Vf("design:paramtypes",[String])],Kf.prototype,"fileIcon",null),Bf([Et({type:Object}),Vf("design:type",Object)],Kf.prototype,"driveItem",void 0),Bf([Et({attribute:"line1-property"}),Vf("design:type",String)],Kf.prototype,"line1Property",void 0),Bf([Et({attribute:"line2-property"}),Vf("design:type",String)],Kf.prototype,"line2Property",void 0),Bf([Et({attribute:"line3-property"}),Vf("design:type",String)],Kf.prototype,"line3Property",void 0),Bf([Et({attribute:"view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Vo[e]?Vo.threelines:Vo[e]):Vo.threelines}),Vf("design:type",Number)],Kf.prototype,"view",void 0),Kf=Bf([Tn("file"),Vf("design:paramtypes",[])],Kf);class Gf extends Wa{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){const e="number"===typeof this.min?this.min:0,t="number"===typeof this.max?this.max:100,n="number"===typeof this.value?this.value:0,o=t-e;this.percentComplete=0===o?0:Math.fround((n-e)/o*100)}}ta([Ys({converter:Ws})],Gf.prototype,"value",void 0),ta([Ys({converter:Ws})],Gf.prototype,"min",void 0),ta([Ys({converter:Ws})],Gf.prototype,"max",void 0),ta([Ys({mode:"boolean"})],Gf.prototype,"paused",void 0),ta([Ms],Gf.prototype,"percentComplete",void 0);const $f=e=>"function"===typeof e,Wf=()=>null;function Qf(e){return void 0===e?Wf:$f(e)?e:()=>e}function Yf(e,t,n){const o=$f(e)?e:()=>e,r=Qf(t),i=Qf(n);return(e,t)=>o(e,t)?r(e,t):i(e,t)}var Zf,Jf,Xf;var eg,tg;const ng=class extends Gf{}.compose({baseName:"progress",template:(e,t)=>ec(Zf||(Zf=Ht(['\n    <template\n        role="progressbar"\n        aria-valuenow="','"\n        aria-valuemin="','"\n        aria-valuemax="','"\n        class="','"\n    >\n        ',"\n    </template>\n"])),(e=>e.value),(e=>e.min),(e=>e.max),(e=>e.paused?"paused":""),Yf((e=>"number"===typeof e.value),ec(Jf||(Jf=Ht(['\n                <div class="progress" part="progress" slot="determinate">\n                    <div\n                        class="determinate"\n                        part="determinate"\n                        style="width: ','%"\n                    ></div>\n                </div>\n            '])),(e=>e.percentComplete)),ec(Xf||(Xf=Ht(['\n                <div class="progress" part="progress" slot="indeterminate">\n                    <slot class="indeterminate" name="indeterminate">\n                        ',"\n                        ","\n                    </slot>\n                </div>\n            "])),t.indeterminateIndicator1||"",t.indeterminateIndicator2||""))),styles:(e,t)=>xp(eg||(eg=Ht(["\n    "," :host {\n      align-items: center;\n      height: calc(("," * 3) * 1px);\n    }\n\n    .progress {\n      background-color: ",";\n      border-radius: calc("," * 1px);\n      width: 100%;\n      height: calc("," * 1px);\n      display: flex;\n      align-items: center;\n      position: relative;\n    }\n\n    .determinate {\n      background-color: ",";\n      border-radius: calc("," * 1px);\n      height: calc(("," * 3) * 1px);\n      transition: all 0.2s ease-in-out;\n      display: flex;\n    }\n\n    .indeterminate {\n      height: calc(("," * 3) * 1px);\n      border-radius: calc("," * 1px);\n      display: flex;\n      width: 100%;\n      position: relative;\n      overflow: hidden;\n    }\n\n    .indeterminate-indicator-1 {\n      position: absolute;\n      opacity: 0;\n      height: 100%;\n      background-color: ",";\n      border-radius: calc("," * 1px);\n      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);\n      width: 40%;\n      animation: indeterminate-1 2s infinite;\n    }\n\n    .indeterminate-indicator-2 {\n      position: absolute;\n      opacity: 0;\n      height: 100%;\n      background-color: ",";\n      border-radius: calc("," * 1px);\n      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);\n      width: 60%;\n      animation: indeterminate-2 2s infinite;\n    }\n\n    :host(.paused) .indeterminate-indicator-1,\n    :host(.paused) .indeterminate-indicator-2 {\n      animation: none;\n      background-color: ",";\n      width: 100%;\n      opacity: 1;\n    }\n\n    :host(.paused) .determinate {\n      background-color: ",";\n    }\n\n    @keyframes indeterminate-1 {\n      0% {\n        opacity: 1;\n        transform: translateX(-100%);\n      }\n      70% {\n        opacity: 1;\n        transform: translateX(300%);\n      }\n      70.01% {\n        opacity: 0;\n      }\n      100% {\n        opacity: 0;\n        transform: translateX(300%);\n      }\n    }\n\n    @keyframes indeterminate-2 {\n      0% {\n        opacity: 0;\n        transform: translateX(-150%);\n      }\n      29.99% {\n        opacity: 0;\n      }\n      30% {\n        opacity: 1;\n        transform: translateX(-150%);\n      }\n      100% {\n        transform: translateX(166.66%);\n        opacity: 1;\n      }\n    }\n  "])),Sp("flex"),rd,lp,td,rd,Qu,td,rd,rd,td,Qu,td,Qu,td,Kh,Kh).withBehaviors(Ep(xp(tg||(tg=Ht(["\n        .indeterminate-indicator-1,\n        .indeterminate-indicator-2,\n        .determinate,\n        .progress {\n          background-color: ",";\n        }\n        :host(.paused) .indeterminate-indicator-1,\n        :host(.paused) .indeterminate-indicator-2,\n        :host(.paused) .determinate {\n          background-color: ",";\n        }\n      "])),Ap.ButtonText,Ap.GrayText))),indeterminateIndicator1:'\n    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>\n  ',indeterminateIndicator2:'\n    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>\n  '});class og{}ta([Ys({attribute:"aria-atomic"})],og.prototype,"ariaAtomic",void 0),ta([Ys({attribute:"aria-busy"})],og.prototype,"ariaBusy",void 0),ta([Ys({attribute:"aria-controls"})],og.prototype,"ariaControls",void 0),ta([Ys({attribute:"aria-current"})],og.prototype,"ariaCurrent",void 0),ta([Ys({attribute:"aria-describedby"})],og.prototype,"ariaDescribedby",void 0),ta([Ys({attribute:"aria-details"})],og.prototype,"ariaDetails",void 0),ta([Ys({attribute:"aria-disabled"})],og.prototype,"ariaDisabled",void 0),ta([Ys({attribute:"aria-errormessage"})],og.prototype,"ariaErrormessage",void 0),ta([Ys({attribute:"aria-flowto"})],og.prototype,"ariaFlowto",void 0),ta([Ys({attribute:"aria-haspopup"})],og.prototype,"ariaHaspopup",void 0),ta([Ys({attribute:"aria-hidden"})],og.prototype,"ariaHidden",void 0),ta([Ys({attribute:"aria-invalid"})],og.prototype,"ariaInvalid",void 0),ta([Ys({attribute:"aria-keyshortcuts"})],og.prototype,"ariaKeyshortcuts",void 0),ta([Ys({attribute:"aria-label"})],og.prototype,"ariaLabel",void 0),ta([Ys({attribute:"aria-labelledby"})],og.prototype,"ariaLabelledby",void 0),ta([Ys({attribute:"aria-live"})],og.prototype,"ariaLive",void 0),ta([Ys({attribute:"aria-owns"})],og.prototype,"ariaOwns",void 0),ta([Ys({attribute:"aria-relevant"})],og.prototype,"ariaRelevant",void 0),ta([Ys({attribute:"aria-roledescription"})],og.prototype,"ariaRoledescription",void 0);class rg{constructor(e,t){this.target=e,this.propertyName=t}bind(e){e[this.propertyName]=this.target}unbind(){}}function ig(e){return new Rl("fast-ref",rg,e)}var sg,ag,lg,cg;class dg{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}}const ug=(e,t)=>ec(sg||(sg=Ht(['\n    <span\n        part="end"\n        ',"\n        class=",'\n    >\n        <slot name="end" ',' @slotchange="','">\n            ',"\n        </slot>\n    </span>\n"])),ig("endContainer"),(e=>t.end?"end":void 0),ig("end"),(e=>e.handleEndContentChange()),t.end||""),hg=(e,t)=>ec(ag||(ag=Ht(['\n    <span\n        part="start"\n        ','\n        class="','"\n    >\n        <slot\n            name="start"\n            ','\n            @slotchange="','"\n        >\n            ',"\n        </slot>\n    </span>\n"])),ig("startContainer"),(e=>t.start?"start":void 0),ig("start"),(e=>e.handleStartContentChange()),t.start||""),pg=ec(lg||(lg=Ht(['\n    <span part="end" ','>\n        <slot\n            name="end"\n            ','\n            @slotchange="','"\n        ></slot>\n    </span>\n'])),ig("endContainer"),ig("end"),(e=>e.handleEndContentChange())),fg=ec(cg||(cg=Ht(['\n    <span part="start" ','>\n        <slot\n            name="start"\n            ','\n            @slotchange="','"\n        ></slot>\n    </span>\n'])),ig("startContainer"),ig("start"),(e=>e.handleStartContentChange()));function gg(e){const t=Gs.locate(e);for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];o.forEach((n=>{Object.getOwnPropertyNames(n.prototype).forEach((t=>{"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(n.prototype,t))}));Gs.locate(n).forEach((e=>t.push(e)))}))}var vg;!function(e){e[e.alt=18]="alt",e[e.arrowDown=40]="arrowDown",e[e.arrowLeft=37]="arrowLeft",e[e.arrowRight=39]="arrowRight",e[e.arrowUp=38]="arrowUp",e[e.back=8]="back",e[e.backSlash=220]="backSlash",e[e.break=19]="break",e[e.capsLock=20]="capsLock",e[e.closeBracket=221]="closeBracket",e[e.colon=186]="colon",e[e.colon2=59]="colon2",e[e.comma=188]="comma",e[e.ctrl=17]="ctrl",e[e.delete=46]="delete",e[e.end=35]="end",e[e.enter=13]="enter",e[e.equals=187]="equals",e[e.equals2=61]="equals2",e[e.equals3=107]="equals3",e[e.escape=27]="escape",e[e.forwardSlash=191]="forwardSlash",e[e.function1=112]="function1",e[e.function10=121]="function10",e[e.function11=122]="function11",e[e.function12=123]="function12",e[e.function2=113]="function2",e[e.function3=114]="function3",e[e.function4=115]="function4",e[e.function5=116]="function5",e[e.function6=117]="function6",e[e.function7=118]="function7",e[e.function8=119]="function8",e[e.function9=120]="function9",e[e.home=36]="home",e[e.insert=45]="insert",e[e.menu=93]="menu",e[e.minus=189]="minus",e[e.minus2=109]="minus2",e[e.numLock=144]="numLock",e[e.numPad0=96]="numPad0",e[e.numPad1=97]="numPad1",e[e.numPad2=98]="numPad2",e[e.numPad3=99]="numPad3",e[e.numPad4=100]="numPad4",e[e.numPad5=101]="numPad5",e[e.numPad6=102]="numPad6",e[e.numPad7=103]="numPad7",e[e.numPad8=104]="numPad8",e[e.numPad9=105]="numPad9",e[e.numPadDivide=111]="numPadDivide",e[e.numPadDot=110]="numPadDot",e[e.numPadMinus=109]="numPadMinus",e[e.numPadMultiply=106]="numPadMultiply",e[e.numPadPlus=107]="numPadPlus",e[e.openBracket=219]="openBracket",e[e.pageDown=34]="pageDown",e[e.pageUp=33]="pageUp",e[e.period=190]="period",e[e.print=44]="print",e[e.quote=222]="quote",e[e.scrollLock=145]="scrollLock",e[e.shift=16]="shift",e[e.space=32]="space",e[e.tab=9]="tab",e[e.tilde=192]="tilde",e[e.windowsLeft=91]="windowsLeft",e[e.windowsOpera=219]="windowsOpera",e[e.windowsRight=92]="windowsRight"}(vg||(vg={}));const mg="ArrowDown",yg="ArrowLeft",bg="ArrowRight",wg="ArrowUp",kg="Enter",xg="Escape",Cg="Home",_g="End",Sg=" ",Tg="Tab",Ig={ArrowDown:mg,ArrowLeft:yg,ArrowRight:bg,ArrowUp:wg},Eg="form-associated-proxy",Ag="ElementInternals",Rg=Ag in window&&"setFormValue"in window[Ag].prototype,Pg=new WeakMap;function Og(e){const t=class extends e{constructor(){super(...arguments),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return Rg}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){const e=this.proxy.labels,t=Array.from(this.proxy.getRootNode().querySelectorAll("[for='".concat(this.id,"']"))),n=e?t.concat(Array.from(e)):t;return Object.freeze(n)}return xs}valueChanged(e,t){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),Rs.queueUpdate((()=>this.classList.toggle("disabled",this.disabled)))}nameChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(e,t){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),Rs.queueUpdate((()=>this.classList.toggle("required",this.required))),this.validate()}get elementInternals(){if(!Rg)return null;let e=Pg.get(this);return e||(e=this.attachInternals(),Pg.set(this,e)),e}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){super.disconnectedCallback(),this.proxyEventsToBlock.forEach((e=>this.proxy.removeEventListener(e,this.stopPropagation))),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(e,t,n){this.elementInternals?this.elementInternals.setValidity(e,t,n):"string"===typeof t&&this.proxy.setCustomValidity(t)}formDisabledCallback(e){this.disabled=e}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var e;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach((e=>this.proxy.addEventListener(e,this.stopPropagation))),this.proxy.disabled=this.disabled,this.proxy.required=this.required,"string"===typeof this.name&&(this.proxy.name=this.name),"string"===typeof this.value&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",Eg),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",Eg)),null===(e=this.shadowRoot)||void 0===e||e.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var e;this.removeChild(this.proxy),null===(e=this.shadowRoot)||void 0===e||e.removeChild(this.proxySlot)}validate(e){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,e)}setFormValue(e,t){this.elementInternals&&this.elementInternals.setFormValue(e,t||e)}_keypressHandler(e){if(e.key===kg)if(this.form instanceof HTMLFormElement){const e=this.form.querySelector("[type=submit]");null===e||void 0===e||e.click()}}stopPropagation(e){e.stopPropagation()}};return Ys({mode:"boolean"})(t.prototype,"disabled"),Ys({mode:"fromView",attribute:"value"})(t.prototype,"initialValue"),Ys({attribute:"current-value"})(t.prototype,"currentValue"),Ys(t.prototype,"name"),Ys({mode:"boolean"})(t.prototype,"required"),Ms(t.prototype,"value"),t}function Dg(e){class t extends(Og(e)){}class n extends t{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];super(t),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(e,t){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),void 0!==e&&this.$emit("change"),this.validate()}currentCheckedChanged(e,t){this.checked=this.currentChecked}updateForm(){const e=this.checked?this.value:null;this.setFormValue(e,e)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return Ys({attribute:"checked",mode:"boolean"})(n.prototype,"checkedAttribute"),Ys({attribute:"current-checked",converter:$s})(n.prototype,"currentChecked"),Ms(n.prototype,"defaultChecked"),Ms(n.prototype,"checked"),n}class Mg extends Wa{}class Ng extends(Og(Mg)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Lg extends Ng{constructor(){super(...arguments),this.handleClick=e=>{var t;this.disabled&&(null===(t=this.defaultSlottedContent)||void 0===t?void 0:t.length)<=1&&e.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;const e=this.proxy.isConnected;e||this.attachProxy(),"function"===typeof this.form.requestSubmit?this.form.requestSubmit(this.proxy):this.proxy.click(),e||this.detachProxy()},this.handleFormReset=()=>{var e;null===(e=this.form)||void 0===e||e.reset()},this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(e=this.$fastController.definition.shadowOptions)||void 0===e?void 0:e.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(e,t){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),"submit"===t&&this.addEventListener("click",this.handleSubmission),"submit"===e&&this.removeEventListener("click",this.handleSubmission),"reset"===t&&this.addEventListener("click",this.handleFormReset),"reset"===e&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var e;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();const t=Array.from(null===(e=this.control)||void 0===e?void 0:e.children);t&&t.forEach((e=>{e.addEventListener("click",this.handleClick)}))}disconnectedCallback(){var e;super.disconnectedCallback();const t=Array.from(null===(e=this.control)||void 0===e?void 0:e.children);t&&t.forEach((e=>{e.removeEventListener("click",this.handleClick)}))}}ta([Ys({mode:"boolean"})],Lg.prototype,"autofocus",void 0),ta([Ys({attribute:"form"})],Lg.prototype,"formId",void 0),ta([Ys],Lg.prototype,"formaction",void 0),ta([Ys],Lg.prototype,"formenctype",void 0),ta([Ys],Lg.prototype,"formmethod",void 0),ta([Ys({mode:"boolean"})],Lg.prototype,"formnovalidate",void 0),ta([Ys],Lg.prototype,"formtarget",void 0),ta([Ys],Lg.prototype,"type",void 0),ta([Ms],Lg.prototype,"defaultSlottedContent",void 0);class Fg{}function Ug(e){return e?function(t,n,o){return 1===t.nodeType&&t.matches(e)}:function(e,t,n){return 1===e.nodeType}}ta([Ys({attribute:"aria-expanded"})],Fg.prototype,"ariaExpanded",void 0),ta([Ys({attribute:"aria-pressed"})],Fg.prototype,"ariaPressed",void 0),gg(Fg,og),gg(Lg,dg,Fg);class zg{constructor(e,t){this.target=e,this.options=t,this.source=null}bind(e){const t=this.options.property;this.shouldUpdate=Ds.getAccessors(e).some((e=>e.name===t)),this.source=e,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(xs),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let e=this.getNodes();return void 0!==this.options.filter&&(e=e.filter(this.options.filter)),e}updateTarget(e){this.source[this.options.property]=e}}class Hg extends zg{constructor(e,t){super(e,t)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}function qg(e){return"string"===typeof e&&(e={property:e}),new Rl("fast-slotted",Hg,e)}var Bg;const Vg="not-allowed";function jg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((e=>e instanceof HTMLElement))}let Kg;const Gg=function(){if("boolean"===typeof Kg)return Kg;if("undefined"===typeof window||!window.document||!window.document.createElement)return Kg=!1,Kg;const e=document.createElement("style"),t=function(){const e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null}();null!==t&&e.setAttribute("nonce",t),document.head.appendChild(e);try{e.sheet.insertRule("foo:focus-visible {color:inherit}",0),Kg=!0}catch(sL){Kg=!1}finally{document.head.removeChild(e)}return Kg}()?"focus-visible":"focus";var $g;const Wg=_p($g||($g=Ht(["("," + ",") * ",""])),Xc,ed,td);var Qg,Yg,Zg,Jg,Xg,ev,tv,nv,ov;const rv=_p(Qg||(Qg=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,cd,dd,ud);_p(Yg||(Yg=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,hd,pd,fd),_p(Zg||(Zg=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,gd,vd,md),_p(Jg||(Jg=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,yd,bd,wd),_p(Xg||(Xg=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,kd,xd,Cd),_p(ev||(ev=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,_d,Sd,Td),_p(tv||(tv=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,Id,Ed,Ad),_p(nv||(nv=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,Rd,Pd,Od),_p(ov||(ov=Ht(["\n  font-family: ",";\n  font-size: ",";\n  line-height: ",";\n  font-weight: initial;\n  font-variation-settings: ",";\n"])),sd,Dd,Md,Nd);var iv,sv;const av=_p(iv||(iv=Ht(["\n  outline: calc("," * 1px) solid ",";\n  outline-offset: calc("," * -1px);\n"])),id,hp,id),lv=_p(sv||(sv=Ht(["\n  outline: calc("," * 1px) solid ",";\n  outline-offset: calc("," * 1px);\n"])),id,hp,rd);var cv,dv,uv,hv,pv,fv,gv,vv,mv,yv,bv;const wv=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[disabled]";return xp(dv||(dv=Ht(["\n    .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n    }\n\n    :host(",":hover) .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n    }\n\n    :host(",":active) .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n    }\n\n    :host(",") .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n    }\n  "])),gh,gh,Zh,n,vh,vh,Jh,n,mh,mh,Xh,o,gh,gh,$h).withBehaviors(Ep(xp(uv||(uv=Ht(["\n        .control {\n          background: ",";\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",":hover) .control,\n        :host(",":active) .control {\n          forced-color-adjust: none;\n          background: ",";\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",") .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n\n        .control:"," {\n          outline-color: ",";\n        }\n\n        :host([href]) .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n\n        :host([href]:hover) .control,\n        :host([href]:active) .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n    "])),Ap.ButtonFace,Ap.ButtonText,Ap.ButtonText,n,n,Ap.HighlightText,Ap.Highlight,Ap.Highlight,o,Ap.GrayText,Ap.GrayText,Gg,Ap.CanvasText,Ap.LinkText,Ap.LinkText,Ap.CanvasText,Ap.CanvasText)))},kv=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[disabled]";return xp(yv||(yv=Ht(["\n    .control {\n      background: ",";\n    }\n\n    :host(",":hover) .control {\n      background: ",";\n    }\n\n    :host(",":active) .control {\n      background: ",";\n    }\n\n    :host(",") .control {\n      background: ",";\n    }\n  "])),Nh,n,Lh,n,Fh,o,Nh).withBehaviors(Ep(xp(bv||(bv=Ht(["\n        .control {\n          forced-color-adjust: none;\n          background: transparent;\n          color: ",";\n        }\n\n        :host(",":hover) .control,\n        :host(",":active) .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",") .control {\n          background: transparent;\n          color: ",";\n        }\n        \n        .control:"," {\n          outline-color: ",";\n        }\n\n        :host([href]) .control {\n          color: ",";\n        }\n\n        :host([href]:hover) .control,\n        :host([href]:active) .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n      "])),Ap.ButtonText,n,n,Ap.ButtonText,Ap.ButtonText,o,Ap.GrayText,Gg,Ap.CanvasText,Ap.LinkText,Ap.LinkText,Ap.LinkText)))};class xv{constructor(e,t,n){this.propertyName=e,this.value=t,this.styles=n}bind(e){Ds.getNotifier(e).subscribe(this,this.propertyName),this.handleChange(e,this.propertyName)}unbind(e){Ds.getNotifier(e).unsubscribe(this,this.propertyName),e.$fastController.removeStyles(this.styles)}handleChange(e,t){e[t]===this.value?e.$fastController.addStyles(this.styles):e.$fastController.removeStyles(this.styles)}}function Cv(e,t){return new xv("appearance",e,t)}var _v;const Sv=":not([disabled])",Tv="[disabled]";class Iv extends Lg{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){const e=this.defaultSlottedContent.filter((e=>e.nodeType===Node.ELEMENT_NODE));1===e.length&&e[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}}i([Ys],Iv.prototype,"appearance",void 0);const Ev=Iv.compose({baseName:"button",baseClass:Lg,template:(e,t)=>ec(Bg||(Bg=Ht(['\n    <button\n        class="control"\n        part="control"\n        ?autofocus="','"\n        ?disabled="','"\n        form="','"\n        formaction="','"\n        formenctype="','"\n        formmethod="','"\n        formnovalidate="','"\n        formtarget="','"\n        name="','"\n        type="','"\n        value="','"\n        aria-atomic="','"\n        aria-busy="','"\n        aria-controls="','"\n        aria-current="','"\n        aria-describedby="','"\n        aria-details="','"\n        aria-disabled="','"\n        aria-errormessage="','"\n        aria-expanded="','"\n        aria-flowto="','"\n        aria-haspopup="','"\n        aria-hidden="','"\n        aria-invalid="','"\n        aria-keyshortcuts="','"\n        aria-label="','"\n        aria-labelledby="','"\n        aria-live="','"\n        aria-owns="','"\n        aria-pressed="','"\n        aria-relevant="','"\n        aria-roledescription="','"\n        ',"\n    >\n        ",'\n        <span class="content" part="content">\n            <slot ',"></slot>\n        </span>\n        ","\n    </button>\n"])),(e=>e.autofocus),(e=>e.disabled),(e=>e.formId),(e=>e.formaction),(e=>e.formenctype),(e=>e.formmethod),(e=>e.formnovalidate),(e=>e.formtarget),(e=>e.name),(e=>e.type),(e=>e.value),(e=>e.ariaAtomic),(e=>e.ariaBusy),(e=>e.ariaControls),(e=>e.ariaCurrent),(e=>e.ariaDescribedby),(e=>e.ariaDetails),(e=>e.ariaDisabled),(e=>e.ariaErrormessage),(e=>e.ariaExpanded),(e=>e.ariaFlowto),(e=>e.ariaHaspopup),(e=>e.ariaHidden),(e=>e.ariaInvalid),(e=>e.ariaKeyshortcuts),(e=>e.ariaLabel),(e=>e.ariaLabelledby),(e=>e.ariaLive),(e=>e.ariaOwns),(e=>e.ariaPressed),(e=>e.ariaRelevant),(e=>e.ariaRoledescription),ig("control"),hg(0,t),qg("defaultSlottedContent"),ug(0,t)),styles:(e,t)=>xp(_v||(_v=Ht(["\n    :host(",") .control {\n      cursor: pointer;\n    }\n\n    :host(",") .control {\n      cursor: ",";\n    }\n\n    @media (forced-colors: none) {\n      :host(",") .control {\n        opacity: ",";\n      }\n    }\n\n    ","\n  "])),Sv,Tv,Vg,Tv,Jc,xp(cv||(cv=Ht(["\n    ","\n    \n    :host {\n      position: relative;\n      box-sizing: border-box;\n      ","\n      height: calc("," * 1px);\n      min-width: calc("," * 1px);\n      color: ",";\n      border-radius: calc("," * 1px);\n      fill: currentcolor;\n    }\n\n    .control {\n      border: calc("," * 1px) solid transparent;\n      flex-grow: 1;\n      box-sizing: border-box;\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      padding: 0 calc((10 + ("," * 2 * ",")) * 1px);\n      white-space: nowrap;\n      outline: none;\n      text-decoration: none;\n      color: inherit;\n      border-radius: inherit;\n      fill: inherit;\n      font-family: inherit;\n    }\n\n    .control,\n    .end,\n    .start {\n      font: inherit;\n    }\n\n    .control.icon-only {\n      padding: 0;\n      line-height: 0;\n    }\n\n    .control:"," {\n      ","\n    }\n\n    .control::-moz-focus-inner {\n      border: 0;\n    }\n\n    .content {\n      pointer-events: none;\n    }\n\n    .start,\n    .end {\n      display: flex;\n      pointer-events: none;\n    }\n\n    .start {\n      margin-inline-end: 11px;\n    }\n\n    .end {\n      margin-inline-start: 11px;\n    }\n  "])),Sp("inline-flex"),rv,Wg,Wg,qh,nd,rd,td,ed,Gg,av)).withBehaviors(Cv("neutral",wv(e,t,Sv,Tv)),Cv("accent",function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[disabled]";return xp(hv||(hv=Ht(["\n    .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n      color: ",";\n    }\n\n    :host(",":hover) .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n      color: ",";\n    }\n\n    :host(",":active) .control {\n      background: padding-box linear-gradient(",", ","),\n        border-box ",";\n      color: ",";\n    }\n\n    :host(",") .control {\n      background: ",";\n    }\n\n    .control:"," {\n      box-shadow: 0 0 0 calc("," * 1px) "," inset !important;\n    }\n  "])),Qu,Qu,dh,eh,n,Yu,Yu,uh,th,n,Zu,Zu,hh,nh,o,Qu,Gg,id,fp).withBehaviors(Ep(xp(pv||(pv=Ht(["\n        .control {\n          forced-color-adjust: none;\n          background: ",";\n          color: ",";\n        }\n\n        :host(",":hover) .control,\n        :host(",":active) .control {\n          background: ",";\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",") .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n\n        .control:"," {\n          outline-color: ",";\n          box-shadow: 0 0 0 calc("," * 1px) "," inset !important;\n        }\n\n        :host([href]) .control {\n          background: ",";\n          color: ",";\n        }\n\n        :host([href]:hover) .control,\n        :host([href]:active) .control {\n          background: ",";\n          border-color: ",";\n          color: ",";\n        }\n      "])),Ap.Highlight,Ap.HighlightText,n,n,Ap.HighlightText,Ap.Highlight,Ap.Highlight,o,Ap.GrayText,Ap.GrayText,Gg,Ap.CanvasText,id,Ap.HighlightText,Ap.LinkText,Ap.HighlightText,Ap.ButtonFace,Ap.LinkText,Ap.LinkText)))}(e,t,Sv,Tv)),Cv("lightweight",function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[disabled]";return xp(fv||(fv=Ht(["\n    :host {\n      color: ",";\n    }\n\n    .control {\n      background: ",";\n    }\n\n    :host(",":hover) .control {\n      background: ",";\n      color: ",";\n    }\n\n    :host(",":active) .control {\n      background: ",";\n      color: ",";\n    }\n\n    :host(",") .control {\n      background: ",";\n    }\n  "])),ih,Nh,n,Lh,sh,n,Fh,ah,o,Nh).withBehaviors(Ep(xp(gv||(gv=Ht(["\n        :host {\n          color: ",";\n        }\n\n        .control {\n          forced-color-adjust: none;\n          background: transparent;\n        }\n\n        :host(",":hover) .control,\n        :host(",":active) .control {\n          background: transparent;\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",") .control {\n          background: transparent;\n          color: ",";\n        }\n\n        .control:"," {\n          outline-color: ",";\n        }\n\n        :host([href]) .control {\n          color: ",";\n        }\n\n        :host([href]:hover) .control,\n        :host([href]:active) .control {\n          border-color: ",";\n          color: ",";\n        }\n      "])),Ap.ButtonText,n,n,Ap.ButtonText,Ap.ButtonText,o,Ap.GrayText,Gg,Ap.CanvasText,Ap.LinkText,Ap.LinkText,Ap.LinkText)))}(e,t,Sv,Tv)),Cv("outline",function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"[disabled]";return xp(vv||(vv=Ht(["\n    .control {\n      background: transparent !important;\n      border-color: ",";\n    }\n\n    :host(",":hover) .control {\n      border-color: ",";\n    }\n\n    :host(",":active) .control {\n      border-color: ",";\n    }\n\n    :host(",") .control {\n      background: transparent !important;\n      border-color: ",";\n    }\n  "])),$h,n,Wh,n,Qh,o,$h).withBehaviors(Ep(xp(mv||(mv=Ht(["\n        .control {\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",":hover) .control,\n        :host(",":active) .control {\n          background: ",";\n          border-color: ",";\n          color: ",";\n        }\n\n        :host(",") .control {\n          border-color: ",";\n          color: ",";\n        }\n\n        .control:"," {\n          outline-color: ",";\n        }\n\n        :host([href]) .control {\n          border-color: ",";\n          color: ",";\n        }\n\n        :host([href]:hover) .control,\n        :host([href]:active) .control {\n          border-color: ",";\n          color: ",";\n        }\n      "])),Ap.ButtonText,Ap.ButtonText,n,n,Ap.HighlightText,Ap.Highlight,Ap.Highlight,o,Ap.GrayText,Ap.GrayText,Gg,Ap.CanvasText,Ap.LinkText,Ap.LinkText,Ap.CanvasText,Ap.CanvasText)))}(e,t,Sv,Tv)),Cv("stealth",kv(e,t,Sv,Tv))),shadowOptions:{delegatesFocus:!0}});class Av extends Wa{}class Rv extends(Dg(Av)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Pv extends Rv{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=e=>{if(!this.readOnly&&e.key===Sg)this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked},this.clickHandler=e=>{this.disabled||this.readOnly||(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}}var Ov;ta([Ys({attribute:"readonly",mode:"boolean"})],Pv.prototype,"readOnly",void 0),ta([Ms],Pv.prototype,"defaultSlottedNodes",void 0),ta([Ms],Pv.prototype,"indeterminate",void 0);var Dv,Mv;const Nv=Pv.compose({baseName:"checkbox",template:(e,t)=>ec(Ov||(Ov=Ht(['\n    <template\n        role="checkbox"\n        aria-checked="','"\n        aria-required="','"\n        aria-disabled="','"\n        aria-readonly="','"\n        tabindex="','"\n        @keypress="','"\n        @click="','"\n        class="'," "," ",'"\n    >\n        <div part="control" class="control">\n            <slot name="checked-indicator">\n                ','\n            </slot>\n            <slot name="indeterminate-indicator">\n                ','\n            </slot>\n        </div>\n        <label\n            part="label"\n            class="','"\n        >\n            <slot ',"></slot>\n        </label>\n    </template>\n"])),(e=>e.checked),(e=>e.required),(e=>e.disabled),(e=>e.readOnly),(e=>e.disabled?null:0),((e,t)=>e.keypressHandler(t.event)),((e,t)=>e.clickHandler(t.event)),(e=>e.readOnly?"readonly":""),(e=>e.checked?"checked":""),(e=>e.indeterminate?"indeterminate":""),t.checkedIndicator||"",t.indeterminateIndicator||"",(e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"),qg("defaultSlottedNodes")),styles:(e,t)=>xp(Dv||(Dv=Ht(["\n    "," :host {\n      align-items: center;\n      outline: none;\n      "," user-select: none;\n    }\n\n    .control {\n      position: relative;\n      width: calc(("," / 2 + ",") * 1px);\n      height: calc(("," / 2 + ",") * 1px);\n      box-sizing: border-box;\n      border-radius: calc("," * 1px);\n      border: calc("," * 1px) solid ",";\n      background: ",";\n      cursor: pointer;\n    }\n\n    .label__hidden {\n      display: none;\n      visibility: hidden;\n    }\n\n    .label {\n      ","\n      color: ",";\n      "," padding-inline-start: calc("," * 2px + 2px);\n      margin-inline-end: calc("," * 2px + 2px);\n      cursor: pointer;\n    }\n\n    slot[name='checked-indicator'],\n    slot[name='indeterminate-indicator'] {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 100%;\n      height: 100%;\n      fill: ",";\n      opacity: 0;\n      pointer-events: none;\n    }\n\n    slot[name='indeterminate-indicator'] {\n      position: absolute;\n      top: 0;\n    }\n\n    :host(.checked) slot[name='checked-indicator'],\n    :host(.checked) slot[name='indeterminate-indicator'] {\n      fill: ",";\n    }\n\n    :host(:not(.disabled):hover) .control {\n      background: ",";\n      border-color: ",";\n    }\n\n    :host(:not(.disabled):active) .control {\n      background: ",";\n      border-color: ",";\n    }\n\n    :host(:",") .control {\n      background: ",";\n      ","\n    }\n\n    :host(.checked) .control {\n      background: ",";\n      border-color: transparent;\n    }\n\n    :host(.checked:not(.disabled):hover) .control {\n      background: ",";\n      border-color: transparent;\n    }\n\n    :host(.checked:not(.disabled):active) .control {\n      background: ",";\n      border-color: transparent;\n    }\n\n    :host(.disabled) .label,\n    :host(.readonly) .label,\n    :host(.readonly) .control,\n    :host(.disabled) .control {\n      cursor: ",";\n    }\n\n    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],\n    :host(.indeterminate) slot[name='indeterminate-indicator'] {\n      opacity: 1;\n    }\n\n    :host(.disabled) {\n      opacity: ",";\n    }\n  "])),Sp("inline-flex"),"",Wg,td,Wg,td,nd,rd,lp,Ch,rv,qh,"",td,td,qh,eh,_h,cp,Sh,dp,Gg,Th,lv,Qu,Yu,Zu,Vg,Jc).withBehaviors(Ep(xp(Mv||(Mv=Ht(["\n        .control {\n          border-color: ",";\n          background: ",";\n        }\n        :host(:not(.disabled):hover) .control,\n        :host(:not(.disabled):active) .control {\n          border-color: ",";\n          background: ",";\n        }\n        slot[name='checked-indicator'],\n        slot[name='indeterminate-indicator'] {\n          fill: ",";\n        }\n        :host(:",") .control {\n          forced-color-adjust: none;\n          outline-color: ",";\n          background: ",";\n          border-color: ",";\n        }\n        :host(.checked) .control {\n          background: ",";\n          border-color: ",";\n        }\n        :host(.checked:not(.disabled):hover) .control,\n        :host(.checked:not(.disabled):active) .control {\n          background: ",";\n          border-color: ",";\n        }\n        :host(.checked) slot[name='checked-indicator'],\n        :host(.checked) slot[name='indeterminate-indicator'] {\n          fill: ",";\n        }\n        :host(.checked:hover ) .control slot[name='checked-indicator'],\n        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {\n          fill: ",";\n        }\n        :host(.disabled) {\n          opacity: 1;\n        }\n        :host(.disabled) .control {\n          border-color: ",";\n          background: ",";\n        }\n        :host(.disabled) slot[name='checked-indicator'],\n        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],\n        :host(.disabled) slot[name='indeterminate-indicator'],\n        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {\n          fill: ",";\n        }\n      "])),Ap.FieldText,Ap.Field,Ap.Highlight,Ap.Field,Ap.FieldText,Gg,Ap.FieldText,Ap.Field,Ap.Highlight,Ap.Highlight,Ap.Highlight,Ap.HighlightText,Ap.Highlight,Ap.HighlightText,Ap.Highlight,Ap.GrayText,Ap.Field,Ap.GrayText))),checkedIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>\n    </svg>\n  ',indeterminateIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>\n    </svg>\n  '});var Lv,Fv,Uv=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],zv=Uv.join(","),Hv="undefined"===typeof Element,qv=Hv?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Bv=!Hv&&Element.prototype.getRootNode?function(e){return e.getRootNode()}:function(e){return e.ownerDocument},Vv=function(e,t){return e.tabIndex<0&&(t||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||e.isContentEditable)&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},jv=function(e){return"INPUT"===e.tagName},Kv=function(e){return function(e){return jv(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||Bv(e),o=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!==typeof window&&"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)t=o(window.CSS.escape(e.name));else try{t=o(e.name)}catch(i){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",i.message),!1}var r=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!r||r===e}(e)},Gv=function(e){var t=e.getBoundingClientRect(),n=t.width,o=t.height;return 0===n&&0===o},$v=function(e,t){return!(t.disabled||function(e){return jv(e)&&"hidden"===e.type}(t)||function(e,t){var n=t.displayCheck,o=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var r=qv.call(e,"details>summary:first-of-type")?e.parentElement:e;if(qv.call(r,"details:not([open]) *"))return!0;var i=Bv(e).host,s=(null===i||void 0===i?void 0:i.ownerDocument.contains(i))||e.ownerDocument.contains(e);if(n&&"full"!==n){if("non-zero-area"===n)return Gv(e)}else{if("function"===typeof o){for(var a=e;e;){var l=e.parentElement,c=Bv(e);if(l&&!l.shadowRoot&&!0===o(l))return Gv(e);e=e.assignedSlot?e.assignedSlot:l||c===e.ownerDocument?l:c.host}e=a}if(s)return!e.getClientRects().length}return!1}(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var o=t.children.item(n);if("LEGEND"===o.tagName)return!!qv.call(t,"fieldset[disabled] *")||!o.contains(e)}return!0}t=t.parentElement}return!1}(t))},Wv=function(e,t){return!(Kv(t)||Vv(t)<0||!$v(e,t))},Qv=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==qv.call(e,zv)&&Wv(t,e)};class Yv extends Wa{constructor(){super(...arguments),this.modal=!0,this.hidden=!1,this.trapFocus=!0,this.trapFocusChanged=()=>{this.$fastController.isConnected&&this.updateTrapFocus()},this.isTrappingFocus=!1,this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&!this.hidden)switch(e.key){case xg:this.dismiss(),e.preventDefault();break;case Tg:this.handleTabKeyDown(e)}},this.handleDocumentFocus=e=>{!e.defaultPrevented&&this.shouldForceFocus(e.target)&&(this.focusFirstElement(),e.preventDefault())},this.handleTabKeyDown=e=>{if(!this.trapFocus||this.hidden)return;const t=this.getTabQueueBounds();return 0!==t.length?1===t.length?(t[0].focus(),void e.preventDefault()):void(e.shiftKey&&e.target===t[0]?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||e.target!==t[t.length-1]||(t[0].focus(),e.preventDefault())):void 0},this.getTabQueueBounds=()=>Yv.reduceTabbableItems([],this),this.focusFirstElement=()=>{const e=this.getTabQueueBounds();e.length>0?e[0].focus():this.dialog instanceof HTMLElement&&this.dialog.focus()},this.shouldForceFocus=e=>this.isTrappingFocus&&!this.contains(e),this.shouldTrapFocus=()=>this.trapFocus&&!this.hidden,this.updateTrapFocus=e=>{const t=void 0===e?this.shouldTrapFocus():e;t&&!this.isTrappingFocus?(this.isTrappingFocus=!0,document.addEventListener("focusin",this.handleDocumentFocus),Rs.queueUpdate((()=>{this.shouldForceFocus(document.activeElement)&&this.focusFirstElement()}))):!t&&this.isTrappingFocus&&(this.isTrappingFocus=!1,document.removeEventListener("focusin",this.handleDocumentFocus))}}dismiss(){this.$emit("dismiss"),this.$emit("cancel")}show(){this.hidden=!1}hide(){this.hidden=!0,this.$emit("close")}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleDocumentKeydown),this.notifier=Ds.getNotifier(this),this.notifier.subscribe(this,"hidden"),this.updateTrapFocus()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeydown),this.updateTrapFocus(!1),this.notifier.unsubscribe(this,"hidden")}handleChange(e,t){if("hidden"===t)this.updateTrapFocus()}static reduceTabbableItems(e,t){return"-1"===t.getAttribute("tabindex")?e:Qv(t)||Yv.isFocusableFastElement(t)&&Yv.hasTabbableShadow(t)?(e.push(t),e):t.childElementCount?e.concat(Array.from(t.children).reduce(Yv.reduceTabbableItems,[])):e}static isFocusableFastElement(e){var t,n;return!!(null===(n=null===(t=e.$fastController)||void 0===t?void 0:t.definition.shadowOptions)||void 0===n?void 0:n.delegatesFocus)}static hasTabbableShadow(e){var t,n;return Array.from(null!==(n=null===(t=e.shadowRoot)||void 0===t?void 0:t.querySelectorAll("*"))&&void 0!==n?n:[]).some((e=>Qv(e)))}}ta([Ys({mode:"boolean"})],Yv.prototype,"modal",void 0),ta([Ys({mode:"boolean"})],Yv.prototype,"hidden",void 0),ta([Ys({attribute:"trap-focus",mode:"boolean"})],Yv.prototype,"trapFocus",void 0),ta([Ys({attribute:"aria-describedby"})],Yv.prototype,"ariaDescribedby",void 0),ta([Ys({attribute:"aria-labelledby"})],Yv.prototype,"ariaLabelledby",void 0),ta([Ys({attribute:"aria-label"})],Yv.prototype,"ariaLabel",void 0);var Zv;const Jv=Yv.compose({baseName:"dialog",template:(e,t)=>ec(Lv||(Lv=Ht(['\n    <div class="positioning-region" part="positioning-region">\n        ','\n        <div\n            role="dialog"\n            tabindex="-1"\n            class="control"\n            part="control"\n            aria-modal="','"\n            aria-describedby="','"\n            aria-labelledby="','"\n            aria-label="','"\n            ',"\n        >\n            <slot></slot>\n        </div>\n    </div>\n"])),Yf((e=>e.modal),ec(Fv||(Fv=Ht(['\n                <div\n                    class="overlay"\n                    part="overlay"\n                    role="presentation"\n                    @click="','"\n                ></div>\n            '])),(e=>e.dismiss()))),(e=>e.modal),(e=>e.ariaDescribedby),(e=>e.ariaLabelledby),(e=>e.ariaLabel),ig("dialog")),styles:(e,t)=>xp(Zv||(Zv=Ht(["\n  :host([hidden]) {\n    display: none;\n  }\n\n  :host {\n    --dialog-height: 480px;\n    --dialog-width: 640px;\n    display: block;\n  }\n\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.3);\n    touch-action: none;\n  }\n\n  .positioning-region {\n    display: flex;\n    justify-content: center;\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    overflow: auto;\n  }\n\n  .control {\n    box-shadow: ",";\n    margin-top: auto;\n    margin-bottom: auto;\n    border-radius: calc("," * 1px);\n    width: var(--dialog-width);\n    height: var(--dialog-height);\n    background: ",";\n    z-index: 1;\n    border: calc("," * 1px) solid transparent;\n  }\n"])),qp,od,Gu,rd)});var Xv;const em=[Ce(Xv||(Xv=Ht(["\n:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}\n"])))],tm={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"};var nm,om,rm,im,sm,am,lm,cm,dm,um=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},hm=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pm=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(ng,Ev,Nv,Jv);const fm=e=>e.isDirectory,gm=e=>"getAsEntry"in e&&"function"===typeof e.getAsEntry;let vm=class extends Lt{static get styles(){return em}get strings(){return tm}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}get _dropEffect(){return"copy"}constructor(){super(),this._dragCounter=0,this._maxChunkSize=4194304,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.onFileUploadChange=e=>{const t=e.target;!e||t.files.length<1||this.readUploadedFiles(t.files,(()=>t.value=null))},this.onFileUploadClick=()=>{this.renderRoot.querySelector("#file-upload-input").click()},this.handleonDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.dropEffect=e.dataTransfer.dropEffect=this._dropEffect)},this.handleonDragEnter=e=>{if(e.preventDefault(),e.stopPropagation(),this._dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0){e.dataTransfer.dropEffect=this._dropEffect;this.renderRoot.querySelector("#file-upload-border").classList.add("visible")}},this.handleonDragLeave=e=>{if(e.preventDefault(),e.stopPropagation(),this._dragCounter--,0===this._dragCounter){this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")}},this.handleonDrop=e=>{var t;e.preventDefault(),e.stopPropagation();const n=()=>{e.dataTransfer.clearData()};this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),(null===(t=e.dataTransfer)||void 0===t?void 0:t.items)&&this.readUploadedFiles(e.dataTransfer.items,n),this._dragCounter=0},this.filesToUpload=[]}render(){if(null!==this.parentElement){const e=this.parentElement;e.addEventListener("dragenter",this.handleonDragEnter),e.addEventListener("dragleave",this.handleonDragLeave),e.addEventListener("dragover",this.handleonDragOver),e.addEventListener("drop",this.handleonDrop)}return ot(nm||(nm=Ht(['\n        <div id="file-upload-dialog" class="file-upload-dialog">\n          \x3c!-- Modal content --\x3e\n          <fluent-dialog modal="true" class="file-upload-dialog-content">\n            <span\n              class="file-upload-dialog-close"\n              id="file-upload-dialog-close">\n                ','\n            </span>\n            <div class="file-upload-dialog-content-text">\n              <h2 class="file-upload-dialog-title">',"</h2>\n              <div>",'</div>\n                <fluent-checkbox\n                  id="file-upload-dialog-check"\n                  class="file-upload-dialog-check">\n                    ','\n                </fluent-checkbox>\n            </div>\n            <div class="file-upload-dialog-editor">\n              <fluent-button\n                appearance="accent"\n                class="file-upload-dialog-ok">\n                ','\n              </fluent-button>\n              <fluent-button\n                appearance="outline"\n                class="file-upload-dialog-cancel">\n                ','\n              </fluent-button>\n            </div>\n          </fluent-dialog>\n        </div>\n        <div id="file-upload-border"></div>\n        <div class="file-upload-area-button">\n          <input\n            id="file-upload-input"\n            title="','"\n            tabindex="-1"\n            aria-label="file upload input"\n            type="file"\n            multiple\n            @change="','"\n          />\n          <fluent-button\n            appearance="accent"\n            class="file-upload-button"\n            @click=',"\n            label=",'>\n              <span slot="start">','</span>\n              <span class="upload-text">','</span>\n          </fluent-button>\n        </div>\n        <div class="file-upload-template">\n          ',"\n        </div>\n       "])),ei(Xr.Cancel),this._dialogTitle,this._dialogContent,this._dialogCheckBox,this._dialogPrimaryButton,this._dialogSecondaryButton,this.strings.uploadButtonLabel,this.onFileUploadChange,this.onFileUploadClick,this.strings.uploadButtonLabel,ei(Xr.Upload),this.strings.buttonUploadFile,this.renderFolderTemplate(this.filesToUpload))}renderFolderTemplate(e){const t=[];if(e.length>0){const n=e.map((e=>-1===t.indexOf(e.fullPath.substring(0,e.fullPath.lastIndexOf("/")))?e.fullPath.endsWith("/")?ot(rm||(rm=Ht(["",""])),this.renderFileTemplate(e,"")):(t.push(e.fullPath.substring(0,e.fullPath.lastIndexOf("/"))),Sn(om||(om=Ht(["\n            <div class='file-upload-table'>\n              <div class='file-upload-cell'>\n                <mgt-file\n                  .fileDetails=","\n                  .view=",'\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n            ',""])),{name:e.fullPath.substring(1,e.fullPath.lastIndexOf("/")),folder:"Folder"},Vo.oneline,this.renderFileTemplate(e,"file-upload-folder-tab"))):ot(im||(im=Ht(["",""])),this.renderFileTemplate(e,"file-upload-folder-tab"))));return ot(sm||(sm=Ht(["",""])),n)}return ot(am||(am=Ht([""])))}renderFileTemplate(e,t){const n=Bn({"file-upload-table":!0,upload:e.completed}),o=t+("lastModifiedDateTime"===e.fieldUploadResponse?" file-upload-dialog-success":""),r=Bn({description:"description"===e.fieldUploadResponse}),i=e.completed?ot(lm||(lm=Ht([""]))):this.renderFileUploadTemplate(e);return Sn(cm||(cm=Ht(['\n        <div class="','">\n          <div class="',"\">\n            <div class='file-upload-cell'>\n              <div class=\"",'">\n                <div class="file-upload-status">\n                  ',"\n                </div>\n                <mgt-file\n                  .fileDetails=","\n                  .view=","\n                  .line2Property=",'\n                  part="upload"\n                  class="mgt-file-item">\n                </mgt-file>\n              </div>\n            </div>\n              ',"\n            </div>\n          </div>\n        </div>"])),n,o,r,e.iconStatus,e.driveItem,e.view,e.fieldUploadResponse,i)}renderFileUploadTemplate(e){const t=Bn({"file-upload-table":!0,upload:e.completed});return ot(dm||(dm=Ht(["\n    <div class='file-upload-cell'>\n      <div class='file-upload-table file-upload-name'>\n        <div class='file-upload-cell'>\n          <div\n            title=\"","\"\n            class='file-upload-filename'>\n            ","\n          </div>\n        </div>\n      </div>\n      <div class='file-upload-table'>\n        <div class='file-upload-cell'>\n          <div class=\"",'">\n            <fluent-progress class="file-upload-bar" value="',"\"></fluent-progress>\n            <div class='file-upload-cell percent-indicator'>\n              <span>",'%</span>\n              <span\n                class="file-upload-cancel"\n                @click=',">\n                ","\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    "])),e.file.name,e.file.name,t,e.percent,e.percent,(()=>this.deleteFileUploadSession(e)),ei(Xr.Cancel))}deleteFileUploadSession(e){return pm(this,void 0,void 0,(function*(){try{void 0!==e.uploadUrl?(yield(t=this.fileUploadList.graph,n=e.uploadUrl,pf(void 0,void 0,void 0,(function*(){try{yield t.client.api(n).middlewareOptions(ie("files.readwrite")).delete()}catch(e){return null}}))),e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,tm.cancelUploadFile)):(e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,tm.cancelUploadFile))}catch(o){e.uploadUrl=void 0,e.completed=!0,this.setUploadFail(e,tm.cancelUploadFile)}var t,n}))}readUploadedFiles(e,t){return pm(this,void 0,void 0,(function*(){const n=yield this.getFilesFromUploadArea(e);yield this.getSelectedFiles(n),t()}))}getSelectedFiles(e){return pm(this,void 0,void 0,(function*(){let t=[];const n=[];this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((e=>{e.completed?n.push(e):t.push(e)}));for(const r of e){const e=""===r.fullPath?"/"+r.name:r.fullPath;if(0===t.filter((t=>t.fullPath===e)).length){let n=!0;if(void 0!==this.fileUploadList.maxFileSize&&n&&r.size>1024*this.fileUploadList.maxFileSize&&(n=!1,!1===this._maximumFileSize)){const t=yield this.getFileUploadStatus(r,e,"MaxFileSize",this.fileUploadList);null!==t&&1===t[0]&&(this._maximumFileSize=!0)}if(void 0!==this.fileUploadList.excludedFileExtensions&&this.fileUploadList.excludedFileExtensions.length>0&&n&&this.fileUploadList.excludedFileExtensions.filter((e=>r.name.toLowerCase().indexOf(e.toLowerCase())>-1)).length>0&&(n=!1,!1===this._excludedFileType)){const t=yield this.getFileUploadStatus(r,e,"ExcludedFileType",this.fileUploadList);null!==t&&1===t[0]&&(this._excludedFileType=!0)}if(n){const n=yield this.getFileUploadStatus(r,e,"Upload",this.fileUploadList);let o=!1;null!==n&&(-1===n[0]?o=!0:(this._applyAll=Boolean(n[0]),this._applyAllConflictBehavior=n[1]?1:0)),t.push({file:r,driveItem:{name:r.name},fullPath:e,conflictBehavior:null!==n?n[1]?1:0:null,iconStatus:null,percent:1,view:Vo.image,completed:o,maxSize:this._maxChunkSize,minSize:0})}}}t=t.sort(((e,t)=>e.fullPath.substring(0,e.fullPath.lastIndexOf("/")).localeCompare(t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))))),t.forEach((e=>{if(0!==n.filter((t=>t.fullPath===e.fullPath)).length){const t=n.findIndex((t=>t.fullPath===e.fullPath));n.splice(t,1)}})),t.push(...n),this.filesToUpload=t;const o=this.filesToUpload.map((e=>this.sendFileItemGraph(e)));yield Promise.all(o)}))}getFileUploadStatus(e,t,n,o){const r=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return pm(this,void 0,void 0,(function*(){const i=this.renderRoot.querySelector("#file-upload-dialog");switch(n){case"Upload":return null!==(yield(s=this.fileUploadList.graph,a="".concat(this.getGrapQuery(t),"?$select=id"),pf(void 0,void 0,void 0,(function*(){try{return(yield s.api(a).middlewareOptions(ie("files.read")).get())||null}catch(e){}return null}))))?!0===this._applyAll?[this._applyAll,this._applyAllConflictBehavior]:(i.classList.add("visible"),this._dialogTitle=tm.fileReplaceTitle,this._dialogContent=tm.fileReplace.replace("{FileName}",e.name),this._dialogCheckBox=tm.checkApplyAll,this._dialogPrimaryButton=tm.buttonReplace,this._dialogSecondaryButton=tm.buttonKeep,yield r.requestStateUpdate.call(this,!0),new Promise((e=>{const t=this.renderRoot.querySelector(".file-upload-dialog-close"),n=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),r=this.renderRoot.querySelector("#file-upload-dialog-check");r.checked=!1,r.classList.remove("hide");const s=()=>{i.classList.remove("visible"),e([r.checked?1:0,1])},a=()=>{i.classList.remove("visible"),e([r.checked?1:0,0])},l=()=>{i.classList.remove("visible"),e([-1])};n.removeEventListener("click",s),o.removeEventListener("click",a),t.removeEventListener("click",l),n.addEventListener("click",s),o.addEventListener("click",a),t.addEventListener("click",l)}))):null;case"ExcludedFileType":return i.classList.add("visible"),this._dialogTitle=tm.fileTypeTitle,this._dialogContent=tm.fileType.replace("{FileName}",e.name)+" ("+o.excludedFileExtensions.join(",")+")",this._dialogCheckBox=tm.checkAgain,this._dialogPrimaryButton=tm.buttonOk,this._dialogSecondaryButton=tm.buttonCancel,yield r.requestStateUpdate.call(this,!0),new Promise((e=>{const t=this.renderRoot.querySelector(".file-upload-dialog-ok"),n=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),r=this.renderRoot.querySelector("#file-upload-dialog-check");r.checked=!1,r.classList.remove("hide");const s=()=>{i.classList.remove("visible"),e([r.checked?1:0])},a=()=>{i.classList.remove("visible"),e([0])};t.removeEventListener("click",s),n.removeEventListener("click",a),o.removeEventListener("click",a),t.addEventListener("click",s),n.addEventListener("click",a),o.addEventListener("click",a)}));case"MaxFileSize":return i.classList.add("visible"),this._dialogTitle=tm.maximumFileSizeTitle,this._dialogContent=tm.maximumFileSize.replace("{FileSize}",Qn(1024*o.maxFileSize)).replace("{FileName}",e.name)+Qn(e.size)+".",this._dialogCheckBox=tm.checkAgain,this._dialogPrimaryButton=tm.buttonOk,this._dialogSecondaryButton=tm.buttonCancel,yield r.requestStateUpdate.call(this,!0),new Promise((e=>{const t=this.renderRoot.querySelector(".file-upload-dialog-ok"),n=this.renderRoot.querySelector(".file-upload-dialog-cancel"),o=this.renderRoot.querySelector(".file-upload-dialog-close"),r=this.renderRoot.querySelector("#file-upload-dialog-check");r.checked=!1,r.classList.remove("hide");const s=()=>{i.classList.remove("visible"),e([r.checked?1:0])},a=()=>{i.classList.remove("visible"),e([0])};t.removeEventListener("click",s),n.removeEventListener("click",a),o.removeEventListener("click",a),t.addEventListener("click",s),n.addEventListener("click",a),o.addEventListener("click",a)}))}var s,a}))}getGrapQuery(e){let t="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(t=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?"/users/".concat(this.fileUploadList.userId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.userId&&this.fileUploadList.itemPath?"/users/".concat(this.fileUploadList.userId,"/drive/root:").concat(t).concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemId?"/groups/".concat(this.fileUploadList.groupId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.groupId&&this.fileUploadList.itemPath?"/groups/".concat(this.fileUploadList.groupId,"/drive/root:").concat(t).concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemId?"/drives/".concat(this.fileUploadList.driveId,"/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.driveId&&this.fileUploadList.itemPath?"/drives/".concat(this.fileUploadList.driveId,"/root:").concat(t).concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemId?"/sites/".concat(this.fileUploadList.siteId,"/drive/items/").concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.siteId&&this.fileUploadList.itemPath?"/sites/".concat(this.fileUploadList.siteId,"/drive/root:").concat(t).concat(e):this.fileUploadList.itemId?"/me/drive/items/".concat(this.fileUploadList.itemId,":").concat(e):this.fileUploadList.itemPath?"/me/drive/root:".concat(t).concat(e):"/me/drive/root:".concat(e)}sendFileItemGraph(e){return pm(this,void 0,void 0,(function*(){const t=this.fileUploadList.graph;let n="";if(e.file.size<this._maxChunkSize)try{e.completed||(null!==e.conflictBehavior&&1!==e.conflictBehavior||(n="".concat(this.getGrapQuery(e.fullPath),":/content")),0===e.conflictBehavior&&(n="".concat(this.getGrapQuery(e.fullPath),":/content?@microsoft.graph.conflictBehavior=rename")),e.driveItem=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){try{const r="files.readwrite";let i;try{i=yield e.client.api(t).middlewareOptions(ie(r)).put(n)}catch(o){}return i||null}catch(sL){return null}})))(t,n,e.file),null!==e.driveItem?this.setUploadSuccess(e):(e.driveItem={name:e.file.name},this.setUploadFail(e,tm.failUploadFile)))}catch(o){this.setUploadFail(e,tm.failUploadFile)}else if(!e.completed&&void 0===e.uploadUrl){const n=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){try{const r="files.readwrite",i={item:{"@microsoft.graph.conflictBehavior":0===n||null===n?"rename":"replace"}};let s;try{s=yield e.api(t).middlewareOptions(ie(r)).post(JSON.stringify(i))}catch(o){}return s||null}catch(sL){return null}})))(t,"".concat(this.getGrapQuery(e.fullPath),":/createUploadSession"),e.conflictBehavior);try{if(null!==n){e.uploadUrl=n.uploadUrl;const o=yield this.sendSessionUrlGraph(t,e);null!==o?(e.driveItem=o,this.setUploadSuccess(e)):this.setUploadFail(e,tm.failUploadFile)}else this.setUploadFail(e,tm.failUploadFile)}catch(r){}}}))}sendSessionUrlGraph(e,t){const n=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return pm(this,void 0,void 0,(function*(){for(;t.file.size>t.minSize;){void 0===t.mimeStreamString&&(t.mimeStreamString=yield this.readFileContent(t.file));const r=new Blob([t.mimeStreamString.slice(t.minSize,t.maxSize)]);if(t.percent=Math.round(t.maxSize/t.file.size*100),yield n.requestStateUpdate.call(this,!0),void 0===t.uploadUrl)return null;{const n=yield Tf(e,t.uploadUrl,"".concat(t.maxSize-t.minSize),"bytes ".concat(t.minSize,"-").concat(t.maxSize-1,"/").concat(t.file.size),r);if(null===n)return null;if(o=n,Array.isArray(o.nextExpectedRanges))t.minSize=parseInt(n.nextExpectedRanges[0].split("-")[0],10),t.maxSize=t.minSize+this._maxChunkSize,t.maxSize>t.file.size&&(t.maxSize=t.file.size);else if(void 0!==n.id)return n}}var o}))}setUploadSuccess(e){e.percent=100,super.requestStateUpdate(!0),setTimeout((()=>{e.iconStatus=ei(Xr.Success),e.view=Vo.twolines,e.fieldUploadResponse="lastModifiedDateTime",e.completed=!0,super.requestStateUpdate(!0),ff()}),500)}setUploadFail(e,t){setTimeout((()=>{e.iconStatus=ei(Xr.Fail),e.view=Vo.twolines,e.driveItem.description=t,e.fieldUploadResponse="description",e.completed=!0,super.requestStateUpdate(!0)}),500)}readFileContent(e){return new Promise(((t,n)=>{const o=new FileReader;o.onloadend=()=>{t(o.result)},o.onerror=e=>{n(e)},o.readAsArrayBuffer(e)}))}getFilesFromUploadArea(e){return pm(this,void 0,void 0,(function*(){const t=[];let n;const o=[];for(const i of e)if("getAsFile"in(r=i)&&"function"===typeof r.getAsFile||"webkitGetAsEntry"in r&&"function"===typeof r.webkitGetAsEntry)if(gm(i))if(n=i.getAsEntry(),fm(n))t.push(n);else{const e=i.getAsFile();e&&(this.writeFilePath(e,""),o.push(e))}else if(i.webkitGetAsEntry)if(n=i.webkitGetAsEntry(),fm(n))t.push(n);else{const e=i.getAsFile();e&&(this.writeFilePath(e,""),o.push(e))}else{const e=i.getAsFile();e&&(this.writeFilePath(e,""),o.push(e))}else this.writeFilePath(i,""),o.push(i);var r;if(t.length>0){const e=yield this.getFolderFiles(t);o.push(...e)}return o}))}getFolderFiles(e){return new Promise((t=>{let n=0;const o=[];e.forEach((e=>{r(e,"")}));const r=(e,r)=>{fm(e)?i(e.createReader()):(e=>e.isFile)(e)&&(n++,e.file((e=>{n--,this.writeFilePath(e,r),o.push(e),0===n&&t(o)})))},i=e=>{n++,e.readEntries((e=>{n--;for(const t of e)r(t,t.fullPath);0===n&&t(o)}))}}))}writeFilePath(e,t){e.fullPath=t}};var mm;um([Et({type:Object}),hm("design:type",Array)],vm.prototype,"filesToUpload",void 0),um([Et({type:Object}),hm("design:type",Object)],vm.prototype,"fileUploadList",void 0),vm=um([Tn("file-upload"),hm("design:paramtypes",[])],vm);const ym=[Ce(mm||(mm=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n'])))],bm={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};var wm,km,xm;var Cm,_m;const Sm=class extends Gf{}.compose({baseName:"progress-ring",template:(e,t)=>ec(wm||(wm=Ht(['\n    <template\n        role="progressbar"\n        aria-valuenow="','"\n        aria-valuemin="','"\n        aria-valuemax="','"\n        class="','"\n    >\n        ',"\n    </template>\n"])),(e=>e.value),(e=>e.min),(e=>e.max),(e=>e.paused?"paused":""),Yf((e=>"number"===typeof e.value),ec(km||(km=Ht(['\n                <svg\n                    class="progress"\n                    part="progress"\n                    viewBox="0 0 16 16"\n                    slot="determinate"\n                >\n                    <circle\n                        class="background"\n                        part="background"\n                        cx="8px"\n                        cy="8px"\n                        r="7px"\n                    ></circle>\n                    <circle\n                        class="determinate"\n                        part="determinate"\n                        style="stroke-dasharray: ',"px ",'px"\n                        cx="8px"\n                        cy="8px"\n                        r="7px"\n                    ></circle>\n                </svg>\n            '])),(e=>44*e.percentComplete/100),44),ec(xm||(xm=Ht(['\n                <slot name="indeterminate" slot="indeterminate">\n                    ',"\n                </slot>\n            "])),t.indeterminateIndicator||""))),styles:(e,t)=>xp(Cm||(Cm=Ht(["\n    "," :host {\n      align-items: center;\n      height: calc("," * 1px);\n      width: calc("," * 1px);\n    }\n\n    .progress {\n      height: 100%;\n      width: 100%;\n    }\n\n    .background {\n      fill: none;\n      stroke-width: 2px;\n    }\n\n    .determinate {\n      stroke: ",";\n      fill: none;\n      stroke-width: 2px;\n      stroke-linecap: round;\n      transform-origin: 50% 50%;\n      transform: rotate(-90deg);\n      transition: all 0.2s ease-in-out;\n    }\n\n    .indeterminate-indicator-1 {\n      stroke: ",";\n      fill: none;\n      stroke-width: 2px;\n      stroke-linecap: round;\n      transform-origin: 50% 50%;\n      transform: rotate(-90deg);\n      transition: all 0.2s ease-in-out;\n      animation: spin-infinite 2s linear infinite;\n    }\n\n    :host(.paused) .indeterminate-indicator-1 {\n      animation: none;\n      stroke: ",";\n    }\n\n    :host(.paused) .determinate {\n      stroke: ",";\n    }\n\n    @keyframes spin-infinite {\n      0% {\n        stroke-dasharray: 0.01px 43.97px;\n        transform: rotate(0deg);\n      }\n      50% {\n        stroke-dasharray: 21.99px 21.99px;\n        transform: rotate(450deg);\n      }\n      100% {\n        stroke-dasharray: 0.01px 43.97px;\n        transform: rotate(1080deg);\n      }\n    }\n  "])),Sp("flex"),Wg,Wg,Qu,Qu,Kh,Kh).withBehaviors(Ep(xp(_m||(_m=Ht(["\n        .background {\n          stroke: ",";\n        }\n        .determinate,\n        .indeterminate-indicator-1 {\n          stroke: ",";\n        }\n        :host(.paused) .determinate,\n        :host(.paused) .indeterminate-indicator-1 {\n          stroke: ",";\n        }\n      "])),Ap.Field,Ap.ButtonText,Ap.GrayText))),indeterminateIndicator:'\n    <svg class="progress" part="progress" viewBox="0 0 16 16">\n        <circle\n            class="background"\n            part="background"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n        <circle\n            class="indeterminate-indicator-1"\n            part="indeterminate-indicator-1"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n    </svg>\n  '});var Tm,Im,Em,Am,Rm,Pm,Om,Dm,Mm,Nm=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Lm=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Fm=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Sm);let Um=class extends Qt{static get styles(){return ym}get strings(){return bm}get fileListQuery(){return this._fileListQuery}set fileListQuery(e){e!==this._fileListQuery&&(this._fileListQuery=e,this.requestStateUpdate(!0))}get displayName(){return this.strings.filesSectionTitle}get cardTitle(){return this.strings.filesSectionTitle}renderIcon(){return ei(Xr.Files)}get fileQueries(){return this._fileQueries}set fileQueries(e){Vt(this._fileQueries,e)||(this._fileQueries=e,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(e){e!==this._siteId&&(this._siteId=e,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(e){e!==this._driveId&&(this._driveId=e,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(e){e!==this._groupId&&(this._groupId=e,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(e){e!==this._itemId&&(this._itemId=e,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(e){e!==this._itemPath&&(this._itemPath=e,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(e){e!==this._insightType&&(this._insightType=e,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(e){Vt(this._fileExtensions,e)||(this._fileExtensions=e,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(e){e!==this._pageSize&&(this._pageSize=e,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(e){e!==this._maxFileSize&&(this._maxFileSize=e,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(e){e!==this._maxUploadFile&&(this._maxUploadFile=e,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(e){Vt(this._excludedFileExtensions,e)||(this._excludedFileExtensions=e,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...Kf.requiredScopes])]}constructor(){super(),this._isCompact=!1,this.disableOpenOnClick=!1,this._focusedItemIndex=-1,this.onFocusFirstItem=()=>this._focusedItemIndex=0,this.onFileListKeyDown=e=>{const t=this.renderRoot.querySelector(".file-list");let n;if(null===t||void 0===t?void 0:t.children.length){if("ArrowUp"!==e.code&&"ArrowDown"!==e.code||("ArrowUp"===e.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=t.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+t.children.length)%t.children.length),"ArrowDown"===e.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%t.children.length),n=t.children[this._focusedItemIndex],this.updateItemBackgroundColor(t,n,"focused")),"Enter"===e.code||"Space"===e.code){n=t.children[this._focusedItemIndex];const o=n.children[0];e.preventDefault(),this.fireCustomEvent("itemClick",o.fileDetails),this.handleFileClick(o.fileDetails),this.updateItemBackgroundColor(t,n,"selected")}"Tab"===e.code&&(n=t.children[this._focusedItemIndex])}},this.pageSize=10,this.itemView=Vo.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}requestStateUpdate(e){return this.clearState(),super.requestStateUpdate(e)}clearState(){super.clearState(),this.files=null}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this._isCompact?this.renderCompactView():this.renderFullView():this.renderNoData()}renderCompactView(){const e=this.files.slice(0,3);return this.renderFiles(e)}renderFullView(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}renderLoading(){return this.renderTemplate("loading",null)||ot(Tm||(Tm=Ht([""])))}renderNoData(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==re.globalProvider?ot(Im||(Im=Ht(['\n            <div class="file-list-wrapper" dir=',">\n              ","\n            </div>"])),this.direction,this.renderFileUpload()):ot(Em||(Em=Ht([""]))))}renderFiles(e){return ot(Am||(Am=Ht(['\n      <div id="file-list-wrapper" class="file-list-wrapper" dir=',">\n        ",'\n        <ul\n          id="file-list"\n          class="file-list"\n        >\n          <li\n            tabindex="0"\n            class="file-item"\n            @keydown="','"\n            @focus="','"\n            @click=',">\n            ","\n          </li>\n          ","\n        </ul>\n        ","\n      </div>\n    "])),this.direction,this.enableFileUpload?this.renderFileUpload():null,this.onFileListKeyDown,this.onFocusFirstItem,(t=>this.handleItemSelect(e[0],t)),this.renderFile(e[0]),ss(e.slice(1),(e=>e.id),(e=>ot(Rm||(Rm=Ht(['\n              <li\n                class="file-item"\n                @keydown="','"\n                @click=',">\n                ","\n              </li>\n            "])),this.onFileListKeyDown,(t=>this.handleItemSelect(e,t)),this.renderFile(e)))),this.hideMoreFilesButton||!this.pageIterator||!this.pageIterator.hasNext&&!this._preloadedFiles.length||this._isCompact?null:this.renderMoreFileButton())}renderFile(e){const t=this.itemView;return this.renderTemplate("file",{file:e},e.id)||Sn(Pm||(Pm=Ht(['\n        <mgt-file class="mgt-file-item" .fileDetails='," .view=","></mgt-file>\n      "])),e,t)}renderMoreFileButton(){return this._isLoadingMore?ot(Om||(Om=Ht(['\n        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>\n      ']))):ot(Dm||(Dm=Ht(['\n        <fluent-button\n          appearance="stealth"\n          id="show-more"\n          class="show-more"\n          @click=','\n        >\n          <span class="show-more-text">',"</span>\n        </fluent-button>"])),(()=>this.renderNextPage()),this.strings.showMoreSubtitle)}renderFileUpload(){const e={graph:re.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return Sn(Mm||(Mm=Ht(["\n        <mgt-file-upload .fileUploadList="," ></mgt-file-upload>\n      "])),e)}loadState(){var e;return Fm(this,void 0,void 0,(function*(){const t=re.globalProvider;if(!t||t.state===te.Loading)return;if(t.state===te.SignedOut)return void(this.files=null);const n=t.graph.forComponent(this);let o,r;const i=!this.driveId&&!this.siteId&&!this.groupId&&!this.userId;if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let t;if(this.fileListQuery?r=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o=lo.stores.fileLists;return bf(e,t,o,["files.read","sites.read.all"],n)})))(n,this.fileListQuery,this.pageSize):this.fileQueries?o=yield((e,t)=>pf(void 0,void 0,void 0,(function*(){if(!t||0===t.length)return[];const n=e.createBatch(),o=[],r=["files.read"];let i,s;vf()&&(i=bn.getCache(ao,ao.stores.fileQueries));for(const e of t)vf()&&(s=yield i.getValue(e)),vf()&&s&&gf()>Date.now()-s.timeCached?o.push(JSON.parse(s.file)):""!==e&&n.get(e,e,r);try{const e=yield n.executeAll();for(const n of t){const t=e.get(n);(null===t||void 0===t?void 0:t.content)&&(o.push(t.content),vf()&&(yield i.putValue(n,{file:JSON.stringify(t.content)})))}return o}catch(Ye){try{return Promise.all(t.filter((e=>e&&""!==e)).map((t=>pf(void 0,void 0,void 0,(function*(){const n=yield yf(e,t);if(n)return vf()&&(yield i.putValue(t,{file:JSON.stringify(n)})),n})))))}catch(sL){return[]}}})))(n,this.fileQueries):i?this.itemId?r=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/me/drive/items/".concat(t,"/children"),r=lo.stores.fileLists;return bf(e,o,r,["files.read"],n)})))(n,this.itemId,this.pageSize):this.itemPath?r=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){const o="/me/drive/root:/".concat(t,":/children"),r=lo.stores.fileLists;return bf(e,o,r,["files.read"],n)})))(n,this.itemPath,this.pageSize):this.insightType?o=yield((e,t)=>pf(void 0,void 0,void 0,(function*(){const n="/me/insights/".concat(t),o=lo.stores.insightfileLists,r=bn.getCache(lo,o),i=yield _f(r,o,n);if(i)return i.files.map((e=>JSON.parse(e)));const s=["sites.read.all"];let a;try{a=yield e.api(n).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(ie(...s)).get()}catch(c){}const l=yield wf(e,a,s);return mf()&&(yield r.putValue(n,{files:l.map((e=>JSON.stringify(e)))})),l||null})))(n,this.insightType):r=yield((e,t)=>pf(void 0,void 0,void 0,(function*(){const n=lo.stores.fileLists;return bf(e,"/me/drive/root/children",n,["files.read"],t)})))(n,this.pageSize):this.driveId?this.itemId?r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/drives/".concat(t,"/items/").concat(n,"/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.driveId,this.itemId,this.pageSize):this.itemPath&&(r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/drives/".concat(t,"/root:/").concat(n,":/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/groups/".concat(t,"/drive/items/").concat(n,"/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.groupId,this.itemId,this.pageSize):this.itemPath&&(r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/groups/".concat(t,"/drive/root:/").concat(n,":/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/sites/".concat(t,"/drive/items/").concat(n,"/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.siteId,this.itemId,this.pageSize):this.itemPath&&(r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/sites/".concat(t,"/drive/root:/").concat(n,":/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/users/".concat(t,"/drive/items/").concat(n,"/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.userId,this.itemId,this.pageSize):this.itemPath?r=yield((e,t,n,o)=>pf(void 0,void 0,void 0,(function*(){const r="/users/".concat(t,"/drive/root:/").concat(n,":/children"),i=lo.stores.fileLists;return bf(e,r,i,["files.read"],o)})))(n,this.userId,this.itemPath,this.pageSize):this.insightType&&(o=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){let o,r;"shared"===n?(o="/me/insights/shared",r="((lastshared/sharedby/id eq '".concat(t,"') and (resourceReference/type eq 'microsoft.graph.driveItem'))")):(o="/users/".concat(t,"/insights/").concat(n),r="resourceReference/type eq 'microsoft.graph.driveItem'");const i="".concat(o,"?$filter=").concat(r),s=lo.stores.insightfileLists,a=bn.getCache(lo,s),l=yield _f(a,s,i);if(l)return l.files.map((e=>JSON.parse(e)));const c=["sites.read.all"];let d;try{d=yield e.api(o).filter(r).middlewareOptions(ie(...c)).get()}catch(h){}const u=yield wf(e,d,c);return mf()&&(yield a.putValue(o,{files:u.map((e=>JSON.stringify(e)))})),u||null})))(n,this.userId,this.insightType))),r&&(this.pageIterator=r,this._preloadedFiles=[...this.pageIterator.value],o=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(null===(e=this.pageIterator)||void 0===e?void 0:e.value){for(;this.pageIterator.hasNext;)yield Sf(this.pageIterator);o=this.pageIterator.value,this._preloadedFiles=[]}t=o.filter((e=>{for(const t of this.fileExtensions)if(t===this.getFileExtension(e.name))return e}))}(null===t||void 0===t?void 0:t.length)>=0?(this.files=t,this.pageSize&&(o=this.files.splice(0,this.pageSize),this.files=o)):this.files=o}}))}handleItemSelect(e,t){if(this.handleFileClick(e),this.fireCustomEvent("itemClick",e),t){const e=this.renderRoot.querySelector(".file-list"),n=Array.from(e.children),o=t.target.closest("li"),r=n.indexOf(o);this._focusedItemIndex=r;const i=e.children[this._focusedItemIndex];this.updateItemBackgroundColor(e,i,"selected")}}renderNextPage(){return Fm(this,void 0,void 0,(function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;const e=this.renderRoot.querySelector("#file-list-wrapper");(null===e||void 0===e?void 0:e.animate)&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield Sf(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()}))}handleFileClick(e){(null===e||void 0===e?void 0:e.webUrl)&&!this.disableOpenOnClick&&window.open(e.webUrl,"_blank","noreferrer")}getFileExtension(e){return/(?:\.([^.]+))?$/.exec(e)[1]||""}updateItemBackgroundColor(e,t,n){for(const o of e.children)o.classList.remove(n),o.removeAttribute("tabindex");t&&(t.classList.add(n),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),t.setAttribute("tabindex","0"),t.focus());for(const o of e.children)o.classList.remove("selected")}reload(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&ff(),this.requestStateUpdate(!0)}};Nm([At(),Lm("design:type",Object)],Um.prototype,"_isCompact",void 0),Nm([Et({attribute:"file-list-query"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"fileListQuery",null),Nm([Et({attribute:"file-queries",converter:(e,t)=>e?e.split(",").map((e=>e.trim())):null}),Lm("design:type",Array),Lm("design:paramtypes",[Array])],Um.prototype,"fileQueries",null),Nm([Et({type:Object}),Lm("design:type",Array)],Um.prototype,"files",void 0),Nm([Et({attribute:"site-id"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"siteId",null),Nm([Et({attribute:"drive-id"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"driveId",null),Nm([Et({attribute:"group-id"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"groupId",null),Nm([Et({attribute:"item-id"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"itemId",null),Nm([Et({attribute:"item-path"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"itemPath",null),Nm([Et({attribute:"user-id"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"userId",null),Nm([Et({attribute:"insight-type"}),Lm("design:type",String),Lm("design:paramtypes",[String])],Um.prototype,"insightType",null),Nm([Et({attribute:"item-view",converter:e=>e&&0!==e.length?(e=e.toLowerCase(),"undefined"===typeof Vo[e]?Vo.threelines:Vo[e]):Vo.threelines}),Lm("design:type",Number)],Um.prototype,"itemView",void 0),Nm([Et({attribute:"file-extensions",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),Lm("design:type",Array),Lm("design:paramtypes",[Array])],Um.prototype,"fileExtensions",null),Nm([Et({attribute:"page-size",type:Number}),Lm("design:type",Number),Lm("design:paramtypes",[Number])],Um.prototype,"pageSize",null),Nm([Et({attribute:"disable-open-on-click",type:Boolean}),Lm("design:type",Object)],Um.prototype,"disableOpenOnClick",void 0),Nm([Et({attribute:"hide-more-files-button",type:Boolean}),Lm("design:type",Boolean)],Um.prototype,"hideMoreFilesButton",void 0),Nm([Et({attribute:"max-file-size",type:Number}),Lm("design:type",Number),Lm("design:paramtypes",[Number])],Um.prototype,"maxFileSize",null),Nm([Et({attribute:"enable-file-upload",type:Boolean}),Lm("design:type",Boolean)],Um.prototype,"enableFileUpload",void 0),Nm([Et({attribute:"max-upload-file",type:Number}),Lm("design:type",Number),Lm("design:paramtypes",[Number])],Um.prototype,"maxUploadFile",null),Nm([Et({attribute:"excluded-file-extensions",converter:(e,t)=>e.split(",").map((e=>e.trim()))}),Lm("design:type",Array),Lm("design:paramtypes",[Array])],Um.prototype,"excludedFileExtensions",null),Nm([At(),Lm("design:type",Boolean)],Um.prototype,"_isLoadingMore",void 0),Um=Nm([Tn("file-list"),Lm("design:paramtypes",[])],Um);const zm={comboboxPlaceholder:"Select an item"};let Hm=0;function qm(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").concat(Hm++)}function Bm(e,t,n){return Math.min(Math.max(n,e),t)}function Vm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[t,n]=[t,n].sort(((e,t)=>e-t)),t<=e&&e<n}function jm(e){return jg(e)&&("option"===e.getAttribute("role")||e instanceof HTMLOptionElement)}class Km extends Wa{constructor(e,t,n,o){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,e&&(this.textContent=e),t&&(this.initialValue=t),n&&(this.defaultSelected=n),o&&(this.selected=o),this.proxy=new Option("".concat(this.textContent),this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(e,t){this.ariaChecked="boolean"!==typeof t?null:t?"true":"false"}contentChanged(e,t){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(e,t){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(e,t){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var e;return null!==(e=this.value)&&void 0!==e?e:this.text}get text(){var e,t;return null!==(t=null===(e=this.textContent)||void 0===e?void 0:e.replace(/\s+/g," ").trim())&&void 0!==t?t:""}set value(e){const t="".concat(null!==e&&void 0!==e?e:"");this._value=t,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=t),Ds.notify(this,"value")}get value(){var e;return Ds.track(this,"value"),null!==(e=this._value)&&void 0!==e?e:this.text}get form(){return this.proxy?this.proxy.form:null}}ta([Ms],Km.prototype,"checked",void 0),ta([Ms],Km.prototype,"content",void 0),ta([Ms],Km.prototype,"defaultSelected",void 0),ta([Ys({mode:"boolean"})],Km.prototype,"disabled",void 0),ta([Ys({attribute:"selected",mode:"boolean"})],Km.prototype,"selectedAttribute",void 0),ta([Ms],Km.prototype,"selected",void 0),ta([Ys({attribute:"value",mode:"fromView"})],Km.prototype,"initialValue",void 0);class Gm{}ta([Ms],Gm.prototype,"ariaChecked",void 0),ta([Ms],Gm.prototype,"ariaPosInSet",void 0),ta([Ms],Gm.prototype,"ariaSelected",void 0),ta([Ms],Gm.prototype,"ariaSetSize",void 0),gg(Gm,og),gg(Km,dg,Gm);class $m extends Wa{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var e;return null!==(e=this.selectedOptions[0])&&void 0!==e?e:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every((e=>e.disabled))}get length(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.length)&&void 0!==t?t:0}get options(){return Ds.track(this,"options"),this._options}set options(e){this._options=e,Ds.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(e){this.typeaheadExpired=e}clickHandler(e){const t=e.target.closest("option,[role=option]");if(t&&!t.disabled)return this.selectedIndex=this.options.indexOf(t),!0}focusAndScrollOptionIntoView(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.firstSelectedOption;this.contains(document.activeElement)&&null!==e&&(e.focus(),requestAnimationFrame((()=>{e.scrollIntoView({block:"nearest"})})))}focusinHandler(e){this.shouldSkipFocus||e.target!==e.currentTarget||(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){const e=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),t=new RegExp("^".concat(e),"gi");return this.options.filter((e=>e.text.trim().match(t)))}getSelectableIndex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedIndex,t=arguments.length>1?arguments[1]:void 0;const n=e>t?-1:e<t?1:0,o=e+n;let r=null;switch(n){case-1:r=this.options.reduceRight(((e,t,n)=>!e&&!t.disabled&&n<o?t:e),r);break;case 1:r=this.options.reduce(((e,t,n)=>!e&&!t.disabled&&n>o?t:e),r)}return this.options.indexOf(r)}handleChange(e,t){if("selected"===t)$m.slottedOptionFilter(e)&&(this.selectedIndex=this.options.indexOf(e)),this.setSelectedOptions()}handleTypeAhead(e){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout((()=>this.typeaheadExpired=!0),$m.TYPE_AHEAD_TIMEOUT_MS),e.length>1||(this.typeaheadBuffer="".concat(this.typeaheadExpired?"":this.typeaheadBuffer).concat(e))}keydownHandler(e){if(this.disabled)return!0;this.shouldSkipFocus=!1;const t=e.key;switch(t){case Cg:e.shiftKey||(e.preventDefault(),this.selectFirstOption());break;case mg:e.shiftKey||(e.preventDefault(),this.selectNextOption());break;case wg:e.shiftKey||(e.preventDefault(),this.selectPreviousOption());break;case _g:e.preventDefault(),this.selectLastOption();break;case Tg:return this.focusAndScrollOptionIntoView(),!0;case kg:case xg:return!0;case Sg:if(this.typeaheadExpired)return!0;default:return 1===t.length&&this.handleTypeAhead("".concat(t)),!0}}mousedownHandler(e){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(e,t){this.ariaMultiSelectable=t?"true":null}selectedIndexChanged(e,t){var n;if(this.hasSelectableOptions){if((null===(n=this.options[this.selectedIndex])||void 0===n?void 0:n.disabled)&&"number"===typeof e){const n=this.getSelectableIndex(e,t),o=n>-1?n:e;return this.selectedIndex=o,void(t===o&&this.selectedIndexChanged(t,o))}this.setSelectedOptions()}else this.selectedIndex=-1}selectedOptionsChanged(e,t){var n;const o=t.filter($m.slottedOptionFilter);null===(n=this.options)||void 0===n||n.forEach((e=>{const t=Ds.getNotifier(e);t.unsubscribe(this,"selected"),e.selected=o.includes(e),t.subscribe(this,"selected")}))}selectFirstOption(){var e,t;this.disabled||(this.selectedIndex=null!==(t=null===(e=this.options)||void 0===e?void 0:e.findIndex((e=>!e.disabled)))&&void 0!==t?t:-1)}selectLastOption(){this.disabled||(this.selectedIndex=function(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return n;return-1}(this.options,(e=>!e.disabled)))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var e,t;this.selectedIndex=null!==(t=null===(e=this.options)||void 0===e?void 0:e.findIndex((e=>e.defaultSelected)))&&void 0!==t?t:-1}setSelectedOptions(){var e,t,n;(null===(e=this.options)||void 0===e?void 0:e.length)&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=null!==(n=null===(t=this.firstSelectedOption)||void 0===t?void 0:t.id)&&void 0!==n?n:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(e,t){this.options=t.reduce(((e,t)=>(jm(t)&&e.push(t),e)),[]);const n="".concat(this.options.length);this.options.forEach(((e,t)=>{e.id||(e.id=qm("option-")),e.ariaPosInSet="".concat(t+1),e.ariaSetSize=n})),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(e,t){if(this.$fastController.isConnected){const e=this.getTypeaheadMatches();if(e.length){const t=this.options.indexOf(e[0]);t>-1&&(this.selectedIndex=t)}this.typeaheadExpired=!1}}}$m.slottedOptionFilter=e=>jm(e)&&!e.hidden,$m.TYPE_AHEAD_TIMEOUT_MS=1e3,ta([Ys({mode:"boolean"})],$m.prototype,"disabled",void 0),ta([Ms],$m.prototype,"selectedIndex",void 0),ta([Ms],$m.prototype,"selectedOptions",void 0),ta([Ms],$m.prototype,"slottedOptions",void 0),ta([Ms],$m.prototype,"typeaheadBuffer",void 0);class Wm{}ta([Ms],Wm.prototype,"ariaActiveDescendant",void 0),ta([Ms],Wm.prototype,"ariaDisabled",void 0),ta([Ms],Wm.prototype,"ariaExpanded",void 0),ta([Ms],Wm.prototype,"ariaMultiSelectable",void 0),gg(Wm,og),gg($m,Wm);const Qm="above",Ym="below";class Zm extends $m{}class Jm extends(Og(Zm)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const Xm="inline",ey="list",ty="both",ny="none";class oy extends Jm{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=qm("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===Xm||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===ey||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===ty}openChanged(){if(this.open)return this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),void Rs.queueUpdate((()=>this.focus()));this.ariaControls="",this.ariaExpanded="false"}get options(){return Ds.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(e){this._options=e,Ds.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}get value(){return Ds.track(this,"value"),this._value}set value(e){var t,n,o;const r="".concat(this._value);if(this.$fastController.isConnected&&this.options){const r=this.options.findIndex((t=>t.text.toLowerCase()===e.toLowerCase())),i=null===(t=this.options[this.selectedIndex])||void 0===t?void 0:t.text,s=null===(n=this.options[r])||void 0===n?void 0:n.text;this.selectedIndex=i!==s?r:this.selectedIndex,e=(null===(o=this.firstSelectedOption)||void 0===o?void 0:o.text)||e}r!==e&&(this._value=e,super.valueChanged(r,e),Ds.notify(this,"value"))}clickHandler(e){if(!this.disabled){if(this.open){const t=e.target.closest("option,[role=option]");if(!t||t.disabled)return;this.selectedOptions=[t],this.control.value=t.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){this.autocomplete&&this.autocomplete!==ny||(this.filter="");const e=this.filter.toLowerCase();this.filteredOptions=this._options.filter((e=>e.text.toLowerCase().startsWith(this.filter.toLowerCase()))),this.isAutocompleteList&&(this.filteredOptions.length||e||(this.filteredOptions=this._options),this._options.forEach((e=>{e.hidden=!this.filteredOptions.includes(e)})))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame((()=>{var e;null===(e=this.firstSelectedOption)||void 0===e||e.scrollIntoView({block:"nearest"})})))}focusoutHandler(e){if(this.syncValue(),!this.open)return!0;const t=e.relatedTarget;this.isSameNode(t)?this.focus():this.options&&this.options.includes(t)||(this.open=!1)}inputHandler(e){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map((e=>e.text)).indexOf(this.control.value)),e.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(e){const t=e.key;if(e.ctrlKey||e.shiftKey)return!0;switch(t){case"Enter":this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break;case"Escape":if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break;case"Tab":if(this.setInputToSelection(),!this.open)return!0;e.preventDefault(),this.open=!1;break;case"ArrowUp":case"ArrowDown":if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(e),this.isAutocompleteInline&&this.setInlineSelection();break;default:return!0}}keyupHandler(e){switch(e.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions()}}selectedIndexChanged(e,t){if(this.$fastController.isConnected){if((t=Bm(-1,this.options.length-1,t))!==this.selectedIndex)return void(this.selectedIndex=t);super.selectedIndexChanged(e,t)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){const e=this.options.findIndex((e=>null!==e.getAttribute("selected")||e.selected));this.selectedIndex=e,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var e;const t=this.selectedIndex>-1?null===(e=this.firstSelectedOption)||void 0===e?void 0:e.text:this.control.value;this.updateValue(this.value!==t)}setPositioning(){const e=this.getBoundingClientRect(),t=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>t?Qm:Ym,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Qm?~~e.top:~~t}selectedOptionsChanged(e,t){this.$fastController.isConnected&&this._options.forEach((e=>{e.selected=t.includes(e)}))}slottedOptionsChanged(e,t){super.slottedOptionsChanged(e,t),this.updateValue()}updateValue(e){var t;this.$fastController.isConnected&&(this.value=(null===(t=this.firstSelectedOption)||void 0===t?void 0:t.text)||this.control.value,this.control.value=this.value),e&&this.$emit("change")}clearSelectionRange(){const e=this.control.value.length;this.control.setSelectionRange(e,e)}}ta([Ys({attribute:"autocomplete",mode:"fromView"})],oy.prototype,"autocomplete",void 0),ta([Ms],oy.prototype,"maxHeight",void 0),ta([Ys({attribute:"open",mode:"boolean"})],oy.prototype,"open",void 0),ta([Ys],oy.prototype,"placeholder",void 0),ta([Ys({attribute:"position"})],oy.prototype,"positionAttribute",void 0),ta([Ms],oy.prototype,"position",void 0);class ry{}var iy;ta([Ms],ry.prototype,"ariaAutoComplete",void 0),ta([Ms],ry.prototype,"ariaControls",void 0),gg(ry,Wm),gg(oy,dg,ry);var sy,ay,ly,cy,dy;const uy=gl.create("input-placeholder-rest").withDefault((e=>{const t=yh.getValueFor(e);return jh.getValueFor(e).evaluate(e,t.evaluate(e).rest)})),hy=gl.create("input-placeholder-hover").withDefault((e=>{const t=yh.getValueFor(e);return jh.getValueFor(e).evaluate(e,t.evaluate(e).hover)})),py=gl.create("input-filled-placeholder-rest").withDefault((e=>{const t=Ah.getValueFor(e);return jh.getValueFor(e).evaluate(e,t.evaluate(e).rest)})),fy=gl.create("input-filled-placeholder-hover").withDefault((e=>{const t=Ah.getValueFor(e);return jh.getValueFor(e).evaluate(e,t.evaluate(e).hover)})),gy=(e,t,n)=>xp(sy||(sy=Ht(["\n  :host {\n    ","\n    color: ",";\n    fill: currentcolor;\n    user-select: none;\n    position: relative;\n  }\n\n  "," {\n    box-sizing: border-box;\n    position: relative;\n    color: inherit;\n    border: calc("," * 1px) solid transparent;\n    border-radius: calc("," * 1px);\n    height: calc("," * 1px);\n    font-family: inherit;\n    font-size: inherit;\n    line-height: inherit;\n  }\n\n  .control {\n    width: 100%;\n    outline: none;\n  }\n\n  .label {\n    display: block;\n    color: ",";\n    cursor: pointer;\n    ","\n    margin-bottom: 4px;\n  }\n\n  .label__hidden {\n    display: none;\n    visibility: hidden;\n  }\n\n  :host([disabled]) ",",\n  :host([readonly]) ",",\n  :host([disabled]) .label,\n  :host([readonly]) .label,\n  :host([disabled]) .control,\n  :host([readonly]) .control {\n    cursor: ",";\n  }\n\n  :host([disabled]) {\n    opacity: ",";\n  }\n"])),rv,qh,n,rd,nd,Wg,qh,rv,n,n,Vg,Jc),vy=(e,t,n)=>xp(ay||(ay=Ht(["\n  @media (forced-colors: none) {\n    :host(:not([disabled]):active)::after {\n      left: 50%;\n      width: 40%;\n      transform: translateX(-50%);\n      border-bottom-left-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n\n    :host(:not([disabled]):focus-within)::after {\n      left: 0;\n      width: 100%;\n      transform: none;\n    }\n\n    :host(:not([disabled]):active)::after,\n    :host(:not([disabled]):focus-within:not(:active))::after {\n      content: '';\n      position: absolute;\n      height: calc("," * 1px);\n      bottom: 0;\n      border-bottom: calc("," * 1px) solid ",";\n      border-bottom-left-radius: calc("," * 1px);\n      border-bottom-right-radius: calc("," * 1px);\n      z-index: 2;\n      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);\n    }\n  }\n"])),id,id,Qu,nd,nd),my=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:":not([disabled]):not(:focus-within)";return xp(ly||(ly=Ht(["\n  "," {\n    background: padding-box linear-gradient(",", ","),\n      border-box ",";\n  }\n\n  :host(",":hover) "," {\n    background: padding-box linear-gradient(",", ","),\n      border-box ",";\n  }\n\n  :host(:not([disabled]):focus-within) "," {\n    background: padding-box linear-gradient(",", ","),\n      border-box ",";\n  }\n  \n  :host([disabled]) "," {\n    background: padding-box linear-gradient(",", ","),\n      border-box ",";\n  }\n\n  .control::placeholder {\n    color: ",";\n  }\n\n  :host(",":hover) .control::placeholder {\n    color: ",";\n  }\n"])),n,bh,bh,op,o,n,wh,wh,rp,n,kh,kh,op,n,bh,bh,$h,uy,o,hy)},yy=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:":not([disabled]):not(:focus-within)";return xp(cy||(cy=Ht(["\n  "," {\n    background: ",";\n  }\n\n  :host(",":hover) "," {\n    background: ",";\n  }\n\n  :host(:not([disabled]):focus-within) "," {\n    background: ",";\n  }\n\n  :host([disabled]) "," {\n    background: ",";\n  }\n\n  .control::placeholder {\n    color: ",";\n  }\n\n  :host(",":hover) .control::placeholder {\n    color: ",";\n  }\n"])),n,Rh,o,n,Ph,n,Dh,n,Rh,py,o,fy)},by=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:":not([disabled]):not(:focus-within)";return xp(dy||(dy=Ht(["\n  :host {\n    color: ",";\n  }\n\n  "," {\n    background: ",";\n    border-color: ",";\n  }\n\n  :host(",":hover) ",",\n  :host(:not([disabled]):focus-within) "," {\n    border-color: ",";\n  }\n\n  :host([disabled]) "," {\n    opacity: 1;\n    background: ",";\n    border-color: ",";\n  }\n\n  .control::placeholder,\n  :host(",":hover) .control::placeholder {\n    color: ",";\n  }\n\n  :host(:not([disabled]):focus) "," {\n    ","\n    outline-color: ",";\n  }\n\n  :host([disabled]) {\n    opacity: 1;\n    color: ",";\n  }\n\n  :host([disabled]) ::placeholder,\n  :host([disabled]) ::-webkit-input-placeholder {\n    color: ",";\n  }\n"])),Ap.ButtonText,n,Ap.ButtonFace,Ap.ButtonText,o,n,n,Ap.Highlight,n,Ap.ButtonFace,Ap.GrayText,o,Ap.CanvasText,n,av,Ap.Highlight,Ap.GrayText,Ap.GrayText)};var wy,ky;const xy=".control",Cy=":not([disabled]):not([open])",_y="[disabled]",Sy=(e,t)=>xp(wy||(wy=Ht(["\n    ","\n    \n    :host {\n      border-radius: calc("," * 1px);\n      box-sizing: border-box;\n      color: ",";\n      fill: currentcolor;\n      font-family: ",";\n      position: relative;\n      user-select: none;\n      min-width: 250px;\n      vertical-align: top;\n    }\n\n    .listbox {\n      box-shadow: ",";\n      background: ",";\n      border-radius: calc("," * 1px);\n      box-sizing: border-box;\n      display: inline-flex;\n      flex-direction: column;\n      left: 0;\n      max-height: calc(var(--max-height) - ("," * 1px));\n      padding: calc(("," - "," ) * 1px);\n      overflow-y: auto;\n      position: absolute;\n      width: 100%;\n      z-index: 1;\n      margin: 1px 0;\n      border: calc("," * 1px) solid transparent;\n    }\n\n    .listbox[hidden] {\n      display: none;\n    }\n\n    .control {\n      border: calc("," * 1px) solid transparent;\n      border-radius: calc("," * 1px);\n      height: calc("," * 1px);\n      align-items: center;\n      box-sizing: border-box;\n      cursor: pointer;\n      display: flex;\n      ","\n      min-height: 100%;\n      padding: 0 calc("," * 2.25px);\n      width: 100%;\n    }\n\n    :host(:",") {\n      ","\n    }\n\n    :host([disabled]) .control {\n      cursor: ",";\n      opacity: ",";\n      user-select: none;\n    }\n\n    :host([open][position='above']) .listbox {\n      bottom: calc(("," + "," * 2) * 1px);\n    }\n\n    :host([open][position='below']) .listbox {\n      top: calc(("," + "," * 2) * 1px);\n    }\n\n    .selected-value {\n      font-family: inherit;\n      flex: 1 1 auto;\n      text-align: start;\n    }\n\n    .indicator {\n      flex: 0 0 auto;\n      margin-inline-start: 1em;\n    }\n\n    slot[name='listbox'] {\n      display: none;\n      width: 100%;\n    }\n\n    :host([open]) slot[name='listbox'] {\n      display: flex;\n      position: absolute;\n    }\n\n    .start {\n      margin-inline-end: 11px;\n    }\n\n    .end {\n      margin-inline-start: 11px;\n    }\n\n    .start,\n    .end,\n    .indicator,\n    ::slotted(svg) {\n      display: flex;\n    }\n\n    ::slotted([role='option']) {\n      flex: 0 0 auto;\n    }\n  "])),Sp("inline-flex"),nd,qh,sd,zp,Gu,od,Wg,td,rd,rd,rd,nd,Wg,rv,td,Gg,av,Vg,Jc,Wg,td,Wg,td);var Ty;const Iy=".control",Ey=":not([disabled]):not([open])";class Ay extends oy{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Gu.setValueFor(this.listbox,Hu)}}i([Ys({mode:"fromView"})],Ay.prototype,"appearance",void 0);const Ry=Ay.compose({baseName:"combobox",baseClass:oy,shadowOptions:{delegatesFocus:!0},template:(e,t)=>ec(iy||(iy=Ht(['\n    <template\n        aria-disabled="','"\n        autocomplete="','"\n        class="'," "," ",'"\n        ?open="','"\n        tabindex="','"\n        @click="','"\n        @focusout="','"\n        @keydown="','"\n    >\n        <div class="control" part="control">\n            ','\n            <slot name="control">\n                <input\n                    aria-activedescendant="','"\n                    aria-autocomplete="','"\n                    aria-controls="','"\n                    aria-disabled="','"\n                    aria-expanded="','"\n                    aria-haspopup="listbox"\n                    class="selected-value"\n                    part="selected-value"\n                    placeholder="','"\n                    role="combobox"\n                    type="text"\n                    ?disabled="','"\n                    :value="','"\n                    @input="','"\n                    @keyup="','"\n                    ','\n                />\n                <div class="indicator" part="indicator" aria-hidden="true">\n                    <slot name="indicator">\n                        ',"\n                    </slot>\n                </div>\n            </slot>\n            ",'\n        </div>\n        <div\n            class="listbox"\n            id="','"\n            part="listbox"\n            role="listbox"\n            ?disabled="','"\n            ?hidden="','"\n            ',"\n        >\n            <slot\n                ","\n            ></slot>\n        </div>\n    </template>\n"])),(e=>e.ariaDisabled),(e=>e.autocomplete),(e=>e.open?"open":""),(e=>e.disabled?"disabled":""),(e=>e.position),(e=>e.open),(e=>e.disabled?null:"0"),((e,t)=>e.clickHandler(t.event)),((e,t)=>e.focusoutHandler(t.event)),((e,t)=>e.keydownHandler(t.event)),hg(0,t),(e=>e.open?e.ariaActiveDescendant:null),(e=>e.ariaAutoComplete),(e=>e.ariaControls),(e=>e.ariaDisabled),(e=>e.ariaExpanded),(e=>e.placeholder),(e=>e.disabled),(e=>e.value),((e,t)=>e.inputHandler(t.event)),((e,t)=>e.keyupHandler(t.event)),ig("control"),t.indicator||"",ug(0,t),(e=>e.listboxId),(e=>e.disabled),(e=>!e.open),ig("listbox"),qg({filter:$m.slottedOptionFilter,flatten:!0,property:"slottedOptions"})),styles:(e,t)=>xp(Ty||(Ty=Ht(["\n    ","\n\n    ","\n\n    :host(:empty) .listbox {\n      display: none;\n    }\n\n    :host([disabled]) *,\n    :host([disabled]) {\n      cursor: ",";\n      user-select: none;\n    }\n\n    :host(:active) .selected-value {\n      user-select: none;\n    }\n\n    .selected-value {\n      -webkit-appearance: none;\n      background: transparent;\n      border: none;\n      color: inherit;\n      ","\n      height: calc(100% - "," * 1px));\n      margin: auto 0;\n      width: 100%;\n      outline: none;\n    }\n  "])),Sy(),vy(),Vg,rv,rd).withBehaviors(Cv("outline",my(e,t,Iy,Ey)),Cv("filled",yy(e,t,Iy,Ey)),Ep(by(e,t,Iy,Ey))),indicator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>\n    </svg>\n  '});var Py;class Oy{constructor(e,t){this.cache=new WeakMap,this.ltr=e,this.rtl=t}bind(e){this.attach(e)}unbind(e){const t=this.cache.get(e);t&&Zc.unsubscribe(t)}attach(e){const t=this.cache.get(e)||new Dy(this.ltr,this.rtl,e),n=Zc.getValueFor(e);Zc.subscribe(t),t.attach(n),this.cache.set(e,t)}}class Dy{constructor(e,t,n){this.ltr=e,this.rtl=t,this.source=n,this.attached=null}handleChange(e){let{target:t,token:n}=e;this.attach(n.getValueFor(this.source))}attach(e){this.attached!==this[e]&&(null!==this.attached&&this.source.$fastController.removeStyles(this.attached),this.attached=this[e],null!==this.attached&&this.source.$fastController.addStyles(this.attached))}}var My,Ny,Ly;const Fy=Km.compose({baseName:"option",template:(e,t)=>ec(Py||(Py=Ht(['\n    <template\n        aria-checked="','"\n        aria-disabled="','"\n        aria-posinset="','"\n        aria-selected="','"\n        aria-setsize="','"\n        class="','"\n        role="option"\n    >\n        ','\n        <span class="content" part="content">\n            <slot ',"></slot>\n        </span>\n        ","\n    </template>\n"])),(e=>e.ariaChecked),(e=>e.ariaDisabled),(e=>e.ariaPosInSet),(e=>e.ariaSelected),(e=>e.ariaSetSize),(e=>[e.checked&&"checked",e.selected&&"selected",e.disabled&&"disabled"].filter(Boolean).join(" ")),hg(0,t),qg("content"),ug(0,t)),styles:(e,t)=>xp(My||(My=Ht(["\n    "," :host {\n      position: relative;\n      ","\n      background: ",";\n      border-radius: calc("," * 1px);\n      border: calc("," * 1px) solid transparent;\n      box-sizing: border-box;\n      color: ",";\n      cursor: pointer;\n      fill: currentcolor;\n      height: calc("," * 1px);\n      overflow: hidden;\n      align-items: center;\n      padding: 0 calc((("," * 3) - "," - 1) * 1px);\n      user-select: none;\n      white-space: nowrap;\n    }\n\n    :host::before {\n      content: '';\n      display: block;\n      position: absolute;\n      left: calc(("," - ",") * 1px);\n      top: calc(("," / 4) - "," * 1px);\n      width: 3px;\n      height: calc(("," / 2) * 1px);\n      background: transparent;\n      border-radius: calc("," * 1px);\n    }\n\n    :host(:not([disabled]):hover) {\n      background: ",";\n    }\n\n    :host(:not([disabled]):active) {\n      background: ",";\n    }\n\n    :host(:not([disabled]):active)::before {\n      background: ",";\n      height: calc((("," / 2) - 6) * 1px);\n    }\n\n    :host([aria-selected='true'])::before {\n      background: ",";\n    }\n\n    :host(:",") {\n      ","\n      background: ",";\n    }\n\n    :host([aria-selected='true']) {\n      background: ",";\n    }\n\n    :host(:not([disabled])[aria-selected='true']:hover) {\n      background: ",";\n    }\n\n    :host(:not([disabled])[aria-selected='true']:active) {\n      background: ",";\n    }\n\n    :host(:not([disabled]):not([aria-selected='true']):hover) {\n      background: ",";\n    }\n\n    :host(:not([disabled]):not([aria-selected='true']):active) {\n      background: ",";\n    }\n\n    :host([disabled]) {\n      cursor: ",";\n      opacity: ",";\n    }\n\n    .content {\n      grid-column-start: 2;\n      justify-self: start;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .start,\n    .end,\n    ::slotted(svg) {\n      display: flex;\n    }\n\n    ::slotted([slot='end']) {\n      margin-inline-start: 1ch;\n    }\n\n    ::slotted([slot='start']) {\n      margin-inline-end: 1ch;\n    }\n  "])),Sp("inline-flex"),rv,Nh,nd,rd,qh,Wg,td,rd,id,rd,Wg,id,Wg,nd,Lh,Fh,Qu,Wg,Qu,Gg,av,Uh,Rh,Ph,Oh,Lh,Fh,Vg,Jc).withBehaviors(new Oy(null,xp(Ny||(Ny=Ht(["\n      :host::before {\n        right: calc(("," - ",") * 1px);\n      }\n    "])),id,rd)),Ep(xp(Ly||(Ly=Ht(["\n        :host {\n          background: ",";\n          border-color: ",";\n          color: ",';\n        }\n        :host(:not([disabled]):not([aria-selected="true"]):hover),\n        :host(:not([disabled])[aria-selected="true"]:hover),\n        :host([aria-selected="true"]) {\n          forced-color-adjust: none;\n          background: ',";\n          color: ",";\n        }\n        :host(:not([disabled]):active)::before,\n        :host([aria-selected='true'])::before {\n          background: ",";\n        }\n        :host([disabled]),\n        :host([disabled]:not([aria-selected='true']):hover) {\n          background: ",";\n          color: ",";\n          fill: currentcolor;\n          opacity: 1;\n        }\n        :host(:",") {\n          outline-color: ",";\n        }\n      "])),Ap.ButtonFace,Ap.ButtonFace,Ap.ButtonText,Ap.Highlight,Ap.HighlightText,Ap.HighlightText,Ap.Canvas,Ap.GrayText,Gg,Ap.CanvasText)))});var Uy;const zy=[Ce(Uy||(Uy=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))];var Hy,qy,By,Vy=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},jy=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ky=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Ry,Fy);let Gy=class extends Qt{get strings(){return zm}static get styles(){return zy}constructor(){super(),this.version="v1.0",this.maxPages=3,this.scopes=[],this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.handleComboboxKeydown=e=>{let t,n;const o=e.key,r=e.target.querySelector(".selected");r&&(t=r.getAttribute("value")),"Enter"===o&&t&&(n=this.response.filter((e=>e.id===t)).pop(),this.fireCustomEvent("selectionChanged",n,!0,!1,!0))},this.placeholder=this.strings.comboboxPlaceholder,this.entityType=null,this.keyName=null,this.isRefreshing=!1}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null,this.error=null}render(){var e;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){const e=this.error?this.error:null;return this.renderTemplate("error",{error:e},"error")}return this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(e=this.response)||void 0===e?void 0:e.length)>0?this.renderPicker():this.renderGet()}renderPicker(){return Sn(Hy||(Hy=Ht(["\n      <fluent-combobox\n        @keydown=","\n        current-value=",'\n        part="picker"\n        class="picker"\n        id="combobox"\n        autocomplete="list"\n        placeholder=',">\n          ","\n      </fluent-combobox>\n     "])),this.handleComboboxKeydown,yi(this.selectedValue),this.placeholder,this.response.map((e=>ot(qy||(qy=Ht(["\n            <fluent-option value="," @click=","> "," </fluent-option>"])),e.id,(t=>this.handleClick(t,e)),e[this.keyName]))))}renderGet(){return Sn(By||(By=Ht(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        .scopes=","\n        max-pages=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),this.resource,this.version,this.scopes,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod)}loadState(){return Ky(this,void 0,void 0,(function*(){if(!this.response){const e=this.renderRoot.querySelector(".mgt-get");e?e.addEventListener("dataChange",(e=>this.handleDataChange(e))):console.error("\ud83e\udd92: mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")}this.isRefreshing=!1,yield Promise.resolve()}))}handleDataChange(e){const t=e.detail.response.value,n=e.detail.error?e.detail.error:null;this.response=t,this.error=n}handleClick(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}};Vy([Et({attribute:"resource",type:String}),jy("design:type",String)],Gy.prototype,"resource",void 0),Vy([Et({attribute:"version",type:String}),jy("design:type",Object)],Gy.prototype,"version",void 0),Vy([Et({attribute:"max-pages",type:Number}),jy("design:type",Object)],Gy.prototype,"maxPages",void 0),Vy([Et({attribute:"placeholder",type:String}),jy("design:type",String)],Gy.prototype,"placeholder",void 0),Vy([Et({attribute:"key-name",type:String}),jy("design:type",String)],Gy.prototype,"keyName",void 0),Vy([Et({attribute:"entity-type",type:String}),jy("design:type",String)],Gy.prototype,"entityType",void 0),Vy([Et({attribute:"scopes",converter:e=>e?e.toLowerCase().split(","):null}),jy("design:type",Array)],Gy.prototype,"scopes",void 0),Vy([Et({attribute:"cache-enabled",type:Boolean}),jy("design:type",Object)],Gy.prototype,"cacheEnabled",void 0),Vy([Et({attribute:"cache-invalidation-period",type:Number}),jy("design:type",Object)],Gy.prototype,"cacheInvalidationPeriod",void 0),Vy([Et({attribute:"selected-value",type:String}),jy("design:type",String)],Gy.prototype,"selectedValue",void 0),Vy([At(),jy("design:type",Array)],Gy.prototype,"response",void 0),Gy=Vy([Tn("picker"),jy("design:paramtypes",[])],Gy);const $y={termsetIdRequired:"The termsetId property or termset-id attribute is required",noTermsFound:"No terms found",comboboxPlaceholder:"Select a term",loadingMessage:"Loading..."};var Wy;const Qy=[Ce(Wy||(Wy=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))];var Yy,Zy,Jy,Xy,eb,tb,nb,ob=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},rb=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ib=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Ry,Fy);let sb=class extends Qt{get strings(){return $y}static get styles(){return Qy}get defaultSelectedTermId(){return this._defaultSelectedTermId}set defaultSelectedTermId(e){e!==this._defaultSelectedTermId&&(this._defaultSelectedTermId=e,this.requestStateUpdate(!0))}get selectedTerm(){return this._selectedTerm}set selectedTerm(e){this._selectedTerm=e}constructor(){super(),this.version="beta",this.position="below",this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.placeholder=this.strings.comboboxPlaceholder,this.isRefreshing=!1,this.noTerms=!1}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.terms=null,this.error=null,this.noTerms=!1}render(){var e;return this.isLoadingState&&!this.terms?this.renderLoading():this.error?this.renderError():this.noTerms?this.renderNoData():(null===(e=this.terms)||void 0===e?void 0:e.length)>0?this.renderTaxonomyPicker():this.renderGet()}renderLoading(){return this.renderTemplate("loading",null,"loading")||Sn(Yy||(Yy=Ht(['\n        <div class="message-parent">\n          <mgt-spinner></mgt-spinner>\n          <div label="loading-text" aria-label="loading">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.loadingMessage)}renderError(){return this.renderTemplate("error",null,"error")||ot(Zy||(Zy=Ht(["\n              <span>\n                ","\n            </span>\n          "])),this.error)}renderNoData(){return this.renderTemplate("no-data",null)||ot(Jy||(Jy=Ht(["\n            <span>\n              ","\n            </span>\n          "])),this.strings.noTermsFound)}renderTaxonomyPicker(){return Sn(Xy||(Xy=Ht(['\n      <fluent-combobox class="taxonomy-picker" autocomplete="both" placeholder='," position="," ?disabled=",">\n        ","\n      </fluent-combobox>\n     "])),this.placeholder,this.position,this.disabled,this.terms.map((e=>this.renderTaxonomyPickerItem(e))))}renderTaxonomyPickerItem(e){const t=this.defaultSelectedTermId&&this.defaultSelectedTermId===e.id;return ot(eb||(eb=Ht(["\n        <fluent-option value="," ?selected="," @click=","> "," </fluent-option>\n        "])),e.id,t,(t=>this.handleClick(t,e)),this.renderTemplate("term",{term:e},e.id)||e.labels[0].name)}renderGet(){if(!this.termsetId)return ot(tb||(tb=Ht(["\n            <span>\n                ","\n            </span>\n            "])),this.strings.termsetIdRequired);let e="/termStore/sets/".concat(this.termsetId,"/children");return this.termId&&(e="/termStore/sets/".concat(this.termsetId,"/terms/").concat(this.termId,"/children")),this.siteId&&(e="/sites/".concat(this.siteId).concat(e)),e+="?$select=id,labels,descriptions,properties",Sn(nb||(nb=Ht(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        scopes=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),e,this.version,["TermStore.Read.All"],this.cacheEnabled,this.cacheInvalidationPeriod)}loadState(){return ib(this,void 0,void 0,(function*(){if(!this.terms){this.renderRoot.querySelector(".mgt-get").addEventListener("dataChange",(e=>this.handleDataChange(e)))}this.isRefreshing=!1,yield Promise.resolve()}))}handleDataChange(e){const t=e.detail.error?e.detail.error:null;if(t)return void(this.error=t);this.locale&&(this.locale=this.locale.toLowerCase());const n=e.detail.response.value.map((e=>{const t=e.labels;if(t&&t.length>0&&this.locale){const n=t.find((e=>e.languageTag.toLowerCase()===this.locale));n&&(e.labels=[n,...t.filter((e=>e.languageTag.toLowerCase()!==this.locale))])}return e}));this.terms=n,0===n.length&&(this.noTerms=!0)}handleClick(e,t){this.selectedTerm=t,this.fireCustomEvent("selectionChanged",t)}};var ab,lb,cb,db,ub;ob([Et({attribute:"term-set-id",type:String}),rb("design:type",String)],sb.prototype,"termsetId",void 0),ob([Et({attribute:"term-id",type:String}),rb("design:type",String)],sb.prototype,"termId",void 0),ob([Et({attribute:"site-id",type:String}),rb("design:type",String)],sb.prototype,"siteId",void 0),ob([Et({attribute:"locale",type:String}),rb("design:type",String)],sb.prototype,"locale",void 0),ob([Et({attribute:"version",type:String}),rb("design:type",Object)],sb.prototype,"version",void 0),ob([Et({attribute:"placeholder",type:String}),rb("design:type",String)],sb.prototype,"placeholder",void 0),ob([Et({attribute:"position",type:String,converter:e=>"above"===e?"above":"below"}),rb("design:type",String)],sb.prototype,"position",void 0),ob([Et({attribute:"default-selected-term-id",type:String}),rb("design:type",String),rb("design:paramtypes",[String])],sb.prototype,"defaultSelectedTermId",null),ob([Et({attribute:"selected-term",type:Object}),rb("design:type",Object),rb("design:paramtypes",[Object])],sb.prototype,"selectedTerm",null),ob([Et({attribute:"disabled",type:Boolean}),rb("design:type",Boolean)],sb.prototype,"disabled",void 0),ob([Et({attribute:"cache-enabled",type:Boolean}),rb("design:type",Object)],sb.prototype,"cacheEnabled",void 0),ob([Et({attribute:"cache-invalidation-period",type:Number}),rb("design:type",Object)],sb.prototype,"cacheInvalidationPeriod",void 0),ob([At(),rb("design:type",Array)],sb.prototype,"terms",void 0),ob([At(),rb("design:type",Boolean)],sb.prototype,"noTerms",void 0),sb=ob([Tn("taxonomy-picker"),rb("design:paramtypes",[])],sb);var hb=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},pb=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fb=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const gb=e=>Array.isArray(null===e||void 0===e?void 0:e.value);var vb;!function(e){e.json="json",e.image="image"}(vb||(vb={}));const mb=()=>bn.config.response.isEnabled&&bn.config.isEnabled;let yb=class extends Qt{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=vb.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),this.requestStateUpdate()}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&gb(this.response)){let e;if(gb(this.response)){let t=null;this.isLoadingState&&!this.isPolling&&(t=this.renderTemplate("loading",null)),e=ot(ab||(ab=Ht(["\n          "," ","\n        "])),this.response.value.map((e=>this.renderTemplate("value",e,e.id))),t)}else e=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const t=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?ot(lb||(lb=Ht(["\n            ","","\n          "])),t,e):ot(cb||(cb=Ht(["\n            ","","\n          "])),e,t)}return e}return this.response?this.renderTemplate("default",this.response)||ot(db||(db=Ht([""]))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):ot(ub||(ub=Ht([""])))}loadState(){var e,t,n;return fb(this,void 0,void 0,(function*(){const o=re.globalProvider;if(this.error=null,o&&o.state===te.SignedIn){if(this.resource){try{let r;const i="".concat(this.version).concat(this.resource);let s=null;if(this.shouldRetrieveCache()){r=bn.getCache(io,io.stores.responses);const e=mb()?yield r.getValue(i):null;e&&(this.cacheInvalidationPeriod||bn.config.response.invalidationPeriod||bn.config.defaultInvalidationPeriod)>Date.now()-e.timeCached&&(s=JSON.parse(e.response))}if(!s){let a=this.resource,l=!1;(null===(e=this.response)||void 0===e?void 0:e["@odata.deltaLink"])?(a=this.response["@odata.deltaLink"],l=!0):l=new URL(a,"https://graph.microsoft.com").pathname.endsWith("delta");const c=o.graph.forComponent(this);let d=c.api(a).version(this.version);if((null===(t=this.scopes)||void 0===t?void 0:t.length)&&(d=d.middlewareOptions(ie(...this.scopes))),this.type===vb.json){if(s=yield d.get(),l&&gb(this.response)&&gb(s)){const e=s.value;s.value=this.response.value.concat(e)}if(this.isPolling||qt(this.response,s)||(this.response=s),gb(s)&&s["@odata.nextLink"]){let e=1,t=s;for(;(e<this.maxPages||this.maxPages<=0||l&&this.pollingRate)&&(null===t||void 0===t?void 0:t["@odata.nextLink"]);){e++;const o=t["@odata.nextLink"].split(this.version)[1];t=yield c.client.api(o).version(this.version).get(),(null===(n=null===t||void 0===t?void 0:t.value)||void 0===n?void 0:n.length)&&(t.value=s.value.concat(t.value),s=t,this.isPolling||(this.response=s))}}}else{if(-1===this.resource.indexOf("/photo/$value")&&-1===this.resource.indexOf("/thumbnails/"))throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let e;if(this.resource.indexOf("/photo/$value")>-1){const t=this.resource.replace("/photo/$value",""),n=yield Po(c,t,this.scopes);n&&(e=n.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){const t=yield((e,t,n)=>pf(void 0,void 0,void 0,(function*(){try{const o=yield e.api(t).responseType(O.RAW).middlewareOptions(ie(...n)).get();if(404===o.status)return{eTag:null,thumbnail:null};if(!o.ok)return null;return{eTag:o.headers.get("eTag"),thumbnail:yield Gn(yield o.blob())}}catch(sL){return null}})))(c,this.resource,this.scopes);t&&(e=t.thumbnail)}e&&(s={image:e})}this.shouldUpdateCache()&&s&&(r=bn.getCache(io,io.stores.responses),yield r.putValue(i,{response:JSON.stringify(s)}))}qt(this.response,s)||(this.response=s)}catch(sL){this.error=sL}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>{this.isPolling=!0,this.loadState().finally((()=>{this.isPolling=!1}))}),this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return mb()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return mb()&&this.cacheEnabled}};var bb;hb([Et({attribute:"resource",reflect:!0,type:String}),pb("design:type",String)],yb.prototype,"resource",void 0),hb([Et({attribute:"scopes",converter:(e,t)=>e?e.toLowerCase().split(","):null,reflect:!0}),pb("design:type",Array)],yb.prototype,"scopes",void 0),hb([Et({attribute:"version",reflect:!0,type:String}),pb("design:type",Object)],yb.prototype,"version",void 0),hb([Et({attribute:"type",reflect:!0,type:vb}),pb("design:type",String)],yb.prototype,"type",void 0),hb([Et({attribute:"max-pages",reflect:!0,type:Number}),pb("design:type",Object)],yb.prototype,"maxPages",void 0),hb([Et({attribute:"polling-rate",reflect:!0,type:Number}),pb("design:type",Object)],yb.prototype,"pollingRate",void 0),hb([Et({attribute:"cache-enabled",reflect:!0,type:Boolean}),pb("design:type",Object)],yb.prototype,"cacheEnabled",void 0),hb([Et({attribute:"cache-invalidation-period",type:Number}),pb("design:type",Object)],yb.prototype,"cacheInvalidationPeriod",void 0),hb([Et({attribute:!1}),pb("design:type",Object)],yb.prototype,"response",void 0),hb([Et({attribute:!1}),pb("design:type",Object)],yb.prototype,"error",void 0),yb=hb([Tn("get")],yb);const wb=[Ce(bb||(bb=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}\n'])))],kb={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out",signInWithADifferentAccount:"Sign in with a different account"};class xb extends $m{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var e;return null===(e=this.options)||void 0===e?void 0:e.filter((e=>e.checked))}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(e,t){var n,o;this.ariaActiveDescendant=null!==(o=null===(n=this.options[t])||void 0===n?void 0:n.id)&&void 0!==o?o:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;const e=this.activeOption;e&&(e.checked=!0)}checkFirstOption(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach(((e,t)=>{e.checked=Vm(t,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((e,t)=>{e.checked=Vm(t,this.rangeStartIndex,this.options.length)}))):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((e,t)=>{e.checked=Vm(t,this.rangeStartIndex,this.activeIndex+1)}))):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),1===this.checkedOptions.length&&(this.rangeStartIndex+=1),this.options.forEach(((e,t)=>{e.checked=Vm(t,this.activeIndex,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(e){var t;if(!this.multiple)return super.clickHandler(e);const n=null===(t=e.target)||void 0===t?void 0:t.closest("[role=option]");return n&&!n.disabled?(this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(n),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0):void 0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(e){if(!this.multiple)return super.focusinHandler(e);this.shouldSkipFocus||e.target!==e.currentTarget||(this.uncheckAllOptions(),-1===this.activeIndex&&(this.activeIndex=-1!==this.firstSelectedOptionIndex?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(e){this.multiple&&this.uncheckAllOptions()}keydownHandler(e){if(!this.multiple)return super.keydownHandler(e);if(this.disabled)return!0;const{key:t,shiftKey:n}=e;switch(this.shouldSkipFocus=!1,t){case Cg:return void this.checkFirstOption(n);case mg:return void this.checkNextOption(n);case wg:return void this.checkPreviousOption(n);case _g:return void this.checkLastOption(n);case Tg:return this.focusAndScrollOptionIntoView(),!0;case xg:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case Sg:if(e.preventDefault(),this.typeAheadExpired)return void this.toggleSelectedForAllCheckedOptions();default:return 1===t.length&&this.handleTypeAhead("".concat(t)),!0}}mousedownHandler(e){if(e.offsetX>=0&&e.offsetX<=this.scrollWidth)return super.mousedownHandler(e)}multipleChanged(e,t){var n;this.ariaMultiSelectable=t?"true":null,null===(n=this.options)||void 0===n||n.forEach((e=>{e.checked=!t&&void 0})),this.setSelectedOptions()}setSelectedOptions(){this.multiple?this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter((e=>e.selected)),this.focusAndScrollOptionIntoView()):super.setSelectedOptions()}sizeChanged(e,t){var n;const o=Math.max(0,parseInt(null!==(n=null===t||void 0===t?void 0:t.toFixed())&&void 0!==n?n:"",10));o!==t&&Rs.queueUpdate((()=>{this.size=o}))}toggleSelectedForAllCheckedOptions(){const e=this.checkedOptions.filter((e=>!e.disabled)),t=!e.every((e=>e.selected));e.forEach((e=>e.selected=t)),this.selectedIndex=this.options.indexOf(e[e.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(e,t){if(this.multiple){if(this.$fastController.isConnected){const e=this.getTypeaheadMatches(),t=this.options.indexOf(e[0]);t>-1&&(this.activeIndex=t,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}else super.typeaheadBufferChanged(e,t)}uncheckAllOptions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.options.forEach((e=>e.checked=!this.multiple&&void 0)),e||(this.rangeStartIndex=-1)}}var Cb;ta([Ms],xb.prototype,"activeIndex",void 0),ta([Ys({mode:"boolean"})],xb.prototype,"multiple",void 0),ta([Ys({converter:Ws})],xb.prototype,"size",void 0);var _b;const Sb=class extends $m{}.compose({baseName:"listbox",template:(e,t)=>ec(Cb||(Cb=Ht(['\n    <template\n        aria-activedescendant="','"\n        aria-multiselectable="','"\n        class="listbox"\n        role="listbox"\n        tabindex="','"\n        @click="','"\n        @focusin="','"\n        @keydown="','"\n        @mousedown="','"\n    >\n        <slot\n            ',"\n        ></slot>\n    </template>\n"])),(e=>e.ariaActiveDescendant),(e=>e.ariaMultiSelectable),(e=>e.disabled?null:"0"),((e,t)=>e.clickHandler(t.event)),((e,t)=>e.focusinHandler(t.event)),((e,t)=>e.keydownHandler(t.event)),((e,t)=>e.mousedownHandler(t.event)),qg({filter:xb.slottedOptionFilter,flatten:!0,property:"slottedOptions"})),styles:(e,t)=>xp(_b||(_b=Ht(["\n    "," :host {\n      border: calc("," * 1px) solid ",";\n      border-radius: calc("," * 1px);\n      box-sizing: border-box;\n      flex-direction: column;\n      padding: calc("," * 1px) 0;\n    }\n\n    ::slotted(",") {\n      margin: 0 calc("," * 1px);\n    }\n\n    :host(:focus-within:not([disabled])) {\n      ","\n    }\n  "])),Sp("inline-flex"),rd,$h,nd,td,e.tagFor(Km),td,av)});var Tb,Ib,Eb,Ab,Rb,Pb,Ob,Db,Mb,Nb,Lb,Fb=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ub=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},zb=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Sb,Sm,Ev,Kp);let Hb=class extends Qt{static get styles(){return wb}get strings(){return kb}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...Wi.requiredScopes])]}get _userDetailsKey(){return"-userDetails"}constructor(){super(),this.showPresence=!1,this.loginView="full",this._arrowKeyLocation=-1,this.logout=()=>zb(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const e=re.globalProvider;(null===e||void 0===e?void 0:e.isMultiAccountSupportedAndEnabled)&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),(null===e||void 0===e?void 0:e.logout)&&(yield e.logout(),this.userDetails=null,e.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(e.getActiveAccount().id+this._userDetailsKey),this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))})),this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this.onUserKeyDown=e=>{if(!this.flyout.isOpen)return;const t=this.renderRoot.querySelector(".popup-content"),n=t.querySelectorAll("ul, fluent-button"),o=t.querySelector("#signout-button")||n[0],r=t.querySelector("#signin-different-account-button")||n[n.length-1];if("Tab"===e.key&&e.shiftKey&&o===e.target&&(e.preventDefault(),null===r||void 0===r||r.focus()),"Tab"!==e.key||e.shiftKey||r!==e.target||(e.preventDefault(),null===o||void 0===o||o.focus()),"Escape"===e.key){const e=this.renderRoot.querySelector("#login-button");null===e||void 0===e||e.focus()}const i=this.renderRoot.querySelector("fluent-card");e.shiftKey&&"Tab"===e.key&&e.target===i&&this.hideFlyout()},this.handleAccountListKeyDown=e=>{const t=this.renderRoot.querySelector("ul.account-list");let n;const o=null===t||void 0===t?void 0:t.children;for(const s of o){const e=s;e.setAttribute("tabindex","-1"),e.blur()}const r=t.childElementCount,i=e.key;if("ArrowDown"===i)this._arrowKeyLocation=(this._arrowKeyLocation+1+r)%r;else if("ArrowUp"===i)this._arrowKeyLocation=(this._arrowKeyLocation-1+r)%r;else if("Tab"===i||"Escape"===i)return this._arrowKeyLocation=-1,t.blur(),void("Escape"===i&&(e.preventDefault(),e.stopPropagation()));this._arrowKeyLocation>-1&&(n=o[this._arrowKeyLocation],n.setAttribute("tabindex","1"),n.focus())},this.onClick=()=>{this.userDetails&&this._isFlyoutOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(e=>e.stopPropagation()))}login(){return zb(this,void 0,void 0,(function*(){const e=re.globalProvider;(e.isMultiAccountSupportedAndEnabled||!this.userDetails&&this.fireCustomEvent("loginInitiated"))&&(null===e||void 0===e?void 0:e.login)&&(yield e.login(),e.state===te.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}render(){return ot(Tb||(Tb=Ht(['\n      <div class="login-root">\n        ',"\n        ","\n      </div>\n    "])),this.renderButton(),this.renderFlyout())}loadState(){return zb(this,void 0,void 0,(function*(){const e=re.globalProvider;e&&!this.userDetails&&(e.state===te.SignedIn?(this.userDetails=yield Bo(e.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),e.isMultiAccountSupportedAndEnabled&&localStorage.setItem(re.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}renderButton(){var e;const t=(null===(e=re.globalProvider)||void 0===e?void 0:e.state)===te.SignedIn,n=Bn({"signed-in":t&&Boolean(this.userDetails),"signed-out":!t,small:"avatar"===this.loginView}),o=t?"stealth":"neutral",r=t&&this.userDetails,i=r?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent(),s=r?this._isFlyoutOpen:void 0;return ot(Ib||(Ib=Ht(['\n      <fluent-button\n        id="login-button"\n        aria-expanded="','"\n        appearance=','\n        aria-label="','"\n        ?disabled=',"\n        @click=","\n        class=",">\n          ","\n      </fluent-button>"])),yi(s),o,yi(t?void 0:this.strings.signInLinkSubtitle),this.isLoadingState,this.onClick,n,i)}renderFlyout(){return Sn(Eb||(Eb=Ht(['\n      <mgt-flyout\n        class="flyout"\n        light-dismiss\n        @opened=',"\n        @closed=",'>\n        <fluent-card \n          slot="flyout" \n          tabindex="0" \n          class="flyout-card"\n          @keydown=',"\n          >\n          ","\n        </fluent-card>\n      </mgt-flyout>"])),this.flyoutOpened,this.flyoutClosed,this.onUserKeyDown,this.renderFlyoutContent())}renderFlyoutContent(){if(this.userDetails)return ot(Ab||(Ab=Ht(['\n       <div class="popup">\n         <div class="popup-content">\n           <div class="commands">\n             ','\n           </div>\n           <div class="content">\n             <div class="main-profile">\n               ',"\n             </div>\n             ","\n           </div>\n           ","\n         </div>\n       </div>\n     "])),this.renderFlyoutCommands(),this.renderFlyoutPersonDetails(this.userDetails,this._image),this.renderAccounts(),this.renderAddAccountContent())}get hasMultipleAccounts(){var e,t,n,o;return(null===(e=re.globalProvider)||void 0===e?void 0:e.isMultiAccountSupportedAndEnabled)&&(null===(o=null===(n=null===(t=re.globalProvider)||void 0===t?void 0:t.getAllAccounts)||void 0===n?void 0:n.call(t))||void 0===o?void 0:o.length)>1}get usesVerticalPersonCard(){return"full"===this.loginView||this.hasMultipleAccounts}renderFlyoutPersonDetails(e,t){return this.renderTemplate("flyout-person-details",{personDetails:e,personImage:t})||Sn(Rb||(Rb=Ht(["\n        <mgt-person\n          .personDetails=","\n          .personImage=","\n          .view=","\n          .line2Property=","\n          ?vertical-layout=",'\n          class="person">\n        </mgt-person>'])),e,t,Vo.twolines,"email",this.usesVerticalPersonCard)}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||ot(Pb||(Pb=Ht(['\n        <fluent-button\n          id="signout-button"\n          appearance="stealth"\n          size="medium"\n          class="flyout-command"\n          @click=',"\n          aria-label=",">\n            ","\n        </fluent-button>"])),this.logout,this.strings.signOutLinkSubtitle,this.strings.signOutLinkSubtitle)}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(re.globalProvider.isMultiAccountSupportedAndEnabled)return ot(Ob||(Ob=Ht(['\n        <div class="add-account">\n          <fluent-button\n            id="signin-different-account-button"\n            appearance="stealth"\n            aria-label="','"\n            @click=','>\n            <span slot="start"><i>',"</i></span>\n            ","\n          </fluent-button>\n        </div>"])),this.strings.signInWithADifferentAccount,(()=>{this.login()}),ei(Xr.SelectAccount,"currentColor"),this.strings.signInWithADifferentAccount)}parsePersonDisplayConfiguration(){const e={view:Vo.twolines,avatarSize:"small"};switch(this.loginView){case"avatar":e.view=Vo.image,e.avatarSize="small";break;case"compact":e.view=Vo.oneline,e.avatarSize="small";break;default:e.view=Vo.twolines,e.avatarSize="auto"}return e}renderSignedInButtonContent(e,t){const n=this.renderTemplate("signed-in-button-content",{personDetails:e,personImage:t}),o=this.parsePersonDisplayConfiguration();return n||Sn(Db||(Db=Ht(["\n        <mgt-person\n          .personDetails=","\n          .personImage=","\n          .view=","\n          .showPresence=","\n          .avatarSize=",'\n          line2-property="email"\n          class="signed-in-person"\n        ></mgt-person>'])),this.userDetails,this._image,o.view,this.showPresence,o.avatarSize)}renderAccounts(){if(re.globalProvider.state===te.SignedIn&&re.globalProvider.isMultiAccountSupportedAndEnabled){const e=re.globalProvider,t=e.getAllAccounts();if((null===t||void 0===t?void 0:t.length)>1)return ot(Mb||(Mb=Ht(['\n          <div id="accounts">\n            <ul\n              tabindex="0"\n              class="account-list"\n              part="account-list"\n              aria-label="','"\n              @keydown=',"\n            >\n              ","\n            </ul>\n          </div>\n       "])),this.ariaLabel,this.handleAccountListKeyDown,t.filter((t=>t.id!==e.getActiveAccount().id)).map((e=>{const t=localStorage.getItem(e.id+this._userDetailsKey);return Sn(Nb||(Nb=Ht(['\n                    <li\n                      tabindex="-1"\n                      part="account-item"\n                      class="account-item"\n                      @click=',"\n                      @keyup=","\n                    >\n                      <mgt-person\n                        .personDetails=","\n                        .fallbackDetails=","\n                        .view=",'\n                        class="account"\n                      ></mgt-person>\n                    </li>'])),(()=>this.setActiveAccount(e)),(t=>{"Enter"===t.key&&this.setActiveAccount(e)}),t?JSON.parse(t):null,{displayName:e.name,mail:e.mail},fi.twolines)})))}}setActiveAccount(e){re.globalProvider.setActiveAccount(e)}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||ot(Lb||(Lb=Ht(["\n        <span>","</span>"])),this.strings.signInLinkSubtitle)}showFlyout(){const e=this.flyout;e&&e.open()}hideFlyout(){const e=this.flyout;e&&e.close()}};Fb([Et({attribute:"user-details",type:Object}),Ub("design:type",Object)],Hb.prototype,"userDetails",void 0),Fb([Et({attribute:"show-presence",type:Boolean}),Ub("design:type",Object)],Hb.prototype,"showPresence",void 0),Fb([Et({attribute:"login-view",type:String}),Ub("design:type",String)],Hb.prototype,"loginView",void 0),Fb([At(),Ub("design:type",Boolean)],Hb.prototype,"_isFlyoutOpen",void 0),Fb([At(),Ub("design:type",Object)],Hb.prototype,"_arrowKeyLocation",void 0),Hb=Fb([Tn("login"),Ub("design:paramtypes",[])],Hb);var qb,Bb=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e[e.any=0]="any",e[e.unified=1]="unified",e[e.security=2]="security",e[e.mailenabledsecurity=4]="mailenabledsecurity",e[e.distribution=8]="distribution"}(qb||(qb={}));const Vb=()=>bn.config.groups.invalidationPeriod||bn.config.defaultInvalidationPeriod,jb=()=>bn.config.groups.isEnabled&&bn.config.isEnabled,Kb=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qb.any,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return Bb(void 0,void 0,void 0,(function*(){const i="Group.Read.All";let s;const a="".concat(t||"*","*").concat(o,"*").concat(r,":").concat(n);if(jb()){s=bn.getCache(ro,ro.stores.groupsQuery);const e=yield s.getValue(a);if(e&&Vb()>Date.now()-e.timeCached&&e.top>=n)return e.groups.map((e=>JSON.parse(e))).slice(0,n+1)}let l,c="";const d=[];if(""!==t&&(c="(startswith(displayName,'".concat(t,"') or startswith(mailNickname,'").concat(t,"') or startswith(mail,'").concat(t,"'))")),r&&(c+="".concat(t?" and ":"").concat(r)),o!==qb.any){const t=e.createBatch(),r=[];qb.unified===(o&qb.unified)&&r.push("groupTypes/any(c:c+eq+'Unified')"),qb.security===(o&qb.security)&&r.push("(mailEnabled eq false and securityEnabled eq true)"),qb.mailenabledsecurity===(o&qb.mailenabledsecurity)&&r.push("(mailEnabled eq true and securityEnabled eq true)"),qb.distribution===(o&qb.distribution)&&r.push("(mailEnabled eq true and securityEnabled eq false)"),c=c?"".concat(c," and "):"";for(const e of r)t.get(e,"/groups?$filter=".concat(c+e),["Group.Read.All"]);try{l=yield t.executeAll();for(const e of r)if(l.get(e).content.value)for(const t of l.get(e).content.value){d.find((e=>e.id===t.id))||d.push(t)}}catch(Ye){try{const t=[];for(const o of r)t.push(e.api("groups").filter("".concat(c," and ").concat(o)).top(n).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(ie(i)).get());return(yield Promise.all(t)).map((e=>e.value)).reduce(((e,t)=>e.concat(t)),[])}catch(sL){return[]}}}else if(0===d.length){const t=yield e.api("groups").filter(c).top(n).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(ie(i)).get();return jb()&&t&&(yield s.putValue(a,{groups:t.value.map((e=>JSON.stringify(e))),top:n})),t?t.value:null}return d}))},Gb=(e,t,n)=>Bb(void 0,void 0,void 0,(function*(){let o;if(jb()){o=bn.getCache(ro,ro.stores.groups);const e=yield o.getValue(t);if(e&&Vb()>Date.now()-e.timeCached){const t=e.group?JSON.parse(e.group):null,o=n&&t?n.filter((e=>!Object.keys(t).includes(e))):null;if(!o||o.length<=1)return t}}let r="/groups/".concat(t);n&&(r=r+"?$select="+n.toString());const i=yield e.api(r).middlewareOptions(ie("Group.Read.All")).get();return jb()&&(yield o.putValue(t,{group:JSON.stringify(i)})),i})),$b=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Bb(void 0,void 0,void 0,(function*(){if(!t||0===t.length)return[];const o=e.createBatch(),r={},i=[];let s;jb()&&(s=bn.getCache(ro,ro.stores.groups));for(const e of t){let t;if(r[e]=null,jb()&&(t=yield s.getValue(e)),t&&Vb()>Date.now()-t.timeCached)r[e]=t.group?JSON.parse(t.group):null;else if(""!==e){let t="/groups/".concat(e);n&&(t="".concat(t,"?$filters=").concat(n)),o.get(e,t,["Group.Read.All"]),i.push(e)}}try{const e=yield o.executeAll();for(const n of t){const t=e.get(n);(null===t||void 0===t?void 0:t.content)&&(r[n]=t.content,jb()&&(yield s.putValue(n,{group:JSON.stringify(t.content)})))}return Promise.all(Object.values(r))}catch(Ye){try{return t.filter((e=>i.includes(e))).forEach((t=>{r[t]=Gb(e,t)})),jb()&&(yield Promise.all(t.filter((e=>i.includes(e))).map((e=>Bb(void 0,void 0,void 0,(function*(){return yield s.putValue(e,{group:JSON.stringify(yield r[e])})})))))),Promise.all(Object.values(r))}catch(sL){return[]}}}))};var Wb;const Qb=[Ce(Wb||(Wb=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}\n'])))];var Yb,Zb=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let Jb=class extends Lt{static get styles(){return Qb}render(){return ot(Yb||(Yb=Ht(['<fluent-progress-ring title="spinner"></fluent-progress-ring>'])))}};var Xb;Jb=Zb([Tn("spinner")],Jb);const ew=[Ce(Xb||(Xb=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:min-content;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item-person{width:max-content}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--neutral-layer-card-container))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:min-content;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item-person{width:max-content}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--neutral-layer-card-container))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}\n'])))];class tw extends Wa{}class nw extends(Og(tw)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const ow="text";class rw extends nw{constructor(){super(...arguments),this.type=ow}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&Rs.queueUpdate((()=>{this.focus()}))}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}}ta([Ys({attribute:"readonly",mode:"boolean"})],rw.prototype,"readOnly",void 0),ta([Ys({mode:"boolean"})],rw.prototype,"autofocus",void 0),ta([Ys],rw.prototype,"placeholder",void 0),ta([Ys],rw.prototype,"type",void 0),ta([Ys],rw.prototype,"list",void 0),ta([Ys({converter:Ws})],rw.prototype,"maxlength",void 0),ta([Ys({converter:Ws})],rw.prototype,"minlength",void 0),ta([Ys],rw.prototype,"pattern",void 0),ta([Ys({converter:Ws})],rw.prototype,"size",void 0),ta([Ys({mode:"boolean"})],rw.prototype,"spellcheck",void 0),ta([Ms],rw.prototype,"defaultSlottedNodes",void 0);class iw{}function sw(e,t,n){return e.nodeType!==Node.TEXT_NODE||"string"===typeof e.nodeValue&&!!e.nodeValue.trim().length}var aw;gg(iw,og),gg(rw,dg,iw);var lw;const cw=".root";class dw extends rw{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}}i([Ys],dw.prototype,"appearance",void 0);const uw=dw.compose({baseName:"text-field",baseClass:rw,template:(e,t)=>ec(aw||(aw=Ht(['\n    <template\n        class="\n            ','\n        "\n    >\n        <label\n            part="label"\n            for="control"\n            class="','"\n        >\n            <slot\n                ','\n            ></slot>\n        </label>\n        <div class="root" part="root">\n            ','\n            <input\n                class="control"\n                part="control"\n                id="control"\n                @input="','"\n                @change="','"\n                ?autofocus="','"\n                ?disabled="','"\n                list="','"\n                maxlength="','"\n                minlength="','"\n                pattern="','"\n                placeholder="','"\n                ?readonly="','"\n                ?required="','"\n                size="','"\n                ?spellcheck="','"\n                :value="','"\n                type="','"\n                aria-atomic="','"\n                aria-busy="','"\n                aria-controls="','"\n                aria-current="','"\n                aria-describedby="','"\n                aria-details="','"\n                aria-disabled="','"\n                aria-errormessage="','"\n                aria-flowto="','"\n                aria-haspopup="','"\n                aria-hidden="','"\n                aria-invalid="','"\n                aria-keyshortcuts="','"\n                aria-label="','"\n                aria-labelledby="','"\n                aria-live="','"\n                aria-owns="','"\n                aria-relevant="','"\n                aria-roledescription="','"\n                ',"\n            />\n            ","\n        </div>\n    </template>\n"])),(e=>e.readOnly?"readonly":""),(e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"),qg({property:"defaultSlottedNodes",filter:sw}),hg(0,t),(e=>e.handleTextInput()),(e=>e.handleChange()),(e=>e.autofocus),(e=>e.disabled),(e=>e.list),(e=>e.maxlength),(e=>e.minlength),(e=>e.pattern),(e=>e.placeholder),(e=>e.readOnly),(e=>e.required),(e=>e.size),(e=>e.spellcheck),(e=>e.value),(e=>e.type),(e=>e.ariaAtomic),(e=>e.ariaBusy),(e=>e.ariaControls),(e=>e.ariaCurrent),(e=>e.ariaDescribedby),(e=>e.ariaDetails),(e=>e.ariaDisabled),(e=>e.ariaErrormessage),(e=>e.ariaFlowto),(e=>e.ariaHaspopup),(e=>e.ariaHidden),(e=>e.ariaInvalid),(e=>e.ariaKeyshortcuts),(e=>e.ariaLabel),(e=>e.ariaLabelledby),(e=>e.ariaLive),(e=>e.ariaOwns),(e=>e.ariaRelevant),(e=>e.ariaRoledescription),ig("control"),ug(0,t)),styles:(e,t)=>xp(lw||(lw=Ht(["\n    ","\n\n    ","\n\n    ","\n\n    .root {\n      display: flex;\n      flex-direction: row;\n    }\n\n    .control {\n      -webkit-appearance: none;\n      color: inherit;\n      background: transparent;\n      border: 0;\n      height: calc(100% - 4px);\n      margin-top: auto;\n      margin-bottom: auto;\n      padding: 0 calc("," * 2px + 1px);\n      font-family: inherit;\n      font-size: inherit;\n      line-height: inherit;\n    }\n\n    .start,\n    .end {\n      display: flex;\n      margin: auto;\n    }\n\n    .start {\n      display: flex;\n      margin-inline-start: 11px;\n    }\n\n    .end {\n      display: flex;\n      margin-inline-end: 11px;\n    }\n  "])),Sp("inline-block"),gy(0,0,cw),vy(),td).withBehaviors(Cv("outline",my(e,t,cw)),Cv("filled",yy(e,t,cw)),Ep(by(e,t,cw))),shadowOptions:{delegatesFocus:!0}}),hw={inputPlaceholderText:"Search for a name",maxSelectionsPlaceHolder:"Max contacts added",maxSelectionsAriaLabel:"Maximum contact selections reached",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",selected:"selected",removeSelectedUser:"Remove ",selectContact:"select a contact",suggestionsTitle:"Suggested contacts"};var pw,fw,gw,vw,mw,yw,bw,ww,kw,xw,Cw,_w,Sw,Tw=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Iw=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ew=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(uw,Kp);let Aw=class extends Qt{static get styles(){return ew}get strings(){return hw}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector("fluent-text-field")}get groupId(){return this._groupId}set groupId(e){this._groupId!==e&&(this._groupId=e,this.requestStateUpdate(!0))}get groupIds(){return this._groupIds}set groupIds(e){Vt(this._groupIds,e)||(this._groupIds=e,this.requestStateUpdate(!0))}get type(){return this._type}set type(e){this._type!==e&&(this._type=e,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(e){this._groupType!==e&&(this._groupType=e,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(e){this._userType!==e&&(this._userType=e,this.requestStateUpdate(!0))}get transitiveSearch(){return this._transitiveSearch}set transitiveSearch(e){this.transitiveSearch!==e&&(this._transitiveSearch=e,this.requestStateUpdate(!0))}get people(){return this._people}set people(e){Vt(this._people,e)||(this._people=e,this.requestStateUpdate(!0))}get showMax(){return this._showMax}set showMax(e){e!==this._showMax&&(this._showMax=e,this.requestStateUpdate(!0))}get selectedPeople(){return this._selectedPeople}set selectedPeople(e){e||(e=[]),Vt(this._selectedPeople,e)||(this._selectedPeople=e,this.requestUpdate())}get defaultSelectedUserIds(){return this._defaultSelectedUserIds}set defaultSelectedUserIds(e){Vt(this._defaultSelectedUserIds,e)||(this._defaultSelectedUserIds=e,this.requestStateUpdate(!0))}get defaultSelectedGroupIds(){return this._defaultSelectedGroupIds}set defaultSelectedGroupIds(e){Vt(this._defaultSelectedGroupIds,e)||(this._defaultSelectedGroupIds=e,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(e){Vt(this._userIds,e)||(this._userIds=e,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(e){this._userFilters=e,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(e){this._peopleFilters=e,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(e){this._groupFilters=e,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...Wi.requiredScopes])]}constructor(){super(),this._type=co.person,this._groupType=qb.any,this._userType=uo.any,this._selectedPeople=[],this._arrowSelectionCount=-1,this.defaultSelectedUsers=[],this.defaultSelectedGroups=[],this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this.handleInputClick=()=>{this.flyout.isOpen||this.handleUserSearch()},this.gainedFocus=()=>{this.clearHighlighted(),this._isFocused=!0,this.loadState(),this.showFlyout()},this.lostFocus=()=>{this._isFocused=!1,this.input&&this.input.setAttribute("aria-activedescendant","");const e=this.renderRoot.querySelector(".people-list");if(e)for(const t of e.children)t.classList.remove("focused"),t.setAttribute("aria-selected","false");this.requestUpdate()},this.onUserKeyUp=e=>{const t=e.key,n=e.getModifierState("Control")||e.getModifierState("Meta"),o=n&&"v"===t,r=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(t);return!o&&n||r?((n||["ArrowLeft","ArrowRight"].includes(t))&&this.hideFlyout(),void("ArrowDown"===t&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch())):["Tab","Enter","Shift"].includes(t)?void 0:"Escape"===t?(this.clearInput(),this._foundPeople=[],void(this._arrowSelectionCount=-1)):"Backspace"===t&&0===this.userInput.length&&this.selectedPeople.length>0?(this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),void this.fireCustomEvent("selectionChanged",this.selectedPeople)):void([";",","].includes(t)&&this.allowAnyEmail&&(this._setAnyEmail=!0,e.preventDefault(),e.stopPropagation()))},this.onUserInput=e=>{const t=e.target;if(this.userInput=t.value,this.userInput){Wn(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1}},this.onUserKeyDown=e=>{const t=e.key,n=this.renderRoot.querySelector(".selected-list"),o=e.getModifierState("Control")||e.getModifierState("Meta");if(o&&n){const e=n.querySelectorAll("mgt-person.selected-list-item-person");if(this.hideFlyout(),o&&"ArrowLeft"===t)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+e.length)%e.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(e[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(o&&"ArrowRight"===t){const e=this._highlightedUsers.pop();if(e){const t=e.parentElement;t&&(this.clearHighlighted(t),this._currentHighlightedUserPos++)}}else o&&"a"===t&&(this._highlightedUsers=[],e.forEach((e=>this._highlightedUsers.push(e))));this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers)}else if(this.clearHighlighted(),this.flyout.isOpen){if("ArrowUp"!==t&&"ArrowDown"!==t||(this.handleArrowSelection(e),e.preventDefault()),"Enter"===t)if(!e.shiftKey&&this._foundPeople){e.preventDefault(),e.stopPropagation();const t=this._foundPeople[this._arrowSelectionCount];if(t){this.addPerson(t),this.hideFlyout(),this.input.value="";const e=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&e&&e.setAttribute("disabled","true")}}else this.allowAnyEmail?this.handleAnyEmail():this.showFlyout();"Escape"===t&&e.stopPropagation(),"Tab"===t&&this.hideFlyout(),[";",","].includes(t)&&this.allowAnyEmail&&(e.preventDefault(),e.stopPropagation(),this.userInput=this.input.value,this.handleAnyEmail())}},this.handleCut=()=>{this.writeHighlightedText().then((()=>{this.removeHighlightedOnCut()}),(()=>{}))},this.handleCopy=()=>{this.writeHighlightedText()},this.handlePaste=()=>{navigator.clipboard.readText().then((e=>{if(e)try{const t=JSON.parse(e);if(t&&t.length>0)for(const e of t)this.addPerson(e)}catch(t){if(t instanceof SyntaxError){const t=[",",";"];let n;try{for(const o of t)if(n=e.split(o),n.length>1){this.hideFlyout(),this.selectUsersById(n);break}}catch(Ye){}}}}),(e=>{}))},this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste)}get hasMaxSelections(){return"single"===this.selectionMode&&this.selectedPeople.length>=1}focus(e){this.input&&(this.input.focus(e),this.input.select())}selectUsersById(e){var t;return Ew(this,void 0,void 0,(function*(){const n=re.globalProvider,o=re.globalProvider.graph;if(n&&n.state===te.SignedIn)for(const r in e){const n=e[r];try{const e=yield Co(o,n,$i);this.addPerson(e)}catch(sL){if(Ho(sL)&&(null===(t=sL.message)||void 0===t?void 0:t.includes("does not exist"))&&this.allowAnyEmail&&Wn(n)){const e={mail:n,displayName:n};this.addPerson(e)}}}}))}selectGroupsById(e){return Ew(this,void 0,void 0,(function*(){const t=re.globalProvider,n=re.globalProvider.graph;if(t&&t.state===te.SignedIn)for(const o in e)try{const t=yield Gb(n,e[o]);this.addPerson(t)}catch(sL){}}))}render(){const e=this.renderTemplate("default",{people:this._foundPeople});if(e)return e;const t=this.renderSelectedPeople(this.selectedPeople),n=this.renderInput(t),o=this.renderFlyout(n);return ot(pw||(pw=Ht(["\n      <div>\n        ","\n      </div>\n    "])),o)}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(e){return e&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),super.requestStateUpdate(e)}renderInput(e){var t,n,o;const r=this.disabled?"":this.placeholder||this.strings.inputPlaceholderText,i=this.hasMaxSelections?this.strings.maxSelectionsAriaLabel:"",s=ot(fw||(fw=Ht(['<span class="search-icon">',"</span>"])),ei(Xr.Search)),a=(null===(t=this.selectedPeople)||void 0===t?void 0:t.length)>0?e:s;return ot(gw||(gw=Ht(['\n      <fluent-text-field\n        autocomplete="off"\n        appearance="outline"\n        slot="anchor"\n        id="people-picker-input"\n        role="combobox"\n        placeholder=',"\n        aria-label=","\n        aria-expanded=",'\n        @click="','"\n        @focus="','"\n        @keydown="','"\n        @input="','"\n        @blur="','"\n        ?disabled=','\n      >\n        <span slot="start">',"</span>\n      </fluent-text-field>\n    "])),this.hasMaxSelections?this.strings.maxSelectionsPlaceHolder:r,this.ariaLabel||i||r||this.strings.selectContact,null!==(o=null===(n=this.flyout)||void 0===n?void 0:n.isOpen)&&void 0!==o&&o,this.hasMaxSelections?void 0:this.handleInputClick,this.hasMaxSelections?void 0:this.gainedFocus,this.hasMaxSelections?void 0:this.onUserKeyDown,this.hasMaxSelections?void 0:this.onUserInput,this.lostFocus,this.disabled,a)}renderSelectedPeople(e){return(null===e||void 0===e?void 0:e.length)?ot(mw||(mw=Ht(['\n       <ul\n        id="selected-list"\n        aria-label="','"\n        class="selected-list">\n          ',"\n      </ul>"])),this.strings.selected,ss(e,(e=>null===e||void 0===e?void 0:e.id),(e=>{var t;return ot(yw||(yw=Ht(['\n            <li class="selected-list-item">\n              ','\n\n              <div\n                role="button"\n                tabindex="0"\n                class="selected-list-item-close-icon"\n                aria-label="',"",'"\n                @click="','"\n                @keydown="','">\n                  ',"\n              </div>\n          </li>"])),this.renderTemplate("selected-person",{person:e},"selected-".concat((null===e||void 0===e?void 0:e.id)?e.id:e.displayName))||this.renderSelectedPerson(e),this.strings.removeSelectedUser,null!==(t=null===e||void 0===e?void 0:e.displayName)&&void 0!==t?t:"",(t=>this.removePerson(e,t)),(t=>this.handleRemovePersonKeyDown(e,t)),ei(Xr.Close))}))):ot(vw||(vw=Ht([""])))}renderFlyout(e){return Sn(bw||(bw=Ht(['\n       <mgt-flyout light-dismiss class="flyout">\n         ','\n         <fluent-card\n          tabindex="0"\n          slot="flyout"\n          class="flyout-root"\n          @wheel=',"\n          @keydown=",'\n          class="custom">\n           ',"\n         </fluent-card>\n       </mgt-flyout>\n     "])),e,(e=>this.handleSectionScroll(e)),(e=>this.onUserKeyDown(e)),this.renderFlyoutContent())}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();const e=this._foundPeople;return e&&0!==e.length&&0!==this.showMax?this.renderSearchResults(e):this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||Sn(ww||(ww=Ht(['\n         <div class="message-parent">\n           <mgt-spinner></mgt-spinner>\n           <div aria-label="','" class="loading-text">\n             ',"\n           </div>\n         </div>\n       "])),this.strings.loadingMessage,this.strings.loadingMessage)}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||ot(kw||(kw=Ht(['\n         <div class="message-parent">\n           <div aria-label=',' class="search-error-text">\n             ',"\n           </div>\n         </div>\n       "])),this.strings.noResultsFound,this.strings.noResultsFound)}renderSearchResults(e){const t=e.filter((e=>e.id));return ot(xw||(xw=Ht(['\n      <ul\n        id="suggestions-list"\n        class="searched-people-list"\n        role="listbox"\n        aria-live="polite"\n        title=',"\n      >\n         ","\n       </ul>\n     "])),this.strings.suggestionsTitle,ss(t,(e=>e.id),(e=>ot(Cw||(Cw=Ht(['\n            <li\n              id="','"\n              class="searched-people-list-result"\n              role="option"\n              @click="','">\n                ',"\n            </li>\n          "])),e.id,(()=>this.handleSuggestionClick(e)),this.renderPersonResult(e)))))}renderPersonResult(e){return this.renderTemplate("person",{person:e},e.id)||Sn(_w||(_w=Ht(['\n         <mgt-person\n          class="person"\n          show-presence\n          view="twoLines"\n          line2-property="jobTitle,mail"\n          .personDetails=',"\n          .fetchImage=",">\n          .personCardInteraction=","\n        </mgt-person>"])),e,!this.disableImages,ui.none)}renderSelectedPerson(e){return Sn(Sw||(Sw=Ht(['\n       <mgt-person\n         tabindex="-1"\n         class="selected-list-item-person"\n         .personDetails=',"\n         .fetchImage=","\n         .view=","\n         .personCardInteraction=",">\n        </mgt-person>\n     "])),e,!this.disableImages,Vo.oneline,ui.none)}loadState(){var e,t,n,o;return Ew(this,void 0,void 0,(function*(){let r=this.people;const i=this.userInput.toLowerCase(),s=re.globalProvider;if(r){if(i){const e=r.filter((e=>null===e||void 0===e?void 0:e.displayName.toLowerCase().includes(i)));r=e}this._showLoading=!1}else if(!r&&s&&s.state===te.SignedIn){const a=s.graph.forComponent(this);if(!i.length){if(this.defaultPeople)r=this.defaultPeople;else{if(this.groupId||this.groupIds){if(null===this._groupPeople)if(this.groupId)try{this.type===co.group?this._groupPeople=yield To(a,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield To(a,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch(Ye){this._groupPeople=[]}else if(this.groupIds)if(this.type===co.group)try{this._groupPeople=yield $b(a,this.groupIds,this.groupFilters)}catch(Ye){this._groupPeople=[]}else try{const e=yield Io(a,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=e}catch(Ye){this._groupPeople=[]}r=this._groupPeople||[]}else if(this.type===co.person||this.type===co.any)if(this.userIds)r=yield _o(a,this.userIds,"",this.userFilters);else{const e=this.userType===uo.user||this.userType===uo.contact;r=this._userFilters&&e?yield function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return bo(void 0,void 0,void 0,(function*(){let o;const r="".concat(""===t?"*":t,":").concat(n),i={maxResults:n,results:null};if(ko()){o=bn.getCache(to,to.stores.userFilters);const e=yield o.getValue(r);if(e&&wo()>Date.now()-e.timeCached)return e.results.map((e=>JSON.parse(e)))}const s=e.api("/users").top(n);t&&s.filter(t);try{const e=yield s.middlewareOptions(ie("user.read")).get();return ko()&&e&&(i.results=e.value.map((e=>JSON.stringify(e))),yield o.putValue(t,i)),e.value}catch(a){}}))}(a,this._userFilters,this.showMax):yield vo(a,this.userType,this._peopleFilters,this.showMax)}else if(this.type===co.group)if(this.groupIds)try{r=yield this.getGroupsForGroupIds(a,r)}catch(Ye){}else{let e=(yield Kb(a,"",this.showMax,this.groupType,this._groupFilters))||[];e.length>0&&e[0].value&&(e=e[0].value),r=e}this.defaultPeople=r}this._isFocused&&(this._showLoading=!1)}if(!((null===(e=this.defaultSelectedUserIds)||void 0===e?void 0:e.length)>0||(null===(t=this.defaultSelectedGroupIds)||void 0===t?void 0:t.length)>0)||this.selectedPeople.length||this.defaultSelectedUsers.length||this.defaultSelectedGroups.length||(this.defaultSelectedUsers=yield _o(a,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield $b(a,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter((e=>null!==e)),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((e=>null!==e)),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),i)if(r=[],this.groupId)r=(yield To(a,i,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type===co.person||this.type===co.any){try{if(this.userType===uo.contact||this.userType===uo.user)r=(null===(n=this.userIds)||void 0===n?void 0:n.length)?yield _o(a,this.userIds,i,this._userFilters):yield So(a,i,this.showMax,this._userFilters);else if(this.groupIds)try{r=yield Io(a,i,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch(Ye){}else r=(null===(o=this.userIds)||void 0===o?void 0:o.length)?yield _o(a,this.userIds,i,this._userFilters):(yield go(a,i,this.showMax,this.userType,this._peopleFilters))||[]}catch(sL){}if(r&&r.length<this.showMax&&this.userType!==uo.contact&&this.type!==co.person)try{const e=(yield So(a,i,this.showMax,this._userFilters))||[],t=new Set(r.map((e=>e.id)));for(const n of e)t.has(n.id)||r.push(n)}catch(sL){}}if((this.type===co.group||this.type===co.any)&&r.length<this.showMax)if(this.groupIds)try{r=yield function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qb.any,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return Bb(void 0,void 0,void 0,(function*(){const s=[],a=yield Kb(e,t,o,r,i);if(a)for(const e of a)e.id&&n.includes(e.id)&&s.push(e);return s}))}(a,i,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch(Ye){}else{let e=[];try{e=(yield Kb(a,i,this.showMax,this.groupType,this._groupFilters))||[],r=r.concat(e)}catch(sL){}}}}this._foundPeople=this.filterPeople(r)}))}getGroupsForGroupIds(e,t){return Ew(this,void 0,void 0,(function*(){const n=yield $b(e,this.groupIds,this.groupFilters);for(const e of n)t=t.concat(e);return t=t.filter((e=>e))}))}hideFlyout(){const e=this.flyout;e&&e.close(),this.input&&this.input.setAttribute("aria-activedescendant",""),this._arrowSelectionCount=-1}showFlyout(){const e=this.flyout;e&&e.open(),this._arrowSelectionCount=-1}removePerson(e,t){t.stopPropagation();const n=this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName!==e.displayName:t.id!==e.id)),o=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&o&&o.removeAttribute("disabled"),this.selectedPeople=n,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople),null===o||void 0===o||o.focus()}handleRemovePersonKeyDown(e,t){"Enter"===t.key&&this.removePerson(e,t)}addPerson(e){if(e){setTimeout((()=>{this.clearInput()}),50);const t=this.selectedPeople.filter((t=>!e.id&&t.displayName?t.displayName===e.displayName:t.id===e.id));0===t.length&&(this.selectedPeople=[...this.selectedPeople,e],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1)}}clearInput(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=-1,Wn(this.userInput)){const e={mail:this.userInput,displayName:this.userInput};this.addPerson(e)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(e){this.addPerson(e);const t=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&t&&(t.setAttribute("disabled","true"),this.input.value=t.value=""),this.hideFlyout()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=Kn((()=>Ew(this,void 0,void 0,(function*(){const e=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(e),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout()}))),400)),this._debouncedSearch()}writeHighlightedText(){return Ew(this,void 0,void 0,(function*(){const e=[];for(const n of this._highlightedUsers){const{id:t,displayName:o,mail:r,userPrincipalName:i,scoredEmailAddresses:s}=n._personDetails;let a;a=s&&s.length>0?s.pop().address:i||r,e.push({id:t,displayName:o,email:a})}let t="";e.length>0&&(t=JSON.stringify(e)),yield navigator.clipboard.writeText(t)}))}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}highlightSelectedPeople(e){for(const t of e){(null===t||void 0===t?void 0:t.parentElement).classList.add("highlighted")}}clearHighlighted(e){if(e)e.classList.remove("highlighted");else{for(const e of this._highlightedUsers){const t=e.parentElement;t&&t.classList.remove("highlighted")}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}handleArrowSelection(e){var t,n;const o=this.renderRoot.querySelector(".searched-people-list");if(null===(t=null===o||void 0===o?void 0:o.children)||void 0===t?void 0:t.length){e&&("ArrowUp"===e.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+o.children.length)%o.children.length),"ArrowDown"===e.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1+o.children.length)%o.children.length));for(const e of null!==(n=null===o||void 0===o?void 0:o.children)&&void 0!==n?n:[]){const t=e;t.setAttribute("aria-selected","false"),t.blur(),t.removeAttribute("tabindex")}const t=o.children[this._arrowSelectionCount];t&&(t.setAttribute("tabindex","0"),t.focus(),t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),t.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",null===t||void 0===t?void 0:t.id))}}filterPeople(e){const t=[];if(e&&e.length>0){e=e.filter((e=>e));const n=this.selectedPeople.map((e=>e.id?e.id:e.displayName)),o=e.filter((e=>(null===e||void 0===e?void 0:e.id)?-1===n.indexOf(e.id):-1===n.indexOf(null===e||void 0===e?void 0:e.displayName))),r=new Set;for(const e of o){const t=JSON.stringify(e);r.add(t)}r.forEach((e=>{const n=JSON.parse(e);t.push(n)}))}return t}handleSectionScroll(e){const t=this.renderRoot.querySelector(".flyout-root");t&&(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.clientHeight+t.scrollTop>=t.scrollHeight-1||e.stopPropagation())}};Tw([Et({attribute:"group-id",converter:e=>e.trim()}),Iw("design:type",String),Iw("design:paramtypes",[Object])],Aw.prototype,"groupId",null),Tw([Et({attribute:"group-ids",converter:e=>e.split(",").map((e=>e.trim()))}),Iw("design:type",Array),Iw("design:paramtypes",[Object])],Aw.prototype,"groupIds",null),Tw([Et({attribute:"type",converter:e=>(e=e.toLowerCase())&&0!==e.length?"undefined"===typeof co[e]?co.any:co[e]:co.any}),Iw("design:type",Object),Iw("design:paramtypes",[Object])],Aw.prototype,"type",null),Tw([Et({attribute:"group-type",converter:e=>{if(!e||0===e.length)return qb.any;const t=e.split(","),n=[];for(let r of t)r=r.trim(),"undefined"!==typeof qb[r]&&n.push(qb[r]);if(0===n.length)return qb.any;const o=n.reduce(((e,t)=>e|t));return o}}),Iw("design:type",Number),Iw("design:paramtypes",[Object])],Aw.prototype,"groupType",null),Tw([Et({attribute:"user-type",converter:e=>(e=e.toLowerCase())&&"undefined"!==typeof uo[e]?uo[e]:uo.any}),Iw("design:type",String),Iw("design:paramtypes",[Object])],Aw.prototype,"userType",null),Tw([Et({attribute:"transitive-search",type:Boolean}),Iw("design:type",Boolean),Iw("design:paramtypes",[Boolean])],Aw.prototype,"transitiveSearch",null),Tw([Et({attribute:"people",type:Object}),Iw("design:type",Array),Iw("design:paramtypes",[Array])],Aw.prototype,"people",null),Tw([Et({attribute:"show-max",type:Number}),Iw("design:type",Number),Iw("design:paramtypes",[Number])],Aw.prototype,"showMax",null),Tw([Et({attribute:"disable-images",type:Boolean}),Iw("design:type",Boolean)],Aw.prototype,"disableImages",void 0),Tw([Et({attribute:"selected-people",type:Array}),Iw("design:type",Array),Iw("design:paramtypes",[Array])],Aw.prototype,"selectedPeople",null),Tw([Et({attribute:"default-selected-user-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),Iw("design:type",Array),Iw("design:paramtypes",[Object])],Aw.prototype,"defaultSelectedUserIds",null),Tw([Et({attribute:"default-selected-group-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),Iw("design:type",Array),Iw("design:paramtypes",[Object])],Aw.prototype,"defaultSelectedGroupIds",null),Tw([Et({attribute:"placeholder",type:String}),Iw("design:type",String)],Aw.prototype,"placeholder",void 0),Tw([Et({attribute:"disabled",type:Boolean}),Iw("design:type",Boolean)],Aw.prototype,"disabled",void 0),Tw([Et({attribute:"allow-any-email",type:Boolean}),Iw("design:type",Boolean)],Aw.prototype,"allowAnyEmail",void 0),Tw([Et({attribute:"selection-mode",type:String}),Iw("design:type",String)],Aw.prototype,"selectionMode",void 0),Tw([Et({attribute:"user-ids",converter:e=>e.split(",").map((e=>e.trim())),type:String}),Iw("design:type",Array),Iw("design:paramtypes",[Array])],Aw.prototype,"userIds",null),Tw([Et({attribute:"user-filters"}),Iw("design:type",String),Iw("design:paramtypes",[String])],Aw.prototype,"userFilters",null),Tw([Et({attribute:"people-filters"}),Iw("design:type",String),Iw("design:paramtypes",[String])],Aw.prototype,"peopleFilters",null),Tw([Et({attribute:"group-filters"}),Iw("design:type",String),Iw("design:paramtypes",[String])],Aw.prototype,"groupFilters",null),Tw([Et({attribute:"aria-label",type:String}),Iw("design:type",String)],Aw.prototype,"ariaLabel",void 0),Tw([At(),Iw("design:type",Boolean)],Aw.prototype,"_showLoading",void 0),Tw([At(),Iw("design:type",Object)],Aw.prototype,"_arrowSelectionCount",void 0),Tw([At(),Iw("design:type",Array)],Aw.prototype,"_highlightedUsers",void 0),Tw([At(),Iw("design:type",Object)],Aw.prototype,"_isFocused",void 0),Tw([At(),Iw("design:type",Object)],Aw.prototype,"_setAnyEmail",void 0),Tw([At(),Iw("design:type",Array)],Aw.prototype,"_foundPeople",void 0),Aw=Tw([Tn("people-picker"),Iw("design:paramtypes",[])],Aw);var Rw=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const Pw="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",Ow="directReports",Dw="files",Mw="messages",Nw="people",Lw="person",Fw=(e,t)=>{const n="manager($levels=max;$select=".concat(Pw,")");e.get(Lw,"users/".concat(t,"?$expand=").concat(n,"&$select=").concat(Pw,"&$count=true"),["user.read.all"],{ConsistencyLevel:"eventual"}),e.get(Ow,"users/".concat(t,"/directReports?$select=").concat(Pw))},Uw=(e,t)=>{e.get(Nw,"users/".concat(t,"/people?$filter=personType/class eq 'Person'"),["People.Read.All"])},zw=(e,t)=>{e.get(Mw,'me/messages?$search="from:'.concat(t,'"'),["Mail.ReadBasic"])},Hw=(e,t)=>{let n;n=t?"me/insights/shared?$filter=lastshared/sharedby/address eq '".concat(t,"'"):"me/insights/used",e.get(Dw,n,["Sites.Read.All"])},qw=(e,t)=>Rw(void 0,void 0,void 0,(function*(){return yield e.api("/users/".concat(t,"/profile")).version("beta").get()}));var Bw;const Vw=[Ce(Bw||(Bw=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow-y:auto;overflow-x:hidden}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow-y:auto;overflow-x:hidden}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'])))];var jw,Kw,Gw,$w=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ww=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};class Qw extends Qt{get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return Sn(jw||(jw=Ht(['\n      <div class="loading">\n        <mgt-spinner></mgt-spinner>\n      </div>\n    '])))}renderNoData(){return ot(Kw||(Kw=Ht(['\n      <div class="no-data">No data</div>\n    '])))}navigateCard(e){var t;let n=this.parentNode;for(;n;){n=n.parentNode;const e=n;if((null===(t=null===e||void 0===e?void 0:e.host)||void 0===t?void 0:t.tagName)==="".concat(ge.prefix,"-PERSON-CARD").toUpperCase()){n=e.host;break}}n.navigate(e)}}$w([Et({attribute:"person-details",type:Object}),Ww("design:type",Object),Ww("design:paramtypes",[Object])],Qw.prototype,"personDetails",null);const Yw=[Ce(Gw||(Gw=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'])))],Zw={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"};var Jw,Xw,ek,tk,nk,ok,rk,ik=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},sk=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ak=class extends Qw{static get styles(){return Yw}get strings(){return Zw}get hasData(){if(!this._contactParts)return!1;const e=Object.values(this._contactParts).filter((e=>!!e.value));return!!e.length}constructor(e){var t;super(),this._contactParts={email:{icon:ei(Xr.Email),onClick:()=>this.sendEmail(mo(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:ei(Xr.Chat),onClick:()=>{var e;return this.sendChat(null===(e=this._person)||void 0===e?void 0:e.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:ei(Xr.Phone),onClick:()=>{var e,t;return this.sendCall((null===(t=null===(e=this._person)||void 0===e?void 0:e.businessPhones)||void 0===t?void 0:t.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:ei(Xr.CellPhone),onClick:()=>{var e;return this.sendCall(null===(e=this._person)||void 0===e?void 0:e.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:ei(Xr.Department),showCompact:!1,title:this.strings.departmentTitle},title:{icon:ei(Xr.Person),showCompact:!1,title:this.strings.titleTitle},officeLocation:{icon:ei(Xr.OfficeLocation),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=e=>{this.sendLink("tel:",e)},this._person=e,this._contactParts.email.value=mo(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,(null===(t=this._person.businessPhones)||void 0===t?void 0:t.length)&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}get cardTitle(){return this.strings.contactSectionTitle}renderIcon(){return ei(Xr.Contact)}clearState(){super.clearState();for(const e of Object.keys(this._contactParts))this._contactParts[e].value=null}renderCompactView(){if(!this.hasData)return null;const e=Object.values(this._contactParts).filter((e=>!!e.value));let t=Object.values(e).filter((e=>!!e.value&&e.showCompact));(null===t||void 0===t?void 0:t.length)||(t=Object.values(e).slice(0,2));const n=ot(Jw||(Jw=Ht(["\n      ","\n    "])),t.map((e=>this.renderContactPart(e))));return ot(Xw||(Xw=Ht(['\n      <div class="root compact" dir=',">\n        ","\n      </div>\n    "])),this.direction,n)}renderFullView(){let e;if(this.hasData){const t=Object.values(this._contactParts).filter((e=>!!e.value));e=ot(ek||(ek=Ht(["\n        ","\n      "])),t.map((e=>this.renderContactPart(e))))}return ot(tk||(tk=Ht(['\n      <div class="root" dir=',">\n        ","\n      </div>\n    "])),this.direction,e)}renderContactPart(e){let t=!1;"Mobile Phone"!==e.title&&"Business Phone"!==e.title||(t=!0);const n={part__link:!0,phone:t},o=e.onClick?ot(nk||(nk=Ht(["\n          <span class="," @click=",">","</span>\n        "])),Bn(n),(t=>e.onClick(t)),e.value):ot(ok||(ok=Ht(["\n          ","\n        "])),e.value);return ot(rk||(rk=Ht(['\n      <div class="part" role="button" @click=',' tabindex="0">\n        <div class="part__icon" aria-label='," title=",">",'</div>\n        <div class="part__details">\n          <div class="part__title">','</div>\n          <div class="part__value" title=',">",'</div>\n        </div>\n        <div\n          class="part__copy"\n          aria-label=',"\n          title=","\n        >\n          ","\n        </div>\n      </div>\n    "])),(t=>this.handlePartClick(t,e.value)),e.title,e.title,e.icon,e.title,e.title,o,this.strings.copyToClipboardButton,this.strings.copyToClipboardButton,ei(Xr.Copy))}handlePartClick(e,t){t&&navigator.clipboard.writeText(t)}sendLink(e,t){t?window.open("".concat(e).concat(t),"_blank","noreferrer"):console.error("\ud83e\udd92: Target resource for ".concat(e," link was not provided: resource: ").concat(t))}sendChat(e){if(!e)return void console.error("\ud83e\udd92: Can't send chat when upn is not provided");const t="https://teams.microsoft.com/l/chat/0/0?users=".concat(e),n=()=>window.open(t,"_blank","noreferrer");wn.isAvailable?wn.executeDeepLink(t,(e=>{e||n()})):n()}sendEmail(e){this.sendLink("mailto:",e)}};var lk;ak=ik([Tn("contact"),sk("design:paramtypes",[Object])],ak);const ck=[Ce(lk||(lk=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-subject-font-size,12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-subject-font-size,12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-subject-font-size,12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-subject-font-size,12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}\n'])))],dk={emailsSectionTitle:"Emails"};var uk,hk,pk,fk,gk,vk=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},mk=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let yk=class extends Qw{static get styles(){return ck}get strings(){return dk}constructor(e){super(),this._messages=e}get displayName(){return this.strings.emailsSectionTitle}get cardTitle(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return ei(Xr.Messages)}renderCompactView(){var e;let t;if(this.isLoadingState)t=this.renderLoading();else if(null===(e=this._messages)||void 0===e?void 0:e.length){const e=this._messages?this._messages.slice(0,3).map((e=>this.renderMessage(e))):[];t=ot(uk||(uk=Ht(["\n         ","\n       "])),e)}else t=this.renderNoData();return ot(hk||(hk=Ht(['\n       <div class="root compact">\n         ',"\n       </div>\n     "])),t)}renderFullView(){var e;let t;return t=this.isLoadingState?this.renderLoading():(null===(e=this._messages)||void 0===e?void 0:e.length)?ot(pk||(pk=Ht(["\n         ","\n       "])),this._messages.slice(0,5).map((e=>this.renderMessage(e)))):this.renderNoData(),ot(fk||(fk=Ht(['\n       <div class="root">\n         ',"\n       </div>\n     "])),t)}renderMessage(e){return ot(gk||(gk=Ht(['\n       <div class="message" @click=','>\n         <div class="message__detail">\n           <div class="message__subject">','</div>\n           <div class="message__from">','</div>\n           <div class="message__message">','</div>\n         </div>\n         <div class="message__date">',"</div>\n       </div>\n     "])),(()=>this.handleMessageClick(e)),e.subject,e.from.emailAddress.name,e.bodyPreview,Vn(new Date(e.receivedDateTime)))}handleMessageClick(e){window.open(e.webLink,"_blank","noreferrer")}};var bk;yk=vk([Tn("messages"),mk("design:paramtypes",[Array])],yk);const wk=[Ce(bk||(bk=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}\n'])))],kk={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var xk,Ck,_k,Sk,Tk,Ik,Ek,Ak,Rk,Pk,Ok,Dk=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Mk=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Nk=class extends Qw{static get styles(){return wk}get strings(){return kk}constructor(e,t){super(),this._state=e,this._me=t}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:e,directReports:t}=this._state;return!e.manager&&(null===t||void 0===t?void 0:t.length)?"".concat(this.strings.directReportsSectionTitle," (").concat(t.length,")"):this.strings.reportsToSectionTitle}get cardTitle(){return this.strings.organizationSectionTitle}renderIcon(){return ei(Xr.Organization)}renderCompactView(){var e;let t;if(!(null===(e=this._state)||void 0===e?void 0:e.person))return null;const{person:n,directReports:o}=this._state;return n?(n.manager?t=this.renderCoworker(n.manager):(null===o||void 0===o?void 0:o.length)&&(t=this.renderCompactDirectReports()),ot(xk||(xk=Ht(['\n        <div class="root compact">\n          ',"\n        </div>\n      "])),t)):null}renderFullView(){var e;let t;if(!(null===(e=this._state)||void 0===e?void 0:e.person))return null;const{person:n,directReports:o,people:r}=this._state;if(!(n||o||r))return null;{const e=this.renderManagers(),n=this.renderCurrentUser(),o=this.renderDirectReports(),r=this.renderCoworkers();t=ot(Ck||(Ck=Ht(["\n          "," "," "," ","\n        "])),e,n,o,r)}return ot(_k||(_k=Ht(['\n       <div class="root" dir=',">\n         ","\n       </div>\n     "])),this.direction,t)}renderManager(e){return Sn(Sk||(Sk=Ht(['\n      <div\n        class="org-member"\n        @keydown=',"\n        @click=",'\n      >\n        <div class="org-member__person">\n          <mgt-person\n            .personDetails=',"\n            .fetchImage=","\n            .view=","\n            .showPresence=",'\n          ></mgt-person>\n        </div>\n        <div tabindex="0" class="org-member__more">\n          ','\n        </div>\n      </div>\n      <div class="org-member__separator"></div>\n     '])),(t=>{"Enter"!==t.code&&" "!==t.code||this.navigateCard(e)}),(()=>this.navigateCard(e)),e,!0,Vo.twolines,!0,ei(Xr.ExpandRight))}renderManagers(){const{person:e}=this._state;if(!(null===e||void 0===e?void 0:e.manager))return null;const t=[];let n=e;for(;n.manager;)t.push(n.manager),n=n.manager;return t.length?t.reverse().map((e=>this.renderManager(e))):null}renderDirectReports(){const{directReports:e}=this._state;return(null===e||void 0===e?void 0:e.length)?ot(Tk||(Tk=Ht(['\n      <div class="org-member__separator"></div>\n      <div>\n        ',"\n      </div>\n     "])),e.map((e=>Sn(Ik||(Ik=Ht(['\n            <div\n              class="org-member org-member--direct-report"\n              @keydown=',"\n              @click=",'\n            >\n              <div class="org-member__person">\n                <mgt-person\n                  .personDetails=',"\n                  .fetchImage=","\n                  .showPresence=","\n                  .view=",'\n                ></mgt-person>\n              </div>\n              <div tabindex="0" class="org-member__more">\n                ','\n              </div>\n            </div>\n            <div class="org-member__separator"></div>\n          '])),(t=>{"Enter"!==t.code&&" "!==t.code||this.navigateCard(e)}),(()=>this.navigateCard(e)),e,!0,!0,Vo.twolines,ei(Xr.ExpandRight))))):null}renderCompactDirectReports(){const{directReports:e}=this._state;return ot(Ek||(Ek=Ht(['\n      <div class="direct-report__compact">\n        ',"\n      </div>\n    "])),e.slice(0,6).map((e=>Sn(Ak||(Ak=Ht(['\n            <div\n              class="direct-report"\n              @keydown=',"\n              @click=","\n            >\n              <mgt-person\n                .personDetails=","\n                .fetchImage=","\n                .showPresence=","\n                .view=","\n              ></mgt-person>\n            </div>\n          "])),(t=>{"Enter"!==t.code&&" "!==t.code||this.navigateCard(e)}),(()=>this.navigateCard(e)),e,!0,!0,Vo.twolines))))}renderCurrentUser(){const{person:e}=this._state;return Sn(Rk||(Rk=Ht(['\n       <div class="org-member org-member--target">\n         <div class="org-member__person">\n           <mgt-person\n             .personDetails=',"\n             .fetchImage=","\n             .showPresence=","\n             .view=","\n           ></mgt-person>\n         </div>\n       </div>\n     "])),e,!0,!0,Vo.twolines)}renderCoworker(e){return Sn(Pk||(Pk=Ht(['\n      <div\n        class="coworker"\n        @keydown=',"\n        @click=",'\n      >\n        <div class="coworker__person">\n          <mgt-person\n            .personDetails=',"\n            .fetchImage=","\n            .showPresence=","\n            .view=","\n          ></mgt-person>\n        </div>\n      </div>\n    "])),(t=>{"Enter"!==t.code&&" "!==t.code||this.navigateCard(e)}),(()=>this.navigateCard(e)),e,!0,!0,Vo.twolines)}renderCoworkers(){const{people:e}=this._state;if(!(null===e||void 0===e?void 0:e.length))return null;const t=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:"".concat(this._state.person.givenName," ").concat(this.strings.userWorksWithSubSectionTitle);return ot(Ok||(Ok=Ht(['\n       <div class="divider"></div>\n       <div class="subtitle" tabindex="0">',"</div>\n       <div>\n         ","\n       </div>\n     "])),t,e.slice(0,6).map((e=>this.renderCoworker(e))))}};var Lk;Nk=Dk([Tn("organization"),Mk("design:paramtypes",[Object,Object])],Nk);const Fk=[Ce(Lk||(Lk=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}\n'])))],Uk={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"};var zk,Hk,qk,Bk,Vk,jk,Kk,Gk,$k,Wk,Qk,Yk,Zk,Jk,Xk,ex,tx,nx=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ox=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let rx=class extends Qw{static get styles(){return Fk}get strings(){return Uk}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get cardTitle(){return this.strings.AboutCompactSectionTitle}get hasData(){var e,t;if(!this.profile)return!1;const{languages:n,skills:o,positions:r,educationalActivities:i}=this.profile;return[this._birthdayAnniversary,null===(e=this._personalInterests)||void 0===e?void 0:e.length,null===(t=this._professionalInterests)||void 0===t?void 0:t.length,null===n||void 0===n?void 0:n.length,null===o||void 0===o?void 0:o.length,null===r||void 0===r?void 0:r.length,null===i||void 0===i?void 0:i.length].filter((e=>!!e)).length>0}get profile(){return this._profile}set profile(e){e!==this._profile&&(this._profile=e,this._birthdayAnniversary=(null===e||void 0===e?void 0:e.anniversaries)?e.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=(null===e||void 0===e?void 0:e.interests)?e.interests.filter(this.isPersonalInterest):null,this._professionalInterests=(null===e||void 0===e?void 0:e.interests)?e.interests.filter(this.isProfessionalInterest):null)}constructor(e){super(),this.isPersonalInterest=e=>{var t;return null===(t=e.categories)||void 0===t?void 0:t.includes("personal")},this.isProfessionalInterest=e=>{var t;return null===(t=e.categories)||void 0===t?void 0:t.includes("professional")},this.isBirthdayAnniversary=e=>"birthday"===e.type,this.profile=e}renderIcon(){return ei(Xr.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return ot(zk||(zk=Ht(['\n       <div class="root compact" dir=',">\n         ","\n       </div>\n     "])),this.direction,this.renderSubSections().slice(0,2))}renderFullView(){return this.initPostRenderOperations(),ot(Hk||(Hk=Ht(['\n       <div class="root" dir=',">\n         ","\n       </div>\n     "])),this.direction,this.renderSubSections())}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((e=>!!e))}renderLanguages(){var e;const{languages:t}=this._profile;if(!(null===t||void 0===t?void 0:t.length))return null;const n=[];for(const r of t){let t=null;(null===(e=r.proficiency)||void 0===e?void 0:e.length)&&(t=ot(qk||(qk=Ht(['\n           <span class="language__proficiency" tabindex="0">\n             &nbsp;(',")\n           </span>\n         "])),r.proficiency)),n.push(ot(Bk||(Bk=Ht(['\n         <div class="token-list__item language">\n           <span class="language__title" tabindex="0">',"</span>\n           ","\n         </div>\n       "])),r.displayName,t))}const o=n.length?this.strings.LanguagesSubSectionTitle:"";return ot(Vk||(Vk=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="token-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),o,n)}renderSkills(){const{skills:e}=this._profile;if(!(null===e||void 0===e?void 0:e.length))return null;const t=[];for(const o of e)t.push(ot(jk||(jk=Ht(['\n         <div class="token-list__item skill" tabindex="0">\n           ',"\n         </div>\n       "])),o.displayName));const n=t.length?this.strings.SkillsSubSectionTitle:"";return ot(Kk||(Kk=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="token-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),n,t)}renderWorkExperience(){var e,t,n,o,r;const{positions:i}=this._profile;if(!(null===i||void 0===i?void 0:i.length))return null;const s=[];for(const l of this._profile.positions)(l.detail.description||""!==l.detail.jobTitle)&&s.push(ot(Gk||(Gk=Ht(['\n           <div class="data-list__item work-position">\n             <div class="data-list__item__header">\n               <div class="data-list__item__title" tabindex="0">','</div>\n               <div class="data-list__item__date-range" tabindex="0">\n                 ','\n               </div>\n             </div>\n             <div class="data-list__item__content">\n               <div class="work-position__company" tabindex="0">\n                 ','\n               </div>\n               <div class="work-position__location" tabindex="0">\n                 ',"\n               </div>\n             </div>\n           </div>\n         "])),null===(e=l.detail)||void 0===e?void 0:e.jobTitle,this.getDisplayDateRange(l.detail),null===(n=null===(t=null===l||void 0===l?void 0:l.detail)||void 0===t?void 0:t.company)||void 0===n?void 0:n.displayName,this.displayLocation(null===(r=null===(o=null===l||void 0===l?void 0:l.detail)||void 0===o?void 0:o.company)||void 0===r?void 0:r.address)));const a=s.length?this.strings.WorkExperienceSubSectionTitle:"";return ot($k||($k=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="data-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),a,s)}renderEducation(){const{educationalActivities:e}=this._profile;if(!(null===e||void 0===e?void 0:e.length))return null;const t=[];for(const o of e)t.push(ot(Wk||(Wk=Ht(['\n         <div class="data-list__item educational-activity">\n           <div class="data-list__item__header">\n             <div class="data-list__item__title" tabindex="0">','</div>\n             <div class="data-list__item__date-range" tabindex="0">\n               ',"\n             </div>\n           </div>\n           ","\n         </div>\n       "])),o.institution.displayName,this.getDisplayDateRange(o),o.program.displayName?ot(Qk||(Qk=Ht(['<div class="data-list__item__content">\n                  <div class="educational-activity__degree" tabindex="0">\n                  ',"\n                </div>"])),o.program.displayName):it));const n=t.length?this.strings.EducationSubSectionTitle:"";return ot(Yk||(Yk=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="data-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),n,t)}renderProfessionalInterests(){var e;if(!(null===(e=this._professionalInterests)||void 0===e?void 0:e.length))return null;const t=[];for(const o of this._professionalInterests)t.push(ot(Zk||(Zk=Ht(['\n         <div class="token-list__item interest interest--professional" tabindex="0">\n           ',"\n         </div>\n       "])),o.displayName));const n=t.length?this.strings.professionalInterestsSubSectionTitle:"";return ot(Jk||(Jk=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="token-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),n,t)}renderPersonalInterests(){var e;if(!(null===(e=this._personalInterests)||void 0===e?void 0:e.length))return null;const t=[];for(const o of this._personalInterests)t.push(ot(Xk||(Xk=Ht(['\n         <div class="token-list__item interest interest--personal" tabindex="0">\n           ',"\n         </div>\n       "])),o.displayName));const n=t.length?this.strings.personalInterestsSubSectionTitle:"";return ot(ex||(ex=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">','</div>\n         <div class="section__content">\n           <div class="token-list">\n             ',"\n           </div>\n         </div>\n       </section>\n     "])),n,t)}renderBirthday(){var e;return(null===(e=this._birthdayAnniversary)||void 0===e?void 0:e.date)?ot(tx||(tx=Ht(['\n       <section>\n         <div class="section__title" tabindex="0">Birthday</div>\n         <div class="section__content">\n           <div class="birthday">\n             <div class="birthday__icon">\n               ','\n             </div>\n             <div class="birthday__date" tabindex="0">\n               ',"\n             </div>\n           </div>\n         </div>\n       </section>\n     "])),ei(Xr.Birthday),this.getDisplayDate(new Date(this._birthdayAnniversary.date))):null}getDisplayDate(e){return e.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(e){if(!e.startMonthYear)return it;const t=new Date(e.startMonthYear).getFullYear();if(0===t||1===t)return it;const n=e.endMonthYear?new Date(e.endMonthYear).getFullYear():this.strings.currentYearSubtitle;return"".concat(t," \u2014 ").concat(n)}displayLocation(e){return(null===e||void 0===e?void 0:e.city)?e.state?"".concat(e.city,", ").concat(e.state):e.city:it}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((e=>{this.handleTokenOverflow(e)}))}catch(e){}}),0)}handleTokenOverflow(e){const t=e.querySelectorAll(".token-list");if(null===t||void 0===t?void 0:t.length)for(const n of Array.from(t)){const e=n.querySelectorAll(".token-list__item");if(!(null===e||void 0===e?void 0:e.length))continue;let t=null,o=e[0].getBoundingClientRect();const r=n.getBoundingClientRect(),i=2*o.height+r.top;for(let n=0;n<e.length-1;n++)if(o=e[n].getBoundingClientRect(),o.top>i){t=Array.from(e).slice(n,e.length);break}if(t){t.forEach((e=>e.classList.add("overflow")));const e=document.createElement("div");e.classList.add("token-list__item"),e.classList.add("token-list__item--show-overflow"),e.tabIndex=0,e.innerText="+ ".concat(t.length," more");const o=()=>{e.remove(),t.forEach((e=>e.classList.remove("overflow")))};e.addEventListener("click",(()=>{o()})),e.addEventListener("keydown",(e=>{"Enter"===e.code&&o()})),n.appendChild(e)}}}};rx=nx([Tn("profile"),ox("design:paramtypes",[Object])],rx);const ix={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message",expandDetailsLabel:"Expand details",sendMessageLabel:"Send message",emailButtonLabel:"Email",callButtonLabel:"Call",chatButtonLabel:"Chat",closeCardLabel:"Close card",videoButtonLabel:"Video",goBackLabel:"Go Back"},sx="horizontal";class ax extends Wa{constructor(){super(...arguments),this.orientation=sx,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=e=>"true"===e.getAttribute("aria-disabled"),this.isHiddenElement=e=>e.hasAttribute("hidden"),this.isFocusableElement=e=>!this.isDisabledElement(e)&&!this.isHiddenElement(e),this.setTabs=()=>{const e="gridColumn",t="gridRow",n=this.isHorizontal()?e:t;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach(((o,r)=>{if("tab"===o.slot){const e=this.activeTabIndex===r&&this.isFocusableElement(o);this.activeindicator&&this.isFocusableElement(o)&&(this.showActiveIndicator=!0);const t=this.tabIds[r],n=this.tabpanelIds[r];o.setAttribute("id",t),o.setAttribute("aria-selected",e?"true":"false"),o.setAttribute("aria-controls",n),o.addEventListener("click",this.handleTabClick),o.addEventListener("keydown",this.handleTabKeyDown),o.setAttribute("tabindex",e?"0":"-1"),e&&(this.activetab=o,this.activeid=t)}o.style[e]="",o.style[t]="",o.style[n]="".concat(r+1),this.isHorizontal()?o.classList.remove("vertical"):o.classList.add("vertical")}))},this.setTabPanels=()=>{this.tabpanels.forEach(((e,t)=>{const n=this.tabIds[t],o=this.tabpanelIds[t];e.setAttribute("id",o),e.setAttribute("aria-labelledby",n),this.activeTabIndex!==t?e.setAttribute("hidden",""):e.removeAttribute("hidden")}))},this.handleTabClick=e=>{const t=e.currentTarget;1===t.nodeType&&this.isFocusableElement(t)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(t),this.setComponent())},this.handleTabKeyDown=e=>{if(this.isHorizontal())switch(e.key){case yg:e.preventDefault(),this.adjustBackward(e);break;case bg:e.preventDefault(),this.adjustForward(e)}else switch(e.key){case wg:e.preventDefault(),this.adjustBackward(e);break;case mg:e.preventDefault(),this.adjustForward(e)}switch(e.key){case Cg:e.preventDefault(),this.adjust(-this.activeTabIndex);break;case _g:e.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1)}},this.adjustForward=e=>{const t=this.tabs;let n=0;for(n=this.activetab?t.indexOf(this.activetab)+1:1,n===t.length&&(n=0);n<t.length&&t.length>1;){if(this.isFocusableElement(t[n])){this.moveToTabByIndex(t,n);break}if(this.activetab&&n===t.indexOf(this.activetab))break;n+1>=t.length?n=0:n+=1}},this.adjustBackward=e=>{const t=this.tabs;let n=0;for(n=this.activetab?t.indexOf(this.activetab)-1:0,n=n<0?t.length-1:n;n>=0&&t.length>1;){if(this.isFocusableElement(t[n])){this.moveToTabByIndex(t,n);break}n-1<0?n=t.length-1:n-=1}},this.moveToTabByIndex=(e,t)=>{const n=e[t];this.activetab=n,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=t,n.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(e,t){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex((t=>t.id===e)),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return void 0!==this.activeid?-1===this.tabIds.indexOf(this.activeid)?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map((e=>{var t;return null!==(t=e.getAttribute("id"))&&void 0!==t?t:"tab-".concat(qm())}))}getTabPanelIds(){return this.tabpanels.map((e=>{var t;return null!==(t=e.getAttribute("id"))&&void 0!==t?t:"panel-".concat(qm())}))}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===sx}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;const e=this.isHorizontal()?"gridColumn":"gridRow",t=this.isHorizontal()?"translateX":"translateY",n=this.isHorizontal()?"offsetLeft":"offsetTop",o=this.activeIndicatorRef[n];this.activeIndicatorRef.style[e]="".concat(this.activeTabIndex+1);const r=this.activeIndicatorRef[n];this.activeIndicatorRef.style[e]="".concat(this.prevActiveTabIndex+1);const i=r-o;this.activeIndicatorRef.style.transform="".concat(t,"(").concat(i,"px)"),this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",(()=>{this.ticking=!1,this.activeIndicatorRef.style[e]="".concat(this.activeTabIndex+1),this.activeIndicatorRef.style.transform="".concat(t,"(0px)"),this.activeIndicatorRef.classList.remove("activeIndicatorTransition")}))}adjust(e){const t=this.tabs.filter((e=>this.isFocusableElement(e))),n=t.indexOf(this.activetab),o=Bm(0,t.length-1,n+e),r=this.tabs.indexOf(t[o]);r>-1&&this.moveToTabByIndex(this.tabs,r)}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}}var lx,cx;ta([Ys],ax.prototype,"orientation",void 0),ta([Ys],ax.prototype,"activeid",void 0),ta([Ms],ax.prototype,"tabs",void 0),ta([Ms],ax.prototype,"tabpanels",void 0),ta([Ys({mode:"boolean"})],ax.prototype,"activeindicator",void 0),ta([Ms],ax.prototype,"activeIndicatorRef",void 0),ta([Ms],ax.prototype,"showActiveIndicator",void 0),gg(ax,dg);var dx,ux;const hx=ax.compose({baseName:"tabs",template:(e,t)=>ec(lx||(lx=Ht(['\n    <template class="','">\n        ','\n        <div class="tablist" part="tablist" role="tablist">\n            <slot class="tab" name="tab" part="tab" ',"></slot>\n\n            ","\n        </div>\n        ",'\n        <div class="tabpanel" part="tabpanel">\n            <slot name="tabpanel" ',"></slot>\n        </div>\n    </template>\n"])),(e=>e.orientation),hg(0,t),qg("tabs"),Yf((e=>e.showActiveIndicator),ec(cx||(cx=Ht(["\n                    <div\n                        ",'\n                        class="activeIndicator"\n                        part="activeIndicator"\n                    ></div>\n                '])),ig("activeIndicatorRef"))),ug(0,t),qg("tabpanels")),styles:(e,t)=>xp(dx||(dx=Ht(["\n      "," :host {\n        box-sizing: border-box;\n        ","\n        color: ",";\n        grid-template-columns: auto 1fr auto;\n        grid-template-rows: auto 1fr;\n      }\n\n      .tablist {\n        display: grid;\n        grid-template-rows: calc("," * 1px); auto;\n        grid-template-columns: auto;\n        position: relative;\n        width: max-content;\n        align-self: end;\n      }\n\n      .start,\n      .end {\n        align-self: center;\n      }\n\n      .activeIndicator {\n        grid-row: 2;\n        grid-column: 1;\n        width: 20px;\n        height: 3px;\n        border-radius: calc("," * 1px);\n        justify-self: center;\n        background: ",";\n      }\n\n      .activeIndicatorTransition {\n        transition: transform 0.2s ease-in-out;\n      }\n\n      .tabpanel {\n        grid-row: 2;\n        grid-column-start: 1;\n        grid-column-end: 4;\n        position: relative;\n      }\n\n      :host(.vertical) {\n        grid-template-rows: auto 1fr auto;\n        grid-template-columns: auto 1fr;\n      }\n\n      :host(.vertical) .tablist {\n        grid-row-start: 2;\n        grid-row-end: 2;\n        display: grid;\n        grid-template-rows: auto;\n        grid-template-columns: auto 1fr;\n        position: relative;\n        width: max-content;\n        justify-self: end;\n        align-self: flex-start;\n        width: 100%;\n      }\n\n      :host(.vertical) .tabpanel {\n        grid-column: 2;\n        grid-row-start: 1;\n        grid-row-end: 4;\n      }\n\n      :host(.vertical) .end {\n        grid-row: 3;\n      }\n\n      :host(.vertical) .activeIndicator {\n        grid-column: 1;\n        grid-row: 1;\n        width: 3px;\n        height: 20px;\n        margin-inline-start: calc("," * 1px);\n        border-radius: calc("," * 1px);\n        align-self: center;\n        background: ",";\n      }\n\n      :host(.vertical) .activeIndicatorTransition {\n        transition: transform 0.2s linear;\n      }\n    "])),Sp("grid"),rv,qh,Wg,nd,Qu,id,nd,Qu).withBehaviors(Ep(xp(ux||(ux=Ht(["\n        .activeIndicator,\n        :host(.vertical) .activeIndicator {\n          background: ",";\n        }\n      "])),Ap.Highlight)))});class px extends Wa{}var fx;ta([Ys({mode:"boolean"})],px.prototype,"disabled",void 0);var gx,vx;const mx=px.compose({baseName:"tab",template:(e,t)=>ec(fx||(fx=Ht(['\n    <template slot="tab" role="tab" aria-disabled="','">\n        <slot></slot>\n    </template>\n'])),(e=>e.disabled)),styles:(e,t)=>xp(gx||(gx=Ht(["\n      "," :host {\n        box-sizing: border-box;\n        ","\n        height: calc(("," + ("," * 2)) * 1px);\n        padding: 0 calc((6 + ("," * 2 * ",")) * 1px);\n        color: ",";\n        border-radius: calc("," * 1px);\n        border: calc("," * 1px) solid transparent;\n        align-items: center;\n        justify-content: center;\n        grid-row: 1 / 3;\n        cursor: pointer;\n      }\n\n      :host([aria-selected='true']) {\n        z-index: 2;\n      }\n\n      :host(:hover),\n      :host(:active) {\n        color: ",";\n      }\n\n      :host(:",") {\n        ","\n      }\n\n      :host(.vertical) {\n        justify-content: start;\n        grid-column: 1 / 3;\n      }\n\n      :host(.vertical[aria-selected='true']) {\n        z-index: 2;\n      }\n\n      :host(.vertical:hover),\n      :host(.vertical:active) {\n        color: ",";\n      }\n\n      :host(.vertical:hover[aria-selected='true']) {\n      }\n    "])),Sp("inline-flex"),rv,Wg,td,td,ed,qh,nd,rd,qh,Gg,av,qh).withBehaviors(Ep(xp(vx||(vx=Ht(["\n          :host {\n            forced-color-adjust: none;\n            border-color: transparent;\n            color: ",";\n            fill: currentcolor;\n          }\n          :host(:hover),\n          :host(.vertical:hover),\n          :host([aria-selected='true']:hover) {\n            background: transparent;\n            color: ",";\n            fill: currentcolor;\n          }\n          :host([aria-selected='true']) {\n            background: transparent;\n            color: ",";\n            fill: currentcolor;\n          }\n          :host(:",") {\n            background: transparent;\n            outline-color: ",";\n          }\n        "])),Ap.ButtonText,Ap.Highlight,Ap.Highlight,Gg,Ap.ButtonText)))});var yx;var bx;const wx=class extends Wa{}.compose({baseName:"tab-panel",template:(e,t)=>ec(yx||(yx=Ht(['\n    <template slot="tabpanel" role="tabpanel">\n        <slot></slot>\n    </template>\n']))),styles:(e,t)=>xp(bx||(bx=Ht(["\n  "," :host {\n    box-sizing: border-box;\n    ","\n    padding: 0 calc((6 + ("," * 2 * ",")) * 1px);\n  }\n"])),Sp("block"),rv,td,ed)});var kx,xx,Cx,_x,Sx,Tx,Ix,Ex,Ax,Rx,Px,Ox,Dx,Mx,Nx,Lx,Fx,Ux,zx,Hx,qx,Bx,Vx,jx,Kx,Gx,$x,Wx=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Qx=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Yx=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Kp,hx,mx,wx,Ev,uw);let Zx=$x=class extends Qt{static get styles(){return Vw}get strings(){return ix}static get requiredScopes(){return $x.getScopes()}static getScopes(){const e=[];return this.config.sections.files&&e.push("Sites.Read.All"),this.config.sections.mailMessages&&(e.push("Mail.Read"),e.push("Mail.ReadBasic")),this.config.sections.organization&&(e.push("User.Read.All"),"boolean"!==typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&e.push("People.Read.All")),this.config.sections.profile&&e.push("User.Read.All"),this.config.useContactApis&&e.push("Contacts.Read"),e.indexOf("User.Read.All")<0&&(e.push("User.ReadBasic.All"),e.push("User.Read")),e.indexOf("People.Read.All")<0&&e.push("People.Read"),e.push("Chat.Create","Chat.ReadWrite"),[...new Set(e)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(e){this._personDetails!==e&&(this._personDetails=e,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(e){e!==this._userId&&(this._userId=e,this.personDetails=null,this._cardState=null,this.requestStateUpdate())}get internalPersonDetails(){var e;return(null===(e=this._cardState)||void 0===e?void 0:e.person)||this.personDetails}constructor(){var e;super(),e=this,this.isSending=!1,this.goBack=()=>{var e;if(!(null===(e=this._history)||void 0===e?void 0:e.length))return;const t=this._history.pop();this._currentSection=null;const n=this.renderRoot.querySelector("fluent-tab");n&&n.click(),this._cardState=t.state,this._personDetails=t.state.person,this.personImage=t.personImage,this.loadSections()},this.handleEndOfCard=e=>{if(e&&"Tab"===e.code){const e=this.renderRoot.querySelector("#end-of-container");if(e){e.blur();const t=this.renderRoot.querySelector("mgt-person");t&&t.focus()}}},this.closeCard=()=>{this.updateCurrentSection(null),this.isExpanded=!1},this.sendQuickMessage=()=>Yx(this,void 0,void 0,(function*(){const e=this._chatInput.trim();if(!(null===e||void 0===e?void 0:e.length))return;const t=this.personDetails,n=this._me.userPrincipalName;this.isSending=!0;const o=yield((e,t,n)=>Rw(void 0,void 0,void 0,(function*(){const o={chatType:"oneonOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":"https://graph.microsoft.com/v1.0/users('".concat(n,"')")},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":"https://graph.microsoft.com/v1.0/users('".concat(t,"')")}]};return yield e.api("/chats").header("Cache-Control","no-store").middlewareOptions(ie("Chat.Create","Chat.ReadWrite")).post(o)})))(this._graph,t.userPrincipalName,n),r={body:{content:e}};yield((e,t,n)=>Rw(void 0,void 0,void 0,(function*(){return yield e.api("/chats/".concat(t,"/messages")).header("Cache-Control","no-store").middlewareOptions(ie("Chat.ReadWrite","ChatMessage.Send")).post(n)})))(this._graph,o.id,r),this.isSending=!1,this.clearInputData()})),this.emailUser=()=>{const e=this.internalPersonDetails;if(e){const t=mo(e);t&&window.open("mailto:"+t,"_blank","noreferrer")}},this.callUser=()=>{var e,t;const n=this.personDetails,o=this.personDetails;if(null===(e=null===n||void 0===n?void 0:n.businessPhones)||void 0===e?void 0:e.length){const e=n.businessPhones[0];e&&window.open("tel:"+e,"_blank","noreferrer")}else if(null===(t=null===o||void 0===o?void 0:o.phones)||void 0===t?void 0:t.length){const e=this.getPersonBusinessPhones(o)[0];e&&window.open("tel:"+e,"_blank","noreferrer")}},this.chatUser=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const n=e.personDetails;if(null===n||void 0===n?void 0:n.userPrincipalName){const e=n.userPrincipalName;let o="https://teams.microsoft.com/l/chat/0/0?users=".concat(e);(null===t||void 0===t?void 0:t.length)&&(o+="&message=".concat(t));const r=()=>window.open(o,"_blank","noreferrer");wn.isAvailable?wn.executeDeepLink(o,(e=>{e||r()})):r()}},this.videoCallUser=()=>{const e=this.personDetails;if(null===e||void 0===e?void 0:e.userPrincipalName){const t=e.userPrincipalName,n="https://teams.microsoft.com/l/call/0/0?users=".concat(t,"&withVideo=true"),o=()=>window.open(n,"_blank");wn.isAvailable?wn.executeDeepLink(n,(e=>{e||o()})):o()}},this.showExpandedDetails=()=>{const e=this.renderRoot.querySelector(".root");(null===e||void 0===e?void 0:e.animate)&&e.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)},this.sendQuickMessageOnEnter=e=>{"Enter"===e.code&&this.sendQuickMessage()},this.handleGoBack=e=>{"Enter"===e.code&&this.goBack()},this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}attributeChangedCallback(e,t,n){if(super.attributeChangedCallback(e,t,n),t!==n&&"person-query"===e)this.personDetails=null,this._cardState=null,this.requestStateUpdate()}navigate(e){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this._personDetails=e,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput="",this.requestStateUpdate()}clearHistory(){var e;if(this._currentSection=null,!(null===(e=this._history)||void 0===e?void 0:e.length))return;const t=this._history[0];this._history=[],this._cardState=t.state,this._personDetails=t.personDetails,this.personImage=t.personImage,this.loadSections()}render(){var e;if(!this.internalPersonDetails)return this.renderNoData();const t=this.internalPersonDetails,n=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:n});let o;o=this.strings.closeCardLabel;const r=this.isExpanded?ot(kx||(kx=Ht(['\n           <div class="close-card-container">\n             <fluent-button \n              appearance="lightweight" \n              class="close-button" \n              aria-label=',"\n              @click="," >\n               ","\n             </fluent-button>\n           </div>\n         "])),o,this.closeCard,ei(Xr.Close)):null;o=this.strings.goBackLabel;const i=(null===(e=this._history)||void 0===e?void 0:e.length)?ot(xx||(xx=Ht(['\n            <div class="nav">\n              <fluent-button \n                appearance="lightweight"\n                class="nav__back" \n                aria-label='," \n                @keydown=","\n                @click=",">","\n               </fluent-button>\n            </div>\n          "])),o,this.handleGoBack,this.goBack,ei(Xr.Back)):null;let s=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:n});if(!s){const e=this.renderPerson(),n=this.renderContactIcons(t);s=ot(Cx||(Cx=Ht(["\n         "," ","\n       "])),e,n)}const a=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);const l=this.lockTabNavigation?ot(_x||(_x=Ht(["<div @keydown="," aria-label=",' tabindex="0" id="end-of-container"></div>'])),this.handleEndOfCard,this.strings.endOfCard):ot(Sx||(Sx=Ht([""])));return ot(Tx||(Tx=Ht(['\n      <div class="root" dir=',">\n        <div class=",">\n          ","\n          ",'\n          <div class="person-details-container">','</div>\n          <div class="expanded-details-container">',"</div>\n          ","\n        </div>\n      </div>\n     "])),this.direction,Bn({small:this._smallView}),i,r,s,a,l)}renderNoData(){return this.renderTemplate("no-data",null)||ot(Ix||(Ix=Ht([""])))}renderPerson(){return Sn(Ex||(Ex=Ht(['\n      <mgt-person\n        tabindex="0"\n        class="person-image"\n        .personDetails=',"\n        .personImage=","\n        .personPresence=","\n        .showPresence=","\n        .view=","\n      ></mgt-person>\n    "])),this.internalPersonDetails,this.getImage(),this.personPresence,this.showPresence,Vo.threelines)}renderPersonSubtitle(e){if(e=e||this.internalPersonDetails,mi(e)&&e.department)return ot(Ax||(Ax=Ht(['\n       <div class="department">',"</div>\n     "])),e.department)}renderContactIcons(e){const t=e=e||this.internalPersonDetails;let n,o,r;mo(e)&&(n="".concat(this.strings.emailButtonLabel," ").concat(e.displayName),o=ot(Rx||(Rx=Ht(['\n        <fluent-button class="icon"\n          aria-label=',"\n          @click=",">\n          ","\n        </fluent-button>\n      "])),n,this.emailUser,ei(Xr.SmallEmail))),(null===t||void 0===t?void 0:t.userPrincipalName)&&(n="".concat(this.strings.chatButtonLabel," ").concat(e.displayName),r=ot(Px||(Px=Ht(['\n        <fluent-button class="icon"\n          aria-label=',"\n          @click=",">\n          ","\n        </fluent-button>\n       "])),n,this.chatUser,ei(Xr.SmallChat))),n="".concat(this.strings.videoButtonLabel," ").concat(e.displayName);const i=ot(Ox||(Ox=Ht(['\n      <fluent-button class="icon"\n        aria-label=',"\n        @click=",">\n        ","\n      </fluent-button>\n    "])),n,this.videoCallUser,ei(Xr.Video));let s;return t.userPrincipalName&&(n="".concat(this.strings.callButtonLabel," ").concat(e.displayName),s=ot(Dx||(Dx=Ht(['\n         <fluent-button class="icon"\n          aria-label=',"\n          @click=",">\n          ","\n        </fluent-button>\n       "])),n,this.callUser,ei(Xr.Call))),ot(Mx||(Mx=Ht(['\n       <div class="base-icons">\n         '," "," "," ","\n       </div>\n     "])),o,r,i,s)}renderExpandedDetailsButton(){return ot(Nx||(Nx=Ht(["\n      <fluent-button\n        aria-label=",'\n        class="expanded-details-button"\n        @click=',"\n      >\n        ","\n      </fluent-button>\n     "])),this.strings.expandDetailsLabel,this.showExpandedDetails,ei(Xr.ExpandDown))}renderExpandedDetails(){if(!this._cardState&&this._isStateLoading)return Sn(Lx||(Lx=Ht(['\n         <div class="loading">\n           <mgt-spinner></mgt-spinner>\n         </div>\n       '])));re.globalProvider.state===te.SignedOut&&this.loadSections();const e=this.renderSectionNavigation();return ot(Fx||(Fx=Ht(['\n      <div class="section-nav">\n        ','\n      </div>\n      <hr class="divider"/>\n      <div\n        class="section-host '," ",'"\n        @wheel=',"\n        tabindex=0\n      ></div>\n    "])),e,this._smallView?"small":"",this._smallView?"small":"",(e=>this.handleSectionScroll(e)))}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const e=this._currentSection?this.sections.indexOf(this._currentSection):-1,t=this.sections.map(((t,n)=>{const o=t.tagName.toLowerCase(),r=Bn({active:n===e,"section-nav__icon":!0});return ot(Ux||(Ux=Ht(['\n        <fluent-tab\n          id="','-Tab"\n          class=','\n          slot="tab"\n          @keyup="','"\n          @click=',"\n        >\n          ","\n        </fluent-tab>\n      "])),o,r,(()=>this.updateCurrentSection(t)),(()=>this.updateCurrentSection(t)),t.renderIcon())})),n=this.sections.map((e=>ot(zx||(zx=Ht(['\n        <fluent-tab-panel slot="tabpanel">\n          <div class="inserted">\n            <div class="title">',"</div>\n            ","\n          </div>\n        </fluent-tab-panel>\n      "])),e.cardTitle,this._currentSection?e.asFullView():null))),o=Bn({active:-1===e,"section-nav__icon":!0,overviewTab:!0});return ot(Hx||(Hx=Ht(['\n      <fluent-tabs\n        orientation="horizontal"\n        activeindicator\n        @wheel=','\n      >\n        <fluent-tab\n          class="','"\n          slot="tab"\n          @keyup="','"\n          @click=',"\n        >\n          <div>","</div>\n        </fluent-tab>\n        ",'\n        <fluent-tab-panel slot="tabpanel" >\n          <div class="overview-panel">',"</div>\n        </fluent-tab-panel>\n        ","\n      </fluent-tabs>\n    "])),(e=>this.handleSectionScroll(e)),o,(()=>this.updateCurrentSection(null)),(()=>this.updateCurrentSection(null)),ei(Xr.Overview),t,this._currentSection?null:this.renderOverviewSection(),n)}renderOverviewSection(){const e=this.sections.map((e=>ot(qx||(qx=Ht(['\n        <div class="section">\n          <div class="section__header">\n            <div class="section__title" tabindex=0>','</div>\n              <fluent-button\n                appearance="lightweight"\n                class="section__show-more"\n                @click=',"\n              >\n                ",'\n              </fluent-button>\n          </div>\n          <div class="section__content">',"</div>\n        </div>\n      "])),e.displayName,(()=>this.updateCurrentSection(e)),this.strings.showMoreSectionButton,e.asCompactView()))),t=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return t&&e.splice(1,0,ot(Bx||(Bx=Ht(['\n           <div class="section">\n             <div class="additional-details">',"</div>\n           </div>\n         "])),t)),ot(Vx||(Vx=Ht(['\n       <div class="sections">\n          ',"\n          ","\n       </div>\n     "])),this.renderMessagingSection(),e)}renderCurrentSection(){var e;if((null===(e=this.sections)||void 0===e?void 0:e.length)||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?ot(Kx||(Kx=Ht(["\n       ","\n     "])),this._currentSection.asFullView()):this.renderOverviewSection():ot(jx||(jx=Ht(["\n         ","\n       "])),this.sections[0].asFullView())}renderMessagingSection(){const e=this.personDetails,t=this._me.userPrincipalName,n=this._chatInput;return(null===e||void 0===e?void 0:e.userPrincipalName)===t?void 0:ot(Gx||(Gx=Ht(['\n      <div class="message-section">\n        <fluent-text-field\n          autocomplete="off"\n          appearance="outline"\n          placeholder="','"\n          .value=',"\n          @input=",'\n          @keydown="','">\n        </fluent-text-field>\n        <fluent-button class="send-message-icon"\n          aria-label=',"\n          @click=","\n          ?disabled=",">\n          ","\n        </fluent-button>\n      </div>\n      "])),this.strings.quickMessage,n,(e=>{this._chatInput=e.target.value,this.requestUpdate()}),(e=>this.sendQuickMessageOnEnter(e)),this.strings.sendMessageLabel,this.sendQuickMessage,this.isSending,this.isSending?ei(Xr.Confirmation):ei(Xr.Send))}loadState(){var e,t;return Yx(this,void 0,void 0,(function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let e=this.parentElement;for(;e&&e.tagName!=="".concat(ge.prefix,"-PERSON").toUpperCase();)e=e.parentElement;const t=e.personDetails||e.personDetailsInternal;e&&t&&(this.personDetails=t,this.personImage=e.personImage)}const n=re.globalProvider;if(!n||n.state!==te.SignedIn)return;const o=n.graph.forComponent(this);if(this._graph=o,this._isStateLoading=!0,this._me||(this._me=yield re.me()),this.personDetails){const e=this.personDetails;let t;if(mi(e)&&(t=e.userPrincipalName||e.id),t&&!mo(e)){const e=yield Bo(o,t);this.personDetails=e,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const e=yield Bo(o,this.userId);this.personDetails=e,this.personImage=this.getImage()}else if(this.personQuery){const e=yield go(o,this.personQuery,1);(null===e||void 0===e?void 0:e.length)&&(this.personDetails=e[0],yield Mo(o,this.personDetails,$x.config.useContactApis).then((e=>{e&&(this.personDetails.personImage=e,this.personImage=e)})))}const r={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{(null===(e=this.personDetails)||void 0===e?void 0:e.id)?this.personPresence=yield zo(o,this.personDetails.id):this.personPresence=r}catch(Ye){this.personPresence=r}(null===(t=this.personDetails)||void 0===t?void 0:t.id)&&(this._cardState=yield((e,n,o,r)=>Rw(void 0,void 0,void 0,(function*(){var i;const s=n.id,a=mo(n),l="classification"in n||"personType"in n&&("PersonalContact"===n.personType.subclass||"Group"===n.personType.class),c=e.createBatch();let d;l||r.sections.organization&&(Fw(c,s),"boolean"!==typeof r.sections.organization&&r.sections.organization.showWorksWith&&Uw(c,s)),r.sections.mailMessages&&a&&zw(c,a),r.sections.files&&Hw(c,o?null:a);const u={};try{d=yield c.executeAll()}catch(t){}if(d)for(const[e,t]of d)u[e]=(null===(i=t.content)||void 0===i?void 0:i.value)||t.content;if(!l&&r.sections.profile)try{const t=yield qw(e,s);t&&(u.profile=t)}catch(h){}return u.directReports&&u.directReports.length>0&&(u.directReports=u.directReports.filter((e=>e.accountEnabled))),u})))(o,this.personDetails,this._me===this.personDetails.id,$x.config)),this.loadSections(),this._isStateLoading=!1}))}get hasPhone(){var e,t;const n=this.personDetails,o=this.personDetails;return Boolean(null===(e=null===n||void 0===n?void 0:n.businessPhones)||void 0===e?void 0:e.length)||Boolean(null===(t=null===o||void 0===o?void 0:o.phones)||void 0===t?void 0:t.length)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const e=new ak(this.internalPersonDetails);if(e.hasData&&this.sections.push(e),!this._cardState)return;const{person:t,directReports:n,messages:o,files:r,profile:i}=this._cardState;if($x.config.sections.organization&&((null===t||void 0===t?void 0:t.manager)||(null===n||void 0===n?void 0:n.length))&&this.sections.push(new Nk(this._cardState,this._me)),$x.config.sections.mailMessages&&(null===o||void 0===o?void 0:o.length)&&this.sections.push(new yk(o)),$x.config.sections.files&&(null===r||void 0===r?void 0:r.length)&&this.sections.push(new Um),$x.config.sections.profile&&i){const e=new rx(i);e.hasData&&this.sections.push(e)}}getImage(){if(this.personImage)return this.personImage;const e=this.personDetails;return(null===e||void 0===e?void 0:e.personImage)?e.personImage:null}clearInputData(){this._chatInput="",this.requestUpdate()}getPersonBusinessPhones(e){const t=e.phones,n=[];for(const o of t)"business"===o.type&&n.push(o.number);return n}updateCurrentSection(e){if(e){const t=e.tagName.toLowerCase();this.renderRoot.querySelector("#".concat(t,"-Tab")).click()}const t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const n of t)n.scrollTop=0;this._currentSection=e,this.requestUpdate()}handleSectionScroll(e){const t=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const n of t)n&&(e.deltaY<0&&0===n.scrollTop||e.deltaY>0&&n.clientHeight+n.scrollTop>=n.scrollHeight-1||e.stopPropagation())}};var Jx;Zx._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0,isSendMessageVisible:!0},Wx([Et({attribute:"person-details",type:Object}),Qx("design:type",Object),Qx("design:paramtypes",[Object])],Zx.prototype,"personDetails",null),Wx([Et({attribute:"person-query"}),Qx("design:type",String)],Zx.prototype,"personQuery",void 0),Wx([Et({attribute:"lock-tab-navigation",type:Boolean}),Qx("design:type",Boolean)],Zx.prototype,"lockTabNavigation",void 0),Wx([Et({attribute:"user-id"}),Qx("design:type",String),Qx("design:paramtypes",[String])],Zx.prototype,"userId",null),Wx([Et({attribute:"person-image",type:String}),Qx("design:type",String)],Zx.prototype,"personImage",void 0),Wx([Et({attribute:"fetch-image",type:Boolean}),Qx("design:type",Boolean)],Zx.prototype,"fetchImage",void 0),Wx([Et({attribute:"is-expanded",type:Boolean}),Qx("design:type",Boolean)],Zx.prototype,"isExpanded",void 0),Wx([Et({attribute:"inherit-details",type:Boolean}),Qx("design:type",Boolean)],Zx.prototype,"inheritDetails",void 0),Wx([Et({attribute:"show-presence",type:Boolean}),Qx("design:type",Boolean)],Zx.prototype,"showPresence",void 0),Wx([Et({attribute:"person-presence",type:Object}),Qx("design:type",Object)],Zx.prototype,"personPresence",void 0),Wx([At(),Qx("design:type",Object)],Zx.prototype,"isSending",void 0),Wx([At(),Qx("design:type",Object)],Zx.prototype,"_cardState",void 0),Wx([At(),Qx("design:type",Boolean)],Zx.prototype,"_isStateLoading",void 0),Zx=$x=Wx([Tn("person-card"),Qx("design:paramtypes",[])],Zx);const Xx=[Ce(Jx||(Jx=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size,large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size,large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}\n'])))],eC="menuitem",tC="menuitemcheckbox",nC="menuitemradio",oC={[eC]:"menuitem",[tC]:"menuitemcheckbox",[nC]:"menuitemradio"},rC=e=>{const t=e.closest("[dir]");return null!==t&&"rtl"===t.dir?dc.rtl:dc.ltr};class iC extends Wa{constructor(){super(...arguments),this.role=eC,this.hasSubmenu=!1,this.currentDirection=dc.ltr,this.focusSubmenuOnLoad=!1,this.handleMenuItemKeyDown=e=>{if(e.defaultPrevented)return!1;switch(e.key){case kg:case Sg:return this.invoke(),!1;case bg:return this.expandAndFocus(),!1;case yg:if(this.expanded)return this.expanded=!1,this.focus(),!1}return!0},this.handleMenuItemClick=e=>(e.defaultPrevented||this.disabled||this.invoke(),!1),this.submenuLoaded=()=>{this.focusSubmenuOnLoad&&(this.focusSubmenuOnLoad=!1,this.hasSubmenu&&(this.submenu.focus(),this.setAttribute("tabindex","-1")))},this.handleMouseOver=e=>(this.disabled||!this.hasSubmenu||this.expanded||(this.expanded=!0),!1),this.handleMouseOut=e=>(!this.expanded||this.contains(document.activeElement)||(this.expanded=!1),!1),this.expandAndFocus=()=>{this.hasSubmenu&&(this.focusSubmenuOnLoad=!0,this.expanded=!0)},this.invoke=()=>{if(!this.disabled)switch(this.role){case tC:this.checked=!this.checked;break;case eC:this.updateSubmenu(),this.hasSubmenu?this.expandAndFocus():this.$emit("change");break;case nC:this.checked||(this.checked=!0)}},this.updateSubmenu=()=>{this.submenu=this.domChildren().find((e=>"menu"===e.getAttribute("role"))),this.hasSubmenu=void 0!==this.submenu}}expandedChanged(e){if(this.$fastController.isConnected){if(void 0===this.submenu)return;!1===this.expanded?this.submenu.collapseExpandedItem():this.currentDirection=rC(this),this.$emit("expanded-change",this,{bubbles:!1})}}checkedChanged(e,t){this.$fastController.isConnected&&this.$emit("change")}connectedCallback(){super.connectedCallback(),Rs.queueUpdate((()=>{this.updateSubmenu()})),this.startColumnCount||(this.startColumnCount=1),this.observer=new MutationObserver(this.updateSubmenu)}disconnectedCallback(){super.disconnectedCallback(),this.submenu=void 0,void 0!==this.observer&&(this.observer.disconnect(),this.observer=void 0)}domChildren(){return Array.from(this.children).filter((e=>!e.hasAttribute("hidden")))}}ta([Ys({mode:"boolean"})],iC.prototype,"disabled",void 0),ta([Ys({mode:"boolean"})],iC.prototype,"expanded",void 0),ta([Ms],iC.prototype,"startColumnCount",void 0),ta([Ys],iC.prototype,"role",void 0),ta([Ys({mode:"boolean"})],iC.prototype,"checked",void 0),ta([Ms],iC.prototype,"submenuRegion",void 0),ta([Ms],iC.prototype,"hasSubmenu",void 0),ta([Ms],iC.prototype,"currentDirection",void 0),ta([Ms],iC.prototype,"submenu",void 0),gg(iC,dg);class sC extends Wa{constructor(){super(...arguments),this.expandedItem=null,this.focusIndex=-1,this.isNestedMenu=()=>null!==this.parentElement&&jg(this.parentElement)&&"menuitem"===this.parentElement.getAttribute("role"),this.handleFocusOut=e=>{if(!this.contains(e.relatedTarget)&&void 0!==this.menuItems){this.collapseExpandedItem();const e=this.menuItems.findIndex(this.isFocusableElement);this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.menuItems[e].setAttribute("tabindex","0"),this.focusIndex=e}},this.handleItemFocus=e=>{const t=e.target;void 0!==this.menuItems&&t!==this.menuItems[this.focusIndex]&&(this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0"))},this.handleExpandedChanged=e=>{if(e.defaultPrevented||null===e.target||void 0===this.menuItems||this.menuItems.indexOf(e.target)<0)return;e.preventDefault();const t=e.target;null===this.expandedItem||t!==this.expandedItem||!1!==t.expanded?t.expanded&&(null!==this.expandedItem&&this.expandedItem!==t&&(this.expandedItem.expanded=!1),this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.expandedItem=t,this.focusIndex=this.menuItems.indexOf(t),t.setAttribute("tabindex","0")):this.expandedItem=null},this.removeItemListeners=()=>{void 0!==this.menuItems&&this.menuItems.forEach((e=>{e.removeEventListener("expanded-change",this.handleExpandedChanged),e.removeEventListener("focus",this.handleItemFocus)}))},this.setItems=()=>{const e=this.domChildren();this.removeItemListeners(),this.menuItems=e;const t=this.menuItems.filter(this.isMenuItemElement);t.length&&(this.focusIndex=0);const n=t.reduce(((e,t)=>{const n=function(e){const t=e.getAttribute("role"),n=e.querySelector("[slot=start]");return t!==eC&&null===n||t===eC&&null!==n?1:t!==eC&&null!==n?2:0}(t);return e>n?e:n}),0);t.forEach(((e,t)=>{e.setAttribute("tabindex",0===t?"0":"-1"),e.addEventListener("expanded-change",this.handleExpandedChanged),e.addEventListener("focus",this.handleItemFocus),e instanceof iC&&(e.startColumnCount=n)}))},this.changeHandler=e=>{if(void 0===this.menuItems)return;const t=e.target,n=this.menuItems.indexOf(t);if(-1!==n&&"menuitemradio"===t.role&&!0===t.checked){for(let t=n-1;t>=0;--t){const e=this.menuItems[t],n=e.getAttribute("role");if(n===nC&&(e.checked=!1),"separator"===n)break}const e=this.menuItems.length-1;for(let t=n+1;t<=e;++t){const e=this.menuItems[t],n=e.getAttribute("role");if(n===nC&&(e.checked=!1),"separator"===n)break}}},this.isMenuItemElement=e=>jg(e)&&sC.focusableElementRoles.hasOwnProperty(e.getAttribute("role")),this.isFocusableElement=e=>this.isMenuItemElement(e)}itemsChanged(e,t){this.$fastController.isConnected&&void 0!==this.menuItems&&this.setItems()}connectedCallback(){super.connectedCallback(),Rs.queueUpdate((()=>{this.setItems()})),this.addEventListener("change",this.changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeItemListeners(),this.menuItems=void 0,this.removeEventListener("change",this.changeHandler)}focus(){this.setFocus(0,1)}collapseExpandedItem(){null!==this.expandedItem&&(this.expandedItem.expanded=!1,this.expandedItem=null)}handleMenuKeyDown(e){if(!e.defaultPrevented&&void 0!==this.menuItems)switch(e.key){case mg:return void this.setFocus(this.focusIndex+1,1);case wg:return void this.setFocus(this.focusIndex-1,-1);case _g:return void this.setFocus(this.menuItems.length-1,-1);case Cg:return void this.setFocus(0,1);default:return!0}}domChildren(){return Array.from(this.children).filter((e=>!e.hasAttribute("hidden")))}setFocus(e,t){if(void 0!==this.menuItems)for(;e>=0&&e<this.menuItems.length;){const n=this.menuItems[e];if(this.isFocusableElement(n)){this.focusIndex>-1&&this.menuItems.length>=this.focusIndex-1&&this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=e,n.setAttribute("tabindex","0"),n.focus();break}e+=t}}}var aC;sC.focusableElementRoles=oC,ta([Ms],sC.prototype,"items",void 0);const lC="horizontal",cC="separator";class dC extends Wa{constructor(){super(...arguments),this.role=cC,this.orientation=lC}}var uC,hC;ta([Ys],dC.prototype,"role",void 0),ta([Ys],dC.prototype,"orientation",void 0);const pC=class extends sC{connectedCallback(){super.connectedCallback(),Gu.setValueFor(this,Hu)}}.compose({baseName:"menu",baseClass:sC,template:(e,t)=>ec(aC||(aC=Ht(['\n    <template\n        slot="','"\n        role="menu"\n        @keydown="','"\n        @focusout="','"\n    >\n        <slot ',"></slot>\n    </template>\n"])),(e=>e.slot?e.slot:e.isNestedMenu()?"submenu":void 0),((e,t)=>e.handleMenuKeyDown(t.event)),((e,t)=>e.handleFocusOut(t.event)),qg("items")),styles:(e,t)=>xp(uC||(uC=Ht(["\n    "," :host {\n      background: ",";\n      border: calc("," * 1px) solid transparent;\n      border-radius: calc("," * 1px);\n      box-shadow: ",";\n      padding: calc(("," - ",") * 1px) 0;\n      max-width: 368px;\n      min-width: 64px;\n    }\n\n    :host([slot='submenu']) {\n      width: max-content;\n      margin: 0 calc("," * 2px);\n    }\n\n    ::slotted(",") {\n      margin: 0 calc("," * 1px);\n    }\n\n    ::slotted(",") {\n      margin: calc("," * 1px) 0;\n    }\n\n    ::slotted(hr) {\n      box-sizing: content-box;\n      height: 0;\n      margin: calc("," * 1px) 0;\n      border: none;\n      border-top: calc("," * 1px) solid ",";\n    }\n  "])),Sp("block"),Hu,rd,od,zp,td,rd,td,e.tagFor(iC),td,e.tagFor(dC),td,td,rd,tp).withBehaviors(Ep(xp(hC||(hC=Ht(["\n        :host([slot='submenu']) {\n          background: ",";\n          border-color: ",";\n        }\n      "])),Ap.Canvas,Ap.CanvasText)))}),fC="focus",gC="focusin",vC="focusout",mC="keydown",yC="resize",bC="scroll";class wC extends Wa{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=dc.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),null!==this.anchorElement&&(this.requestPositionUpdates(),null!==this.resizeDetector&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{null===this.anchorElement||this.pendingPositioningUpdate||(wC.intersectionService.requestPosition(this,this.handleIntersection),wC.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&wC.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,wC.intersectionService.cancelRequestPosition(this,this.handleIntersection),null!==this.anchorElement&&wC.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&wC.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),null!==this.resizeDetector&&this.resizeDetector.disconnect()},this.getViewport=()=>"string"!==typeof this.viewport||""===this.viewport?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=e=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(e)&&this.updateLayout())},this.applyIntersectionEntries=e=>{const t=e.find((e=>e.target===this)),n=e.find((e=>e.target===this.anchorElement)),o=e.find((e=>e.target===this.viewportElement));return void 0!==t&&void 0!==o&&void 0!==n&&(!!(!this.regionVisible||this.forceUpdate||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect||this.isRectDifferent(this.anchorRect,n.boundingClientRect)||this.isRectDifferent(this.viewportRect,o.boundingClientRect)||this.isRectDifferent(this.regionRect,t.boundingClientRect))&&(this.regionRect=t.boundingClientRect,this.anchorRect=n.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(o.boundingClientRect.x+document.documentElement.scrollLeft,o.boundingClientRect.y+document.documentElement.scrollTop,o.boundingClientRect.width,o.boundingClientRect.height):this.viewportRect=o.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0))},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(e,t)=>Math.abs(e.top-t.top)>this.updateThreshold||Math.abs(e.right-t.right)>this.updateThreshold||Math.abs(e.bottom-t.bottom)>this.updateThreshold||Math.abs(e.left-t.left)>this.updateThreshold,this.handleResize=e=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,null===this.anchorElement&&(this.anchorElement=this.getAnchor()),null===this.viewportElement&&(this.viewportElement=this.getViewport()),this.currentDirection=rC(this),this.startObservers())},this.updateLayout=()=>{let e,t;if("uncontrolled"!==this.horizontalPositioningMode){const e=this.getPositioningOptions(this.horizontalInset);if("center"===this.horizontalDefaultPosition)t="center";else if("unset"!==this.horizontalDefaultPosition){let e=this.horizontalDefaultPosition;if("start"===e||"end"===e){const t=rC(this);if(t!==this.currentDirection)return this.currentDirection=t,void this.initialize();e=this.currentDirection===dc.ltr?"start"===e?"left":"right":"start"===e?"right":"left"}switch(e){case"left":t=this.horizontalInset?"insetStart":"start";break;case"right":t=this.horizontalInset?"insetEnd":"end"}}const n=void 0!==this.horizontalThreshold?this.horizontalThreshold:void 0!==this.regionRect?this.regionRect.width:0,o=void 0!==this.anchorRect?this.anchorRect.left:0,r=void 0!==this.anchorRect?this.anchorRect.right:0,i=void 0!==this.anchorRect?this.anchorRect.width:0,s=void 0!==this.viewportRect?this.viewportRect.left:0,a=void 0!==this.viewportRect?this.viewportRect.right:0;(void 0===t||"locktodefault"!==this.horizontalPositioningMode&&this.getAvailableSpace(t,o,r,i,s,a)<n)&&(t=this.getAvailableSpace(e[0],o,r,i,s,a)>this.getAvailableSpace(e[1],o,r,i,s,a)?e[0]:e[1])}if("uncontrolled"!==this.verticalPositioningMode){const t=this.getPositioningOptions(this.verticalInset);if("center"===this.verticalDefaultPosition)e="center";else if("unset"!==this.verticalDefaultPosition)switch(this.verticalDefaultPosition){case"top":e=this.verticalInset?"insetStart":"start";break;case"bottom":e=this.verticalInset?"insetEnd":"end"}const n=void 0!==this.verticalThreshold?this.verticalThreshold:void 0!==this.regionRect?this.regionRect.height:0,o=void 0!==this.anchorRect?this.anchorRect.top:0,r=void 0!==this.anchorRect?this.anchorRect.bottom:0,i=void 0!==this.anchorRect?this.anchorRect.height:0,s=void 0!==this.viewportRect?this.viewportRect.top:0,a=void 0!==this.viewportRect?this.viewportRect.bottom:0;(void 0===e||"locktodefault"!==this.verticalPositioningMode&&this.getAvailableSpace(e,o,r,i,s,a)<n)&&(e=this.getAvailableSpace(t[0],o,r,i,s,a)>this.getAvailableSpace(t[1],o,r,i,s,a)?t[0]:t[1])}const n=this.getNextRegionDimension(t,e),o=this.horizontalPosition!==t||this.verticalPosition!==e;if(this.setHorizontalPosition(t,n),this.setVerticalPosition(e,n),this.updateRegionStyle(),!this.initialLayoutComplete)return this.initialLayoutComplete=!0,void this.requestPositionUpdates();this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),o&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform="translate(".concat(this.translateX,"px, ").concat(this.translateY,"px)")},this.updatePositionClasses=()=>{this.classList.toggle("top","start"===this.verticalPosition),this.classList.toggle("bottom","end"===this.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.verticalPosition),this.classList.toggle("vertical-center","center"===this.verticalPosition),this.classList.toggle("left","start"===this.horizontalPosition),this.classList.toggle("right","end"===this.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.horizontalPosition),this.classList.toggle("horizontal-center","center"===this.horizontalPosition)},this.setHorizontalPosition=(e,t)=>{if(void 0===e||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let n=0;switch(this.horizontalScaling){case"anchor":case"fill":n=this.horizontalViewportLock?this.viewportRect.width:t.width,this.regionWidth="".concat(n,"px");break;case"content":n=this.regionRect.width,this.regionWidth="unset"}let o=0;switch(e){case"start":this.translateX=this.baseHorizontalOffset-n,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-n+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(o=(this.anchorRect.width-n)/2,this.translateX=this.baseHorizontalOffset+o,this.horizontalViewportLock){const e=this.anchorRect.left+o,t=this.anchorRect.right-o;e<this.viewportRect.left&&!(t>this.viewportRect.right)?this.translateX=this.translateX-(e-this.viewportRect.left):t>this.viewportRect.right&&!(e<this.viewportRect.left)&&(this.translateX=this.translateX-(t-this.viewportRect.right))}}this.horizontalPosition=e},this.setVerticalPosition=(e,t)=>{if(void 0===e||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let n=0;switch(this.verticalScaling){case"anchor":case"fill":n=this.verticalViewportLock?this.viewportRect.height:t.height,this.regionHeight="".concat(n,"px");break;case"content":n=this.regionRect.height,this.regionHeight="unset"}let o=0;switch(e){case"start":this.translateY=this.baseVerticalOffset-n,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-n+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(o=(this.anchorRect.height-n)/2,this.translateY=this.baseVerticalOffset+o,this.verticalViewportLock){const e=this.anchorRect.top+o,t=this.anchorRect.bottom-o;e<this.viewportRect.top&&!(t>this.viewportRect.bottom)?this.translateY=this.translateY-(e-this.viewportRect.top):t>this.viewportRect.bottom&&!(e<this.viewportRect.top)&&(this.translateY=this.translateY-(t-this.viewportRect.bottom))}}this.verticalPosition=e},this.getPositioningOptions=e=>e?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(e,t,n,o,r,i)=>{const s=t-r,a=i-(t+o);switch(e){case"start":return s;case"insetStart":return s+o;case"insetEnd":return a+o;case"end":return a;case"center":return 2*Math.min(s,a)+o}},this.getNextRegionDimension=(e,t)=>{const n={height:void 0!==this.regionRect?this.regionRect.height:0,width:void 0!==this.regionRect?this.regionRect.width:0};return void 0!==e&&"fill"===this.horizontalScaling?n.width=this.getAvailableSpace(e,void 0!==this.anchorRect?this.anchorRect.left:0,void 0!==this.anchorRect?this.anchorRect.right:0,void 0!==this.anchorRect?this.anchorRect.width:0,void 0!==this.viewportRect?this.viewportRect.left:0,void 0!==this.viewportRect?this.viewportRect.right:0):"anchor"===this.horizontalScaling&&(n.width=void 0!==this.anchorRect?this.anchorRect.width:0),void 0!==t&&"fill"===this.verticalScaling?n.height=this.getAvailableSpace(t,void 0!==this.anchorRect?this.anchorRect.top:0,void 0!==this.anchorRect?this.anchorRect.bottom:0,void 0!==this.anchorRect?this.anchorRect.height:0,void 0!==this.viewportRect?this.viewportRect.top:0,void 0!==this.viewportRect?this.viewportRect.bottom:0):"anchor"===this.verticalScaling&&(n.height=void 0!==this.anchorRect?this.anchorRect.height:0),n},this.startAutoUpdateEventListeners=()=>{window.addEventListener(yC,this.update,{passive:!0}),window.addEventListener(bC,this.update,{passive:!0,capture:!0}),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(yC,this.update),window.removeEventListener(bC,this.update),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(e,t){this.$fastController.isConnected&&this.initialLayoutComplete&&("auto"===e&&this.stopAutoUpdateEventListeners(),"auto"===t&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),"auto"===this.autoUpdateMode&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),"auto"===this.autoUpdateMode&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){null!==this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),null===this.anchorElement&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&!1===this.pendingReset&&(this.setInitialState(),Rs.queueUpdate((()=>this.reset())),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}}var kC,xC,CC,_C,SC;wC.intersectionService=new class{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(e,t)=>{var n;null!==this.intersectionDetector&&(this.observedElements.has(e)?null===(n=this.observedElements.get(e))||void 0===n||n.push(t):(this.observedElements.set(e,[t]),this.intersectionDetector.observe(e)))},this.cancelRequestPosition=(e,t)=>{const n=this.observedElements.get(e);if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}},this.initializeIntersectionDetector=()=>{bs.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=e=>{if(null===this.intersectionDetector)return;const t=[],n=[];e.forEach((e=>{var o;null===(o=this.intersectionDetector)||void 0===o||o.unobserve(e.target);const r=this.observedElements.get(e.target);void 0!==r&&(r.forEach((o=>{let r=t.indexOf(o);-1===r&&(r=t.length,t.push(o),n.push([])),n[r].push(e)})),this.observedElements.delete(e.target))})),t.forEach(((e,t)=>{e(n[t])}))},this.initializeIntersectionDetector()}},ta([Ys],wC.prototype,"anchor",void 0),ta([Ys],wC.prototype,"viewport",void 0),ta([Ys({attribute:"horizontal-positioning-mode"})],wC.prototype,"horizontalPositioningMode",void 0),ta([Ys({attribute:"horizontal-default-position"})],wC.prototype,"horizontalDefaultPosition",void 0),ta([Ys({attribute:"horizontal-viewport-lock",mode:"boolean"})],wC.prototype,"horizontalViewportLock",void 0),ta([Ys({attribute:"horizontal-inset",mode:"boolean"})],wC.prototype,"horizontalInset",void 0),ta([Ys({attribute:"horizontal-threshold"})],wC.prototype,"horizontalThreshold",void 0),ta([Ys({attribute:"horizontal-scaling"})],wC.prototype,"horizontalScaling",void 0),ta([Ys({attribute:"vertical-positioning-mode"})],wC.prototype,"verticalPositioningMode",void 0),ta([Ys({attribute:"vertical-default-position"})],wC.prototype,"verticalDefaultPosition",void 0),ta([Ys({attribute:"vertical-viewport-lock",mode:"boolean"})],wC.prototype,"verticalViewportLock",void 0),ta([Ys({attribute:"vertical-inset",mode:"boolean"})],wC.prototype,"verticalInset",void 0),ta([Ys({attribute:"vertical-threshold"})],wC.prototype,"verticalThreshold",void 0),ta([Ys({attribute:"vertical-scaling"})],wC.prototype,"verticalScaling",void 0),ta([Ys({attribute:"fixed-placement",mode:"boolean"})],wC.prototype,"fixedPlacement",void 0),ta([Ys({attribute:"auto-update-mode"})],wC.prototype,"autoUpdateMode",void 0),ta([Ms],wC.prototype,"anchorElement",void 0),ta([Ms],wC.prototype,"viewportElement",void 0),ta([Ms],wC.prototype,"initialLayoutComplete",void 0);var TC,IC,EC,AC;const RC=iC.compose({baseName:"menu-item",template:(e,t)=>ec(kC||(kC=Ht(['\n    <template\n        role="','"\n        aria-haspopup="','"\n        aria-checked="','"\n        aria-disabled="','"\n        aria-expanded="','"\n        @keydown="','"\n        @click="','"\n        @mouseover="','"\n        @mouseout="','"\n        class="'," "," ",'"\n    >\n            ',"\n            ","\n        </div>\n        ",'\n        <span class="content" part="content">\n            <slot></slot>\n        </span>\n        ',"\n        ","\n        ","\n    </template>\n"])),(e=>e.role),(e=>e.hasSubmenu?"menu":void 0),(e=>e.role!==eC?e.checked:void 0),(e=>e.disabled),(e=>e.expanded),((e,t)=>e.handleMenuItemKeyDown(t.event)),((e,t)=>e.handleMenuItemClick(t.event)),((e,t)=>e.handleMouseOver(t.event)),((e,t)=>e.handleMouseOut(t.event)),(e=>e.disabled?"disabled":""),(e=>e.expanded?"expanded":""),(e=>"indent-".concat(e.startColumnCount)),Yf((e=>e.role===tC),ec(xC||(xC=Ht(['\n                    <div part="input-container" class="input-container">\n                        <span part="checkbox" class="checkbox">\n                            <slot name="checkbox-indicator">\n                                ',"\n                            </slot>\n                        </span>\n                    </div>\n                "])),t.checkboxIndicator||"")),Yf((e=>e.role===nC),ec(CC||(CC=Ht(['\n                    <div part="input-container" class="input-container">\n                        <span part="radio" class="radio">\n                            <slot name="radio-indicator">\n                                ',"\n                            </slot>\n                        </span>\n                    </div>\n                "])),t.radioIndicator||"")),hg(0,t),ug(0,t),Yf((e=>e.hasSubmenu),ec(_C||(_C=Ht(['\n                <div\n                    part="expand-collapse-glyph-container"\n                    class="expand-collapse-glyph-container"\n                >\n                    <span part="expand-collapse" class="expand-collapse">\n                        <slot name="expand-collapse-indicator">\n                            ',"\n                        </slot>\n                    </span>\n                </div>\n            "])),t.expandCollapseGlyph||"")),Yf((e=>e.expanded),ec(SC||(SC=Ht(["\n                <",'\n                    :anchorElement="','"\n                    vertical-positioning-mode="dynamic"\n                    vertical-default-position="bottom"\n                    vertical-inset="true"\n                    horizontal-positioning-mode="dynamic"\n                    horizontal-default-position="end"\n                    class="submenu-region"\n                    dir="','"\n                    @loaded="','"\n                    ','\n                    part="submenu-region"\n                >\n                    <slot name="submenu"></slot>\n                </',">\n            "])),e.tagFor(wC),(e=>e),(e=>e.currentDirection),(e=>e.submenuLoaded()),ig("submenuRegion"),e.tagFor(wC)))),styles:(e,t)=>xp(TC||(TC=Ht(["\n    "," :host {\n      contain: layout;\n      overflow: visible;\n      ","\n      box-sizing: border-box;\n      height: calc("," * 1px);\n      grid-template-columns: minmax(32px, auto) 1fr minmax(32px, auto);\n      grid-template-rows: auto;\n      justify-items: center;\n      align-items: center;\n      padding: 0;\n      white-space: nowrap;\n      color: ",";\n      fill: currentcolor;\n      cursor: pointer;\n      border-radius: calc("," * 1px);\n      border: calc("," * 1px) solid transparent;\n      position: relative;\n    }\n\n    :host(.indent-0) {\n      grid-template-columns: auto 1fr minmax(32px, auto);\n    }\n\n    :host(.indent-0) .content {\n      grid-column: 1;\n      grid-row: 1;\n      margin-inline-start: 10px;\n    }\n\n    :host(.indent-0) .expand-collapse-glyph-container {\n      grid-column: 5;\n      grid-row: 1;\n    }\n\n    :host(.indent-2) {\n      grid-template-columns: minmax(32px, auto) minmax(32px, auto) 1fr minmax(32px, auto) minmax(32px, auto);\n    }\n\n    :host(.indent-2) .content {\n      grid-column: 3;\n      grid-row: 1;\n      margin-inline-start: 10px;\n    }\n\n    :host(.indent-2) .expand-collapse-glyph-container {\n      grid-column: 5;\n      grid-row: 1;\n    }\n\n    :host(.indent-2) .start {\n      grid-column: 2;\n    }\n\n    :host(.indent-2) .end {\n      grid-column: 4;\n    }\n\n    :host(:",") {\n      ","\n    }\n\n    :host(:not([disabled]):hover) {\n      background: ",";\n    }\n\n    :host(:not([disabled]):active),\n    :host(.expanded) {\n      background: ",";\n      color: ",";\n      z-index: 2;\n    }\n\n    :host([disabled]) {\n      cursor: ",";\n      opacity: ",";\n    }\n\n    .content {\n      grid-column-start: 2;\n      justify-self: start;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n\n    .start,\n    .end {\n      display: flex;\n      justify-content: center;\n    }\n\n    :host(.indent-0[aria-haspopup='menu']) {\n      display: grid;\n      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);\n      align-items: center;\n      min-height: 32px;\n    }\n\n    :host(.indent-1[aria-haspopup='menu']),\n    :host(.indent-1[role='menuitemcheckbox']),\n    :host(.indent-1[role='menuitemradio']) {\n      display: grid;\n      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);\n      align-items: center;\n      min-height: 32px;\n    }\n\n    :host(.indent-2:not([aria-haspopup='menu'])) .end {\n      grid-column: 5;\n    }\n\n    :host .input-container,\n    :host .expand-collapse-glyph-container {\n      display: none;\n    }\n\n    :host([aria-haspopup='menu']) .expand-collapse-glyph-container,\n    :host([role='menuitemcheckbox']) .input-container,\n    :host([role='menuitemradio']) .input-container {\n      display: grid;\n    }\n\n    :host([aria-haspopup='menu']) .content,\n    :host([role='menuitemcheckbox']) .content,\n    :host([role='menuitemradio']) .content {\n      grid-column-start: 3;\n    }\n\n    :host([aria-haspopup='menu'].indent-0) .content {\n      grid-column-start: 1;\n    }\n\n    :host([aria-haspopup='menu']) .end,\n    :host([role='menuitemcheckbox']) .end,\n    :host([role='menuitemradio']) .end {\n      grid-column-start: 4;\n    }\n\n    :host .expand-collapse,\n    :host .checkbox,\n    :host .radio {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: relative;\n      box-sizing: border-box;\n    }\n\n    :host .checkbox-indicator,\n    :host .radio-indicator,\n    slot[name='checkbox-indicator'],\n    slot[name='radio-indicator'] {\n      display: none;\n    }\n\n    ::slotted([slot='end']:not(svg)) {\n      margin-inline-end: 10px;\n      color: ",";\n    }\n\n    :host([aria-checked='true']) .checkbox-indicator,\n    :host([aria-checked='true']) slot[name='checkbox-indicator'],\n    :host([aria-checked='true']) .radio-indicator,\n    :host([aria-checked='true']) slot[name='radio-indicator'] {\n      display: flex;\n    }\n  "])),Sp("grid"),rv,Wg,qh,nd,rd,Gg,av,Lh,Fh,qh,Vg,Jc,Kh).withBehaviors(Ep(xp(IC||(IC=Ht(["\n        :host,\n        ::slotted([slot='end']:not(svg)) {\n          forced-color-adjust: none;\n          color: ",";\n          fill: currentcolor;\n        }\n        :host(:not([disabled]):hover) {\n          background: ",";\n          color: ",";\n          fill: currentcolor;\n        }\n        :host(:hover) .start,\n        :host(:hover) .end,\n        :host(:hover)::slotted(svg),\n        :host(:active) .start,\n        :host(:active) .end,\n        :host(:active)::slotted(svg),\n        :host(:hover) ::slotted([slot='end']:not(svg)),\n        :host(:",") ::slotted([slot='end']:not(svg)) {\n          color: ",";\n          fill: currentcolor;\n        }\n        :host(.expanded) {\n          background: ",";\n          color: ",";\n        }\n        :host(:",") {\n          background: ",";\n          outline-color: ",";\n          color: ",";\n          fill: currentcolor;\n        }\n        :host([disabled]),\n        :host([disabled]:hover),\n        :host([disabled]:hover) .start,\n        :host([disabled]:hover) .end,\n        :host([disabled]:hover)::slotted(svg),\n        :host([disabled]:",") {\n          background: ",";\n          color: ",";\n          fill: currentcolor;\n          opacity: 1;\n        }\n        :host([disabled]:",") {\n          outline-color: ",";\n        }\n        :host .expanded-toggle,\n        :host .checkbox,\n        :host .radio {\n          border-color: ",";\n          background: ",";\n        }\n        :host([checked]) .checkbox,\n        :host([checked]) .radio {\n          background: ",";\n          border-color: ",";\n        }\n        :host(:hover) .expanded-toggle,\n            :host(:hover) .checkbox,\n            :host(:hover) .radio,\n            :host(:",") .expanded-toggle,\n            :host(:",") .checkbox,\n            :host(:",") .radio,\n            :host([checked]:hover) .checkbox,\n            :host([checked]:hover) .radio,\n            :host([checked]:",") .checkbox,\n            :host([checked]:",") .radio {\n          border-color: ",";\n        }\n        :host([aria-checked='true']) {\n          background: ",";\n          color: ",";\n        }\n        :host([aria-checked='true']) .checkbox-indicator,\n        :host([aria-checked='true']) ::slotted([slot='checkbox-indicator']),\n        :host([aria-checked='true']) ::slotted([slot='radio-indicator']) {\n          fill: ",";\n        }\n        :host([aria-checked='true']) .radio-indicator {\n          background: ",";\n        }\n      "])),Ap.ButtonText,Ap.Highlight,Ap.HighlightText,Gg,Ap.HighlightText,Ap.Highlight,Ap.HighlightText,Gg,Ap.Highlight,Ap.ButtonText,Ap.HighlightText,Gg,Ap.ButtonFace,Ap.GrayText,Gg,Ap.GrayText,Ap.ButtonText,Ap.HighlightText,Ap.HighlightText,Ap.HighlightText,Gg,Gg,Gg,Gg,Gg,Ap.HighlightText,Ap.Highlight,Ap.HighlightText,Ap.Highlight,Ap.Highlight)),new Oy(xp(EC||(EC=Ht(["\n        .expand-collapse-glyph-container {\n          transform: rotate(0deg);\n        }\n      "]))),xp(AC||(AC=Ht(["\n        .expand-collapse-glyph-container {\n          transform: rotate(180deg);\n        }\n      "]))))),checkboxIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>\n    </svg>\n  ',expandCollapseGlyph:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M5.65 3.15a.5.5 0 000 .7L9.79 8l-4.14 4.15a.5.5 0 00.7.7l4.5-4.5a.5.5 0 000-.7l-4.5-4.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  ',radioIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <circle cx="8" cy="8" r="2"/>\n    </svg>\n  '});var PC,OC,DC=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},MC=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Tl(pC,RC,Ev);let NC=class extends Lt{static get styles(){return Xx}constructor(){super(),this.onHeaderClick=e=>{Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)},this.onHeaderKeyDown=e=>{if("Enter"===e.key){e.preventDefault(),e.stopPropagation(),this.open=!this.open;const t=this.renderRoot.querySelector("fluent-menu");t&&(t.classList.remove("closed"),t.classList.add("open"));const n=e.target;if(n){const e=this.renderRoot.querySelector("fluent-menu-item[tabindex='0']");e&&(n.blur(),e.focus())}}},this.value="",this.options={},this._clickHandler=()=>this.open=!1,window.addEventListener("onblur",(()=>this.open=!1))}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return ot(PC||(PC=Ht(['\n      <fluent-button\n        class="header"\n        @click=',"\n        @keydown=",'\n        appearance="lightweight">\n          ',"\n      </fluent-button>\n      <fluent-menu\n        class=",">\n          ","\n      </fluent-menu>"])),this.onHeaderClick,this.onHeaderKeyDown,this.value,Bn({menu:!0,open:this.open,closed:!this.open}),this.getMenuOptions())}getMenuOptions(){return Object.keys(this.options).map((e=>ot(OC||(OC=Ht(["\n          <fluent-menu-item\n            @click=","\n            @keydown=",">\n              ","\n          </fluent-menu-item>"])),(t=>{this.open=!1,this.options[e](t)}),(t=>{const n=this.renderRoot.querySelector(".header");"Enter"===t.key?(this.open=!1,this.options[e](t),n.focus()):"Tab"===t.key?this.open=!1:"Escape"===t.key&&(this.open=!1,n&&n.focus())}),e)))}};DC([Et({type:Boolean}),MC("design:type",Boolean)],NC.prototype,"open",void 0),DC([Et({type:String}),MC("design:type",String)],NC.prototype,"value",void 0),DC([Et({type:Object}),MC("design:type",Object)],NC.prototype,"options",void 0),NC=DC([Tn("arrow-options"),MC("design:paramtypes",[])],NC);const LC={dotOptionsTitle:"More options"};var FC;const UC=[Ce(FC||(FC=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--neutral-fill-rest) 0 0 40px 5px;background:var(--neutral-fill-rest);z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--neutral-fill-rest) 0 0 40px 5px;background:var(--neutral-fill-rest);z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}\n'])))];var zC,HC=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},qC=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},BC=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Tl(pC,RC,Ev);let VC=class extends Lt{constructor(){super(...arguments),this._clickHandler=()=>this.open=!1,this.handleItemClick=(e,t)=>{e.preventDefault(),e.stopPropagation(),t(e),this.open=!1},this.handleItemKeydown=(e,t)=>{this.handleKeydownMenuOption(e),t(e),this.open=!1},this.onDotClick=e=>{e.preventDefault(),e.stopPropagation(),this.open=!this.open},this.onDotKeydown=e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}}static get styles(){return UC}get strings(){return LC}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){const e=Object.keys(this.options);return ot(jC||(jC=HC(['\n      <fluent-button\n        appearance="stealth"\n        aria-label=',"\n        @click=","\n        @keydown=",'\n        class="dot-icon">\ue712</fluent-button>\n      <fluent-menu class=',">\n        ","\n      </fluent-menu>"],['\n      <fluent-button\n        appearance="stealth"\n        aria-label=',"\n        @click=","\n        @keydown=",'\n        class="dot-icon">\\uE712</fluent-button>\n      <fluent-menu class=',">\n        ","\n      </fluent-menu>"])),this.strings.dotOptionsTitle,this.onDotClick,this.onDotKeydown,Bn({menu:!0,open:this.open}),e.map((e=>this.getMenuOption(e,this.options[e]))))}getMenuOption(e,t){return ot(zC||(zC=Ht(["\n      <fluent-menu-item\n        @click=","\n        @keydown=",">\n          ","\n      </fluent-menu-item>"])),(e=>this.handleItemClick(e,t)),(e=>this.handleItemKeydown(e,t)),e)}handleKeydownMenuOption(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())}};var jC,KC;qC([Et({type:Boolean}),BC("design:type",Boolean)],VC.prototype,"open",void 0),qC([Et({type:Object}),BC("design:type",Object)],VC.prototype,"options",void 0),VC=qC([Tn("dot-options")],VC);const GC=[Ce(KC||(KC=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size,16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size,12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size,medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size,16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size,12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size,medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}\n'])))],$C={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding a task...",addTaskButtonSubtitle:"Add",due:"Due ",addTaskDate:"Add the task date",assign:"Assign"};var WC=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const QC=(e,t,n)=>WC(void 0,void 0,void 0,(function*(){const o={assignments:n,appliedCategories:{category4:!0}};yield YC(e,t,o)})),YC=(e,t,n)=>WC(void 0,void 0,void 0,(function*(){let o;try{o=yield e.api("/planner/tasks/".concat(t.id)).header("Cache-Control","no-store").middlewareOptions(ie("Group.ReadWrite.All")).header("Prefer","return=representation").header("If-Match",t.eTag).update(n)}catch(Ye){}return o}));var ZC=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const JC=(e,t,n,o)=>ZC(void 0,void 0,void 0,(function*(){return yield e.api("/me/outlook/tasks/".concat(t)).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(ie("Tasks.ReadWrite")).patch(n)}));var XC=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};class e_{constructor(e){this.graph=me.fromGraph(e)}}class t_ extends e_{getTaskGroups(){return XC(this,void 0,void 0,(function*(){var e;return(yield(e=this.graph,WC(void 0,void 0,void 0,(function*(){const t=yield e.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(ie("Group.Read.All")).get();return null===t||void 0===t?void 0:t.value})))).map((e=>{var t;return{id:e.id,title:e.title,containerId:null===(t=null===e||void 0===e?void 0:e.container)||void 0===t?void 0:t.containerId}}))}))}getTaskGroupsForGroup(e){return XC(this,void 0,void 0,(function*(){var t,n;return(yield(t=this.graph,n=e,WC(void 0,void 0,void 0,(function*(){const e="/groups/".concat(n,"/planner/plans"),o=yield t.api(e).header("Cache-Control","no-store").middlewareOptions(ie("Group.Read.All")).get();return null===o||void 0===o?void 0:o.value})))).map((e=>({id:e.id,title:e.title})))}))}getTaskGroup(e){return XC(this,void 0,void 0,(function*(){const t=yield(n=this.graph,o=e,WC(void 0,void 0,void 0,(function*(){return yield n.api("/planner/plans/".concat(o)).header("Cache-Control","no-store").middlewareOptions(ie("Group.Read.All")).get()})));var n,o;return{id:t.id,title:t.title,_raw:t}}))}getTaskFoldersForTaskGroup(e){return XC(this,void 0,void 0,(function*(){var t,n;return(yield(t=this.graph,n=e,WC(void 0,void 0,void 0,(function*(){const e=yield t.api("/planner/plans/".concat(n,"/buckets")).header("Cache-Control","no-store").middlewareOptions(ie("Group.Read.All")).get();return null===e||void 0===e?void 0:e.value})))).map((e=>({_raw:e,id:e.id,name:e.name,parentId:e.planId})))}))}getTasksForTaskFolder(e){return XC(this,void 0,void 0,(function*(){var t,n;return(yield(t=this.graph,n=e,WC(void 0,void 0,void 0,(function*(){const e=yield t.api("/planner/buckets/".concat(n,"/tasks")).header("Cache-Control","no-store").middlewareOptions(ie("Group.Read.All")).get();return null===e||void 0===e?void 0:e.value})))).map((e=>({_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId})))}))}setTaskComplete(e){return XC(this,void 0,void 0,(function*(){return yield((e,t)=>WC(void 0,void 0,void 0,(function*(){yield YC(e,t,{percentComplete:100})})))(this.graph,e)}))}setTaskIncomplete(e){return XC(this,void 0,void 0,(function*(){return((e,t)=>WC(void 0,void 0,void 0,(function*(){yield YC(e,t,{percentComplete:0})})))(this.graph,e)}))}addTask(e){var t;return XC(this,void 0,void 0,(function*(){return yield((e,t)=>WC(void 0,void 0,void 0,(function*(){return yield e.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(ie("Group.ReadWrite.All")).post(t)})))(this.graph,{assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:null===(t=e.dueDate)||void 0===t?void 0:t.toISOString(),planId:e.topParentId,title:e.name})}))}assignPeopleToTask(e,t){return XC(this,void 0,void 0,(function*(){return QC(this.graph,e,t)}))}removeTask(e){return XC(this,void 0,void 0,(function*(){return yield((e,t)=>WC(void 0,void 0,void 0,(function*(){yield e.api("/planner/tasks/".concat(t.id)).header("Cache-Control","no-store").header("If-Match",t.eTag).middlewareOptions(ie("Group.ReadWrite.All")).delete()})))(this.graph,e)}))}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}}class n_ extends e_{getTaskGroups(){return XC(this,void 0,void 0,(function*(){var e;return(yield(e=this.graph,ZC(void 0,void 0,void 0,(function*(){const t=yield e.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get();return null===t||void 0===t?void 0:t.value})))).map((e=>({_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name})))}))}getTaskGroup(e){return XC(this,void 0,void 0,(function*(){const t=yield(n=this.graph,o=e,ZC(void 0,void 0,void 0,(function*(){return yield n.api("/me/outlook/taskGroups/".concat(o)).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get()})));var n,o;return{id:t.id,secondaryId:t.groupKey,title:t.name,_raw:t}}))}getTaskFoldersForTaskGroup(e){return XC(this,void 0,void 0,(function*(){var t,n;return(yield(t=this.graph,n=e,ZC(void 0,void 0,void 0,(function*(){const e=yield t.api("/me/outlook/taskGroups/".concat(n,"/taskFolders")).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get();return null===e||void 0===e?void 0:e.value})))).map((t=>({_raw:t,id:t.id,name:t.name,parentId:e})))}))}getTasksForTaskFolder(e,t){return XC(this,void 0,void 0,(function*(){var n,o;return(yield(n=this.graph,o=e,ZC(void 0,void 0,void 0,(function*(){const e=yield n.api("/me/outlook/taskFolders/".concat(o,"/tasks")).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get();return null===e||void 0===e?void 0:e.value})))).map((n=>({_raw:n,assignments:{},completed:!!n.completedDateTime,dueDate:n.dueDateTime&&new Date(n.dueDateTime.dateTime+"Z"),eTag:n["@odata.etag"],id:n.id,immediateParentId:e,name:n.subject,topParentId:t})))}))}setTaskComplete(e){return XC(this,void 0,void 0,(function*(){var t,n,o;yield(t=this.graph,n=e.id,o=e.eTag,ZC(void 0,void 0,void 0,(function*(){return yield JC(t,n,{isReminderOn:!1,status:"completed"},o)})))}))}assignPeopleToTask(e,t){return XC(this,void 0,void 0,(function*(){return yield QC(this.graph,e,t)}))}setTaskIncomplete(e){return XC(this,void 0,void 0,(function*(){var t,n,o;yield(t=this.graph,n=e.id,o=e.eTag,ZC(void 0,void 0,void 0,(function*(){return yield JC(t,n,{isReminderOn:!0,status:"notStarted"},o)})))}))}addTask(e){return XC(this,void 0,void 0,(function*(){const t={parentFolderId:e.immediateParentId,subject:e.name};return e.dueDate&&(t.dueDateTime={dateTime:e.dueDate.toISOString(),timeZone:"UTC"}),yield((e,t)=>ZC(void 0,void 0,void 0,(function*(){const{parentFolderId:n=null}=t;return n?yield e.api("/me/outlook/taskFolders/".concat(n,"/tasks")).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.ReadWrite")).post(t):yield e.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(ie("Tasks.ReadWrite")).post(t)})))(this.graph,t)}))}removeTask(e){return XC(this,void 0,void 0,(function*(){return yield(t=this.graph,n=e.id,o=e.eTag,ZC(void 0,void 0,void 0,(function*(){yield t.api("/me/outlook/tasks/".concat(n)).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(ie("Tasks.ReadWrite")).delete()})));var t,n,o}))}isAssignedToMe(e,t){return Object.keys(e.assignments).includes(t)}getTaskGroupsForGroup(e){return XC(this,void 0,void 0,(function*(){return Promise.resolve(void 0)}))}}const o_=e=>{const t=Ld.getValueFor(e);return Ic(Cc.create(t,t,t))};class r_ extends xb{}class i_ extends(Og(r_)){constructor(){super(...arguments),this.proxy=document.createElement("select")}}class s_ extends i_{constructor(){super(...arguments),this.open=!1,this.forcedPosition=!1,this.listboxId=qm("listbox-"),this.maxHeight=0}openChanged(e,t){if(this.collapsible){if(this.open)return this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),this.indexWhenOpened=this.selectedIndex,void Rs.queueUpdate((()=>this.focus()));this.ariaControls="",this.ariaExpanded="false"}}get collapsible(){return!(this.multiple||"number"===typeof this.size)}get value(){return Ds.track(this,"value"),this._value}set value(e){var t,n,o,r,i,s,a;const l="".concat(this._value);if(null===(t=this._options)||void 0===t?void 0:t.length){const t=this._options.findIndex((t=>t.value===e)),l=null!==(o=null===(n=this._options[this.selectedIndex])||void 0===n?void 0:n.value)&&void 0!==o?o:null,c=null!==(i=null===(r=this._options[t])||void 0===r?void 0:r.value)&&void 0!==i?i:null;-1!==t&&l===c||(e="",this.selectedIndex=t),e=null!==(a=null===(s=this.firstSelectedOption)||void 0===s?void 0:s.value)&&void 0!==a?a:e}l!==e&&(this._value=e,super.valueChanged(l,e),Ds.notify(this,"value"),this.updateDisplayValue())}updateValue(e){var t,n;this.$fastController.isConnected&&(this.value=null!==(n=null===(t=this.firstSelectedOption)||void 0===t?void 0:t.value)&&void 0!==n?n:""),e&&(this.$emit("input"),this.$emit("change",this,{bubbles:!0,composed:void 0}))}selectedIndexChanged(e,t){super.selectedIndexChanged(e,t),this.updateValue()}positionChanged(e,t){this.positionAttribute=t,this.setPositioning()}setPositioning(){const e=this.getBoundingClientRect(),t=window.innerHeight-e.bottom;this.position=this.forcedPosition?this.positionAttribute:e.top>t?Qm:Ym,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===Qm?~~e.top:~~t}get displayValue(){var e,t;return Ds.track(this,"displayValue"),null!==(t=null===(e=this.firstSelectedOption)||void 0===e?void 0:e.text)&&void 0!==t?t:""}disabledChanged(e,t){super.disabledChanged&&super.disabledChanged(e,t),this.ariaDisabled=this.disabled?"true":"false"}formResetCallback(){this.setProxyOptions(),super.setDefaultSelectedOption(),-1===this.selectedIndex&&(this.selectedIndex=0)}clickHandler(e){if(!this.disabled){if(this.open){const t=e.target.closest("option,[role=option]");if(t&&t.disabled)return}return super.clickHandler(e),this.open=this.collapsible&&!this.open,this.open||this.indexWhenOpened===this.selectedIndex||this.updateValue(!0),!0}}focusoutHandler(e){var t;if(super.focusoutHandler(e),!this.open)return!0;const n=e.relatedTarget;this.isSameNode(n)?this.focus():(null===(t=this.options)||void 0===t?void 0:t.includes(n))||(this.open=!1,this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0))}handleChange(e,t){super.handleChange(e,t),"value"===t&&this.updateValue()}slottedOptionsChanged(e,t){this.options.forEach((e=>{Ds.getNotifier(e).unsubscribe(this,"value")})),super.slottedOptionsChanged(e,t),this.options.forEach((e=>{Ds.getNotifier(e).subscribe(this,"value")})),this.setProxyOptions(),this.updateValue()}mousedownHandler(e){var t;return e.offsetX>=0&&e.offsetX<=(null===(t=this.listbox)||void 0===t?void 0:t.scrollWidth)?super.mousedownHandler(e):this.collapsible}multipleChanged(e,t){super.multipleChanged(e,t),this.proxy&&(this.proxy.multiple=t)}selectedOptionsChanged(e,t){var n;super.selectedOptionsChanged(e,t),null===(n=this.options)||void 0===n||n.forEach(((e,t)=>{var n;const o=null===(n=this.proxy)||void 0===n?void 0:n.options.item(t);o&&(o.selected=e.selected)}))}setDefaultSelectedOption(){var e;const t=null!==(e=this.options)&&void 0!==e?e:Array.from(this.children).filter($m.slottedOptionFilter),n=null===t||void 0===t?void 0:t.findIndex((e=>e.hasAttribute("selected")||e.selected||e.value===this.value));this.selectedIndex=-1===n?0:n}setProxyOptions(){this.proxy instanceof HTMLSelectElement&&this.options&&(this.proxy.options.length=0,this.options.forEach((e=>{const t=e.proxy||(e instanceof HTMLOptionElement?e.cloneNode():null);t&&this.proxy.options.add(t)})))}keydownHandler(e){super.keydownHandler(e);const t=e.key||e.key.charCodeAt(0);switch(t){case Sg:e.preventDefault(),this.collapsible&&this.typeAheadExpired&&(this.open=!this.open);break;case Cg:case _g:e.preventDefault();break;case kg:e.preventDefault(),this.open=!this.open;break;case xg:this.collapsible&&this.open&&(e.preventDefault(),this.open=!1);break;case Tg:return this.collapsible&&this.open&&(e.preventDefault(),this.open=!1),!0}return this.open||this.indexWhenOpened===this.selectedIndex||(this.updateValue(!0),this.indexWhenOpened=this.selectedIndex),!(t===mg||t===wg)}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.addEventListener("contentchange",this.updateDisplayValue)}disconnectedCallback(){this.removeEventListener("contentchange",this.updateDisplayValue),super.disconnectedCallback()}sizeChanged(e,t){super.sizeChanged(e,t),this.proxy&&(this.proxy.size=t)}updateDisplayValue(){this.collapsible&&Ds.notify(this,"displayValue")}}ta([Ys({attribute:"open",mode:"boolean"})],s_.prototype,"open",void 0),ta([function(e,t,n){return Object.assign({},n,{get:function(){return Ds.trackVolatile(),n.get.apply(this)}})}],s_.prototype,"collapsible",null),ta([Ms],s_.prototype,"control",void 0),ta([Ys({attribute:"position"})],s_.prototype,"positionAttribute",void 0),ta([Ms],s_.prototype,"position",void 0),ta([Ms],s_.prototype,"maxHeight",void 0);class a_{}var l_,c_;ta([Ms],a_.prototype,"ariaControls",void 0),gg(a_,Wm),gg(s_,dg,a_);class d_ extends s_{appearanceChanged(e,t){e!==t&&(this.classList.add(t),this.classList.remove(e))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&Gu.setValueFor(this.listbox,Hu)}}i([Ys({mode:"fromView"})],d_.prototype,"appearance",void 0);const u_=d_.compose({baseName:"select",baseClass:s_,template:(e,t)=>ec(l_||(l_=Ht(['\n    <template\n        class="','"\n        aria-activedescendant="','"\n        aria-controls="','"\n        aria-disabled="','"\n        aria-expanded="','"\n        aria-haspopup="','"\n        aria-multiselectable="','"\n        ?open="','"\n        role="combobox"\n        tabindex="','"\n        @click="','"\n        @focusin="','"\n        @focusout="','"\n        @keydown="','"\n        @mousedown="','"\n    >\n        ','\n        <div\n            class="listbox"\n            id="','"\n            part="listbox"\n            role="listbox"\n            ?disabled="','"\n            ?hidden="','"\n            ',"\n        >\n            <slot\n                ","\n            ></slot>\n        </div>\n    </template>\n"])),(e=>[e.collapsible&&"collapsible",e.collapsible&&e.open&&"open",e.disabled&&"disabled",e.collapsible&&e.position].filter(Boolean).join(" ")),(e=>e.ariaActiveDescendant),(e=>e.ariaControls),(e=>e.ariaDisabled),(e=>e.ariaExpanded),(e=>e.collapsible?"listbox":null),(e=>e.ariaMultiSelectable),(e=>e.open),(e=>e.disabled?null:"0"),((e,t)=>e.clickHandler(t.event)),((e,t)=>e.focusinHandler(t.event)),((e,t)=>e.focusoutHandler(t.event)),((e,t)=>e.keydownHandler(t.event)),((e,t)=>e.mousedownHandler(t.event)),Yf((e=>e.collapsible),ec(c_||(c_=Ht(['\n                <div\n                    class="control"\n                    part="control"\n                    ?disabled="','"\n                    ',"\n                >\n                    ",'\n                    <slot name="button-container">\n                        <div class="selected-value" part="selected-value">\n                            <slot name="selected-value">','</slot>\n                        </div>\n                        <div aria-hidden="true" class="indicator" part="indicator">\n                            <slot name="indicator">\n                                ',"\n                            </slot>\n                        </div>\n                    </slot>\n                    ","\n                </div>\n            "])),(e=>e.disabled),ig("control"),hg(0,t),(e=>e.displayValue),t.indicator||"",ug(0,t))),(e=>e.listboxId),(e=>e.disabled),(e=>!!e.collapsible&&!e.open),ig("listbox"),qg({filter:$m.slottedOptionFilter,flatten:!0,property:"slottedOptions"})),styles:(e,t)=>Sy().withBehaviors(Cv("outline",wv(e,t,Cy,_y)),Cv("filled",yy(e,t,xy,Cy).withBehaviors(Ep(by(e,t,xy,Cy)))),Cv("stealth",kv(e,t,Cy,_y)),Ep(xp(ky||(ky=Ht(["\n    :host([open]) .listbox {\n      background: ",";\n      border-color: ",";\n    }\n  "])),Ap.ButtonFace,Ap.CanvasText))),indicator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>\n    </svg>\n  '});class h_ extends Wa{constructor(){super(...arguments),this.shape="rect"}}var p_,f_;ta([Ys],h_.prototype,"fill",void 0),ta([Ys],h_.prototype,"shape",void 0),ta([Ys],h_.prototype,"pattern",void 0),ta([Ys({mode:"boolean"})],h_.prototype,"shimmer",void 0);var g_,v_;const m_=h_.compose({baseName:"skeleton",template:(e,t)=>ec(p_||(p_=Ht(['\n    <template\n        class="','"\n        pattern="','"\n        ?shimmer="','"\n    >\n        ','\n        <object type="image/svg+xml" data="','" role="presentation">\n            <img class="pattern" src="','" />\n        </object>\n        <slot></slot>\n    </template>\n'])),(e=>"circle"===e.shape?"circle":"rect"),(e=>e.pattern),(e=>e.shimmer),Yf((e=>!0===e.shimmer),ec(f_||(f_=Ht(['\n                <span class="shimmer"></span>\n            '])))),(e=>e.pattern),(e=>e.pattern)),styles:(e,t)=>xp(g_||(g_=Ht(["\n    "," :host {\n      --skeleton-fill-default: ",";\n      overflow: hidden;\n      width: 100%;\n      position: relative;\n      background-color: var(--skeleton-fill, var(--skeleton-fill-default));\n      --skeleton-animation-gradient-default: linear-gradient(\n        270deg,\n        var(--skeleton-fill, var(--skeleton-fill-default)) 0%,\n        "," 51%,\n        var(--skeleton-fill, var(--skeleton-fill-default)) 100%\n      );\n      --skeleton-animation-timing-default: ease-in-out;\n    }\n\n    :host(.rect) {\n      border-radius: calc("," * 1px);\n    }\n\n    :host(.circle) {\n      border-radius: 100%;\n      overflow: hidden;\n    }\n\n    object {\n      position: absolute;\n      width: 100%;\n      height: auto;\n      z-index: 2;\n    }\n\n    object img {\n      width: 100%;\n      height: auto;\n    }\n\n    "," span.shimmer {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      background-image: var(--skeleton-animation-gradient, var(--skeleton-animation-gradient-default));\n      background-size: 0px 0px / 90% 100%;\n      background-repeat: no-repeat;\n      background-color: var(--skeleton-animation-fill, ",");\n      animation: shimmer 2s infinite;\n      animation-timing-function: var(--skeleton-animation-timing, var(--skeleton-timing-default));\n      animation-direction: normal;\n      z-index: 1;\n    }\n\n    ::slotted(svg) {\n      z-index: 2;\n    }\n\n    ::slotted(.pattern) {\n      width: 100%;\n      height: 100%;\n    }\n\n    @keyframes shimmer {\n      0% {\n        transform: translateX(-100%);\n      }\n      100% {\n        transform: translateX(100%);\n      }\n    }\n  "])),Sp("block"),Rh,Ph,nd,Sp("block"),Rh).withBehaviors(Ep(xp(v_||(v_=Ht(["\n        :host{\n          background-color: ",";\n        }\n      "])),Ap.CanvasText)))});var y_,b_,w_,k_,x_,C_,__,S_,T_,I_,E_,A_,R_,P_,O_,D_,M_,N_,L_,F_,U_,z_,H_,q_,B_,V_,j_,K_,G_,$_,W_,Q_,Y_,Z_,J_,X_,eS,tS=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},nS=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},oS=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(u_,Fy,uw,Ev,Nv,m_),function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(eS||(eS={}));const rS={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},iS={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},sS={"@odata.type":"#microsoft.graph.plannerAssignment",orderHint:" !"};let aS=class extends Qt{get res(){switch(this.dataSource){case eS.todo:return rS;case eS.planner:default:return iS}}static get styles(){return GC}get strings(){return $C}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="",this._newTaskContainerId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...ys.requiredScopes,...Aw.requiredScopes])]}constructor(){super(),this.dataSource=eS.planner,this._isDarkMode=!1,this._me=null,this.onResize=()=>{this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.onThemeChanged=()=>{this._isDarkMode=o_(this)},this.onAddTaskClick=()=>{var e;const t=this.getPeoplePicker(null),n={};if(t)for(const o of null!==(e=null===t||void 0===t?void 0:t.selectedPeople)&&void 0!==e?e:[])n[o.id]=sS;!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,n)},this.onAddTaskKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||this.onAddTaskClick()},this.newTaskButtonKeydown=e=>{"Enter"===e.key&&(this.isNewTaskVisible=!this.isNewTaskVisible)},this.addNewTaskButtonClick=()=>{this.isNewTaskVisible=!this.isNewTaskVisible},this.handleNewTaskDateChange=e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null},this.handleSelectedPlan=e=>{var t,n;if(this._newTaskGroupId=e.target.value,this.dataSource===eS.planner){const e=this._groups.filter((e=>e.id===this._newTaskGroupId));this._newTaskContainerId=null!==(n=null===(t=e.pop())||void 0===t?void 0:t.containerId)&&void 0!==n?n:this._newTaskContainerId}},this.newTaskVisible=e=>{"Enter"===e.key&&(this.isNewTaskVisible=!1)},this.handleDateChange=e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null},this.renderPlannerIcon=e=>ei(Xr.Planner,e),this.renderBucketIcon=e=>ei(Xr.Milestone,e),this.handlePeopleClick=(e,t)=>{this.togglePeoplePicker(t),e.stopPropagation()},this.handlePeopleKeydown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(this.togglePeoplePicker(t),e.stopPropagation(),e.preventDefault())},this.handlePeoplePickerKeydown=e=>{"Enter"===e.key&&e.stopPropagation()},this.clearState(),this.previousMediaQuery=this.mediaQuery}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("resize",this.onResize),window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),"data-source"===e&&(this.dataSource===eS.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===eS.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(e){super.firstUpdated(e),this.initialId&&!this._currentGroup&&(this.dataSource===eS.planner?this._currentGroup=this.initialId:this.dataSource===eS.todo&&(this._currentFolder=this.initialId)),this.dataSource===eS.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){const e=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let t;return this.hideHeader||(t=ot(y_||(y_=Ht(['\n        <div class="header">\n          ',"\n        </div>\n      "])),this.renderPlanOptions())),ot(b_||(b_=Ht(["\n      ",'\n      <div class="tasks">\n        '," ","\n        ","\n      </div>\n    "])),t,this._isNewTaskVisible?this.renderNewTask():null,e,ss(this._tasks,(e=>e.id),(e=>this.renderTask(e))))}loadState(){return oS(this,void 0,void 0,(function*(){const e=this.getTaskSource();if(!e)return;const t=re.globalProvider;if(t&&t.state===te.SignedIn){if(this._inTaskLoad=!0,!this._me){const e=t.graph.forComponent(this);this._me=yield xo(e)}this.groupId&&this.dataSource===eS.planner?yield this._loadTasksForGroup(e):this.targetId?this.dataSource===eS.todo?yield this._loadTargetTodoTasks(e):yield this._loadTargetPlannerTasks(e):yield this._loadAllTasks(e),this._tasks=this._tasks.filter((e=>this.isTaskInSelectedGroupFilter(e))).filter((e=>this.isTaskInSelectedFolderFilter(e))).filter((e=>!this._hiddenTasks.includes(e.id))),this.taskFilter&&(this._tasks=this._tasks.filter((e=>this.taskFilter(e._raw)))),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}}))}_loadTargetTodoTasks(e){return oS(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),n=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),o=(yield Promise.all(n.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=n,this._groups=t,this._currentGroup=null}))}_loadTargetPlannerTasks(e){return oS(this,void 0,void 0,(function*(){const t=yield e.getTaskGroup(this.targetId);let n=yield e.getTaskFoldersForTaskGroup(t.id);this.targetBucketId&&(n=n.filter((e=>e.id===this.targetBucketId)));const o=(yield Promise.all(n.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=n,this._groups=[t]}))}_loadAllTasks(e){return oS(this,void 0,void 0,(function*(){const t=yield e.getTaskGroups(),n=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]);if(!this.initialId&&this.dataSource===eS.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const e=n.find((e=>e._raw.isDefaultFolder));e&&(this._currentFolder=e.id)}const o=(yield Promise.all(n.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=n,this._groups=t}))}_loadTasksForGroup(e){return oS(this,void 0,void 0,(function*(){const t=yield e.getTaskGroupsForGroup(this.groupId),n=(yield Promise.all(t.map((t=>e.getTaskFoldersForTaskGroup(t.id))))).reduce(((e,t)=>[...e,...t]),[]),o=(yield Promise.all(n.map((t=>e.getTasksForTaskFolder(t.id,t.parentId))))).reduce(((e,t)=>[...e,...t]),[]);this._tasks=o,this._folders=n,this._groups=t}))}addTask(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return oS(this,void 0,void 0,(function*(){const i=this.getTaskSource();if(!i)return;const s={assignments:r,dueDate:t,immediateParentId:o,name:e,topParentId:n};this._newTaskBeingAdded=!0,s._raw=yield i.addTask(s),this.fireCustomEvent("taskAdded",s),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(e){return oS(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskComplete(e),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}uncompleteTask(e){return oS(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._loadingTasks=[...this._loadingTasks,e.id],yield t.setTaskIncomplete(e),this.fireCustomEvent("taskChanged",e),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}removeTask(e){return oS(this,void 0,void 0,(function*(){const t=this.getTaskSource();t&&(this._hiddenTasks=[...this._hiddenTasks,e.id],yield t.removeTask(e),this.fireCustomEvent("taskRemoved",e),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((t=>t!==e.id)))}))}assignPeople(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return oS(this,void 0,void 0,(function*(){const n=this.getTaskSource();if(!n)return;let o=[];e&&e.assignments&&(o=Object.keys(e.assignments).sort());const r=t.map((e=>e.id));if(r.length===o.length&&r.sort().every(((e,t)=>e===o[t])))return;const i={};for(const e of o)r.includes(e)?i[e]=sS:i[e]=null;r.forEach((e=>{o.includes(e)||(i[e]=sS)})),e&&(yield n.assignPeopleToTask(e,i),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)))}))}renderPlanOptions(){var e;const t=re.globalProvider;if(!t||t.state!==te.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return ot(w_||(w_=Ht(['<span class="loading-header"></span>'])));const n=this.readOnly||this._isNewTaskVisible?null:ot(k_||(k_=Ht(['\n          <fluent-button\n            appearance="accent"\n            class="new-task-button"\n            @keydown=',"\n            @click=",'>\n              <span slot="start">',"</span>\n              ","\n          </fluent-button>\n        "])),this.newTaskButtonKeydown,(()=>this.isNewTaskVisible=!this.isNewTaskVisible),ei(Xr.Add,"currentColor"),this.strings.addTaskButtonSubtitle);if(this.dataSource===eS.planner){const t=this._groups.find((e=>e.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},o={[this.res.BASE_SELF_ASSIGNED]:()=>{this._currentGroup=null,this._currentFolder=null}};for(const e of this._groups)o[e.title]=()=>{this._currentGroup=e.id,this._currentFolder=null};const r=Sn(x_||(x_=Ht(['\n        <mgt-arrow-options\n          class="arrow-options"\n          .options="','"\n          .value="','"></mgt-arrow-options>'])),o,t.title),i=this._currentGroup?ei(Xr.ChevronRight):null,s=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},a={[this.res.BUCKETS_SELF_ASSIGNED]:()=>{this._currentFolder=null}};for(const e of this._folders.filter((e=>e.parentId===this._currentGroup)))a[e.name]=()=>{this._currentFolder=e.id};const l=this.targetBucketId?ot(C_||(C_=Ht(['\n            <span class="plan-title">\n              ',"\n            </span>"])),(null===(e=this._folders[0])||void 0===e?void 0:e.name)||""):Sn(__||(__=Ht(['\n            <mgt-arrow-options class="arrow-options" .options="','" .value="','"></mgt-arrow-options>\n          '])),a,s.name);return ot(S_||(S_=Ht(['\n        <div class="Title">\n          '," "," ","\n        </div>\n        ","\n      "])),r,i,this._currentGroup?l:null,n)}{const e=this._folders.find((e=>e.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},t=this._folders.find((e=>e.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},o={};for(const n of this._folders)o[n.name]=()=>{this._currentFolder=n.id};o[this.res.BUCKETS_SELF_ASSIGNED]=()=>{this._currentFolder=null};const r=this.targetId?ot(T_||(T_=Ht(['\n            <span class="plan-title">\n              ',"\n            </span>\n          "])),e.name):Sn(I_||(I_=Ht(['\n            <mgt-arrow-options class="arrow-options" .value="','" .options="','"></mgt-arrow-options>\n          '])),t.name,o);return ot(E_||(E_=Ht(['\n        <span class="title">\n          ',"\n        </span>\n        ","\n      "])),r,n)}}renderNewTask(){const e="var(--neutral-foreground-hint)",t=ot(A_||(A_=Ht(['\n      <fluent-text-field\n        autocomplete="off"\n        placeholder=','\n        .value="','"\n        class="new-task"\n        aria-label=',"\n        @input=",">\n      </fluent-text-field>"])),this.strings.newTaskPlaceholder,this._newTaskName,this.strings.newTaskPlaceholder,(e=>this._newTaskName=e.target.value));this._groups.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=this._groups[0].id);const n=ot(R_||(R_=Ht(["\n      ",""])),ss(this._groups,(e=>e.id),(e=>ot(P_||(P_=Ht(['<fluent-option value="','">',"</fluent-option>"])),e.id,e.title)))),o=this.dataSource===eS.todo?null:this._currentGroup?ot(O_||(O_=Ht(['\n          <span class="new-task-group">\n            ',"\n            <span>","</span>\n          </span>"])),this.renderPlannerIcon(e),this.getPlanTitle(this._currentGroup)):ot(D_||(D_=Ht(['\n            <fluent-select>\n              <span slot="start">',"</span>\n              ","\n            </fluent-select>"])),this.renderPlannerIcon(e),this._groups.length>0?n:ot(M_||(M_=Ht(["<fluent-option selected>No groups found</fluent-option>"])))),r=this._folders.filter((e=>this._currentGroup&&e.parentId===this._currentGroup||!this._currentGroup&&e.parentId===this._newTaskGroupId));r.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=r[0].id);const i=ot(N_||(N_=Ht(["\n      ",""])),ss(r,(e=>e.id),(e=>ot(L_||(L_=Ht(['<fluent-option value="','">',"</fluent-option>"])),e.id,e.name)))),s=this._currentFolder?ot(F_||(F_=Ht(['\n          <span class="new-task-bucket">\n            ',"\n            <span>","</span>\n          </span>\n        "])),this.renderBucketIcon(e),this.getFolderName(this._currentFolder)):ot(U_||(U_=Ht(['\n         <fluent-select>\n          <span slot="start">',"</span>\n          ","\n        </fluent-select>"])),this.renderBucketIcon(e),r.length>0?i:ot(z_||(z_=Ht(["<fluent-option selected>No folders found</fluent-option>"])))),a={dark:this._isDarkMode,"new-task":!0},l=ot(H_||(H_=Ht(['\n      <fluent-text-field\n        autocomplete="off"\n        type="date"\n        class=','\n        aria-label="','"\n        .value="','"\n        @change=',">\n      </fluent-text-field>"])),Bn(a),this.strings.addTaskDate,this.dateToInputValue(this._newTaskDueDate),this.handleDateChange),c=this.dataSource===eS.todo?null:this.renderAssignedPeople(null),d=this._newTaskBeingAdded?ot(q_||(q_=Ht(['<div class="task-add-button-container"></div>']))):ot(B_||(B_=Ht(['\n          <fluent-button\n            class="add-task"\n            @click=',"\n            @keydown=",'\n            appearance="neutral">\n              ','\n          </fluent-button>\n          <fluent-button\n            class="cancel-task"\n            @click=',"\n            @keydown=",'\n            appearance="neutral">\n              ',"\n          </fluent-button>"])),this.onAddTaskClick,this.onAddTaskKeyDown,this.strings.addTaskButtonSubtitle,(()=>this.isNewTaskVisible=!1),this.newTaskVisible,this.strings.cancelNewTaskSubtitle);return ot(V_||(V_=Ht(["\n    <div\n      class=",'>\n      <div class="task-details-container">\n        <div class="top add-new-task">\n          <div class="check-and-title">\n            ','\n            <div class="task-content">\n              <div class="task-group">','</div>\n              <div class="task-bucket">',"</div>\n              ",'\n              <div class="task-due">','</div>\n            </div>\n          </div>\n          <div class="task-options new-task-action-buttons">',"</div>\n        </div>\n      </div>\n    </div>\n  "])),Bn({task:!0,"new-task":!0}),t,o,s,c,l,d)}togglePeoplePicker(e){const t=this.getPeoplePicker(e),n=this.getMgtPeople(e),o=this.getFlyout(e);t&&n&&o&&(o.isOpen?o.close():(t.selectedPeople=n.people,o.open(),setTimeout((()=>t.focus()),100)))}updateAssignedPeople(e){const t=this.getPeoplePicker(e),n=this.getMgtPeople(e);t&&t.selectedPeople!==n.people&&(n.people=t.selectedPeople,this.assignPeople(e,t.selectedPeople))}getPeoplePicker(e){const t=e?e.id:"new-task";return this.renderRoot.querySelector(".picker-".concat(t))}getMgtPeople(e){const t=e?e.id:"new-task";return this.renderRoot.querySelector(".people-".concat(t))}getFlyout(e){const t=e?e.id:"new-task";return this.renderRoot.querySelector(".flyout-".concat(t))}renderTask(e){const{name:t="Task",completed:n=!1,dueDate:o}=e,r=this._currentGroup?null:this.getPlanTitle(e.topParentId),i=this._currentFolder?null:this.getFolderName(e.immediateParentId),s={task:Object.assign(Object.assign({},e._raw),{groupTitle:r,folderTitle:i})},a=this.renderTemplate("task",s,e.id);if(a)return a;let l=this.renderTemplate("task-details",s,"task-details-".concat(e.id));if(!l){const t="var(--neutral-foreground-hint)",n=this.dataSource===eS.todo||this._currentGroup?null:ot(j_||(j_=Ht(['\n              <div class="task-group">\n                <span class="task-icon">','</span>\n                <span class="task-icon-text">',"</span>\n              </div>\n            "])),this.renderPlannerIcon(t),this.getPlanTitle(e.topParentId)),r=this._currentFolder?null:ot(K_||(K_=Ht(['\n            <div class="task-bucket">\n              <span class="task-icon">','</span>\n              <span class="task-icon-text">',"</span>\n            </div>\n          "])),this.renderBucketIcon(t),this.getFolderName(e.immediateParentId)),i=o?ot(G_||(G_=Ht(['\n            <div class="task-due">\n              <span class="task-icon-text">',"","</span>\n            </div>\n          "])),this.strings.due,(e=>{const t=e.getMonth(),n=e.getDate();return"".concat(jn(t)," ").concat(n)})(o)):null,s=this.dataSource===eS.todo?null:this.renderAssignedPeople(e);l=ot($_||($_=Ht([""," "," "," ",""])),n,r,s,i)}const c=this.readOnly||this.hideOptions?null:Sn(W_||(W_=Ht(['\n            <mgt-dot-options\n              class="dot-options"\n              .options="','"\n            ></mgt-dot-options>'])),{[this.strings.removeTaskSubtitle]:()=>this.removeTask(e)}),d=Bn({task:!0,complete:n,incomplete:!n,"read-only":this.readOnly});return ot(Q_||(Q_=Ht(['\n      <div\n        data-id="task-','"\n        class=',"\n        @click=",'>\n        <div class="task-details-container">\n          <div class="top">\n            <div class="check-and-title">\n              <fluent-checkbox\n                @click=',"\n                @keydown=","\n                ?checked=",">\n                  ",'\n              </fluent-checkbox>\n            </div>\n            <div class="task-options">','</div>\n          </div>\n          <div class="bottom">',"</div>\n        </div>\n      </div>\n    "])),e.id,d,(()=>this.handleTaskClick(e)),(t=>this.checkTask(t,e)),(t=>this.handleTaskCheckKeyDown(t,e)),n,t,c,l)}handleTaskCheckKeyDown(e,t){return oS(this,void 0,void 0,(function*(){"Enter"===e.key&&(this.readOnly||(t.completed?yield this.uncompleteTask(t):yield this.completeTask(t),e.stopPropagation(),e.preventDefault()))}))}checkTask(e,t){return oS(this,void 0,void 0,(function*(){if(!this.readOnly){const n=this.shadowRoot.querySelector("[data-id='task-".concat(t.id,"'"));n&&n.classList.add("updating"),t.completed?yield this.uncompleteTask(t):yield this.completeTask(t),n&&n.classList.remove("updating"),e.stopPropagation(),e.preventDefault()}}))}renderAssignedPeople(e){var t;let n;const o={"new-task-assignee":null===e,"task-assignee":null!==e,"task-detail":null!==e},r=e?e.id:"new-task";o["flyout-".concat(r)]=!0;const i=e?Object.keys(e.assignments).map((e=>e)):[];if(!this.newTaskVisible){const o=null===e||void 0===e?void 0:e._raw,r=null===o||void 0===o?void 0:o.planId;if(r){n=null===(t=this._groups.filter((e=>e.id===r)).pop())||void 0===t?void 0:t.containerId}}const s=this.isNewTaskVisible?this._newTaskContainerId:n,a=Sn(Y_||(Y_=Ht(['\n      <mgt-people\n        class="people people-','"\n        .userIds=',"\n        .personCardInteraction=","\n        @click=","\n        @keydown=",'\n      >\n        <template data-type="no-data">\n          <fluent-button>\n            <span style="display:flex;place-content:start;gap:4px;padding-inline-start:4px">\n              <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">\n                <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>\n                <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>\n                <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>\n              </svg> Assign</span>\n            </fluent-button>\n        </template>\n      </mgt-people>'])),r,i,ui.none,(t=>this.handlePeopleClick(t,e)),(t=>this.handlePeopleKeydown(t,e))),l=Sn(Z_||(Z_=Ht(['\n      <mgt-people-picker\n        class="people-picker picker-','"\n        .groupId=',"\n        @keydown=",">\n      ></mgt-people-picker>"])),r,yi(s),this.handlePeoplePickerKeydown);return Sn(J_||(J_=Ht(["\n      <mgt-flyout\n        light-dismiss\n        class=","\n        @closed=",'\n      >\n        <div slot="anchor">','</div>\n        <div slot="flyout" part="picker" class="picker">',"</div>\n      </mgt-flyout>\n    "])),Bn(o),(()=>this.updateAssignedPeople(e)),a,l)}handleTaskClick(e){e&&this.fireCustomEvent("taskClick",e)}renderLoadingTask(){return ot(X_||(X_=Ht(['\n      <div class="header">\n        <div class="title">\n          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>\n        </div>\n        <div class="new-task-button">\n          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>\n        </div>\n      </div>\n      <div class="tasks">\n        <div class="task incomplete">\n          <div class="task-details-container">\n            <div class="top">\n              <div class="check-and-title shimmer">\n                <fluent-skeleton shimmer class="checkbox" shape="circle"></fluent-skeleton>\n                <fluent-skeleton shimmer class="title" shape="rect"></fluent-skeleton>\n              </div>\n              <div class="task-options">\n                <fluent-skeleton shimmer class="options" shape="rect"></fluent-skeleton>\n              </div>\n            </div>\n            <div class="bottom">\n              <div class="task-group">\n                <div class="task-icon">\n                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>\n                </div>\n                <div class="task-icon-text">\n                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>\n                </div>\n              </div>\n              <div class="task-bucket">\n                <div class="task-icon">\n                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>\n                </div>\n                <div class="task-icon-text">\n                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>\n                </div>\n              </div>\n              <div class="task-details shimmer">\n                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>\n                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>\n                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>\n              </div>\n              <div class="task-due">\n                <div class="task-icon-text">\n                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>\n                </div>\n              </div>\n              </div>\n          </div>\n        </div>\n      </div>\n    '])))}getTaskSource(){const e=re.globalProvider;if(!e||e.state!==te.SignedIn)return null;const t=e.graph.forComponent(this);return this.dataSource===eS.planner?new t_(t):this.dataSource===eS.todo?new n_(t):null}getPlanTitle(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((t=>t.id===e))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(e){return e?(this._folders.find((t=>t.id===e))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(e){var t;return!this._currentGroup||e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,null===(t=this._me)||void 0===t?void 0:t.id)}isTaskInSelectedFolderFilter(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}};var lS;tS([Et({attribute:"read-only",type:Boolean}),nS("design:type",Boolean)],aS.prototype,"readOnly",void 0),tS([Et({attribute:"data-source",converter:(e,t)=>(e=e.toLowerCase(),eS[e]||eS.planner)}),nS("design:type",Number)],aS.prototype,"dataSource",void 0),tS([Et({attribute:"target-id",type:String}),nS("design:type",String)],aS.prototype,"targetId",void 0),tS([Et({attribute:"target-bucket-id",type:String}),nS("design:type",String)],aS.prototype,"targetBucketId",void 0),tS([Et({attribute:"initial-id",type:String}),nS("design:type",String)],aS.prototype,"initialId",void 0),tS([Et({attribute:"initial-bucket-id",type:String}),nS("design:type",String)],aS.prototype,"initialBucketId",void 0),tS([Et({attribute:"hide-header",type:Boolean}),nS("design:type",Boolean)],aS.prototype,"hideHeader",void 0),tS([Et({attribute:"hide-options",type:Boolean}),nS("design:type",Boolean)],aS.prototype,"hideOptions",void 0),tS([Et({attribute:"group-id",type:String}),nS("design:type",String)],aS.prototype,"groupId",void 0),tS([Et(),nS("design:type",Boolean)],aS.prototype,"_isNewTaskVisible",void 0),tS([Et(),nS("design:type",Boolean)],aS.prototype,"_newTaskBeingAdded",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_newTaskName",void 0),tS([Et(),nS("design:type",Date)],aS.prototype,"_newTaskDueDate",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_newTaskGroupId",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_newTaskFolderId",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_newTaskContainerId",void 0),tS([Et(),nS("design:type",Array)],aS.prototype,"_groups",void 0),tS([Et(),nS("design:type",Array)],aS.prototype,"_folders",void 0),tS([Et(),nS("design:type",Array)],aS.prototype,"_tasks",void 0),tS([Et(),nS("design:type",Array)],aS.prototype,"_hiddenTasks",void 0),tS([Et(),nS("design:type",Array)],aS.prototype,"_loadingTasks",void 0),tS([Et(),nS("design:type",Boolean)],aS.prototype,"_inTaskLoad",void 0),tS([Et(),nS("design:type",Boolean)],aS.prototype,"_hasDoneInitialLoad",void 0),tS([Et(),nS("design:type",Boolean)],aS.prototype,"_todoDefaultSet",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_currentGroup",void 0),tS([Et(),nS("design:type",String)],aS.prototype,"_currentFolder",void 0),tS([At(),nS("design:type",Object)],aS.prototype,"_isDarkMode",void 0),tS([At(),nS("design:type",Object)],aS.prototype,"_me",void 0),aS=tS([Tn("tasks"),nS("design:paramtypes",[])],aS);const cS=[Ce(lS||(lS=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}\n'])))];var dS=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const uS={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",photoFor:"Teams photo for",teamsChannels:"Teams and channels results",closeButtonAriaLabel:"remove the selected channel"};class hS extends Wa{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var e;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(e=this.$fastController.definition.shadowOptions)||void 0===e?void 0:e.delegatesFocus)&&(this.focus=()=>{var e;null===(e=this.control)||void 0===e||e.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}}ta([Ys],hS.prototype,"download",void 0),ta([Ys],hS.prototype,"href",void 0),ta([Ys],hS.prototype,"hreflang",void 0),ta([Ys],hS.prototype,"ping",void 0),ta([Ys],hS.prototype,"referrerpolicy",void 0),ta([Ys],hS.prototype,"rel",void 0),ta([Ys],hS.prototype,"target",void 0),ta([Ys],hS.prototype,"type",void 0),ta([Ms],hS.prototype,"defaultSlottedContent",void 0);class pS{}ta([Ys({attribute:"aria-expanded"})],pS.prototype,"ariaExpanded",void 0),gg(pS,og),gg(hS,dg,pS);class fS extends hS{constructor(){super(...arguments),this.separator=!0}}ta([Ms],fS.prototype,"separator",void 0),gg(fS,dg,pS);class gS extends Wa{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(void 0===this.slottedBreadcrumbItems||0===this.slottedBreadcrumbItems.length)return;const e=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach((t=>{const n=t===e;this.setItemSeparator(t,n),this.setAriaCurrent(t,n)}))}}setItemSeparator(e,t){e instanceof fS&&(e.separator=!t)}findChildWithHref(e){var t,n;return e.childElementCount>0?e.querySelector("a[href]"):(null===(t=e.shadowRoot)||void 0===t?void 0:t.childElementCount)?null===(n=e.shadowRoot)||void 0===n?void 0:n.querySelector("a[href]"):null}setAriaCurrent(e,t){const n=this.findChildWithHref(e);null===n&&e.hasAttribute("href")&&e instanceof fS?t?e.setAttribute("aria-current","page"):e.removeAttribute("aria-current"):null!==n&&(t?n.setAttribute("aria-current","page"):n.removeAttribute("aria-current"))}}var vS;ta([Ms],gS.prototype,"slottedBreadcrumbItems",void 0);var mS;const yS=gS.compose({baseName:"breadcrumb",template:(e,t)=>ec(vS||(vS=Ht(['\n    <template role="navigation">\n        <div role="list" class="list" part="list">\n            <slot\n                ',"\n            ></slot>\n        </div>\n    </template>\n"])),qg({property:"slottedBreadcrumbItems",filter:Ug()})),styles:(e,t)=>xp(mS||(mS=Ht(["\n  "," :host {\n    box-sizing: border-box;\n    ",";\n  }\n\n  .list {\n    display: flex;\n  }\n"])),Sp("inline-block"),rv)});var bS;var wS,kS,xS,CS;var _S,SS;const TS=fS.compose({baseName:"breadcrumb-item",template:(e,t)=>ec(wS||(wS=Ht(['\n    <div role="listitem" class="listitem" part="listitem">\n        ',"\n        ","\n        ","\n    </div>\n"])),Yf((e=>e.href&&e.href.length>0),ec(kS||(kS=Ht(["\n                ","\n            "])),((e,t)=>ec(bS||(bS=Ht(['\n    <a\n        class="control"\n        part="control"\n        download="','"\n        href="','"\n        hreflang="','"\n        ping="','"\n        referrerpolicy="','"\n        rel="','"\n        target="','"\n        type="','"\n        aria-atomic="','"\n        aria-busy="','"\n        aria-controls="','"\n        aria-current="','"\n        aria-describedby="','"\n        aria-details="','"\n        aria-disabled="','"\n        aria-errormessage="','"\n        aria-expanded="','"\n        aria-flowto="','"\n        aria-haspopup="','"\n        aria-hidden="','"\n        aria-invalid="','"\n        aria-keyshortcuts="','"\n        aria-label="','"\n        aria-labelledby="','"\n        aria-live="','"\n        aria-owns="','"\n        aria-relevant="','"\n        aria-roledescription="','"\n        ',"\n    >\n        ",'\n        <span class="content" part="content">\n            <slot ',"></slot>\n        </span>\n        ","\n    </a>\n"])),(e=>e.download),(e=>e.href),(e=>e.hreflang),(e=>e.ping),(e=>e.referrerpolicy),(e=>e.rel),(e=>e.target),(e=>e.type),(e=>e.ariaAtomic),(e=>e.ariaBusy),(e=>e.ariaControls),(e=>e.ariaCurrent),(e=>e.ariaDescribedby),(e=>e.ariaDetails),(e=>e.ariaDisabled),(e=>e.ariaErrormessage),(e=>e.ariaExpanded),(e=>e.ariaFlowto),(e=>e.ariaHaspopup),(e=>e.ariaHidden),(e=>e.ariaInvalid),(e=>e.ariaKeyshortcuts),(e=>e.ariaLabel),(e=>e.ariaLabelledby),(e=>e.ariaLive),(e=>e.ariaOwns),(e=>e.ariaRelevant),(e=>e.ariaRoledescription),ig("control"),hg(0,t),qg("defaultSlottedContent"),ug(0,t)))(0,t))),Yf((e=>!e.href),ec(xS||(xS=Ht(["\n                ","\n                <slot></slot>\n                ","\n            "])),hg(0,t),ug(0,t))),Yf((e=>e.separator),ec(CS||(CS=Ht(['\n                <span class="separator" part="separator" aria-hidden="true">\n                    <slot name="separator">',"</slot>\n                </span>\n            "])),t.separator||""))),styles:(e,t)=>xp(_S||(_S=Ht(["\n    "," :host {\n      background: transparent;\n      color: ",";\n      fill: currentcolor;\n      box-sizing: border-box;\n      ",";\n      min-width: calc("," * 1px);\n      border-radius: calc("," * 1px);\n    }\n\n    .listitem {\n      display: flex;\n      align-items: center;\n      border-radius: inherit;\n    }\n\n    .control {\n      position: relative;\n      align-items: center;\n      box-sizing: border-box;\n      color: inherit;\n      fill: inherit;\n      cursor: pointer;\n      display: flex;\n      outline: none;\n      text-decoration: none;\n      white-space: nowrap;\n      border-radius: inherit;\n    }\n\n    .control:hover {\n      color: ",";\n    }\n\n    .control:active {\n      color: ",";\n    }\n\n    .control:"," {\n      ","\n    }\n\n    :host(:not([href])),\n    :host([aria-current]) .control {\n      color: ",";\n      fill: currentcolor;\n      cursor: default;\n    }\n\n    .start {\n      display: flex;\n      margin-inline-end: 6px;\n    }\n\n    .end {\n      display: flex;\n      margin-inline-start: 6px;\n    }\n\n    .separator {\n      display: flex;\n    }\n  "])),Sp("inline-flex"),qh,rv,Wg,nd,Bh,Vh,Gg,lv,qh).withBehaviors(Ep(xp(SS||(SS=Ht(["\n        :host(:not([href])),\n        .start,\n        .end,\n        .separator {\n          background: ",";\n          color: ",";\n          fill: currentcolor;\n        }\n        .separator {\n          fill: ",";\n        }\n        :host([href]) {\n          forced-color-adjust: none;\n          background: ",";\n          color: ",";\n        }\n        :host([href]) .control:hover {\n          background: ",";\n          color: ",";\n          fill: currentcolor;\n        }\n        .control:"," {\n          outline-color: ",";\n        }\n      "])),Ap.ButtonFace,Ap.ButtonText,Ap.ButtonText,Ap.ButtonFace,Ap.LinkText,Ap.LinkText,Ap.HighlightText,Gg,Ap.LinkText))),shadowOptions:{delegatesFocus:!0},separator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '});function IS(e){return jg(e)&&"treeitem"===e.getAttribute("role")}class ES extends Wa{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>IS(this.parentElement),this.handleExpandCollapseButtonClick=e=>{this.disabled||e.defaultPrevented||(this.expanded=!this.expanded)},this.handleFocus=e=>{this.setAttribute("tabindex","0")},this.handleBlur=e=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(e,t){this.$fastController.isConnected&&this.items.forEach((e=>{IS(e)&&(e.nested=!0)}))}static focusItem(e){e.focusable=!0,e.focus()}childItemLength(){const e=this.childItems.filter((e=>IS(e)));return e?e.length:0}}ta([Ys({mode:"boolean"})],ES.prototype,"expanded",void 0),ta([Ys({mode:"boolean"})],ES.prototype,"selected",void 0),ta([Ys({mode:"boolean"})],ES.prototype,"disabled",void 0),ta([Ms],ES.prototype,"focusable",void 0),ta([Ms],ES.prototype,"childItems",void 0),ta([Ms],ES.prototype,"items",void 0),ta([Ms],ES.prototype,"nested",void 0),ta([Ms],ES.prototype,"renderCollapsedChildren",void 0),gg(ES,dg);class AS extends Wa{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=e=>{if(!(this.slottedTreeItems.length<1))return e.target===this?(null===this.currentFocused&&(this.currentFocused=this.getValidFocusableItem()),void(null!==this.currentFocused&&ES.focusItem(this.currentFocused))):void(this.contains(e.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=e.target))},this.handleBlur=e=>{e.target instanceof HTMLElement&&(null===e.relatedTarget||!this.contains(e.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=e=>{if(e.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;const t=this.getVisibleNodes();switch(e.key){case Cg:return void(t.length&&ES.focusItem(t[0]));case _g:return void(t.length&&ES.focusItem(t[t.length-1]));case yg:if(e.target&&this.isFocusableElement(e.target)){const t=e.target;t instanceof ES&&t.childItemLength()>0&&t.expanded?t.expanded=!1:t instanceof ES&&t.parentElement instanceof ES&&ES.focusItem(t.parentElement)}return!1;case bg:if(e.target&&this.isFocusableElement(e.target)){const t=e.target;t instanceof ES&&t.childItemLength()>0&&!t.expanded?t.expanded=!0:t instanceof ES&&t.childItemLength()>0&&this.focusNextNode(1,e.target)}return;case mg:return void(e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(1,e.target));case wg:return void(e.target&&this.isFocusableElement(e.target)&&this.focusNextNode(-1,e.target));case kg:return void this.handleClick(e)}return!0},this.handleSelectedChange=e=>{if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!IS(e.target))return!0;const t=e.target;t.selected?(this.currentSelected&&this.currentSelected!==t&&(this.currentSelected.selected=!1),this.currentSelected=t):t.selected||this.currentSelected!==t||(this.currentSelected=null)},this.setItems=()=>{const e=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=e,null!==this.currentFocused&&this.contains(this.currentFocused)||(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems();this.getVisibleNodes().forEach((e=>{IS(e)&&(e.nested=this.nested)}))},this.isFocusableElement=e=>IS(e),this.isSelectedElement=e=>e.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),Rs.queueUpdate((()=>{this.setItems()}))}handleClick(e){if(e.defaultPrevented)return;if(!(e.target instanceof Element)||!IS(e.target))return!0;const t=e.target;t.disabled||(t.selected=!t.selected)}focusNextNode(e,t){const n=this.getVisibleNodes();if(!n)return;const o=n[n.indexOf(t)+e];jg(o)&&ES.focusItem(o)}getValidFocusableItem(){const e=this.getVisibleNodes();let t=e.findIndex(this.isSelectedElement);return-1===t&&(t=e.findIndex(this.isFocusableElement)),-1!==t?e[t]:null}checkForNestedItems(){return this.slottedTreeItems.some((e=>IS(e)&&e.querySelector("[role='treeitem']")))}getVisibleNodes(){return function(e,t){if(!e||!t||!jg(e))return;return Array.from(e.querySelectorAll(t)).filter((e=>null!==e.offsetParent))}(this,"[role='treeitem']")||[]}}var RS;ta([Ys({attribute:"render-collapsed-nodes"})],AS.prototype,"renderCollapsedNodes",void 0),ta([Ms],AS.prototype,"currentSelected",void 0),ta([Ms],AS.prototype,"slottedTreeItems",void 0);var PS;const OS=AS.compose({baseName:"tree-view",template:(e,t)=>ec(RS||(RS=Ht(['\n    <template\n        role="tree"\n        ','\n        @keydown="','"\n        @focusin="','"\n        @focusout="','"\n        @click="','"\n        @selected-change="','"\n    >\n        <slot ',"></slot>\n    </template>\n"])),ig("treeView"),((e,t)=>e.handleKeyDown(t.event)),((e,t)=>e.handleFocus(t.event)),((e,t)=>e.handleBlur(t.event)),((e,t)=>e.handleClick(t.event)),((e,t)=>e.handleSelectedChange(t.event)),qg("slottedTreeItems")),styles:(e,t)=>xp(PS||(PS=Ht(["\n  :host([hidden]) {\n    display: none;\n  }\n\n  "," :host {\n    flex-direction: column;\n    align-items: stretch;\n    min-width: fit-content;\n    font-size: 0;\n  }\n"])),Sp("flex"))});class DS extends zg{constructor(e,t){super(e,t),this.observer=null,t.childList=!0}observe(){null===this.observer&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}var MS,NS,LS;var FS,US,zS,HS,qS;const BS=xp(FS||(FS=Ht(["\n  .expand-collapse-button svg {\n    transform: rotate(0deg);\n  }\n  :host(.nested) .expand-collapse-button {\n    left: var(--expand-collapse-button-nested-width, calc("," * -1px));\n  }\n  :host([selected])::after {\n    left: calc("," * 1px);\n  }\n  :host([expanded]) > .positioning-region .expand-collapse-button svg {\n    transform: rotate(90deg);\n  }\n"])),Wg,id),VS=xp(US||(US=Ht(["\n  .expand-collapse-button svg {\n    transform: rotate(180deg);\n  }\n  :host(.nested) .expand-collapse-button {\n    right: var(--expand-collapse-button-nested-width, calc("," * -1px));\n  }\n  :host([selected])::after {\n    right: calc("," * 1px);\n  }\n  :host([expanded]) > .positioning-region .expand-collapse-button svg {\n    transform: rotate(90deg);\n  }\n"])),Wg,id),jS=_p(zS||(zS=Ht(["(("," / 2) * ",") + (("," * ",") / 2)"])),Xc,td,td,ed),KS=gl.create("tree-item-expand-collapse-hover").withDefault((e=>{const t=Mh.getValueFor(e);return t.evaluate(e,t.evaluate(e).hover).hover})),GS=gl.create("tree-item-expand-collapse-selected-hover").withDefault((e=>{const t=Ah.getValueFor(e);return Mh.getValueFor(e).evaluate(e,t.evaluate(e).rest).hover})),$S=ES.compose({baseName:"tree-item",template:(e,t)=>{return ec(MS||(MS=Ht(['\n    <template\n        role="treeitem"\n        slot="','"\n        tabindex="-1"\n        class="'," "," ","\n            ",'"\n        aria-expanded="','"\n        aria-selected="','"\n        aria-disabled="','"\n        @focusin="','"\n        @focusout="','"\n        ','\n    >\n        <div class="positioning-region" part="positioning-region">\n            <div class="content-region" part="content-region">\n                ',"\n                ","\n                <slot></slot>\n                ","\n            </div>\n        </div>\n        ","\n    </template>\n"])),(e=>e.isNestedItem()?"item":void 0),(e=>e.expanded?"expanded":""),(e=>e.selected?"selected":""),(e=>e.nested?"nested":""),(e=>e.disabled?"disabled":""),(e=>e.childItems&&e.childItemLength()>0?e.expanded:void 0),(e=>e.selected),(e=>e.disabled),((e,t)=>e.handleFocus(t.event)),((e,t)=>e.handleBlur(t.event)),("string"===typeof(n={property:"childItems",filter:Ug()})&&(n={property:n}),new Rl("fast-children",DS,n)),Yf((e=>e.childItems&&e.childItemLength()>0),ec(NS||(NS=Ht(['\n                        <div\n                            aria-hidden="true"\n                            class="expand-collapse-button"\n                            part="expand-collapse-button"\n                            @click="','"\n                            ','\n                        >\n                            <slot name="expand-collapse-glyph">\n                                ',"\n                            </slot>\n                        </div>\n                    "])),((e,t)=>e.handleExpandCollapseButtonClick(t.event)),ig("expandCollapseButton"),t.expandCollapseGlyph||"")),hg(0,t),ug(0,t),Yf((e=>e.childItems&&e.childItemLength()>0&&(e.expanded||e.renderCollapsedChildren)),ec(LS||(LS=Ht(['\n                <div role="group" class="items" part="items">\n                    <slot name="item" ',"></slot>\n                </div>\n            "])),qg("items"))));var n},styles:(e,t)=>xp(HS||(HS=Ht(["\n    "," :host {\n      contain: content;\n      position: relative;\n      outline: none;\n      color: ",";\n      fill: currentcolor;\n      cursor: pointer;\n      font-family: ",";\n      --expand-collapse-button-size: calc("," * 1px);\n      --tree-item-nested-width: 0;\n    }\n\n    .positioning-region {\n      display: flex;\n      position: relative;\n      box-sizing: border-box;\n      background: ",";\n      border: calc("," * 1px) solid transparent;\n      border-radius: calc("," * 1px);\n      height: calc(("," + 1) * 1px);\n    }\n\n    :host(:",") .positioning-region {\n      ","\n    }\n\n    .positioning-region::before {\n      content: '';\n      display: block;\n      width: var(--tree-item-nested-width);\n      flex-shrink: 0;\n    }\n\n    :host(:not([disabled])) .positioning-region:hover {\n      background: ",";\n    }\n\n    :host(:not([disabled])) .positioning-region:active {\n      background: ",";\n    }\n\n    .content-region {\n      display: inline-flex;\n      align-items: center;\n      white-space: nowrap;\n      width: 100%;\n      height: calc("," * 1px);\n      margin-inline-start: calc("," * 2px + 8px);\n      ","\n    }\n\n    .items {\n      display: none;\n      "," font-size: calc(1em + ("," + 16) * 1px);\n    }\n\n    .expand-collapse-button {\n      background: none;\n      border: none;\n      border-radius: calc("," * 1px);\n      "," width: calc(("," + ("," * 2)) * 1px);\n      height: calc(("," + ("," * 2)) * 1px);\n      padding: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      cursor: pointer;\n      margin: 0 6px;\n    }\n\n    .expand-collapse-button svg {\n      transition: transform 0.1s linear;\n      pointer-events: none;\n    }\n\n    .start,\n    .end {\n      display: flex;\n    }\n\n    .start {\n      "," margin-inline-end: calc("," * 2px + 2px);\n    }\n\n    .end {\n      "," margin-inline-start: calc("," * 2px + 2px);\n    }\n\n    :host(.expanded) > .items {\n      display: block;\n    }\n\n    :host([disabled]) {\n      opacity: ",";\n      cursor: ",";\n    }\n\n    :host(.nested) .content-region {\n      position: relative;\n      margin-inline-start: var(--expand-collapse-button-size);\n    }\n\n    :host(.nested) .expand-collapse-button {\n      position: absolute;\n    }\n\n    :host(.nested) .expand-collapse-button:hover {\n      background: ",";\n    }\n\n    :host(:not([disabled])[selected]) .positioning-region {\n      background: ",";\n    }\n\n    :host(:not([disabled])[selected]) .expand-collapse-button:hover {\n      background: ",";\n    }\n\n    :host([selected])::after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: calc(("," / 4) * 1px);\n      width: 3px;\n      height: calc(("," / 2) * 1px);\n      "," background: ",";\n      border-radius: calc("," * 1px);\n    }\n\n    ::slotted(fluent-tree-item) {\n      --tree-item-nested-width: 1em;\n      --expand-collapse-button-nested-width: calc("," * -1px);\n    }\n  "])),Sp("block"),qh,sd,Wg,Nh,rd,nd,Wg,Gg,av,Lh,Fh,Wg,td,rv,"",td,nd,"",jS,td,jS,td,"",td,"",td,Jc,Vg,KS,Rh,GS,Wg,Wg,"",Qu,nd,Wg).withBehaviors(new Oy(BS,VS),Ep(xp(qS||(qS=Ht(["\n        :host {\n          color: ",";\n        }\n        .positioning-region {\n          border-color: ",";\n          background: ",";\n        }\n        :host(:not([disabled])) .positioning-region:hover,\n        :host(:not([disabled])) .positioning-region:active,\n        :host(:not([disabled])[selected]) .positioning-region {\n          background: ",";\n        }\n        :host .positioning-region:hover .content-region,\n        :host([selected]) .positioning-region .content-region {\n          forced-color-adjust: none;\n          color: ",";\n        }\n        :host([disabled][selected]) .positioning-region .content-region {\n          color: ",";\n        }\n        :host([selected])::after {\n          background: ",";\n        }\n        :host(:",") .positioning-region {\n          forced-color-adjust: none;\n          outline-color: ",";\n        }\n        :host([disabled]),\n        :host([disabled]) .content-region,\n        :host([disabled]) .positioning-region:hover .content-region {\n          opacity: 1;\n          color: ",";\n        }\n        :host(.nested) .expand-collapse-button:hover,\n        :host(:not([disabled])[selected]) .expand-collapse-button:hover {\n          background: ",";\n          fill: ",";\n        }\n      "])),Ap.ButtonText,Ap.ButtonFace,Ap.ButtonFace,Ap.Highlight,Ap.HighlightText,Ap.GrayText,Ap.HighlightText,Gg,Ap.ButtonFace,Ap.GrayText,Ap.ButtonFace,Ap.ButtonText))),expandCollapseGlyph:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '});var WS,QS,YS,ZS,JS,XS,eT,tT,nT,oT,rT,iT,sT,aT,lT,cT,dT=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},uT=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},hT=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(yS,TS,Kp,OS,$S,uw);let pT=cT=class extends Qt{static get styles(){return cS}get strings(){return uS}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return["team.readbasic.all","channel.readbasic.all"]}set items(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}get items(){return this._items}get _inputWrapper(){return this.renderRoot.querySelector("fluent-text-field")}get _input(){return this._inputWrapper.shadowRoot.querySelector("input")}constructor(){super(),this.teamsPhotos={},this._inputValue="",this._treeViewState=[],this._focusList=[],this.handleInputClick=e=>{e.stopPropagation(),this.gainedFocus()},this.handleInputKeydown=e=>{const t=e.key;if(["ArrowDown","Enter"].includes(t))if(this._isDropdownVisible){this.renderRoot.querySelector("fluent-tree-item").focus()}else this.gainedFocus();else"Escape"===t&&this.lostFocus()},this.onClickCloseButton=()=>{this.removeSelectedChannel(null)},this.onKeydownCloseButton=e=>{"Enter"===e.key&&this.removeSelectedChannel(null)},this.onKeydownTreeView=e=>{"Escape"===e.key&&this.lostFocus()},this.handleTeamTreeItemClick=e=>{e.preventDefault(),e.stopImmediatePropagation();const t=e.target;if(t){t.getAttribute("expanded")?t.removeAttribute("expanded"):t.setAttribute("expanded","true"),t.removeAttribute("selected");t.getAttribute("id")&&t.setAttribute("selected","true")}},this.handleInputChanged=e=>{const t=e.target;this._inputValue!==(null===t||void 0===t?void 0:t.value)&&(this._inputValue=null===t||void 0===t?void 0:t.value,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=Kn((()=>{this.filterList()}),400)),this.debouncedSearch())},this.handleWindowClick=e=>{e.target!==this&&this.lostFocus()},this.gainedFocus=()=>{const e=this._input;e&&e.focus(),this._isDropdownVisible=!0,this.toggleChevron(),this.resetFocusState(),this.requestUpdate()},this.lostFocus=()=>{this._input.value=this._inputValue="",this._input.textContent="";this._inputWrapper.value="",this._isDropdownVisible=!1,this.filterList(),this.toggleChevron(),this.requestUpdate(),void 0!==this._selectedItemState&&this.showCloseIcon()},this.handleFocus=()=>{this.lostFocus(),this.gainedFocus()},this.handleUpChevronClick=e=>{e.stopPropagation(),this.lostFocus()},this.addEventListener("focus",(()=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(()=>this.loadTeamsIfNotLoaded())),this.addEventListener("blur",(()=>this.lostFocus())),this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick);const e=this.renderRoot.ownerDocument;e&&e.documentElement.setAttribute("dir",this.direction)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(e){return hT(this,void 0,void 0,(function*(){const t=re.globalProvider;if(t&&t.state===te.SignedIn){this.items||(yield this.requestStateUpdate());for(const t of this._treeViewState)for(const n of t.channels)if(n.item.id===e)return t.isExpanded=!0,this.selectChannel(n),this.markSelectedChannelInDropdown(e),!0}return!1}))}markSelectedChannelInDropdown(e){const t=this.renderRoot.querySelector("[id='".concat(e,"']"));t&&(t.setAttribute("selected","true"),t.parentElement&&t.parentElement.setAttribute("expanded","true"))}render(){var e;const t={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:null!==(e=this.items)&&void 0!==e?e:[]})||ot(WS||(WS=Ht(['\n        <div class="container" @blur=','>\n          <fluent-text-field\n            autocomplete="off"\n            appearance="outline"\n            id="teams-channel-picker-input"\n            role="combobox"\n            placeholder="',' "\n            aria-label=','\n            aria-expanded="','"\n            label="teams-channel-picker-input"\n            @focus=',"\n            @keyup=","\n            @click=","\n            @keydown=",'\n          >\n            <div tabindex="0" slot="start" style="width: max-content;">','</div>\n            <div tabindex="0" slot="end">',"","</div>\n          </fluent-text-field>\n          <fluent-card\n            class=","\n          >\n            ","\n          </fluent-card>\n        </div>"])),this.lostFocus,this._selectedItemState?"":this.strings.inputPlaceholderText,this.strings.inputPlaceholderText,this._isDropdownVisible,this.handleFocus,this.handleInputChanged,this.handleInputClick,this.handleInputKeydown,this.renderSelected(),this.renderChevrons(),this.renderCloseButton(),Bn(t),this.renderDropdown())}renderSelected(){var e,t,n,o,r,i;if(!this._selectedItemState)return this.renderSearchIcon();let s;if(this._selectedItemState.parent.channels){const t=null===(e=this.teamsPhotos[this._selectedItemState.parent.item.id])||void 0===e?void 0:e.photo;s=ot(QS||(QS=Ht(['<img\n        class="team-photo"\n        alt="','"\n        role="img"\n        src='," />"])),this._selectedItemState.parent.item.displayName,t)}const a=null===(o=null===(n=null===(t=this._selectedItemState)||void 0===t?void 0:t.parent)||void 0===n?void 0:n.item)||void 0===o?void 0:o.displayName.trim(),l=null===(i=null===(r=this._selectedItemState)||void 0===r?void 0:r.item)||void 0===i?void 0:i.displayName.trim();return ot(YS||(YS=Ht(["\n      <fluent-breadcrumb title=",'>\n        <fluent-breadcrumb-item>\n          <span slot="start">','</span>\n          <span class="team-parent-name">','</span>\n          <span slot="separator" class="arrow">',"</span>\n        </fluent-breadcrumb-item>\n        <fluent-breadcrumb-item>","</fluent-breadcrumb-item>\n      </fluent-breadcrumb>"])),this._selectedItemState.item.displayName,s,a,ei(Xr.TeamSeparator,"#000000"),l)}clearState(){this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}renderSearchIcon(){return ot(ZS||(ZS=Ht(['\n      <div class="search-icon">\n        ',"\n      </div>\n    "])),ei(Xr.Search,"#252424"))}renderCloseButton(){return ot(JS||(JS=Ht(['\n      <fluent-button\n        appearance="stealth"\n        class="close-icon"\n        style="display:none"\n        aria-label=',"\n        @click=","\n        @keydown=",'>\n        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>\n        </svg>\n      </fluent-button>\n    '])),this.strings.closeButtonAriaLabel,this.onClickCloseButton,this.onKeydownCloseButton)}showCloseIcon(){const e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron"),n=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display=null)}renderDownChevron(){return ot(XS||(XS=Ht(['\n      <fluent-button appearance="stealth" class="down-chevron" @click=','>\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />\n        </svg>\n      </fluent-button>'])),this.gainedFocus)}renderUpChevron(){return ot(eT||(eT=Ht(['\n      <fluent-button appearance="stealth" style="display:none" class="up-chevron" @click=','>\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />\n        </svg>\n      </fluent-button>'])),this.handleUpChevronClick)}renderChevrons(){return ot(tT||(tT=Ht(["","",""])),this.renderUpChevron(),this.renderDownChevron())}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):ot(nT||(nT=Ht([""])))}renderDropdownList(e){if(e&&e.length>0){let t=null;return ot(oT||(oT=Ht(['\n        <fluent-tree-view\n          class="tree-view"\n          dir=','\n          aria-live="polite"\n          aria-relevant="all"\n          aria-atomic="true"\n          aria-label=','\n          aria-orientation="horizontal"\n          @keydown=',">\n          ","\n        </fluent-tree-view>"])),this.direction,this.strings.teamsChannels,this.onKeydownTreeView,ss(e,(e=>null===e||void 0===e?void 0:e.item),(e=>{var n;return e.channels&&(t=ot(rT||(rT=Ht(['<img\n                  class="team-photo"\n                  alt="'," ",'"\n                  src='," />"])),this.strings.photoFor,e.item.displayName,null===(n=this.teamsPhotos[e.item.id])||void 0===n?void 0:n.photo)),ot(iT||(iT=Ht(["\n                <fluent-tree-item\n                  ?expanded=","\n                  @click=",'>\n                    <span slot="start">',"</span>","\n                    ","\n                </fluent-tree-item>"])),null===e||void 0===e?void 0:e.isExpanded,this.handleTeamTreeItemClick,t,e.item.displayName,ss(null===e||void 0===e?void 0:e.channels,(e=>e.item),(e=>this.renderItem(e))))})))}return null}renderItem(e){var t;return ot(sT||(sT=Ht(["\n      <fluent-tree-item\n        id=","\n        @keydown=","\n        @click=",">\n          ","\n      </fluent-tree-item>"])),null===(t=null===e||void 0===e?void 0:e.item)||void 0===t?void 0:t.id,(t=>this.onUserKeyDown(t,e)),(()=>this.handleItemClick(e)),null===e||void 0===e?void 0:e.item.displayName)}renderError(){return this.renderTemplate("error",null,"error")||ot(aT||(aT=Ht(['\n        <div class="message-parent">\n          <div\n            label="search-error-text"\n            aria-live="polite"\n            aria-relevant="all"\n            aria-atomic="true"\n            class="search-error-text"\n          >\n            ',"\n          </div>\n        </div>\n      "])),this.strings.noResultsFound)}renderLoading(){return this.renderTemplate("loading",null,"loading")||Sn(lT||(lT=Ht(['\n        <div class="message-parent">\n          <mgt-spinner></mgt-spinner>\n          <div label="loading-text" aria-label="loading" class="loading-text">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.loadingMessage)}loadState(){var e,t;return hT(this,void 0,void 0,(function*(){const n=re.globalProvider;let o;if(n&&n.state===te.SignedIn){const r=n.graph.forComponent(this);o=yield((e,t)=>dS(void 0,void 0,void 0,(function*(){const n=yield e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(ie(...t)).get();return null===n||void 0===n?void 0:n.value})))(r,cT.requiredScopes),o=o.filter((e=>!e.isArchived));const i=me.fromGraph(r),s=o.map((e=>e.id));this.teamsPhotos=yield((e,t)=>dS(void 0,void 0,void 0,(function*(){let n,o={};if(Ro()){n=bn.getCache(no,no.stores.teams);for(const e of t)try{const t=yield n.getValue(e);t&&Ao()>Date.now()-t.timeCached&&(o[e]=t)}catch(Ye){}if(Object.keys(o).length)return o}const r=["team.readbasic.all"];o={};for(const i of t)try{const t=yield Po(e,"/teams/".concat(i),r);Ro()&&t&&(yield n.putValue(i,t)),o[i]=t}catch(Ye){}return o})))(i,s);const a=r.createBatch();for(const e of o)a.get(e.id,"teams/".concat(e.id,"/channels"),cT.requiredScopes);const l=yield a.executeAll();this._items=[];for(const n of o){const o=l.get(n.id);(null===(t=null===(e=o.content)||void 0===e?void 0:e.value)||void 0===t?void 0:t.length)&&this.items.push({item:n,channels:o.content.value.map((e=>({item:e})))})}}this.filterList(),this.resetFocusState()}))}removeSelectedChannel(e){this.selectChannel(e);const t=this.renderRoot.querySelectorAll("fluent-tree-item");t&&t.forEach((e=>{e.removeAttribute("expanded"),e.removeAttribute("selected")}))}handleItemClick(e){e.channels?e.isExpanded=!e.isExpanded:(this.selectChannel(e),this.lostFocus())}onUserKeyDown(e,t){switch(e.code){case"Enter":this.selectChannel(t),this.resetFocusState(),this.lostFocus(),e.preventDefault();break;case"Backspace":0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),e.preventDefault())}}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}generateTreeViewState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=[];if(t=t.toLowerCase(),e)for(const r of e){let e;if(0===t.length||r.item.displayName.toLowerCase().includes(t))e={item:r.item,parent:n},r.channels&&(e.channels=this.generateTreeViewState(r.channels,"",e),e.isExpanded=t.length>0);else if(r.channels){const o={item:r.item,parent:n},i=this.generateTreeViewState(r.channels,t,o);i.length>0&&(e=o,e.channels=i,e.isExpanded=!0)}e&&o.push(e)}return o}generateFocusList(e){if(!e||0===e.length)return[];let t=[];for(const n of e)t.push(n),n.channels&&n.isExpanded&&(t=[...t,...this.generateFocusList(n.channels)]);return t}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}selectChannel(e){e&&this._selectedItemState!==e?this._input.setAttribute("disabled","true"):this._input.removeAttribute("disabled"),this._selectedItemState=e,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}hideCloseIcon(){const e=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none")}toggleChevron(){const e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(e&&(e.style.display="none"),t&&(t.style.display=null)):(e&&(e.style.display=null,this.hideCloseIcon()),t&&(t.style.display="none")),this.hideCloseIcon()}};dT([At(),uT("design:type",Object)],pT.prototype,"_selectedItemState",void 0),dT([At(),uT("design:type",Boolean)],pT.prototype,"_isDropdownVisible",void 0),pT=cT=dT([Tn("teams-channel-picker"),uT("design:paramtypes",[])],pT);const fT={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};class gT{constructor(e){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,e)for(const t in e){const n=e[t];"date"===t?this.date=this.getDateObject(n):this[t]=n}}getDateObject(e){if("string"===typeof e){const t=e.split(/[/-]/);return t.length<3?new Date:new Date(parseInt(t[2],10),parseInt(t[0],10)-1,parseInt(t[1],10))}if("day"in e&&"month"in e&&"year"in e){const{day:t,month:n,year:o}=e;return new Date(o,n-1,t)}return e}getDate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.locale;const o=this.getDateObject(e);if(!o.getTime())return"";const r=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},t);return new Intl.DateTimeFormat(n,r).format(o)}getDay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.date.getDate(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dayFormat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.locale;return this.getDate({month:1,day:e,year:2020},{day:t},n)}getMonth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.date.getMonth()+1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.monthFormat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.locale;return this.getDate({month:e,day:2,year:2020},{month:t},n)}getYear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.date.getFullYear(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.yearFormat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.locale;return this.getDate({month:2,day:2,year:e},{year:t},n)}getWeekday(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.weekdayFormat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.locale;const o="1-".concat(e+1,"-2017");return this.getDate(o,{weekday:t},n)}getWeekdays(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.weekdayFormat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.locale;return Array(7).fill(null).map(((n,o)=>this.getWeekday(o,e,t)))}}class vT extends Wa{constructor(){super(...arguments),this.dateFormatter=new gT,this.readonly=!1,this.locale="en-US",this.month=(new Date).getMonth()+1,this.year=(new Date).getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.month,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.year;const n=e=>new Date(e.getFullYear(),e.getMonth(),1).getDay(),o=e=>{const t=new Date(e.getFullYear(),e.getMonth()+1,1);return new Date(t.getTime()-this.oneDayInMs).getDate()},r=new Date(t,e-1),i=new Date(t,e),s=new Date(t,e-2);return{length:o(r),month:e,start:n(r),year:t,previous:{length:o(s),month:s.getMonth()+1,start:n(s),year:s.getFullYear()},next:{length:o(i),month:i.getMonth()+1,start:n(i),year:i.getFullYear()}}}getDays(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getMonthInfo(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.minWeeks;t=t>10?10:t;const{start:n,length:o,previous:r,next:i}=e,s=[];let a=1-n;for(;a<o+1||s.length<t||s[s.length-1].length%7!==0;){const{month:t,year:n}=a<1?r:a>o?i:e,l=a<1?r.length+a:a>o?a-o:a,c="".concat(t,"-").concat(l,"-").concat(n),d={day:l,month:t,year:n,disabled:this.dateInString(c,this.disabledDates),selected:this.dateInString(c,this.selectedDates)},u=s[s.length-1];0===s.length||u.length%7===0?s.push([d]):u.push(d),a++}return s}dateInString(e,t){const n=t.split(",").map((e=>e.trim()));return e="string"===typeof e?e:"".concat(e.getMonth()+1,"-").concat(e.getDate(),"-").concat(e.getFullYear()),n.some((t=>t===e))}getDayClassNames(e,t){const{day:n,month:o,year:r,disabled:i,selected:s}=e;return["day",t==="".concat(o,"-").concat(n,"-").concat(r)&&"today",this.month!==o&&"inactive",i&&"disabled",s&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){const e=this.dateFormatter.getWeekdays().map((e=>({text:e})));if("long"!==this.weekdayFormat){const t=this.dateFormatter.getWeekdays("long");e.forEach(((e,n)=>{e.abbr=t[n]}))}return e}handleDateSelect(e,t){e.preventDefault,this.$emit("dateselected",t)}handleKeydown(e,t){return e.key===kg&&this.handleDateSelect(e,t),!0}}function mT(e,t,n){return{index:e,removed:t,addedCount:n}}ta([Ys({mode:"boolean"})],vT.prototype,"readonly",void 0),ta([Ys],vT.prototype,"locale",void 0),ta([Ys({converter:Ws})],vT.prototype,"month",void 0),ta([Ys({converter:Ws})],vT.prototype,"year",void 0),ta([Ys({attribute:"day-format",mode:"fromView"})],vT.prototype,"dayFormat",void 0),ta([Ys({attribute:"weekday-format",mode:"fromView"})],vT.prototype,"weekdayFormat",void 0),ta([Ys({attribute:"month-format",mode:"fromView"})],vT.prototype,"monthFormat",void 0),ta([Ys({attribute:"year-format",mode:"fromView"})],vT.prototype,"yearFormat",void 0),ta([Ys({attribute:"min-weeks",converter:Ws})],vT.prototype,"minWeeks",void 0),ta([Ys({attribute:"disabled-dates"})],vT.prototype,"disabledDates",void 0),ta([Ys({attribute:"selected-dates"})],vT.prototype,"selectedDates",void 0);const yT=0,bT=1,wT=2,kT=3;function xT(e,t,n,o,r,i){let s=0,a=0;const l=Math.min(n-t,i-r);if(0===t&&0===r&&(s=function(e,t,n){for(let o=0;o<n;++o)if(e[o]!==t[o])return o;return n}(e,o,l)),n===e.length&&i===o.length&&(a=function(e,t,n){let o=e.length,r=t.length,i=0;for(;i<n&&e[--o]===t[--r];)i++;return i}(e,o,l-s)),r+=s,i-=a,(n-=a)-(t+=s)===0&&i-r===0)return xs;if(t===n){const e=mT(t,[],0);for(;r<i;)e.removed.push(o[r++]);return[e]}if(r===i)return[mT(t,[],n-t)];const c=function(e){let t=e.length-1,n=e[0].length-1,o=e[t][n];const r=[];for(;t>0||n>0;){if(0===t){r.push(wT),n--;continue}if(0===n){r.push(kT),t--;continue}const i=e[t-1][n-1],s=e[t-1][n],a=e[t][n-1];let l;l=s<a?s<i?s:i:a<i?a:i,l===i?(i===o?r.push(yT):(r.push(bT),o=i),t--,n--):l===s?(r.push(kT),t--,o=s):(r.push(wT),n--,o=a)}return r.reverse(),r}(function(e,t,n,o,r,i){const s=i-r+1,a=n-t+1,l=new Array(s);let c,d;for(let u=0;u<s;++u)l[u]=new Array(a),l[u][0]=u;for(let u=0;u<a;++u)l[0][u]=u;for(let u=1;u<s;++u)for(let n=1;n<a;++n)e[t+n-1]===o[r+u-1]?l[u][n]=l[u-1][n-1]:(c=l[u-1][n]+1,d=l[u][n-1]+1,l[u][n]=c<d?c:d);return l}(e,t,n,o,r,i)),d=[];let u,h=t,p=r;for(let f=0;f<c.length;++f)switch(c[f]){case yT:void 0!==u&&(d.push(u),u=void 0),h++,p++;break;case bT:void 0===u&&(u=mT(h,[],0)),u.addedCount++,h++,u.removed.push(o[p]),p++;break;case wT:void 0===u&&(u=mT(h,[],0)),u.addedCount++,h++;break;case kT:void 0===u&&(u=mT(h,[],0)),u.removed.push(o[p]),p++}return void 0!==u&&d.push(u),d}const CT=Array.prototype.push;function _T(e,t,n,o){const r=mT(t,n,o);let i=!1,s=0;for(let u=0;u<e.length;u++){const t=e[u];if(t.index+=s,i)continue;const n=(a=r.index,l=r.index+r.removed.length,c=t.index,d=t.index+t.addedCount,l<c||d<a?-1:l===c||d===a?0:a<c?l<d?l-c:d-c:d<l?d-a:l-a);if(n>=0){e.splice(u,1),u--,s-=t.addedCount-t.removed.length,r.addedCount+=t.addedCount-n;const o=r.removed.length+t.removed.length-n;if(r.addedCount||o){let e=t.removed;if(r.index<t.index){const n=r.removed.slice(0,t.index-r.index);CT.apply(n,e),e=n}if(r.index+r.removed.length>t.index+t.addedCount){const n=r.removed.slice(t.index+t.addedCount-r.index);CT.apply(e,n)}r.removed=e,t.index<r.index&&(r.index=t.index)}else i=!0}else if(r.index<t.index){i=!0,e.splice(u,0,r),u++;const n=r.addedCount-r.removed.length;t.index+=n,s+=n}}var a,l,c,d;i||e.push(r)}function ST(e,t){let n=[];const o=function(e){const t=[];for(let n=0,o=e.length;n<o;n++){const o=e[n];_T(t,o.index,o.removed,o.addedCount)}return t}(t);for(let r=0,i=o.length;r<i;++r){const t=o[r];1!==t.addedCount||1!==t.removed.length?n=n.concat(xT(e,t.index,t.index+t.addedCount,t.removed,0,t.removed.length)):t.removed[0]!==e[t.index]&&n.push(t)}return n}let TT=!1;function IT(e,t){let n=e.index;const o=t.length;return n>o?n=o-e.addedCount:n<0&&(n=o+e.removed.length+n-e.addedCount),n<0&&(n=0),e.index=n,e}class ET extends Ps{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(e,"$fastController",{value:this,enumerable:!1})}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){void 0===this.splices?this.splices=[e]:this.splices.push(e),this.needsQueue&&(this.needsQueue=!1,Rs.queueUpdate(this))}reset(e){this.oldCollection=e,this.needsQueue&&(this.needsQueue=!1,Rs.queueUpdate(this))}flush(){const e=this.splices,t=this.oldCollection;if(void 0===e&&void 0===t)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;const n=void 0===t?ST(this.source,e):xT(this.source,0,this.source.length,t,0,t.length);this.notify(n)}}const AT=Object.freeze({positioning:!1,recycle:!0});function RT(e,t,n,o){e.bind(t[n],o)}function PT(e,t,n,o){const r=Object.create(o);r.index=n,r.length=t.length,e.bind(t[n],r)}class OT{constructor(e,t,n,o,r,i){this.location=e,this.itemsBinding=t,this.templateBinding=o,this.options=i,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=RT,this.itemsBindingObserver=Ds.binding(t,this,n),this.templateBindingObserver=Ds.binding(o,this,r),i.positioning&&(this.bindView=PT)}bind(e,t){this.source=e,this.originalContext=t,this.childContext=Object.create(t),this.childContext.parent=e,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(e,this.originalContext),this.template=this.templateBindingObserver.observe(e,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,null!==this.itemsObserver&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(t)}observeItems(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.items)return void(this.items=xs);const t=this.itemsObserver,n=this.itemsObserver=Ds.getNotifier(this.items),o=t!==n;o&&null!==t&&t.unsubscribe(this),(o||e)&&n.subscribe(this)}updateViews(e){const t=this.childContext,n=this.views,o=this.bindView,r=this.items,i=this.template,s=this.options.recycle,a=[];let l=0,c=0;for(let d=0,u=e.length;d<u;++d){const u=e[d],h=u.removed;let p=0,f=u.index;const g=f+u.addedCount,v=n.splice(u.index,h.length),m=c=a.length+v.length;for(;f<g;++f){const e=n[f],d=e?e.firstChild:this.location;let u;s&&c>0?(p<=m&&v.length>0?(u=v[p],p++):(u=a[l],l++),c--):u=i.create(),n.splice(f,0,u),o(u,r,f,t),u.insertBefore(d)}v[p]&&a.push(...v.slice(p))}for(let d=l,u=a.length;d<u;++d)a[d].dispose();if(this.options.positioning)for(let d=0,u=n.length;d<u;++d){const e=n[d].context;e.length=u,e.index=d}}refreshAllViews(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.items,n=this.childContext,o=this.template,r=this.location,i=this.bindView;let s=t.length,a=this.views,l=a.length;if(0!==s&&!e&&this.options.recycle||(Zl.disposeContiguousBatch(a),l=0),0===l){this.views=a=new Array(s);for(let e=0;e<s;++e){const s=o.create();i(s,t,e,n),a[e]=s,s.insertBefore(r)}}else{let e=0;for(;e<s;++e)if(e<l){i(a[e],t,e,n)}else{const s=o.create();i(s,t,e,n),a.push(s),s.insertBefore(r)}const c=a.splice(e,l-e);for(e=0,s=c.length;e<s;++e)c[e].dispose()}}unbindAllViews(){const e=this.views;for(let t=0,n=e.length;t<n;++t)e[t].unbind()}}class DT extends El{constructor(e,t,n){super(),this.itemsBinding=e,this.templateBinding=t,this.options=n,this.createPlaceholder=Rs.createBlockPlaceholder,function(){if(TT)return;TT=!0,Ds.setArrayObserverFactory((e=>new ET(e)));const e=Array.prototype;if(e.$fastPatch)return;Reflect.defineProperty(e,"$fastPatch",{value:1,enumerable:!1});const t=e.pop,n=e.push,o=e.reverse,r=e.shift,i=e.sort,s=e.splice,a=e.unshift;e.pop=function(){const e=this.length>0,n=t.apply(this,arguments),o=this.$fastController;return void 0!==o&&e&&o.addSplice(mT(this.length,[n],0)),n},e.push=function(){const e=n.apply(this,arguments),t=this.$fastController;return void 0!==t&&t.addSplice(IT(mT(this.length-arguments.length,[],arguments.length),this)),e},e.reverse=function(){let e;const t=this.$fastController;void 0!==t&&(t.flush(),e=this.slice());const n=o.apply(this,arguments);return void 0!==t&&t.reset(e),n},e.shift=function(){const e=this.length>0,t=r.apply(this,arguments),n=this.$fastController;return void 0!==n&&e&&n.addSplice(mT(0,[t],0)),t},e.sort=function(){let e;const t=this.$fastController;void 0!==t&&(t.flush(),e=this.slice());const n=i.apply(this,arguments);return void 0!==t&&t.reset(e),n},e.splice=function(){const e=s.apply(this,arguments),t=this.$fastController;return void 0!==t&&t.addSplice(IT(mT(+arguments[0],e,arguments.length>2?arguments.length-2:0),this)),e},e.unshift=function(){const e=a.apply(this,arguments),t=this.$fastController;return void 0!==t&&t.addSplice(IT(mT(0,[],arguments.length),this)),e}}(),this.isItemsBindingVolatile=Ds.isVolatileBinding(e),this.isTemplateBindingVolatile=Ds.isVolatileBinding(t)}createBehavior(e){return new OT(e,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}function MT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:AT;return new DT(e,"function"===typeof t?t:()=>t,Object.assign(Object.assign({},AT),n))}const NT="none",LT="default",FT="sticky",UT="default",zT="columnheader",HT="rowheader",qT="default",BT="header",VT="sticky-header";var jT,KT;const GT=ec(jT||(jT=Ht(["\n    <template>\n        ","\n    </template>\n"])),(e=>null===e.rowData||null===e.columnDefinition||null===e.columnDefinition.columnDataKey?null:e.rowData[e.columnDefinition.columnDataKey])),$T=ec(KT||(KT=Ht(["\n    <template>\n        ","\n    </template>\n"])),(e=>null===e.columnDefinition?null:void 0===e.columnDefinition.title?e.columnDefinition.columnDataKey:e.columnDefinition.title));class WT extends Wa{constructor(){super(...arguments),this.cellType=UT,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(e,t){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var e;super.connectedCallback(),this.addEventListener(gC,this.handleFocusin),this.addEventListener(vC,this.handleFocusout),this.addEventListener(mC,this.handleKeydown),this.style.gridColumn="".concat(void 0===(null===(e=this.columnDefinition)||void 0===e?void 0:e.gridColumn)?0:this.columnDefinition.gridColumn),this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(gC,this.handleFocusin),this.removeEventListener(vC,this.handleFocusout),this.removeEventListener(mC,this.handleKeydown),this.disconnectCellView()}handleFocusin(e){if(!this.isActiveCell){if(this.isActiveCell=!0,this.cellType===zT){if(null!==this.columnDefinition&&!0!==this.columnDefinition.headerCellInternalFocusQueue&&"function"===typeof this.columnDefinition.headerCellFocusTargetCallback){const e=this.columnDefinition.headerCellFocusTargetCallback(this);null!==e&&e.focus()}}else if(null!==this.columnDefinition&&!0!==this.columnDefinition.cellInternalFocusQueue&&"function"===typeof this.columnDefinition.cellFocusTargetCallback){const e=this.columnDefinition.cellFocusTargetCallback(this);null!==e&&e.focus()}this.$emit("cell-focused",this)}}handleFocusout(e){this===document.activeElement||this.contains(document.activeElement)||(this.isActiveCell=!1)}handleKeydown(e){if(!(e.defaultPrevented||null===this.columnDefinition||this.cellType===UT&&!0!==this.columnDefinition.cellInternalFocusQueue||this.cellType===zT&&!0!==this.columnDefinition.headerCellInternalFocusQueue))switch(e.key){case kg:case"F2":if(this.contains(document.activeElement)&&document.activeElement!==this)return;if(this.cellType===zT){if(void 0!==this.columnDefinition.headerCellFocusTargetCallback){const t=this.columnDefinition.headerCellFocusTargetCallback(this);null!==t&&t.focus(),e.preventDefault()}}else if(void 0!==this.columnDefinition.cellFocusTargetCallback){const t=this.columnDefinition.cellFocusTargetCallback(this);null!==t&&t.focus(),e.preventDefault()}break;case xg:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),e.preventDefault())}}updateCellView(){if(this.disconnectCellView(),null!==this.columnDefinition)switch(this.cellType){case zT:void 0!==this.columnDefinition.headerCellTemplate?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=$T.render(this,this);break;case void 0:case HT:case UT:void 0!==this.columnDefinition.cellTemplate?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=GT.render(this,this)}}disconnectCellView(){null!==this.customCellView&&(this.customCellView.dispose(),this.customCellView=null)}}ta([Ys({attribute:"cell-type"})],WT.prototype,"cellType",void 0),ta([Ys({attribute:"grid-column"})],WT.prototype,"gridColumn",void 0),ta([Ms],WT.prototype,"rowData",void 0),ta([Ms],WT.prototype,"columnDefinition",void 0);class QT extends Wa{constructor(){super(...arguments),this.rowType=qT,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){null!==this.rowData&&this.isActiveRow&&(this.refocusOnLoad=!0)}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),null===this.cellsRepeatBehavior&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new DT((e=>e.columnDefinitions),(e=>e.activeCellItemTemplate),{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(vC,this.handleFocusout),this.addEventListener(mC,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(vC,this.handleFocusout),this.removeEventListener(mC,this.handleKeydown)}handleFocusout(e){this.contains(e.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(e){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(e.target),this.$emit("row-focused",this)}handleKeydown(e){if(e.defaultPrevented)return;let t=0;switch(e.key){case yg:t=Math.max(0,this.focusColumnIndex-1),this.cellElements[t].focus(),e.preventDefault();break;case bg:t=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[t].focus(),e.preventDefault();break;case Cg:e.ctrlKey||(this.cellElements[0].focus(),e.preventDefault());break;case _g:e.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),e.preventDefault())}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===qT&&void 0!==this.cellItemTemplate?this.cellItemTemplate:this.rowType===qT&&void 0===this.cellItemTemplate?this.defaultCellItemTemplate:void 0!==this.headerCellItemTemplate?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}}ta([Ys({attribute:"grid-template-columns"})],QT.prototype,"gridTemplateColumns",void 0),ta([Ys({attribute:"row-type"})],QT.prototype,"rowType",void 0),ta([Ms],QT.prototype,"rowData",void 0),ta([Ms],QT.prototype,"columnDefinitions",void 0),ta([Ms],QT.prototype,"cellItemTemplate",void 0),ta([Ms],QT.prototype,"headerCellItemTemplate",void 0),ta([Ms],QT.prototype,"rowIndex",void 0),ta([Ms],QT.prototype,"isActiveRow",void 0),ta([Ms],QT.prototype,"activeCellItemTemplate",void 0),ta([Ms],QT.prototype,"defaultCellItemTemplate",void 0),ta([Ms],QT.prototype,"defaultHeaderCellItemTemplate",void 0),ta([Ms],QT.prototype,"cellElements",void 0);class YT extends Wa{constructor(){super(),this.noTabbing=!1,this.generateHeader=LT,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(e,t,n)=>{if(0===this.rowElements.length)return this.focusRowIndex=0,void(this.focusColumnIndex=0);const o=Math.max(0,Math.min(this.rowElements.length-1,e)),r=this.rowElements[o].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),i=r[Math.max(0,Math.min(r.length-1,t))];n&&this.scrollHeight!==this.clientHeight&&(o<this.focusRowIndex&&this.scrollTop>0||o>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&i.scrollIntoView({block:"center",inline:"center"}),i.focus()},this.onChildListChange=(e,t)=>{e&&e.length&&(e.forEach((e=>{e.addedNodes.forEach((e=>{1===e.nodeType&&"row"===e.getAttribute("role")&&(e.columnDefinitions=this.columnDefinitions)}))})),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,Rs.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let e=this.gridTemplateColumns;if(void 0===e){if(""===this.generatedGridTemplateColumns&&this.rowElements.length>0){const e=this.rowElements[0];this.generatedGridTemplateColumns=new Array(e.cellElements.length).fill("1fr").join(" ")}e=this.generatedGridTemplateColumns}this.rowElements.forEach(((t,n)=>{const o=t;o.rowIndex=n,o.gridTemplateColumns=e,this.columnDefinitionsStale&&(o.columnDefinitions=this.columnDefinitions)})),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(e){let t="";return e.forEach((e=>{t="".concat(t).concat(""===t?"":" ","1fr")})),t}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){null===this.columnDefinitions&&this.rowsData.length>0&&(this.columnDefinitions=YT.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){null!==this.columnDefinitions?(this.generatedGridTemplateColumns=YT.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())):this.generatedGridTemplateColumns=""}headerCellItemTemplateChanged(){this.$fastController.isConnected&&null!==this.generatedHeader&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),void 0===this.rowItemTemplate&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new DT((e=>e.rowsData),(e=>e.rowItemTemplate),{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(fC,this.handleFocus),this.addEventListener(mC,this.handleKeydown),this.addEventListener(vC,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),Rs.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(fC,this.handleFocus),this.removeEventListener(mC,this.handleKeydown),this.removeEventListener(vC,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(e){this.isUpdatingFocus=!0;const t=e.target;this.focusRowIndex=this.rowElements.indexOf(t),this.focusColumnIndex=t.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(e){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(e){null!==e.relatedTarget&&this.contains(e.relatedTarget)||this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(e){if(e.defaultPrevented)return;let t;const n=this.rowElements.length-1,o=this.offsetHeight+this.scrollTop,r=this.rowElements[n];switch(e.key){case wg:e.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case mg:e.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case"PageUp":if(e.preventDefault(),0===this.rowElements.length){this.focusOnCell(0,0,!1);break}if(0===this.focusRowIndex)return void this.focusOnCell(0,this.focusColumnIndex,!1);for(t=this.focusRowIndex-1;t>=0;t--){const e=this.rowElements[t];if(e.offsetTop<this.scrollTop){this.scrollTop=e.offsetTop+e.clientHeight-this.clientHeight;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case"PageDown":if(e.preventDefault(),0===this.rowElements.length){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=n||r.offsetTop+r.offsetHeight<=o)return void this.focusOnCell(n,this.focusColumnIndex,!1);for(t=this.focusRowIndex+1;t<=n;t++){const e=this.rowElements[t];if(e.offsetTop+e.offsetHeight>o){let t=0;this.generateHeader===FT&&null!==this.generatedHeader&&(t=this.generatedHeader.clientHeight),this.scrollTop=e.offsetTop-t;break}}this.focusOnCell(t,this.focusColumnIndex,!1);break;case Cg:e.ctrlKey&&(e.preventDefault(),this.focusOnCell(0,0,!0));break;case _g:e.ctrlKey&&null!==this.columnDefinitions&&(e.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0))}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||!1===this.pendingFocusUpdate&&(this.pendingFocusUpdate=!0,Rs.queueUpdate((()=>this.updateFocus())))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(null!==this.generatedHeader&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==NT&&this.rowsData.length>0){const e=document.createElement(this.rowElementTag);return this.generatedHeader=e,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===FT?VT:BT,void(null===this.firstChild&&null===this.rowsPlaceholder||this.insertBefore(e,null!==this.firstChild?this.firstChild:this.rowsPlaceholder))}}}var ZT,JT,XT,eI,tI,nI,oI,rI,iI,sI;YT.generateColumns=e=>Object.getOwnPropertyNames(e).map(((e,t)=>({columnDataKey:e,gridColumn:"".concat(t)}))),ta([Ys({attribute:"no-tabbing",mode:"boolean"})],YT.prototype,"noTabbing",void 0),ta([Ys({attribute:"generate-header"})],YT.prototype,"generateHeader",void 0),ta([Ys({attribute:"grid-template-columns"})],YT.prototype,"gridTemplateColumns",void 0),ta([Ms],YT.prototype,"rowsData",void 0),ta([Ms],YT.prototype,"columnDefinitions",void 0),ta([Ms],YT.prototype,"rowItemTemplate",void 0),ta([Ms],YT.prototype,"cellItemTemplate",void 0),ta([Ms],YT.prototype,"headerCellItemTemplate",void 0),ta([Ms],YT.prototype,"focusRowIndex",void 0),ta([Ms],YT.prototype,"focusColumnIndex",void 0),ta([Ms],YT.prototype,"defaultRowItemTemplate",void 0),ta([Ms],YT.prototype,"rowElementTag",void 0),ta([Ms],YT.prototype,"rowElements",void 0);const aI=ec(ZT||(ZT=Ht(['\n    <div\n        class="title"\n        part="title"\n        aria-label="','"\n    >\n        <span part="month">\n            ','\n        </span>\n        <span part="year">',"</span>\n    </div>\n"])),(e=>e.dateFormatter.getDate("".concat(e.month,"-2-").concat(e.year),{month:"long",year:"numeric"})),(e=>e.dateFormatter.getMonth(e.month)),(e=>e.dateFormatter.getYear(e.year))),lI=(e,t)=>{const n=e.tagFor(QT);return ec(eI||(eI=Ht(["\n        <",'\n            class="week"\n            part="week"\n            role="row"\n            role-type="default"\n            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"\n        >\n        ',"\n        </",">\n    "])),n,MT((e=>e),((e,t)=>{const n=e.tagFor(WT);return ec(XT||(XT=Ht(["\n        <",'\n            class="','"\n            part="day"\n            tabindex="-1"\n            role="gridcell"\n            grid-column="','"\n            @click="','"\n            @keydown="','"\n            aria-label="','"\n        >\n            <div\n                class="date"\n                part="','"\n            >\n                ','\n            </div>\n            <slot name="',"-","-",'"></slot>\n        </',">\n    "])),n,((e,n)=>n.parentContext.parent.getDayClassNames(e,t)),((e,t)=>t.index+1),((e,t)=>t.parentContext.parent.handleDateSelect(t.event,e)),((e,t)=>t.parentContext.parent.handleKeydown(t.event,e)),((e,t)=>t.parentContext.parent.dateFormatter.getDate("".concat(e.month,"-").concat(e.day,"-").concat(e.year),{month:"long",day:"numeric"})),(e=>t==="".concat(e.month,"-").concat(e.day,"-").concat(e.year)?"today":"date"),((e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)),(e=>e.month),(e=>e.day),(e=>e.year),n)})(e,t),{positioning:!0}),n)},cI=(e,t)=>{const n=e.tagFor(YT),o=e.tagFor(QT);return ec(tI||(tI=Ht(["\n    <",' class="days interact" part="days" generate-header="none">\n        <','\n            class="week-days"\n            part="week-days"\n            role="row"\n            row-type="header"\n            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"\n        >\n            ',"\n        </",">\n        ","\n    </",">\n"])),n,o,MT((e=>e.getWeekdayText()),(e=>{const t=e.tagFor(WT);return ec(JT||(JT=Ht(["\n        <",'\n            class="week-day"\n            part="week-day"\n            tabindex="-1"\n            grid-column="','"\n            abbr="','"\n        >\n            ',"\n        </",">\n    "])),t,((e,t)=>t.index+1),(e=>e.abbr),(e=>e.text),t)})(e),{positioning:!0}),o,MT((e=>e.getDays()),lI(e,t)),n)};var dI,uI,hI,pI;const fI=xp(dI||(dI=Ht(["\n.day.disabled::before {\n  transform: translate(-50%, 0) rotate(45deg);\n}\n"]))),gI=xp(uI||(uI=Ht(["\n.day.disabled::before {\n  transform: translate(50%, 0) rotate(-45deg);\n}\n"])));class vI extends vT{constructor(){super(...arguments),this.readonly=!0}}i([Ys({converter:$s})],vI.prototype,"readonly",void 0);const mI=vI.compose({baseName:"calendar",template:(e,t)=>{var n;const o=new Date,r="".concat(o.getMonth()+1,"-").concat(o.getDate(),"-").concat(o.getFullYear());return ec(sI||(sI=Ht(["\n        <template>\n            ","\n            ","\n            <slot></slot>\n            ","\n            ","\n        </template>\n    "])),fg,t.title instanceof Function?t.title(e,t):null!==(n=t.title)&&void 0!==n?n:"",Yf((e=>e.readonly),(e=>ec(nI||(nI=Ht(['\n        <div class="days" part="days">\n            <div class="week-days" part="week-days">\n                ',"\n            </div>\n            ","\n        </div>\n    "])),MT((e=>e.getWeekdayText()),ec(oI||(oI=Ht(['\n                        <div class="week-day" part="week-day" abbr="','">\n                            ',"\n                        </div>\n                    "])),(e=>e.abbr),(e=>e.text))),MT((e=>e.getDays()),ec(rI||(rI=Ht(['\n                    <div class="week">\n                        ',"\n                    </div>\n                "])),MT((e=>e),ec(iI||(iI=Ht(['\n                                <div\n                                    class="','"\n                                    part="day"\n                                    aria-label="','"\n                                >\n                                    <div\n                                        class="date"\n                                        part="','"\n                                    >\n                                        ','\n                                    </div>\n                                    <slot\n                                        name="',"-","-",'"\n                                    ></slot>\n                                </div>\n                            '])),((t,n)=>n.parentContext.parent.getDayClassNames(t,e)),((e,t)=>t.parentContext.parent.dateFormatter.getDate("".concat(e.month,"-").concat(e.day,"-").concat(e.year),{month:"long",day:"numeric"})),(t=>e==="".concat(t.month,"-").concat(t.day,"-").concat(t.year)?"today":"date"),((e,t)=>t.parentContext.parent.dateFormatter.getDay(e.day)),(e=>e.month),(e=>e.day),(e=>e.year)))))))(r),cI(e,r)),pg)},styles:(e,t)=>xp(hI||(hI=Ht(["\n"," :host {\n  --calendar-cell-size: calc(("," + 2 + ",") * "," * 1px);\n  --calendar-gap: 2px;\n  ","\n  color: ",";\n}\n\n.title {\n  padding: calc("," * 2px);\n  font-weight: 600;\n}\n\n.days {\n  text-align: center;\n}\n\n.week-days,\n.week {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  grid-gap: var(--calendar-gap);\n  border: 0;\n  padding: 0;\n}\n\n.day,\n.week-day {\n  border: 0;\n  width: var(--calendar-cell-size);\n  height: var(--calendar-cell-size);\n  line-height: var(--calendar-cell-size);\n  padding: 0;\n  box-sizing: initial;\n}\n\n.week-day {\n  font-weight: 600;\n}\n\n.day {\n  border: calc("," * 1px) solid transparent;\n  border-radius: calc("," * 1px);\n}\n\n.interact .day {\n  cursor: pointer;\n}\n\n.date {\n  height: 100%;\n}\n\n.inactive .date,\n.inactive.disabled::before {\n  color: ",";\n}\n\n.disabled::before {\n  content: '';\n  display: inline-block;\n  width: calc(var(--calendar-cell-size) * .8);\n  height: calc("," * 1px);\n  background: currentColor;\n  position: absolute;\n  margin-top: calc(var(--calendar-cell-size) / 2);\n  transform-origin: center;\n  z-index: 1;\n}\n\n.selected {\n  color: ",";\n  border: 1px solid ",";\n  background: ",";\n}\n\n.selected + .selected {\n  border-start-start-radius: 0;\n  border-end-start-radius: 0;\n  border-inline-start-width: 0;\n  padding-inline-start: calc(var(--calendar-gap) + ("," + ",") * 1px);\n  margin-inline-start: calc(("," * -1px) - var(--calendar-gap));\n}\n\n.today.disabled::before {\n  color: ",";\n}\n\n.today .date {\n  color: ",";\n  background: ",";\n  border-radius: 50%;\n  position: relative;\n}\n"])),Sp("inline-block"),Xc,ed,td,rv,qh,td,rd,nd,Kh,rd,Qu,Qu,Gu,rd,nd,nd,eh,eh,Qu).withBehaviors(Ep(xp(pI||(pI=Ht(["\n          .day.selected {\n              color: ",";\n          }\n\n          .today .date {\n              background: ",";\n              color: ",";\n          }\n      "])),Ap.Highlight,Ap.Highlight,Ap.HighlightText)),new Oy(fI,gI)),title:aI});var yI,bI,wI,kI=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},xI=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Tl(uw,Ev,mI);class CI extends Qt{get strings(){return fT}constructor(){super(),this.handleTaskClick=e=>{this.fireCustomEvent("taskClick",{task:e})},this.onResize=()=>{this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.clearState(),this._previousMediaQuery=this.mediaQuery}attributeChangedCallback(e,t,n){switch(super.attributeChangedCallback(e,t,n),e){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const e=re.globalProvider;if(!e||e.state!==te.SignedIn)return ot(yI||(yI=Ht([""])));if(this.isLoadingState)return this.renderLoadingTask();const t=this.renderPicker(),n=this.renderNewTask(),o=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return ot(bI||(bI=Ht(["\n      ","\n      ",'\n      <div class="tasks" dir=',">\n        ","\n      </div>\n    "])),t,n,this.direction,o)}renderLoadingTask(){return ot(wI||(wI=Ht(['\n      <div class="task loading-task">\n        <div class="task-details">\n          <div class="title"></div>\n          <div class="task-due"></div>\n          <div class="task-delete"></div>\n        </div>\n      </div>\n    '])))}clearState(){this.requestUpdate()}dateToInputValue(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}}kI([Et({attribute:"read-only",type:Boolean}),xI("design:type",Boolean)],CI.prototype,"readOnly",void 0),kI([Et({attribute:"hide-header",type:Boolean}),xI("design:type",Boolean)],CI.prototype,"hideHeader",void 0),kI([Et({attribute:"hide-options",type:Boolean}),xI("design:type",Boolean)],CI.prototype,"hideOptions",void 0),kI([Et({attribute:"target-id",type:String}),xI("design:type",String)],CI.prototype,"targetId",void 0),kI([Et({attribute:"initial-id",type:String}),xI("design:type",String)],CI.prototype,"initialId",void 0);var _I=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};const SI=(e,t)=>_I(void 0,void 0,void 0,(function*(){const n=yield e.api("/me/todo/lists/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get();return null===n||void 0===n?void 0:n.value})),TI=(e,t)=>_I(void 0,void 0,void 0,(function*(){return yield e.api("/me/todo/lists/".concat(t)).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get()}));var II;const EI=[Ce(II||(II=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{text-decoration:line-through;border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .title,:host.loading-task .task-details .title{flex-grow:1}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host .task .task-details .task-due .task-calendar,:host.loading-task .task-details .task-due .task-calendar{display:flex;margin-top:5px;margin-inline-end:10px}:host .task .task-details .task-due .task-calendar svg,:host.loading-task .task-details .task-due .task-calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host .task .task-details .task-due .task-due-date,:host.loading-task .task-details .task-due .task-due-date{display:flex;margin-top:5px}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar .date::after{border-bottom:none}:host fluent-text-field.new-task div:nth-child(2) .calendar .date.dark::part(control){color-scheme:dark}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.task.complete div>svg .filled{display:block}:host fluent-checkbox.task.complete div>svg .regular{display:none}:host fluent-checkbox.task.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox.task div>svg .filled{display:none}:host fluent-checkbox.task div>svg .regular{display:block}:host fluent-checkbox.task div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{text-decoration:line-through;border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .title,:host.loading-task .task-details .title{flex-grow:1}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host .task .task-details .task-due .task-calendar,:host.loading-task .task-details .task-due .task-calendar{display:flex;margin-top:5px;margin-inline-end:10px}:host .task .task-details .task-due .task-calendar svg,:host.loading-task .task-details .task-due .task-calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host .task .task-details .task-due .task-due-date,:host.loading-task .task-details .task-due .task-due-date{display:flex;margin-top:5px}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar .date::after{border-bottom:none}:host fluent-text-field.new-task div:nth-child(2) .calendar .date.dark::part(control){color-scheme:dark}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.task.complete div>svg .filled{display:block}:host fluent-checkbox.task.complete div>svg .regular{display:none}:host fluent-checkbox.task.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox.task div>svg .filled{display:none}:host fluent-checkbox.task div>svg .regular{display:block}:host fluent-checkbox.task div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}\n'])))],AI={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",newTaskLabel:"New Task Input",addTaskButtonSubtitle:"Add",deleteTaskLabel:"Delete Task",dueDate:"Due date",newTaskDateInputLabel:"New Task Date Input",newTaskNameInputLabel:"New Task Name Input",cancelAddingTask:"Cancel adding a new task"};class RI extends Wa{constructor(){super(...arguments),this.orientation=lC,this.radioChangeHandler=e=>{const t=e.target;t.checked&&(this.slottedRadioButtons.forEach((e=>{e!==t&&(e.checked=!1,this.isInsideFoundationToolbar||e.setAttribute("tabindex","-1"))})),this.selectedRadio=t,this.value=t.value,t.setAttribute("tabindex","0"),this.focusedRadio=t),e.stopPropagation()},this.moveToRadioByIndex=(e,t)=>{const n=e[t];this.isInsideToolbar||(n.setAttribute("tabindex","0"),n.readOnly?this.slottedRadioButtons.forEach((e=>{e!==n&&e.setAttribute("tabindex","-1")})):(n.checked=!0,this.selectedRadio=n)),this.focusedRadio=n,n.focus()},this.moveRightOffGroup=()=>{var e;null===(e=this.nextElementSibling)||void 0===e||e.focus()},this.moveLeftOffGroup=()=>{var e;null===(e=this.previousElementSibling)||void 0===e||e.focus()},this.focusOutHandler=e=>{const t=this.slottedRadioButtons,n=e.target,o=null!==n?t.indexOf(n):0,r=this.focusedRadio?t.indexOf(this.focusedRadio):-1;return(0===r&&o===r||r===t.length-1&&r===o)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),t.forEach((e=>{e!==this.selectedRadio&&e.setAttribute("tabindex","-1")})))):(this.focusedRadio=t[0],this.focusedRadio.setAttribute("tabindex","0"),t.forEach((e=>{e!==this.focusedRadio&&e.setAttribute("tabindex","-1")})))),!0},this.clickHandler=e=>{const t=e.target;if(t){const e=this.slottedRadioButtons;t.checked||0===e.indexOf(t)?(t.setAttribute("tabindex","0"),this.selectedRadio=t):(t.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=t}e.preventDefault()},this.shouldMoveOffGroupToTheRight=(e,t,n)=>e===t.length&&this.isInsideToolbar&&n===bg,this.shouldMoveOffGroupToTheLeft=(e,t)=>(this.focusedRadio?e.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&t===yg,this.checkFocusedRadio=()=>{null===this.focusedRadio||this.focusedRadio.readOnly||this.focusedRadio.checked||(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=e=>{const t=this.slottedRadioButtons;let n=0;if(n=this.focusedRadio?t.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(n,t,e.key))this.moveRightOffGroup();else for(n===t.length&&(n=0);n<t.length&&t.length>1;){if(!t[n].disabled){this.moveToRadioByIndex(t,n);break}if(this.focusedRadio&&n===t.indexOf(this.focusedRadio))break;if(n+1>=t.length){if(this.isInsideToolbar)break;n=0}else n+=1}},this.moveLeft=e=>{const t=this.slottedRadioButtons;let n=0;if(n=this.focusedRadio?t.indexOf(this.focusedRadio)-1:0,n=n<0?t.length-1:n,this.shouldMoveOffGroupToTheLeft(t,e.key))this.moveLeftOffGroup();else for(;n>=0&&t.length>1;){if(!t[n].disabled){this.moveToRadioByIndex(t,n);break}if(this.focusedRadio&&n===t.indexOf(this.focusedRadio))break;n-1<0?n=t.length-1:n-=1}},this.keydownHandler=e=>{const t=e.key;if(t in Ig&&this.isInsideFoundationToolbar)return!0;switch(t){case kg:this.checkFocusedRadio();break;case bg:case mg:this.direction===dc.ltr?this.moveRight(e):this.moveLeft(e);break;case yg:case wg:this.direction===dc.ltr?this.moveLeft(e):this.moveRight(e);break;default:return!0}}}readOnlyChanged(){void 0!==this.slottedRadioButtons&&this.slottedRadioButtons.forEach((e=>{this.readOnly?e.readOnly=!0:e.readOnly=!1}))}disabledChanged(){void 0!==this.slottedRadioButtons&&this.slottedRadioButtons.forEach((e=>{this.disabled?e.disabled=!0:e.disabled=!1}))}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach((e=>{e.setAttribute("name",this.name)}))}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach((e=>{e.value===this.value&&(e.checked=!0,this.selectedRadio=e)})),this.$emit("change")}slottedRadioButtonsChanged(e,t){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var e;return null!==(e=this.parentToolbar)&&void 0!==e&&e}get isInsideFoundationToolbar(){var e;return!!(null===(e=this.parentToolbar)||void 0===e?void 0:e.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=rC(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach((e=>{e.removeEventListener("change",this.radioChangeHandler)}))}setupRadioButtons(){const e=this.slottedRadioButtons.filter((e=>e.hasAttribute("checked"))),t=e?e.length:0;if(t>1){e[t-1].checked=!0}let n=!1;if(this.slottedRadioButtons.forEach((e=>{void 0!==this.name&&e.setAttribute("name",this.name),this.disabled&&(e.disabled=!0),this.readOnly&&(e.readOnly=!0),this.value&&this.value===e.value?(this.selectedRadio=e,this.focusedRadio=e,e.checked=!0,e.setAttribute("tabindex","0"),n=!0):(this.isInsideFoundationToolbar||e.setAttribute("tabindex","-1"),e.checked=!1),e.addEventListener("change",this.radioChangeHandler)})),void 0===this.value&&this.slottedRadioButtons.length>0){const e=this.slottedRadioButtons.filter((e=>e.hasAttribute("checked"))),t=null!==e?e.length:0;if(t>0&&!n){const n=e[t-1];n.checked=!0,this.focusedRadio=n,n.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}}var PI;ta([Ys({attribute:"readonly",mode:"boolean"})],RI.prototype,"readOnly",void 0),ta([Ys({attribute:"disabled",mode:"boolean"})],RI.prototype,"disabled",void 0),ta([Ys],RI.prototype,"name",void 0),ta([Ys],RI.prototype,"value",void 0),ta([Ys],RI.prototype,"orientation",void 0),ta([Ms],RI.prototype,"childItems",void 0),ta([Ms],RI.prototype,"slottedRadioButtons",void 0);var OI;const DI=RI.compose({baseName:"radio-group",template:(e,t)=>ec(PI||(PI=Ht(['\n    <template\n        role="radiogroup"\n        aria-disabled="','"\n        aria-readonly="','"\n        @click="','"\n        @keydown="','"\n        @focusout="','"\n    >\n        <slot name="label"></slot>\n        <div\n            class="positioning-region ','"\n            part="positioning-region"\n        >\n            <slot\n                ',"\n            ></slot>\n        </div>\n    </template>\n"])),(e=>e.disabled),(e=>e.readOnly),((e,t)=>e.clickHandler(t.event)),((e,t)=>e.keydownHandler(t.event)),((e,t)=>e.focusOutHandler(t.event)),(e=>e.orientation===lC?"horizontal":"vertical"),qg({property:"slottedRadioButtons",filter:Ug("[role=radio]")})),styles:(e,t)=>xp(OI||(OI=Ht(["\n  "," :host {\n    align-items: flex-start;\n    flex-direction: column;\n  }\n\n  .positioning-region {\n    display: flex;\n    flex-wrap: wrap;\n  }\n\n  :host([orientation='vertical']) .positioning-region {\n    flex-direction: column;\n  }\n\n  :host([orientation='horizontal']) .positioning-region {\n    flex-direction: row;\n  }\n"])),Sp("flex"))});var MI,NI,LI,FI,UI,zI,HI,qI,BI,VI,jI,KI,GI,$I,WI,QI,YI,ZI,JI,XI,eE,tE,nE=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},oE=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},rE=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(Nv,DI,Ev);let iE=class extends CI{static get styles(){return EI}get strings(){return AI}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._isDarkMode=!1,this.onThemeChanged=()=>{this._isDarkMode=o_(this)},this.addTask=()=>rE(this,void 0,void 0,(function*(){if(!this._isNewTaskBeingAdded&&this._newTaskName){this._isNewTaskBeingAdded=!0,this.requestUpdate();try{yield this.createNewTask()}finally{this.clearNewTaskData(),this._isNewTaskBeingAdded=!1,this.requestUpdate()}}})),this.renderNewTask=()=>{const e=this._newTaskName?ot(MI||(MI=Ht(['\n        <fluent-checkbox\n          class="task-add-icon"\n          @click="','">\n        </fluent-checkbox>\n      '])),this.addTask):ot(NI||(NI=Ht(['\n        <span class="add-icon">',"</span>\n      "])),ei(Xr.Add)),t=ot(LI||(LI=Ht(["\n      <fluent-button\n        aria-label=",'\n        class="task-cancel-icon" \n        @click="','"\n      >\n        ',"\n      </fluent-button>\n    "])),this.strings.cancelAddingTask,this.clearNewTaskData,ei(Xr.Cancel)),n={dark:this._isDarkMode,date:!0},o=ot(FI||(FI=Ht(['\n      <fluent-text-field\n        autocomplete="off"\n        type="date"\n        id="new-taskDate-input"\n        class="','"\n        aria-label="','"\n        .value="','"\n        @change="','"\n      >\n      </fluent-text-field>\n    '])),Bn(n),this.strings.newTaskDateInputLabel,this.dateToInputValue(this._newTaskDueDate),this.handleDateChange),r=this.readOnly?it:ot(UI||(UI=Ht(['\n      <fluent-text-field\n        autocomplete="off"\n        appearance="outline"\n        class="new-task"\n        id="new-task-name-input"\n        aria-label="','"\n        .value=','\n        placeholder="','"\n        @keydown="','"\n        @input="','"\n      >\n        <div slot="start" class="start">',"</div>\n        ","\n      </fluent-text-field>\n    "])),this.strings.newTaskLabel,this._newTaskName,this.strings.newTaskPlaceholder,this.handleKeyDown,this.handleInput,e,this._newTaskName?ot(zI||(zI=Ht(['\n              <div slot="end" class="end">\n                <span class="calendar">',"</span>\n                ","\n              </div> "])),o,t):ot(HI||(HI=Ht([""]))));return ot(qI||(qI=Ht(["\n      ","  \n     "])),this.currentList?ot(BI||(BI=Ht(["\n            <div dir=",' class="task new-task incomplete">\n              ',"\n            </div>\n        "])),this.direction,r):ot(VI||(VI=Ht([""]))))},this.handleSelectionChanged=e=>{this.currentList=e.detail,this.loadTasks(this.currentList)},this.renderTaskDetails=e=>{const t={task:e,list:this.currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",t,e.id);let n=null;const o=e.dueDateTime?ot(jI||(jI=Ht(['\n        <span class="task-calendar">','</span>\n        <span class="task-due-date">',"</span>\n      "])),ei(Xr.Calendar),(e=>{const t=e.getMonth(),n=e.getDate(),o=e.getFullYear();return"".concat(n," / ").concat(t," / ").concat(o)})(new Date(e.dueDateTime.dateTime))):ot(KI||(KI=Ht([""]))),r=this.readOnly?ot(GI||(GI=Ht([""]))):ot($I||($I=Ht(['\n        <fluent-button class="task-delete"\n          @click="','"\n          aria-label="','"\n        >\n          ',"\n        </fluent-button>\n      "])),(()=>this.removeTask(e.id)),this.strings.deleteTaskLabel,ei(Xr.Delete));return n=this.hasTemplate("task-details")?this.renderTemplate("task-details",t,"task-details-".concat(e.id)):ot(WI||(WI=Ht(['\n      <div class="task-details">\n        <div class="title">','</div>\n        <div class="task-due">',"</div>\n        ","\n      </div>\n      "])),e.title,o,r),ot(QI||(QI=Ht(["",""])),n)},this.renderTask=e=>{const t=Bn({"read-only":this.readOnly,task:!0});return ot(YI||(YI=Ht(["\n      <fluent-checkbox \n        id=","\n        class=","\n        ?disabled=",'\n        @click="','"\n      >\n        ',"\n      </fluent-checkbox>\n    "])),e.id,t,this.readOnly,(()=>this.handleTaskCheckClick(e)),this.renderTaskDetails(e))},this.renderCompletedTask=e=>{const t=Bn({complete:!0,"read-only":this.readOnly,task:!0}),n=ot(ZI||(ZI=Ht(["",""])),ei(Xr.CheckMark));return ot(JI||(JI=Ht(["\n      <fluent-checkbox \n        id="," \n        class="," \n        checked \n        ?disabled=",' \n        @click="','"\n      >\n        <div slot="checked-indicator">\n          ',"\n        </div>\n        ","\n      </fluent-checkbox>\n    "])),e.id,t,this.readOnly,(()=>this.handleTaskCheckClick(e)),n,this.renderTaskDetails(e))},this.loadState=()=>rE(this,void 0,void 0,(function*(){const e=re.globalProvider;if(e&&e.state===te.SignedIn){if(this._isLoadingTasks=!0,!this._graph){const t=e.graph.forComponent(this);this._graph=t}if(!this.currentList&&!this.initialId){const e=yield(t=this._graph,_I(void 0,void 0,void 0,(function*(){const e=yield t.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(ie("Tasks.Read")).get();return null===e||void 0===e?void 0:e.value}))),n=null===e||void 0===e?void 0:e.find((e=>"defaultList"===e.wellknownListName));n&&(yield this.loadTasks(n))}var t;this.targetId?(this.currentList=yield TI(this._graph,this.targetId),this._tasks=yield SI(this._graph,this.targetId)):this.initialId&&(this.currentList=yield TI(this._graph,this.initialId),this._tasks=yield SI(this._graph,this.initialId)),this._isLoadingTasks=!1}})),this.clearNewTaskData=()=>{this._newTaskDueDate=null,this._newTaskName=""},this.clearState=()=>{super.clearState(),this.currentList=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1},this.loadTasks=e=>rE(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this.currentList=e,this._tasks=yield SI(this._graph,e.id),this._isLoadingTasks=!1,this.requestUpdate()})),this.updateTaskStatus=(e,t)=>rE(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,e.id],this.requestUpdate(),e.status=t;const n=this.currentList.id;e=yield((e,t,n,o)=>_I(void 0,void 0,void 0,(function*(){return yield e.api("/me/todo/lists/".concat(t,"/tasks/").concat(n)).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.ReadWrite")).patch(o)})))(this._graph,n,e.id,e);const o=this._tasks.findIndex((t=>t.id===e.id));this._tasks[o]=e,this._loadingTasks=this._loadingTasks.filter((t=>t!==e.id)),this.requestUpdate()})),this.removeTask=e=>rE(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((t=>t.id!==e)),this.requestUpdate();const t=this.currentList.id;yield((e,t,n)=>_I(void 0,void 0,void 0,(function*(){yield e.api("/me/todo/lists/".concat(t,"/tasks/").concat(n)).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.ReadWrite")).delete()})))(this._graph,t,e),this._tasks=this._tasks.filter((t=>t.id!==e))})),this.handleInput=e=>{"new-task-name-input"===e.target.id&&(this._newTaskName=e.target.value)},this.handleKeyDown=e=>rE(this,void 0,void 0,(function*(){"Enter"===e.key&&(yield this.addTask())})),this.handleDateChange=e=>{const t=e.target.value;this._newTaskDueDate=t?new Date(t+"T17:00"):null},this._graph=null,this._newTaskDueDate=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1,this.addEventListener("selectionChanged",this.handleSelectionChanged)}connectedCallback(){super.connectedCallback(),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let e=this._tasks;e&&this.taskFilter&&(e=e.filter((e=>this.taskFilter(e))));const t=e.filter((e=>"completed"===e.status)),n=ss(e.filter((e=>"completed"!==e.status)),(e=>e.id),(e=>this.renderTask(e))),o=ss(t.sort(((e,t)=>new Date(e.lastModifiedDateTime).getTime()-new Date(t.lastModifiedDateTime).getTime())),(e=>e.id),(e=>this.renderCompletedTask(e)));return ot(XI||(XI=Ht(["\n      ","\n      ","\n    "])),n,o)}renderPicker(){var e,t;return this.targetId?ot(eE||(eE=Ht(["<p>","</p>"])),null===(e=this.currentList)||void 0===e?void 0:e.displayName):Sn(tE||(tE=Ht(['\n        <mgt-picker\n          resource="me/todo/lists"\n          scopes="tasks.read, tasks.readwrite"\n          key-name="displayName"\n          selected-value="','"\n          placeholder="Select a task list">\n        </mgt-picker>'])),yi(null===(t=this.currentList)||void 0===t?void 0:t.displayName))}createNewTask(){return rE(this,void 0,void 0,(function*(){const e=this.currentList.id,t={title:this._newTaskName};this._newTaskDueDate&&(t.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"});const n=yield((e,t,n)=>_I(void 0,void 0,void 0,(function*(){return yield e.api("/me/todo/lists/".concat(t,"/tasks")).header("Cache-Control","no-store").middlewareOptions(ie("Tasks.ReadWrite")).post(n)})))(this._graph,e,t);this._tasks.unshift(n)}))}handleTaskCheckClick(e){this.handleTaskClick(e),this.readOnly||("completed"===e.status?this.updateTaskStatus(e,"notStarted"):this.updateTaskStatus(e,"completed"))}};nE([At(),oE("design:type",String)],iE.prototype,"_newTaskName",void 0),nE([At(),oE("design:type",Object)],iE.prototype,"currentList",void 0),nE([At(),oE("design:type",Object)],iE.prototype,"_isDarkMode",void 0),iE=nE([Tn("todo"),oE("design:paramtypes",[])],iE);class sE extends Wa{}class aE extends(Dg(sE)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class lE extends aE{constructor(){super(),this.initialValue="on",this.keypressHandler=e=>{if(!this.readOnly)switch(e.key){case kg:case Sg:this.checked=!this.checked}},this.clickHandler=e=>{this.disabled||this.readOnly||(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(e,t){super.checkedChanged(e,t),this.checked?this.classList.add("checked"):this.classList.remove("checked")}}var cE;ta([Ys({attribute:"readonly",mode:"boolean"})],lE.prototype,"readOnly",void 0),ta([Ms],lE.prototype,"defaultSlottedNodes",void 0);var dE,uE,hE,pE;const fE=lE.compose({baseName:"switch",template:(e,t)=>ec(cE||(cE=Ht(['\n    <template\n        role="switch"\n        aria-checked="','"\n        aria-disabled="','"\n        aria-readonly="','"\n        tabindex="','"\n        @keypress="','"\n        @click="','"\n        class="','"\n    >\n        <label\n            part="label"\n            class="','"\n        >\n            <slot ','></slot>\n        </label>\n        <div part="switch" class="switch">\n            <slot name="switch">','</slot>\n        </div>\n        <span class="status-message" part="status-message">\n            <span class="checked-message" part="checked-message">\n                <slot name="checked-message"></slot>\n            </span>\n            <span class="unchecked-message" part="unchecked-message">\n                <slot name="unchecked-message"></slot>\n            </span>\n        </span>\n    </template>\n'])),(e=>e.checked),(e=>e.disabled),(e=>e.readOnly),(e=>e.disabled?null:0),((e,t)=>e.keypressHandler(t.event)),((e,t)=>e.clickHandler(t.event)),(e=>e.checked?"checked":""),(e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"),qg("defaultSlottedNodes"),t.switch||""),styles:(e,t)=>xp(dE||(dE=Ht(["\n    :host([hidden]) {\n      display: none;\n    }\n\n    "," :host {\n      align-items: center;\n      outline: none;\n      font-family: ",";\n      "," user-select: none;\n    }\n\n    :host(.disabled) {\n      opacity: ",";\n    }\n\n    :host(.disabled) .label,\n    :host(.readonly) .label,\n    :host(.disabled) .switch,\n    :host(.readonly) .switch,\n    :host(.disabled) .status-message,\n    :host(.readonly) .status-message {\n      cursor: ",";\n    }\n\n    .switch {\n      position: relative;\n      box-sizing: border-box;\n      width: calc((("," / 2) + ",") * 2px);\n      height: calc((("," / 2) + ",") * 1px);\n      background: ",";\n      border-radius: calc("," * 1px);\n      border: calc("," * 1px) solid ",";\n      cursor: pointer;\n    }\n\n    :host(:not(.disabled):hover) .switch {\n      background: ",";\n      border-color: ",";\n    }\n\n    :host(:not(.disabled):active) .switch {\n      background: ",";\n      border-color: ",";\n    }\n\n    :host(:",") .switch {\n      ","\n      background: ",";\n    }\n\n    :host(.checked) .switch {\n      background: ",";\n      border-color: transparent;\n    }\n\n    :host(.checked:not(.disabled):hover) .switch {\n      background: ",";\n      border-color: transparent;\n    }\n\n    :host(.checked:not(.disabled):active) .switch {\n      background: ",";\n      border-color: transparent;\n    }\n\n    slot[name='switch'] {\n      position: absolute;\n      display: flex;\n      border: 1px solid transparent; /* Spacing included in the transform reference box */\n      fill: ",";\n      transition: all 0.2s ease-in-out;\n    }\n\n    .status-message {\n      color: ",";\n      cursor: pointer;\n      ","\n    }\n\n    .label__hidden {\n      display: none;\n      visibility: hidden;\n    }\n\n    .label {\n      color: ",";\n      ","\n      margin-inline-end: calc(",' * 2px + 2px);\n      cursor: pointer;\n    }\n\n    ::slotted([slot="checked-message"]),\n    ::slotted([slot="unchecked-message"]) {\n        margin-inline-start: calc('," * 2px + 2px);\n    }\n\n    :host(.checked) .switch {\n      background: ",";\n    }\n\n    :host(.checked) .switch slot[name='switch'] {\n      fill: ",";\n      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));\n    }\n\n    :host(.checked:not(.disabled)) .switch:hover {\n      background: ",";\n    }\n\n    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {\n      fill: ",";\n    }\n\n    :host(.checked:not(.disabled)) .switch:active {\n      background: ",";\n    }\n\n    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {\n      fill: ",";\n    }\n\n    .unchecked-message {\n      display: block;\n    }\n\n    .checked-message {\n      display: none;\n    }\n\n    :host(.checked) .unchecked-message {\n      display: none;\n    }\n\n    :host(.checked) .checked-message {\n      display: block;\n    }\n  "])),Sp("inline-flex"),sd,"",Jc,Vg,Wg,td,Wg,td,Ch,Wg,rd,lp,_h,cp,Sh,dp,Gg,lv,Th,Qu,Yu,Zu,qh,qh,rv,qh,rv,td,td,Qu,eh,Yu,th,Zu,nh).withBehaviors(new Oy(xp(uE||(uE=Ht(["\n        slot[name='switch'] {\n          left: 0;\n        }\n\n        :host(.checked) slot[name='switch'] {\n          left: 100%;\n          transform: translateX(-100%);\n        }\n      "]))),xp(hE||(hE=Ht(["\n        slot[name='switch'] {\n          right: 0;\n        }\n\n        :host(.checked) slot[name='switch'] {\n          right: 100%;\n          transform: translateX(100%);\n        }\n      "])))),Ep(xp(pE||(pE=Ht(["\n        :host(:not(.disabled)) .switch slot[name='switch'] {\n          forced-color-adjust: none;\n          fill: ",";\n        }\n        .switch {\n          background: ",";\n          border-color: ",";\n        }\n        :host(.checked) .switch {\n          background: ",";\n          border-color: ",";\n        }\n        :host(:not(.disabled):hover) .switch ,\n        :host(:not(.disabled):active) .switch,\n        :host(.checked:not(.disabled):hover) .switch {\n          background: ",";\n          border-color: ",';\n        }\n        :host(.checked:not(.disabled)) .switch slot[name="switch"] {\n          fill: ',";\n        }\n        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {\n          fill: ",";\n        }\n        :host(:",") .switch {\n          forced-color-adjust: none;\n          background: ","; \n          border-color: ",";\n          outline-color: ",";\n        }\n        :host(.disabled) {\n          opacity: 1;\n        }\n        :host(.disabled) slot[name='switch'] {\n          forced-color-adjust: none;\n          fill: ",";\n        }\n        :host(.disabled) .switch {\n          background: ",";\n          border-color: ",";\n        }\n        .status-message,\n        .label {\n          color: ",";\n        }\n      "])),Ap.FieldText,Ap.Field,Ap.FieldText,Ap.Highlight,Ap.Highlight,Ap.HighlightText,Ap.Highlight,Ap.HighlightText,Ap.Highlight,Gg,Ap.Field,Ap.Highlight,Ap.FieldText,Ap.GrayText,Ap.Field,Ap.GrayText,Ap.FieldText))),switch:'\n    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n      <rect x="2" y="2" width="12" height="12" rx="6"/>\n    </svg>\n  '}),gE="#717171",vE=gl.create("secondary-text-color").withDefault(gE),mE="#1a1a1a",yE=gl.create("secondary-text-hover-color").withDefault(mE),bE=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;var n;Lu.setValueFor(t,Cc.from(cc(e.accentBaseColor))),Mu.setValueFor(t,Cc.from(cc(e.neutralBaseColor))),Ld.setValueFor(t,e.baseLayerLuminance),null===(n=e.designTokenOverrides)||void 0===n||n.call(e,t)},wE=e=>{switch(e){case"contrast":return{accentBaseColor:"#7f85f5",neutralBaseColor:"#adadad",baseLayerLuminance:Gc.DarkMode};case"default":return{accentBaseColor:"#5b5fc7",neutralBaseColor:"#616161",baseLayerLuminance:Gc.LightMode};case"dark":return{accentBaseColor:"#479ef5",neutralBaseColor:"#adadad",baseLayerLuminance:Gc.DarkMode,designTokenOverrides:e=>{Qu.setValueFor(e,Cc.from(cc("#115ea3"))),Yu.setValueFor(e,Cc.from(cc("#0f6cbd"))),Zu.setValueFor(e,Cc.from(cc("#0c3b5e"))),Ju.setValueFor(e,Cc.from(cc("#0f548c"))),ih.setValueFor(e,Cc.from(cc("#479EF5"))),sh.setValueFor(e,Cc.from(cc("#62abf5"))),ah.setValueFor(e,Cc.from(cc("#2886de"))),lh.setValueFor(e,Cc.from(cc("#479ef5"))),dh.setValueFor(e,Cc.from(cc("#115ea3"))),uh.setValueFor(e,Cc.from(cc("#0f6cbd"))),hh.setValueFor(e,Cc.from(cc("#0c3b5e"))),ph.setValueFor(e,Cc.from(cc("#0f548c"))),nh.setValueFor(e,Cc.from(cc("#ffffff"))),eh.setValueFor(e,Cc.from(cc("#ffffff"))),th.setValueFor(e,Cc.from(cc("#ffffff"))),oh.setValueFor(e,Cc.from(cc("#ffffff"))),vE.setValueFor(e,"#8e8e8e"),yE.setValueFor(e,"#ffffff")}};default:return{accentBaseColor:"#0f6cbd",neutralBaseColor:"#616161",baseLayerLuminance:Gc.LightMode,designTokenOverrides:e=>{vE.setValueFor(e,gE),yE.setValueFor(e,mE)}}}},kE={label:"Color mode:",on:"Dark",off:"Light"};var xE,CE=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_E=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Tl(fE);let SE=class extends Lt{constructor(){super(),this.onSwitchChanged=e=>{this.darkModeActive=e.target.checked};const e=window.matchMedia("(prefers-color-scheme:dark)").matches;this.darkModeActive=e,this.applyTheme(this.darkModeActive)}get strings(){return kE}updated(e){e.has("darkModeActive")&&this.applyTheme(this.darkModeActive)}render(){return ot(xE||(xE=Ht(["\n      <fluent-switch checked="," @change=",'>\n        <span slot="checked-message">','</span>\n        <span slot="unchecked-message">','</span>\n        <label for="direction-switch">',"</label>\n      </fluent-switch>\n"])),this.darkModeActive,this.onSwitchChanged,kE.on,kE.off,kE.label)}applyTheme(e){const t=e?"dark":"light";!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;const n=wE(e);bE(n,t)}(t),document.body.classList.remove("mgt-dark-mode","mgt-light-mode"),document.body.classList.add("mgt-".concat(t,"-mode")),this.fireCustomEvent("darkmodechanged",this.darkModeActive,!0,!1,!0)}};CE([Et({attribute:"mode",reflect:!0,type:String,converter:{fromAttribute:e=>"dark"===e,toAttribute:e=>e?"dark":"light"}}),_E("design:type",Boolean)],SE.prototype,"darkModeActive",void 0),SE=CE([Tn("theme-toggle"),_E("design:paramtypes",[])],SE);class TE extends Wa{}class IE extends(Og(TE)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class EE extends IE{readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.validate(),this.autofocus&&Rs.queueUpdate((()=>{this.focus()}))}validate(){super.validate(this.control)}handleTextInput(){this.value=this.control.value}handleClearInput(){this.value="",this.control.focus(),this.handleChange()}handleChange(){this.$emit("change")}}ta([Ys({attribute:"readonly",mode:"boolean"})],EE.prototype,"readOnly",void 0),ta([Ys({mode:"boolean"})],EE.prototype,"autofocus",void 0),ta([Ys],EE.prototype,"placeholder",void 0),ta([Ys],EE.prototype,"list",void 0),ta([Ys({converter:Ws})],EE.prototype,"maxlength",void 0),ta([Ys({converter:Ws})],EE.prototype,"minlength",void 0),ta([Ys],EE.prototype,"pattern",void 0),ta([Ys({converter:Ws})],EE.prototype,"size",void 0),ta([Ys({mode:"boolean"})],EE.prototype,"spellcheck",void 0),ta([Ms],EE.prototype,"defaultSlottedNodes",void 0);class AE{}var RE;gg(AE,og),gg(EE,dg,AE);var PE;const OE=".root",DE=gl.create("clear-button-hover").withDefault((e=>{const t=Mh.getValueFor(e),n=yh.getValueFor(e);return t.evaluate(e,n.evaluate(e).focus).hover})),ME=gl.create("clear-button-active").withDefault((e=>{const t=Mh.getValueFor(e),n=yh.getValueFor(e);return t.evaluate(e,n.evaluate(e).focus).active}));class NE extends EE{constructor(){super(...arguments),this.appearance="outline"}}i([Ys],NE.prototype,"appearance",void 0);const LE=NE.compose({baseName:"search",baseClass:EE,template:(e,t)=>ec(RE||(RE=Ht(['\n  <template\n    class="\n            ','\n        "\n  >\n    <label\n      part="label"\n      for="control"\n      class="','"\n    >\n      <slot ','></slot>\n    </label>\n    <div class="root" part="root" ',">\n      ",'\n      <div class="input-wrapper" part="input-wrapper">\n        <input\n          class="control"\n          part="control"\n          id="control"\n          @input="','"\n          @change="','"\n          ?autofocus="','"\n          ?disabled="','"\n          list="','"\n          maxlength="','"\n          minlength="','"\n          pattern="','"\n          placeholder="','"\n          ?readonly="','"\n          ?required="','"\n          size="','"\n          ?spellcheck="','"\n          :value="','"\n          type="search"\n          aria-atomic="','"\n          aria-busy="','"\n          aria-controls="','"\n          aria-current="','"\n          aria-describedby="','"\n          aria-details="','"\n          aria-disabled="','"\n          aria-errormessage="','"\n          aria-flowto="','"\n          aria-haspopup="','"\n          aria-hidden="','"\n          aria-invalid="','"\n          aria-keyshortcuts="','"\n          aria-label="','"\n          aria-labelledby="','"\n          aria-live="','"\n          aria-owns="','"\n          aria-relevant="','"\n          aria-roledescription="','"\n          ','\n        />\n        <slot name="clear-button">\n          <button\n            class="clear-button ','"\n            part="clear-button"\n            tabindex="-1"\n            @click=','\n          >\n            <slot name="clear-glyph">\n              <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">\n                <path\n                  d="m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"\n                />\n              </svg>\n            </slot>\n          </button>\n        </slot>\n      </div>\n      ',"\n    </div>\n  </template>\n"])),(e=>e.readOnly?"readonly":""),(e=>e.defaultSlottedNodes&&e.defaultSlottedNodes.length?"label":"label label__hidden"),qg({property:"defaultSlottedNodes",filter:sw}),ig("root"),hg(0,t),(e=>e.handleTextInput()),(e=>e.handleChange()),(e=>e.autofocus),(e=>e.disabled),(e=>e.list),(e=>e.maxlength),(e=>e.minlength),(e=>e.pattern),(e=>e.placeholder),(e=>e.readOnly),(e=>e.required),(e=>e.size),(e=>e.spellcheck),(e=>e.value),(e=>e.ariaAtomic),(e=>e.ariaBusy),(e=>e.ariaControls),(e=>e.ariaCurrent),(e=>e.ariaDescribedby),(e=>e.ariaDetails),(e=>e.ariaDisabled),(e=>e.ariaErrormessage),(e=>e.ariaFlowto),(e=>e.ariaHaspopup),(e=>e.ariaHidden),(e=>e.ariaInvalid),(e=>e.ariaKeyshortcuts),(e=>e.ariaLabel),(e=>e.ariaLabelledby),(e=>e.ariaLive),(e=>e.ariaOwns),(e=>e.ariaRelevant),(e=>e.ariaRoledescription),ig("control"),(e=>e.value?"":"clear-button__hidden"),(e=>e.handleClearInput()),ug(0,t)),styles:(e,t)=>xp(PE||(PE=Ht(["\n    ","\n\n    ","\n\n    ","\n\n    .root {\n      display: flex;\n      flex-direction: row;\n    }\n    .control {\n      -webkit-appearance: none;\n      color: inherit;\n      background: transparent;\n      border: 0;\n      height: calc(100% - 4px);\n      margin-top: auto;\n      margin-bottom: auto;\n      padding: 0 calc("," * 2px + 1px);\n      font-family: inherit;\n      font-size: inherit;\n      line-height: inherit;\n    }\n    .clear-button {\n      display: inline-flex;\n      align-items: center;\n      margin: 1px;\n      height: calc(100% - 2px);\n      opacity: 0;\n      background: transparent;\n      color: ",";\n      fill: currentcolor;\n      border: none;\n      border-radius: calc("," * 1px);\n      min-width: calc("," * 1px);\n      ","\n      outline: none;\n      padding: 0 calc((10 + ("," * 2 * ",")) * 1px);\n    }\n    .clear-button:hover {\n      background: ",";\n    }\n    .clear-button:active {\n      background: ",';\n    }\n    :host(:hover:not([disabled], [readOnly])) .clear-button,\n    :host(:active:not([disabled], [readOnly])) .clear-button,\n    :host(:focus-within:not([disabled], [readOnly])) .clear-button {\n        opacity: 1;\n    }\n    :host(:hover:not([disabled], [readOnly])) .clear-button__hidden,\n    :host(:active:not([disabled], [readOnly])) .clear-button__hidden,\n    :host(:focus-within:not([disabled], [readOnly])) .clear-button__hidden {\n        opacity: 0;\n    }\n    .control::-webkit-search-cancel-button {\n      -webkit-appearance: none;\n    }\n    .input-wrapper {\n      display: flex;\n      position: relative;\n      width: 100%;\n    }\n    .start,\n    .end {\n      display: flex;\n      margin: 1px;\n      align-items: center;\n    }\n    .start {\n      display: flex;\n      margin-inline-start: 11px;\n    }\n    ::slotted([slot="end"]) {\n      height: 100%\n    }\n    .clear-button__hidden {\n      opacity: 0;\n    }\n    .end {\n        margin-inline-end: 11px;\n    }\n    ::slotted(',") {\n      margin-inline-end: 1px;\n    }\n  "])),Sp("inline-block"),gy(0,0,OE),vy(),td,qh,nd,Wg,rv,td,ed,DE,ME,e.tagFor(Lg)).withBehaviors(Cv("outline",my(e,t,OE)),Cv("filled",yy(e,t,OE)),Ep(by(e,t,OE))),start:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg%22%3E"><path d="M8.5 3a5.5 5.5 0 0 1 4.23 9.02l4.12 4.13a.5.5 0 0 1-.63.76l-.07-.06-4.13-4.12A5.5 5.5 0 1 1 8.5 3Zm0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Z"/></svg>',shadowOptions:{delegatesFocus:!0}}),FE={placeholder:"Search",title:"Search"};var UE;const zE=[Ce(UE||(UE=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host fluent-search{width:100%}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host fluent-search{width:100%}\n'])))];var HE,qE=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},BE=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Tl(LE);let VE=class extends Lt{static get styles(){return zE}get strings(){return FE}get searchTerm(){return this._searchTerm}set searchTerm(e){this._searchTerm=e,this.fireSearchTermChanged()}constructor(){super(),this._searchTerm="",this.onInputChanged=e=>{this.searchTerm=e.target.value},console.warn("\ud83e\udd92: <mgt-search-box> is a preview component and may change prior to becoming generally available. See more information https://aka.ms/mgt/preview-components"),this.debounceDelay=300}render(){var e;return ot(HE||(HE=Ht(['\n      <fluent-search\n        autocomplete="off"\n        class="search-term-input"\n        appearance="outline"\n        value=',"\n        placeholder=","\n        title=","\n        @input=","\n        @change=","\n      >\n      </fluent-search>"])),null!==(e=this.searchTerm)&&void 0!==e?e:"",this.placeholder?this.placeholder:FE.placeholder,this.title?this.title:FE.title,this.onInputChanged,this.onInputChanged)}fireSearchTermChanged(){this.debouncedSearchTermChanged||(this.debouncedSearchTermChanged=Kn((()=>{this.fireCustomEvent("searchTermChanged",this.searchTerm)}),this.debounceDelay)),this.debouncedSearchTermChanged()}};qE([Et({attribute:"placeholder",type:String}),BE("design:type",String)],VE.prototype,"placeholder",void 0),qE([Et({attribute:"search-term",type:String}),BE("design:type",Object),BE("design:paramtypes",[Object])],VE.prototype,"searchTerm",null),qE([Et({attribute:"debounce-delay",type:Number,reflect:!0}),BE("design:type",Number)],VE.prototype,"debounceDelay",void 0),VE=qE([Tn("search-box"),BE("design:paramtypes",[])],VE);const jE={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"};var KE;const GE=[Ce(KE||(KE=Ht(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n'])))],$E="top",WE="right",QE="bottom",YE="left",ZE="start",JE="end",XE="top-left",eA="top-right",tA="bottom-left",nA="bottom-right",oA="top-start",rA="top-end",iA="bottom-start",sA="bottom-end";class aA extends Wa{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=dc.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=e=>{this.classList.toggle("top","start"===this.region.verticalPosition),this.classList.toggle("bottom","end"===this.region.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.region.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.region.verticalPosition),this.classList.toggle("center-vertical","center"===this.region.verticalPosition),this.classList.toggle("left","start"===this.region.horizontalPosition),this.classList.toggle("right","end"===this.region.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.region.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.region.horizontalPosition),this.classList.toggle("center-horizontal","center"===this.region.horizontalPosition)},this.handleRegionMouseOver=e=>{this.isRegionHovered=!0},this.handleRegionMouseOut=e=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=e=>{this.tooltipVisible?this.isAnchorHoveredFocused=!0:this.startShowDelayTimer()},this.handleAnchorMouseOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=e=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=e=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout((()=>{this.updateTooltipVisibility()}),60))},this.clearHideDelayTimer=()=>{null!==this.hideDelayTimer&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{this.isAnchorHoveredFocused||(this.delay>1?null===this.showDelayTimer&&(this.showDelayTimer=window.setTimeout((()=>{this.startHover()}),this.delay)):this.startHover())},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{null!==this.showDelayTimer&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{const e=this.getRootNode();return e instanceof ShadowRoot?e.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=e=>{if(!e.defaultPrevented&&this.tooltipVisible&&e.key===xg)this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss")},this.updateTooltipVisibility=()=>{if(!1===this.visible)this.hideTooltip();else{if(!0===this.visible)return void this.showTooltip();if(this.isAnchorHoveredFocused||this.isRegionHovered)return void this.showTooltip();this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=rC(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),Rs.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),null!==this.region&&void 0!==this.region&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(e){if(this.$fastController.isConnected){if(null!==e&&void 0!==e&&(e.removeEventListener("mouseover",this.handleAnchorMouseOver),e.removeEventListener("mouseout",this.handleAnchorMouseOut),e.removeEventListener("focusin",this.handleAnchorFocusIn),e.removeEventListener("focusout",this.handleAnchorFocusOut)),null!==this.anchorElement&&void 0!==this.anchorElement){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});const e=this.anchorElement.id;null!==this.anchorElement.parentElement&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach((t=>{t.id===e&&this.startShowDelayTimer()}))}null!==this.region&&void 0!==this.region&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){null!==this.region&&void 0!==this.region&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case $E:case QE:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case WE:case YE:case ZE:case JE:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case XE:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case eA:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case tA:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case nA:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case oA:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case rA:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case iA:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case sA:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center"}}}var lA,cA;ta([Ys({mode:"boolean"})],aA.prototype,"visible",void 0),ta([Ys],aA.prototype,"anchor",void 0),ta([Ys],aA.prototype,"delay",void 0),ta([Ys],aA.prototype,"position",void 0),ta([Ys({attribute:"auto-update-mode"})],aA.prototype,"autoUpdateMode",void 0),ta([Ys({attribute:"horizontal-viewport-lock"})],aA.prototype,"horizontalViewportLock",void 0),ta([Ys({attribute:"vertical-viewport-lock"})],aA.prototype,"verticalViewportLock",void 0),ta([Ms],aA.prototype,"anchorElement",void 0),ta([Ms],aA.prototype,"viewportElement",void 0),ta([Ms],aA.prototype,"verticalPositioningMode",void 0),ta([Ms],aA.prototype,"horizontalPositioningMode",void 0),ta([Ms],aA.prototype,"horizontalInset",void 0),ta([Ms],aA.prototype,"verticalInset",void 0),ta([Ms],aA.prototype,"horizontalScaling",void 0),ta([Ms],aA.prototype,"verticalScaling",void 0),ta([Ms],aA.prototype,"verticalDefaultPosition",void 0),ta([Ms],aA.prototype,"horizontalDefaultPosition",void 0),ta([Ms],aA.prototype,"tooltipVisible",void 0),ta([Ms],aA.prototype,"currentDirection",void 0);var dA,uA;const hA=class extends aA{connectedCallback(){super.connectedCallback(),Gu.setValueFor(this,Hu)}}.compose({baseName:"tooltip",baseClass:aA,template:(e,t)=>ec(lA||(lA=Ht(["\n        ","\n    "])),Yf((e=>e.tooltipVisible),ec(cA||(cA=Ht(["\n            <",'\n                fixed-placement="true"\n                auto-update-mode="','"\n                vertical-positioning-mode="','"\n                vertical-default-position="','"\n                vertical-inset="','"\n                vertical-scaling="','"\n                horizontal-positioning-mode="','"\n                horizontal-default-position="','"\n                horizontal-scaling="','"\n                horizontal-inset="','"\n                vertical-viewport-lock="','"\n                horizontal-viewport-lock="','"\n                dir="','"\n                ','\n            >\n                <div class="tooltip" part="tooltip" role="tooltip">\n                    <slot></slot>\n                </div>\n            </',">\n        "])),e.tagFor(wC),(e=>e.autoUpdateMode),(e=>e.verticalPositioningMode),(e=>e.verticalDefaultPosition),(e=>e.verticalInset),(e=>e.verticalScaling),(e=>e.horizontalPositioningMode),(e=>e.horizontalDefaultPosition),(e=>e.horizontalScaling),(e=>e.horizontalInset),(e=>e.horizontalViewportLock),(e=>e.verticalViewportLock),(e=>e.currentDirection),ig("region"),e.tagFor(wC)))),styles:(e,t)=>xp(dA||(dA=Ht(["\n    :host {\n      position: relative;\n      contain: layout;\n      overflow: visible;\n      height: 0;\n      width: 0;\n      z-index: 10000;\n    }\n\n    .tooltip {\n      box-sizing: border-box;\n      border-radius: calc("," * 1px);\n      border: calc("," * 1px) solid ",";\n      background: ",";\n      color: ",";\n      padding: 4px 12px;\n      height: fit-content;\n      width: fit-content;\n      ","\n      white-space: nowrap;\n      box-shadow: ",";\n    }\n\n    "," {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      overflow: visible;\n      flex-direction: row;\n    }\n\n    ",".right,\n    ",".left {\n      flex-direction: column;\n    }\n\n    ",".top .tooltip::after,\n    ",".bottom .tooltip::after,\n    ",".left .tooltip::after,\n    ",".right .tooltip::after {\n      content: '';\n      width: 12px;\n      height: 12px;\n      background: ",";\n      border-top: calc("," * 1px) solid ",";\n      border-left: calc("," * 1px) solid ",";\n      position: absolute;\n    }\n\n    ",".top .tooltip::after {\n      transform: translateX(-50%) rotate(225deg);\n      bottom: 5px;\n      left: 50%;\n    }\n\n    ",".top .tooltip {\n      margin-bottom: 12px;\n    }\n\n    ",".bottom .tooltip::after {\n      transform: translateX(-50%) rotate(45deg);\n      top: 5px;\n      left: 50%;\n    }\n\n    ",".bottom .tooltip {\n      margin-top: 12px;\n    }\n\n    ",".left .tooltip::after {\n      transform: translateY(-50%) rotate(135deg);\n      top: 50%;\n      right: 5px;\n    }\n\n    ",".left .tooltip {\n      margin-right: 12px;\n    }\n\n    ",".right .tooltip::after {\n      transform: translateY(-50%) rotate(-45deg);\n      top: 50%;\n      left: 5px;\n    }\n\n    ",".right .tooltip {\n      margin-left: 12px;\n    }\n  "])),nd,rd,sp,Gu,qh,rv,Fp,e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),Gu,rd,sp,rd,sp,e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC)).withBehaviors(Ep(xp(uA||(uA=Ht(["\n        :host([disabled]) {\n          opacity: 1;\n        }\n        ",".top .tooltip::after,\n        ",".bottom .tooltip::after,\n        ",".left .tooltip::after,\n        ",".right .tooltip::after {\n          content: '';\n          width: unset;\n          height: unset;\n        }\n      "])),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC),e.tagFor(wC))))});var pA;var fA;const gA=dC.compose({baseName:"divider",template:(e,t)=>ec(pA||(pA=Ht(['\n    <template role="','" aria-orientation="','"></template>\n'])),(e=>e.role),(e=>e.orientation)),styles:(e,t)=>xp(fA||(fA=Ht(["\n    "," :host {\n      box-sizing: content-box;\n      height: 0;\n      border: none;\n      border-top: calc("," * 1px) solid ",';\n    }\n\n    :host([orientation="vertical"]) {\n      border: none;\n      height: 100%;\n      margin: 0 calc('," * 1px);\n      border-left: calc("," * 1px) solid ",";\n  }\n  "])),Sp("block"),rd,tp,td,rd,tp)});var vA,mA,yA,bA,wA,kA,xA,CA,_A,SA,TA,IA,EA,AA,RA,PA,OA,DA,MA,NA,LA,FA,UA,zA,HA,qA,BA=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},VA=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},jA=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};Tl(m_,Ev,hA,gA);let KA=class extends Qt{static get styles(){return GE}get strings(){return jE}get queryString(){return this._queryString}set queryString(e){this._queryString!==e&&(this._queryString=e,this._currentPage=1,this.setLoadingState(!0),this.requestStateUpdate(!0))}get from(){return(this.currentPage-1)*this.size}get size(){return this._size}set size(e){e>this.maxPageSize?this._size=this.maxPageSize:this._size=e}get searchEndpoint(){return"/search/query"}get maxPageSize(){return 1e3}get currentPage(){return this._currentPage}set currentPage(e){this._currentPage!==e&&(this._currentPage=e,this.requestStateUpdate(!0))}constructor(){super(),this._size=10,this.entityTypes=["driveItem","listItem","site"],this.scopes=[],this.contentSources=[],this.version="v1.0",this.pagingMax=7,this.enableTopResults=!1,this.cacheEnabled=!1,this.cacheInvalidationPeriod=3e4,this.isRefreshing=!1,this.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],this._currentPage=1,this.onFirstPageClick=()=>{this.currentPage=1,this.scrollToFirstResult()},this.onPageBackClick=()=>{this.currentPage--,this.scrollToFirstResult()},this.onPageNextClick=()=>{this.currentPage++,this.scrollToFirstResult()},console.warn("\ud83e\udd92: <mgt-search-results> is a preview component and may change prior to becoming generally available. See more information https://aka.ms/mgt/preview-components")}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),this.requestStateUpdate()}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}clearState(){this.response=null}render(){var e,t,n,o,r,i,s,a;let l=null,c=null,d=null;return this.hasTemplate("header")&&(c=this.renderTemplate("header",this.response)),d=this.renderFooter(null===(t=null===(e=this.response)||void 0===e?void 0:e.value[0])||void 0===t?void 0:t.hitsContainers[0]),l=this.isLoadingState?this.renderLoading():this.error?this.renderError():this.response&&this.hasTemplate("default")?this.renderTemplate("default",this.response)||ot(vA||(vA=Ht([""]))):(null===(o=null===(n=this.response)||void 0===n?void 0:n.value[0])||void 0===o?void 0:o.hitsContainers[0])?ot(mA||(mA=Ht(["",""])),null===(a=null===(s=null===(i=null===(r=this.response)||void 0===r?void 0:r.value[0])||void 0===i?void 0:i.hitsContainers[0])||void 0===s?void 0:s.hits)||void 0===a?void 0:a.map((e=>this.renderResult(e)))):this.hasTemplate("no-data")?this.renderTemplate("no-data",null):ot(yA||(yA=Ht([""]))),ot(bA||(bA=Ht(["\n      ",'\n      <div class="search-results">\n        ',"\n      </div>\n      ",""])),c,l,d)}loadState(){var e,t,n,o,r,i;return jA(this,void 0,void 0,(function*(){const s=re.globalProvider;if(this.error=null,s&&s.state===te.SignedIn){if(this.queryString){try{const l=this.getRequestOptions();let c;const d=JSON.stringify({endpoint:"".concat(this.version).concat(this.searchEndpoint),requestOptions:l});let u=null;if(this.shouldRetrieveCache()){c=bn.getCache(so,so.stores.responses);const e=Xn()?yield c.getValue(d):null;e&&(this.cacheInvalidationPeriod||bn.config.response.invalidationPeriod||bn.config.defaultInvalidationPeriod)>Date.now()-e.timeCached&&(u=JSON.parse(e.response))}if(!u){const h=s.graph.forComponent(this);let p=h.api(this.searchEndpoint).version(this.version);if((null===(e=this.scopes)||void 0===e?void 0:e.length)&&(p=p.middlewareOptions(ie(...this.scopes))),u=yield p.post({requests:[l]}),this.fetchThumbnail){const e=h.createBatch(),s=me.fromGraph(h).createBatch(),l=(null===(t=u.value)||void 0===t?void 0:t.length)&&(null===(n=u.value[0].hitsContainers)||void 0===n?void 0:n.length)&&null!==(r=null===(o=u.value[0].hitsContainers[0])||void 0===o?void 0:o.hits)&&void 0!==r?r:[];for(const t of l){const n=t.resource;!(n.size>0||(null===(i=n.webUrl)||void 0===i?void 0:i.endsWith(".aspx")))||"#microsoft.graph.driveItem"!==n["@odata.type"]&&"#microsoft.graph.listItem"!==n["@odata.type"]||("#microsoft.graph.listItem"===n["@odata.type"]?s.get(t.hitId.toString(),"/sites/".concat(n.parentReference.siteId,"/pages/").concat(n.id)):e.get(t.hitId.toString(),"/drives/".concat(n.parentReference.driveId,"/items/").concat(n.id,"/thumbnails/0/medium")))}const c=e=>{if(e&&e.size>0)for(const[t,n]of e){const e=u.value[0].hitsContainers[0].hits[t],o="#microsoft.graph.listItem"===e.resource["@odata.type"]?{url:n.content.thumbnailWebUrl}:{url:n.content.url};e.resource.thumbnail=o}};try{c(yield e.executeAll()),c(yield s.executeAll())}catch(a){}}this.shouldUpdateCache()&&u&&(c=bn.getCache(so,so.stores.responses),yield c.putValue(d,{response:JSON.stringify(u)}))}qt(this.response,u)||(this.response=u)}catch(sL){this.error=sL}this.response&&(this.error=null)}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}renderLoading(){return this.renderTemplate("loading",null)||ot(wA||(wA=Ht(["\n        ","\n       "])),[...Array(this.size)].map((()=>ot(kA||(kA=Ht(['\n            <div class="search-result">\n              <div class="search-result-grid">\n                <div class="search-result-icon">\n                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                <div class="searc-result-content">\n                  <div class="search-result-name">\n                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  </div>\n                  <div class="search-result-info">\n                    <div class="search-result-author">\n                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>\n                    </div>\n                    <div class="search-result-date">\n                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>\n                </div>\n                ',"\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          "])),this.fetchThumbnail&&ot(xA||(xA=Ht(['\n                    <div class="search-result-thumbnail">\n                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>\n                    </div>\n                  '])))))))}renderResult(e){const t=this.getResourceType(e.resource);if(this.hasTemplate("result-".concat(t)))return this.renderTemplate("result-".concat(t),e,e.hitId);switch(e.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(e);case"#microsoft.graph.site":return this.renderSite(e);case"#microsoft.graph.person":return this.renderPerson(e);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(e);case"#microsoft.graph.listItem":return this.renderListItem(e);case"#microsoft.graph.search.bookmark":return this.renderBookmark(e);case"#microsoft.graph.search.acronym":return this.renderAcronym(e);case"#microsoft.graph.search.qna":return this.renderQnA(e);default:return this.renderDefault(e)}}renderFooter(e){if(this.pagingRequired(e)){const t=this.getActivePages(e.total);return ot(CA||(CA=Ht(['\n        <div class="search-results-pages">\n          ',"\n          ","\n          ","\n          ","\n        </div>\n      "])),this.renderPreviousPage(),this.renderFirstPage(t),this.renderAllPages(t),this.renderNextPage())}}pagingRequired(e){return(null===e||void 0===e?void 0:e.moreResultsAvailable)||this.currentPage*this.size<(null===e||void 0===e?void 0:e.total)}getActivePages(e){const t=[],n=(()=>{const e=this.currentPage-Math.floor(this.pagingMax/2)-1;return e>=Math.floor(this.pagingMax/2)?e:0})();if(n+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(let o=n+1;o<Math.ceil(e/this.size)&&o<this.pagingMax+(this.currentPage-1)&&t.length<this.pagingMax-2;++o)t.push(o+1);else for(let o=n;o<this.pagingMax;++o)t.push(o+1);return t}renderAllPages(e){return ot(_A||(_A=Ht(["\n      ",""])),e.map((e=>ot(SA||(SA=Ht(['\n            <fluent-button\n              title="'," ",'"\n              appearance="stealth"\n              class="','"\n              @click="','">\n                ',"\n            </fluent-button>"])),jE.page,e,e===this.currentPage?"search-results-page-active":"search-results-page",(()=>this.onPageClick(e)),e))))}renderFirstPage(e){return ot(TA||(TA=Ht(["\n      ",""])),e.some((e=>1===e))?it:ot(IA||(IA=Ht(['\n              <fluent-button\n                 title="',' 1"\n                 appearance="stealth"\n                 class="search-results-page"\n                 @click="','">\n                 1\n               </fluent-button>'])),jE.page,this.onFirstPageClick)?ot(EA||(EA=Ht(['\n              <fluent-button\n                id="page-back-dot"\n                appearance="stealth"\n                class="search-results-page"\n                title="','"\n                @click="','"\n              >\n                ...\n              </fluent-button>'])),this.getDotButtonTitle(),(()=>this.onPageClick(this.currentPage-Math.ceil(this.pagingMax/2)))):it)}getDotButtonTitle(){return"".concat(jE.back," ").concat(Math.ceil(this.pagingMax/2)," ").concat(jE.pages)}renderPreviousPage(){return this.currentPage>1?ot(AA||(AA=Ht(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),jE.back,this.onPageBackClick,ei(Xr.ChevronLeft)):it}renderNextPage(){return this.isLastPage()?it:ot(RA||(RA=Ht(['\n          <fluent-button\n            appearance="stealth"\n            class="search-results-page"\n            title="','"\n            aria-label="','"\n            @click="','">\n              ',"\n            </fluent-button>"])),jE.next,jE.next,this.onPageNextClick,ei(Xr.ChevronRight))}onPageClick(e){this.currentPage=e,this.scrollToFirstResult()}isLastPage(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}scrollToFirstResult(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}getResourceType(e){return e["@odata.type"].split(".").pop()}renderDriveItem(e){var t,n;const o=e.resource;return Sn(PA||(PA=Ht(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image"\n            class="file-icon">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),e.resource,o.webUrl,Zn(o.name),o.lastModifiedBy.user.email,jE.modified,Vn(new Date(o.lastModifiedDateTime)),Yn(e.summary),(null===(t=o.thumbnail)||void 0===t?void 0:t.url)&&ot(OA||(OA=Ht(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),o.webUrl,o.name,null===(n=o.thumbnail)||void 0===n?void 0:n.url))}renderSite(e){const t=e.resource;return ot(DA||(DA=Ht(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="searc-result-content">\n          <div class="search-result-name">\n            <a href="','" target="_blank">','</a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-url">\n              <a href="','" target="_blank">','</a>\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),t.webUrl,t.displayName,t.webUrl,t.webUrl,Yn(e.summary))}renderList(e){const t=e.resource;return Sn(MA||(MA=Ht(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          <mgt-file\n            .fileDetails="','"\n            view="image">\n          </mgt-file>\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),e.resource,t.webUrl,Zn(t.name||Jn(t.webUrl)),Yn(e.summary))}renderListItem(e){var t,n;const o=e.resource;return Sn(NA||(NA=Ht(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">\n              ','\n            </a>\n          </div>\n          <div class="search-result-info">\n            <div class="search-result-author">\n              <mgt-person\n                person-query=','\n                view="oneLine"\n                person-card="hover"\n                show-presence="true">\n              </mgt-person>\n            </div>\n            <div class="search-result-date">\n              &nbsp; '," ",'\n            </div>\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n        ',"\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),o.webUrl.endsWith(".aspx")?ei(Xr.News):ei(Xr.FileOuter),o.webUrl,Zn(o.name||Jn(o.webUrl)),o.lastModifiedBy.user.email,jE.modified,Vn(new Date(o.lastModifiedDateTime)),Yn(e.summary),(null===(t=o.thumbnail)||void 0===t?void 0:t.url)&&ot(LA||(LA=Ht(['\n          <div class="search-result-thumbnail">\n            <a href="','" target="_blank"><img alt="','" src="','" /></a>\n          </div>'])),o.webUrl,Zn(o.name||Jn(o.webUrl)),(null===(n=o.thumbnail)||void 0===n?void 0:n.url)||it))}renderPerson(e){const t=e.resource;return Sn(FA||(FA=Ht(['\n      <div class="search-result">\n        <mgt-person\n          view="fourLines"\n          person-query=','\n          person-card="hover"\n          show-presence="true">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),t.userPrincipalName)}renderBookmark(e){return this.renderAnswer(e,Xr.DoubleBookmark)}renderAcronym(e){return this.renderAnswer(e,Xr.BookOpen)}renderQnA(e){return this.renderAnswer(e,Xr.BookQuestion)}renderAnswer(e,t){const n=e.resource;return ot(UA||(UA=Ht(['\n      <div class="search-result-grid search-result-answer">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            <a href="','?Web=1" target="_blank">','</a>\n          </div>\n          <div class="search-result-summary">',"</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    "])),ei(t),this.getResourceUrl(n),n.displayName,n.description)}renderDefault(e){const t=e.resource,n=this.getResourceUrl(t);return ot(zA||(zA=Ht(['\n      <div class="search-result-grid">\n        <div class="search-result-icon">\n          ','\n        </div>\n        <div class="search-result-content">\n          <div class="search-result-name">\n            ','\n          </div>\n          <div class="search-result-summary" .innerHTML="','"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    '])),this.getResourceIcon(t),n?ot(HA||(HA=Ht(['\n                  <a href="','?Web=1" target="_blank">',"</a>\n                "])),n,this.getResourceName(t)):ot(qA||(qA=Ht(["\n                  ","\n                "])),this.getResourceName(t)),this.getResultSummary(e))}getResourceUrl(e){return e.webUrl||e.webLink||null}getResourceName(e){return e.displayName||e.subject||Zn(e.name)}getResultSummary(e){var t;return Yn(e.summary||(null===(t=e.resource)||void 0===t?void 0:t.description)||null)}getResourceIcon(e){switch(e["@odata.type"]){case"#microsoft.graph.site":return ei(Xr.Globe);case"#microsoft.graph.message":return ei(Xr.Email);case"#microsoft.graph.event":return ei(Xr.Event);case"microsoft.graph.chatMessage":return ei(Xr.SmallChat);default:return ei(Xr.FileOuter)}}shouldRetrieveCache(){return Xn()&&this.cacheEnabled&&!this.isRefreshing}shouldUpdateCache(){return Xn()&&this.cacheEnabled}getRequestOptions(){const e={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(e.contentSources=this.contentSources),"beta"===this.version&&(e.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),e}getFields(){if(this.fields)return this.defaultFields.concat(this.fields)}};BA([Et({attribute:"query-string",type:String}),VA("design:type",String),VA("design:paramtypes",[String])],KA.prototype,"queryString",null),BA([Et({attribute:"query-template",type:String}),VA("design:type",String)],KA.prototype,"queryTemplate",void 0),BA([Et({attribute:"entity-types",converter:e=>e.split(",").map((e=>e.trim())),type:String}),VA("design:type",Array)],KA.prototype,"entityTypes",void 0),BA([Et({attribute:"scopes",converter:(e,t)=>e?e.toLowerCase().split(","):null}),VA("design:type",Array)],KA.prototype,"scopes",void 0),BA([Et({attribute:"content-sources",converter:(e,t)=>e?e.toLowerCase().split(","):null}),VA("design:type",Array)],KA.prototype,"contentSources",void 0),BA([Et({attribute:"version",reflect:!0,type:String}),VA("design:type",Object)],KA.prototype,"version",void 0),BA([Et({attribute:"size",reflect:!0,type:Number}),VA("design:type",Number),VA("design:paramtypes",[Object])],KA.prototype,"size",null),BA([Et({attribute:"paging-max",reflect:!0,type:Number}),VA("design:type",Object)],KA.prototype,"pagingMax",void 0),BA([Et({attribute:"fetch-thumbnail",type:Boolean}),VA("design:type",Boolean)],KA.prototype,"fetchThumbnail",void 0),BA([Et({attribute:"fields",converter:e=>e.split(",").map((e=>e.trim())),type:String}),VA("design:type",Array)],KA.prototype,"fields",void 0),BA([Et({attribute:"enable-top-results",reflect:!0,type:Boolean}),VA("design:type",Object)],KA.prototype,"enableTopResults",void 0),BA([Et({attribute:"cache-enabled",reflect:!0,type:Boolean}),VA("design:type",Object)],KA.prototype,"cacheEnabled",void 0),BA([Et({attribute:"cache-invalidation-period",reflect:!0,type:Number}),VA("design:type",Object)],KA.prototype,"cacheInvalidationPeriod",void 0),BA([At(),VA("design:type",Object)],KA.prototype,"response",void 0),BA([At(),VA("design:type",Number),VA("design:paramtypes",[Number])],KA.prototype,"currentPage",null),KA=BA([Tn("search-results"),VA("design:paramtypes",[])],KA);var GA=n(184);const $A=function(){const[t]=function(){const[t,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=()=>{const e=re.globalProvider;n(e&&e.state===te.SignedIn)};return re.onProviderUpdated(e),e(),()=>{re.removeProviderUpdatedListener(e)}}),[]),[t]}();return(0,GA.jsxs)("div",{className:"App",children:[(0,GA.jsx)("header",{children:(0,GA.jsx)(Dn,{})}),(0,GA.jsx)("div",{className:"row",children:(0,GA.jsx)("div",{className:"column",children:t&&(0,GA.jsx)(On,{})})})]})},WA=e=>{e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((t=>{let{getCLS:n,getFID:o,getFCP:r,getLCP:i,getTTFB:s}=t;n(e),o(e),r(e),i(e),s(e)}))};var QA=function(e,t){return QA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},QA(e,t)};function YA(e,t){function n(){this.constructor=e}QA(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ZA,JA,XA=function(){return XA=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},XA.apply(this,arguments)};function eR(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function tR(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))}function nR(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(sL){i=[6,sL],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function oR(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function rR(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(oR(arguments[t]));return e}!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",e.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"}(ZA||(ZA={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(JA||(JA={}));var iR=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]),sR=function(e,t){return sR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},sR(e,t)};function aR(e,t){function n(){this.constructor=e}sR(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var lR=function(){return lR=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},lR.apply(this,arguments)};function cR(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))}function dR(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(sL){i=[6,sL],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function uR(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,r++)o[r]=i[s];return o}var hR,pR,fR,gR,vR,mR={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},yR=[mR.OPENID_SCOPE,mR.PROFILE_SCOPE,mR.OFFLINE_ACCESS_SCOPE],bR=uR(yR,[mR.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(hR||(hR={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(pR||(pR={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(fR||(fR={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(gR||(gR={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(vR||(vR={}));var wR,kR={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(wR||(wR={}));var xR,CR,_R,SR,TR,IR,ER={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(xR||(xR={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(CR||(CR={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(_R||(_R={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(SR||(SR={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(TR||(TR={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(IR||(IR={}));var AR,RR="appmetadata",PR="1",OR="authority-metadata",DR=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(AR||(AR={}));var MR,NR={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(MR||(MR={}));var LR,FR,UR,zR,HR,qR,BR=60,VR=3600,jR="throttling",KR="retry-after, h429",GR="invalid_grant",$R="client_mismatch";!function(e){e.username="username",e.password="password"}(LR||(LR={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(FR||(FR={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(UR||(UR={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(zR||(zR={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4",e.CLAIMS_REQUESTED_CACHE_SKIPPED="5"}(HR||(HR={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(qR||(qR={}));var WR,QR,YR,ZR,JR,XR,eP,tP,nP,oP={code:"unexpected_error",desc:"Unexpected error in authentication."},rP={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},iP=function(e){function t(n,o,r){var i=this,s=o?n+": "+o:n;return i=e.call(this,s)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=n||mR.EMPTY_STRING,i.errorMessage=o||mR.EMPTY_STRING,i.subError=r||mR.EMPTY_STRING,i.name="AuthError",i}return aR(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(oP.code,oP.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(rP.code,rP.desc+": "+e)},t}(Error),sP=function(e){function t(n,o,r){var i=e.call(this,n,o,r)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return aR(t,e),t}(iP),aP=["interaction_required","consent_required","login_required"],lP=["message_only","additional_action","basic_action","user_password_expired","consent_required"],cP={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},dP={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},uP=function(e){function t(n,o,r,i,s,a,l){var c=e.call(this,n,o,r)||this;return Object.setPrototypeOf(c,t.prototype),c.timestamp=i||mR.EMPTY_STRING,c.traceId=s||mR.EMPTY_STRING,c.correlationId=a||mR.EMPTY_STRING,c.claims=l||mR.EMPTY_STRING,c.name="InteractionRequiredAuthError",c}return aR(t,e),t.isInteractionRequiredError=function(e,t,n){var o=!!e&&aP.indexOf(e)>-1,r=!!n&&lP.indexOf(n)>-1,i=!!t&&aP.some((function(e){return t.indexOf(e)>-1}));return o||i||r},t.createNoTokensFoundError=function(){return new t(cP.code,cP.desc)},t.createNativeAccountUnavailableError=function(){return new t(dP.code,dP.desc)},t}(iP),hP="invalid_grant",pP=483,fP=600,gP="msal",vP=30,mP="msal.js.browser",yP="53ee284d-920a-4b59-9d30-a60315b26836",bP="ppnbnpeolgkicgegkbkbjmhlideopiji",wP="MATS";!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(WR||(WR={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(QR||(QR={})),function(e){e.GET="GET",e.POST="POST"}(YR||(YR={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(ZR||(ZR={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(JR||(JR={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(XR||(XR={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(eP||(eP={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(tP||(tP={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(nP||(nP={}));var kP,xP={scopes:yR},CP="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(kP||(kP={}));var _P,SP="msal.db",TP=SP+".keys";!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(_P||(_P={}));var IP,EP={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},AP={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},RP=function(e){function t(n,o){var r=e.call(this,n,o)||this;return r.name="JoseHeaderError",Object.setPrototypeOf(r,t.prototype),r}return aR(t,e),t.createMissingKidError=function(){return new t(EP.code,EP.desc)},t.createMissingAlgError=function(){return new t(AP.code,AP.desc)},t}(iP),PP=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw RP.createMissingKidError();if(!t.alg)throw RP.createMissingAlgError();var n=new e({typ:t.typ||qR.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(n)},e}(),OP=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),DP=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,OP.decimalToHex(e[0])+OP.decimalToHex(e[1])+OP.decimalToHex(e[2])+OP.decimalToHex(e[3])+"-"+OP.decimalToHex(e[4])+OP.decimalToHex(e[5])+"-"+OP.decimalToHex(e[6])+OP.decimalToHex(e[7])+"-"+OP.decimalToHex(e[8])+OP.decimalToHex(e[9])+"-"+OP.decimalToHex(e[10])+OP.decimalToHex(e[11])+OP.decimalToHex(e[12])+OP.decimalToHex(e[13])+OP.decimalToHex(e[14])+OP.decimalToHex(e[15])}catch(s){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",o=0,r=mR.EMPTY_STRING,i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(o=16*Math.random()|0),"x"===t[i]?r+=n[o]:"y"===t[i]?(o&=3,r+=n[o|=8]):r+=t[i];return r}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),MP=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,n=0,o=e.length,r=0;r<o;r++)n+=(t=e.charCodeAt(r))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(n),s=0,a=0;s<n;a++)(t=e.charCodeAt(a))<128?i[s++]=t:t<2048?(i[s++]=192+(t>>>6),i[s++]=128+(63&t)):t<65536?(i[s++]=224+(t>>>12),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<2097152?(i[s++]=240+(t>>>18),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):t<67108864?(i[s++]=248+(t>>>24),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t)):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63),i[s++]=128+(t>>>18&63),i[s++]=128+(t>>>12&63),i[s++]=128+(t>>>6&63),i[s++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);return t},e.utf8ArrToString=function(e){for(var t=mR.EMPTY_STRING,n=void 0,o=e.length,r=0;r<o;r++)n=e[r],t+=String.fromCharCode(n>251&&n<254&&r+5<o?1073741824*(n-252)+(e[++r]-128<<24)+(e[++r]-128<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>247&&n<252&&r+4<o?(n-248<<24)+(e[++r]-128<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>239&&n<248&&r+3<o?(n-240<<18)+(e[++r]-128<<12)+(e[++r]-128<<6)+e[++r]-128:n>223&&n<240&&r+2<o?(n-224<<12)+(e[++r]-128<<6)+e[++r]-128:n>191&&n<224&&r+1<o?(n-192<<6)+e[++r]-128:n);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),NP=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,mR.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,mR.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=MP.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,n=mR.EMPTY_STRING,o=void 0,r=e.length,i=0,s=0;s<r;s++)o=s%3,i|=e[s]<<(16>>>o&24),2!==o&&e.length-s!==1||(n+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?n:n.substring(0,n.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),LP=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var n=this.base64DecToArr(t);return MP.utf8ArrToString(n)},e.prototype.base64DecToArr=function(e,t){for(var n=e.replace(/[^A-Za-z0-9\+\/]/g,mR.EMPTY_STRING),o=n.length,r=t?Math.ceil((3*o+1>>>2)/t)*t:3*o+1>>>2,i=new Uint8Array(r),s=void 0,a=void 0,l=0,c=0,d=0;d<o;d++)if(a=3&d,l|=this.b64ToUint6(n.charCodeAt(d))<<18-6*a,3===a||o-d===1){for(s=0;s<3&&c<r;s++,c++)i[c]=l>>>(16>>>s&24)&255;l=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),FP={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},UP={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},zP={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},HP={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},qP={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},BP={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},VP={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},jP={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},KP={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},GP={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},$P={code:"state_not_found",desc:"State not found"},WP={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},QP={code:"nonce_not_found",desc:"nonce not found"},YP={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},ZP={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},JP={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},XP={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},eO={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tO={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},nO={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},oO={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},rO={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},iO={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},sO={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},aO={code:"device_code_expired",desc:"Device code is expired."},lO={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},cO={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},dO={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},uO={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},hO={code:"no_account_found",desc:"No account found in cache for given key."},pO={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},fO={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},gO={code:"invalid_cache_type",desc:"Invalid cache type"},vO={code:"unexpected_account_type",desc:"Unexpected account type."},mO={code:"unexpected_credential_type",desc:"Unexpected credential type."},yO={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},bO={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},wO={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},kO={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},xO={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},CO={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},_O={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},SO={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},TO={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},IO={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},EO={code:"user_canceled",desc:"User canceled the flow."},AO=function(e){function t(n,o){var r=e.call(this,n,o)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,t.prototype),r}return aR(t,e),t.createClientInfoDecodingError=function(e){return new t(FP.code,FP.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(UP.code,""+UP.desc)},t.createTokenParsingError=function(e){return new t(zP.code,zP.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(HP.code,HP.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(qP.code,qP.desc+" Detail: "+e)},t.createNetworkError=function(e,n){return new t(BP.code,BP.desc+" | Fetch client threw: "+n+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(VP.code,VP.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(jP.code,jP.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,n){return new t(KP.code,KP.desc+" Invalid State: "+e+", Root Err: "+n)},t.createStateMismatchError=function(){return new t(GP.code,GP.desc)},t.createStateNotFoundError=function(e){return new t($P.code,$P.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(WP.code,WP.desc)},t.createAuthTimeNotFoundError=function(){return new t(YP.code,YP.desc)},t.createMaxAgeTranspiredError=function(){return new t(ZP.code,ZP.desc)},t.createNonceNotFoundError=function(e){return new t(QP.code,QP.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(JP.code,JP.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(XP.code,XP.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(eO.code,eO.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(tO.code,tO.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(nO.code,nO.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(oO.code,oO.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(rO.code,rO.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(iO.code,""+iO.desc)},t.createDeviceCodeCancelledError=function(){return new t(sO.code,""+sO.desc)},t.createDeviceCodeExpiredError=function(){return new t(aO.code,""+aO.desc)},t.createDeviceCodeUnknownError=function(){return new t(lO.code,""+lO.desc)},t.createNoAccountInSilentRequestError=function(){return new t(cO.code,""+cO.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(dO.code,dO.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(uO.code,uO.desc)},t.createNoAccountFoundError=function(){return new t(hO.code,hO.desc)},t.createCachePluginError=function(){return new t(pO.code,""+pO.desc)},t.createNoCryptoObjectError=function(e){return new t(fO.code,""+fO.desc+e)},t.createInvalidCacheTypeError=function(){return new t(gO.code,""+gO.desc)},t.createUnexpectedAccountTypeError=function(){return new t(vO.code,""+vO.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(mO.code,""+mO.desc)},t.createInvalidAssertionError=function(){return new t(yO.code,""+yO.desc)},t.createInvalidCredentialError=function(){return new t(bO.code,""+bO.desc)},t.createRefreshRequiredError=function(){return new t(wO.code,wO.desc)},t.createUserTimeoutReachedError=function(){return new t(kO.code,kO.desc)},t.createTokenClaimsRequiredError=function(){return new t(xO.code,xO.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(CO.code,CO.desc)},t.createBindingKeyNotRemovedError=function(){return new t(_O.code,_O.desc)},t.createLogoutNotSupportedError=function(){return new t(SO.code,SO.desc)},t.createKeyIdMissingError=function(){return new t(TO.code,TO.desc)},t.createNoNetworkConnectivityError=function(){return new t(IO.code,IO.desc)},t.createUserCanceledError=function(){return new t(EO.code,EO.desc)},t}(iP),RO=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw AO.createTokenNullOrEmptyError(t);var n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw AO.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:n[1],JWSPayload:n[2],JWSSig:n[3]}},e.isEmpty=function(e){return"undefined"===typeof e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var n=JSON.parse(t);return 0===Object.keys(n).length}catch(sL){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},n=e.split("&"),o=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return n.forEach((function(e){if(e.trim()){var n=e.split(/=(.+)/g,2),r=n[0],i=n[1];r&&i&&(t[o(r)]=o(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(sL){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}(),PO={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},OO={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},DO={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},MO={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},NO={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},LO={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},FO={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},UO={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},zO={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},HO={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},qO={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},BO={code:"empty_window_error",desc:"window.open returned null or undefined window object."},VO={code:"user_cancelled",desc:"User cancelled the flow."},jO={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},KO={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},GO={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},$O={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},WO={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},QO={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},YO={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},ZO={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},JO={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},XO={code:"no_token_request_cache_error",desc:"No token request found in cache."},eD={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},tD={code:"no_cached_authority_error",desc:"No cached authority found."},nD={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},oD={code:"invalid_cache_type",desc:"Invalid cache type"},rD={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},iD={code:"database_not_open",desc:"Database is not open!"},sD={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},aD={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},lD={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},cD={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},dD={code:"unable_to_load_token",desc:"Error loading token to cache."},uD={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},hD={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},pD={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},fD={code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},gD={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},vD={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},mD={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},yD={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},bD={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},wD={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},kD={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},xD=function(e){function t(n,o){var r=e.call(this,n,o)||this;return Object.setPrototypeOf(r,t.prototype),r.name="BrowserAuthError",r}return YA(t,e),t.createPkceNotGeneratedError=function(e){return new t(PO.code,PO.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(OO.code,OO.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(DO.code,DO.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(MO.code,MO.desc)},t.createEmptyHashError=function(e){return new t(NO.code,NO.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(LO.code,LO.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(FO.code,FO.desc)},t.createUnableToParseStateError=function(){return new t(UO.code,UO.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(zO.code,zO.desc)},t.createInteractionInProgressError=function(){return new t(HO.code,HO.desc)},t.createPopupWindowError=function(e){var n=qO.desc;return n=RO.isEmpty(e)?n:n+" Details: "+e,new t(qO.code,n)},t.createEmptyWindowCreatedError=function(){return new t(BO.code,BO.desc)},t.createUserCancelledError=function(){return new t(VO.code,VO.desc)},t.createMonitorPopupTimeoutError=function(){return new t(jO.code,jO.desc)},t.createMonitorIframeTimeoutError=function(){return new t(KO.code,KO.desc)},t.createRedirectInIframeError=function(e){return new t(GO.code,GO.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t($O.code,$O.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(WO.code,WO.desc)},t.createIframeClosedPrematurelyError=function(){return new t(QO.code,QO.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(YO.code,YO.desc)},t.createNoAccountError=function(){return new t(ZO.code,ZO.desc)},t.createSilentPromptValueError=function(e){return new t(JO.code,JO.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(eD.code,eD.desc)},t.createNoTokenRequestCacheError=function(){return new t(XO.code,XO.desc)},t.createAuthRequestNotSetError=function(){return new t(nD.code,nD.desc)},t.createNoCachedAuthorityError=function(){return new t(tD.code,tD.desc)},t.createInvalidCacheTypeError=function(){return new t(oD.code,""+oD.desc)},t.createNonBrowserEnvironmentError=function(){return new t(rD.code,rD.desc)},t.createDatabaseNotOpenError=function(){return new t(iD.code,iD.desc)},t.createNoNetworkConnectivityError=function(){return new t(sD.code,sD.desc)},t.createPostRequestFailedError=function(e,n){return new t(aD.code,aD.desc+" | Network client threw: "+e+" | Attempted to reach: "+n.split("?")[0])},t.createGetRequestFailedError=function(e,n){return new t(lD.code,lD.desc+" | Network client threw: "+e+" | Attempted to reach: "+n.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(cD.code,cD.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(dD.code,dD.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(uD.code,uD.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(hD.code,hD.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(pD.code,pD.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t(fD.code,fD.desc)},t.createDatabaseUnavailableError=function(){return new t(gD.code,gD.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(vD.code,vD.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(mD.code,mD.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(yD.code,yD.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(bD.code,bD.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(wD.code,wD.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(kD.code,kD.desc)},t}(iP),CD=function(){function e(e){this.base64Encode=new NP,this.cryptoObj=e}return e.prototype.generateCodes=function(){return tR(this,void 0,void 0,(function(){var e,t;return nR(this,(function(n){switch(n.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=n.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(sL){throw xD.createPkceNotGeneratedError(sL)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return tR(this,void 0,void 0,(function(){var t,n;return nR(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=o.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw n=o.sent(),xD.createPkceNotGeneratedError(n);case 3:return[2]}}))}))},e}(),_D=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,window.crypto.subtle.generateKey(e,t,n)]}))}))},e.prototype.exportKey=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){return[2,window.crypto.subtle.exportKey(CP,e)]}))}))},e.prototype.importKey=function(e,t,n,o){return tR(this,void 0,void 0,(function(){return nR(this,(function(r){return[2,window.crypto.subtle.importKey(CP,e,t,n,o)]}))}))},e.prototype.sign=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,window.crypto.subtle.sign(e,t,n)]}))}))},e.prototype.digest=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),SD=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(rR(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,window.msrCrypto.subtle.generateKey(e,t,n)]}))}))},e.prototype.exportKey=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){return[2,window.msrCrypto.subtle.exportKey(CP,e)]}))}))},e.prototype.importKey=function(e,t,n,o){return tR(this,void 0,void 0,(function(){return nR(this,(function(r){return[2,window.msrCrypto.subtle.importKey(CP,e,t,n,o)]}))}))},e.prototype.sign=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,window.msrCrypto.subtle.sign(e,t,n)]}))}))},e.prototype.digest=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),TD=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,new Promise((function(o,r){var i=window.msCrypto.subtle.generateKey(e,t,n);i.addEventListener("complete",(function(e){o(e.target.result)})),i.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.exportKey=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){return[2,new Promise((function(t,n){var o=window.msCrypto.subtle.exportKey(CP,e);o.addEventListener("complete",(function(e){var o=e.target.result,r=MP.utf8ArrToString(new Uint8Array(o)).replace(/\r/g,mR.EMPTY_STRING).replace(/\n/g,mR.EMPTY_STRING).replace(/\t/g,mR.EMPTY_STRING).split(" ").join(mR.EMPTY_STRING).replace("\0",mR.EMPTY_STRING);try{t(JSON.parse(r))}catch(e){n(e)}})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.importKey=function(e,t,n,o){return tR(this,void 0,void 0,(function(){var r,i;return nR(this,(function(s){return r=MP.getSortedObjectString(e),i=MP.stringToArrayBuffer(r),[2,new Promise((function(e,r){var s=window.msCrypto.subtle.importKey(CP,i,t,n,o);s.addEventListener("complete",(function(t){e(t.target.result)})),s.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.sign=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,new Promise((function(o,r){var i=window.msCrypto.subtle.sign(e,t,n);i.addEventListener("complete",(function(e){o(e.target.result)})),i.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.digest=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,new Promise((function(n,o){var r=window.msCrypto.subtle.digest(e,t.buffer);r.addEventListener("complete",(function(e){n(e.target.result)})),r.addEventListener("error",(function(e){o(e)}))}))]}))}))},e}(),ID={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},ED={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},AD={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},RD={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},PD={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},OD={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},DD={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},MD=function(e){function t(n,o){var r=e.call(this,n,o)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,t.prototype),r}return YA(t,e),t.createRedirectUriEmptyError=function(){return new t(ID.code,ID.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(ED.code,ED.desc)},t.createStorageNotSupportedError=function(e){return new t(AD.code,AD.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(RD.code,RD.desc)},t.createStubPcaInstanceCalledError=function(){return new t(PD.code,PD.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(OD.code,OD.desc)},t.createEntropyNotProvided=function(){return new t(DD.code,DD.desc)},t}(iP),ND="SHA-256",LD=new Uint8Array([1,0,1]),FD=function(){function e(e,t){var n,o;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new _D;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new TD;else{if(!this.hasMsrCrypto()||!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),xD.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new SD}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(o=this.cryptoOptions)||void 0===o?void 0:o.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),MD.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:ND,modulusLength:2048,publicExponent:LD}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){return t=MP.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:ND},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,n)]}))}))},e.prototype.sign=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),UD=function(){function e(){this.dbName=SP,this.version=1,this.tableName=TP,this.dbOpen=!1}return e.prototype.open=function(){return tR(this,void 0,void 0,(function(){var e=this;return nR(this,(function(t){return[2,new Promise((function(t,n){var o=window.indexedDB.open(e.dbName,e.version);o.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),o.addEventListener("success",(function(n){var o=n;e.db=o.target.result,e.dbOpen=!0,t()})),o.addEventListener("error",(function(){return n(xD.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return tR(this,void 0,void 0,(function(){return nR(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return tR(this,void 0,void 0,(function(){var t=this;return nR(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!t.db)return o(xD.createDatabaseNotOpenError());var r=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);r.addEventListener("success",(function(e){var o=e;t.closeConnection(),n(o.target.result)})),r.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return tR(this,void 0,void 0,(function(){var n=this;return nR(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,r){if(!n.db)return r(xD.createDatabaseNotOpenError());var i=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).put(t,e);i.addEventListener("success",(function(){n.closeConnection(),o()})),i.addEventListener("error",(function(e){n.closeConnection(),r(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return tR(this,void 0,void 0,(function(){var t=this;return nR(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!t.db)return o(xD.createDatabaseNotOpenError());var r=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);r.addEventListener("success",(function(){t.closeConnection(),n()})),r.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},e.prototype.getKeys=function(){return tR(this,void 0,void 0,(function(){var e=this;return nR(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,n){if(!e.db)return n(xD.createDatabaseNotOpenError());var o=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();o.addEventListener("success",(function(n){var o=n;e.closeConnection(),t(o.target.result)})),o.addEventListener("error",(function(t){e.closeConnection(),n(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return tR(this,void 0,void 0,(function(){var t=this;return nR(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,o){if(!t.db)return o(xD.createDatabaseNotOpenError());var r=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);r.addEventListener("success",(function(e){var o=e;t.closeConnection(),n(1===o.target.result)})),r.addEventListener("error",(function(e){t.closeConnection(),o(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return tR(this,void 0,void 0,(function(){return nR(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var n=window.indexedDB.deleteDatabase(SP);n.addEventListener("success",(function(){return e(!0)})),n.addEventListener("blocked",(function(){return e(!0)})),n.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),zD=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,n){e.push(n)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),HD=function(){function e(e,t){this.inMemoryCache=new zD,this.indexedDBCache=new UD,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof xD&&e.errorCode===gD.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return tR(this,void 0,void 0,(function(){var t,n;return nR(this,(function(o){switch(o.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,o.sent()];case 3:return n=o.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return tR(this,void 0,void 0,(function(){var n;return nR(this,(function(o){switch(o.label){case 0:this.inMemoryCache.setItem(e,t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return o.sent(),[3,4];case 3:return n=o.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){switch(n.label){case 0:this.inMemoryCache.removeItem(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return tR(this,void 0,void 0,(function(){var e,t;return nR(this,(function(n){switch(n.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,n.sent()];case 3:return t=n.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return tR(this,void 0,void 0,(function(){var t,n;return nR(this,(function(o){switch(o.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,o.sent()];case 3:return n=o.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return tR(this,void 0,void 0,(function(){var e,t;return nR(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=n.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=n.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(IP||(IP={}));var qD,BD=function(){function e(e){this.logger=e,this.asymmetricKeys=new HD(this.logger,IP.asymmetricKeys),this.symmetricKeys=new HD(this.logger,IP.symmetricKeys)}return e.prototype.clear=function(){return tR(this,void 0,void 0,(function(){var e;return nR(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),VD=function(){function e(e,t,n){this.logger=e,this.browserCrypto=new FD(this.logger,n),this.b64Encode=new NP,this.b64Decode=new LP,this.guidGenerator=new DP(this.browserCrypto),this.pkceGenerator=new CD(this.browserCrypto),this.cache=new BD(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return tR(this,void 0,void 0,(function(){return nR(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var n;return tR(this,void 0,void 0,(function(){var o,r,i,s,a,l,c,d;return nR(this,(function(u){switch(u.label){case 0:return o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(ZA.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=u.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return i=u.sent(),s={e:i.e,kty:i.kty,n:i.n},a=MP.getSortedObjectString(s),[4,this.hashString(a)];case 3:return l=u.sent(),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return c=u.sent(),[4,this.browserCrypto.importJwk(c,!1,["sign"])];case 5:return d=u.sent(),[4,this.cache.asymmetricKeys.setItem(l,{privateKey:d,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return u.sent(),o&&o.endMeasurement({success:!0}),[2,l]}}))}))},e.prototype.removeTokenBindingKey=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return tR(this,void 0,void 0,(function(){return nR(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,n){var o;return tR(this,void 0,void 0,(function(){var r,i,s,a,l,c,d,u,h,p,f,g,v;return nR(this,(function(m){switch(m.label){case 0:return r=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ZA.CryptoOptsSignJwt,n),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(i=m.sent()))throw xD.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return s=m.sent(),a=MP.getSortedObjectString(s),l=this.b64Encode.urlEncode(JSON.stringify({kid:t})),c=PP.getShrHeaderString({kid:l,alg:s.alg}),d=this.b64Encode.urlEncode(c),e.cnf={jwk:JSON.parse(a)},u=this.b64Encode.urlEncode(JSON.stringify(e)),h=d+"."+u,p=MP.stringToArrayBuffer(h),[4,this.browserCrypto.sign(i.privateKey,p)];case 3:return f=m.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(f)),v=h+"."+g,r&&r.endMeasurement({success:!0}),[2,v]}}))}))},e.prototype.hashString=function(e){return tR(this,void 0,void 0,(function(){var t,n;return nR(this,(function(o){switch(o.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=o.sent(),n=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(n)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(qD||(qD={}));var jD,KD=function(){function e(t,n,o){this.level=qD.Info;var r=t||e.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||function(){},this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:qD.Info,this.correlationId=r.correlationId||mR.EMPTY_STRING,this.packageName=n||mR.EMPTY_STRING,this.packageVersion=o||mR.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:qD.Info}},e.prototype.clone=function(t,n,o){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},t,n)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var n=(new Date).toUTCString(),o=(RO.isEmpty(t.correlationId)?RO.isEmpty(this.correlationId)?"["+n+"]":"["+n+"] : ["+this.correlationId+"]":"["+n+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+qD[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,o,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:qD.Error,containsPii:!1,correlationId:t||mR.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:qD.Error,containsPii:!0,correlationId:t||mR.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:qD.Warning,containsPii:!1,correlationId:t||mR.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:qD.Warning,containsPii:!0,correlationId:t||mR.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:qD.Info,containsPii:!1,correlationId:t||mR.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:qD.Info,containsPii:!0,correlationId:t||mR.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:qD.Verbose,containsPii:!1,correlationId:t||mR.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:qD.Verbose,containsPii:!0,correlationId:t||mR.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:qD.Trace,containsPii:!1,correlationId:t||mR.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:qD.Trace,containsPii:!0,correlationId:t||mR.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),GD=function(){function e(e,t,n,o,r,i){this.authority=t,this.libraryName=o,this.libraryVersion=r,this.applicationTelemetry=i,this.clientId=e,this.logger=n,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return iR},e.prototype.getPreQueueTime=function(e,t){var n=this.preQueueTimeByCorrelationId.get(t);if(n){if(n.name===e)return n.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,n,o){if(t){if(0===n)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+n);else if(!n)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var r={eventName:e,queueTime:n,manuallyCompleted:o},i=this.queueMeasurements.get(t);if(i)i.push(r),this.queueMeasurements.set(t,i);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var s=[r];this.queueMeasurements.set(t,s)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var n,o,r=this,i=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",i),this.logger.trace("PerformanceClient: Performance measurement started for "+e,i);var s=this.startPerformanceMeasuremeant(e,i);s.startMeasurement();var a={eventId:this.generateId(),status:JA.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:i,appName:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appName,appVersion:null===(o=this.applicationTelemetry)||void 0===o?void 0:o.appVersion};return this.cacheEventByCorrelationId(a),{endMeasurement:function(e){return r.endMeasurement(lR(lR({},a),e),s)},discardMeasurement:function(){return r.discardMeasurements(a.correlationId)},addStaticFields:function(e){return r.addStaticFields(e,a.correlationId)},increment:function(e){return r.increment(e,a.correlationId)},measurement:s,event:a}},e.prototype.endMeasurement=function(e,t){var n,o,r=this,i=this.eventsByCorrelationId.get(e.correlationId);if(!i)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var s=e.eventId===i.eventId,a={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};s?(a=this.getQueueInfo(e.correlationId),this.discardCache(i.correlationId)):null===(n=i.incompleteSubMeasurements)||void 0===n||n.delete(e.eventId),null===t||void 0===t||t.endMeasurement();var l=null===t||void 0===t?void 0:t.flushMeasurement();if(!l)return this.logger.trace("PerformanceClient: Performance measurement not taken",i.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+l+" ms",e.correlationId),!s)return i[e.name+"DurationMs"]=Math.floor(l),lR({},i);var c=lR(lR({},i),e),d=0;return null===(o=c.incompleteSubMeasurements)||void 0===o||o.forEach((function(t){r.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,c.correlationId),d++})),c.incompleteSubMeasurements=void 0,c=lR(lR({},c),{durationMs:Math.round(l),queuedTimeMs:a.totalQueueTime,queuedCount:a.totalQueueCount,queuedManuallyCompletedCount:a.manuallyCompletedCount,status:JA.Completed,incompleteSubsCount:d}),this.truncateIntegralFields(c,this.getIntFields()),this.emitEvents([c],e.correlationId),c},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var n=this.eventsByCorrelationId.get(t);n?this.eventsByCorrelationId.set(t,lR(lR({},n),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var n=this.eventsByCorrelationId.get(t);if(n)for(var o in e)n.hasOwnProperty(o)||(n[o]=0),n[o]+=e[o];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,lR({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var n=0,o=0,r=0;return null===t||void 0===t||t.forEach((function(e){n+=e.queueTime,o++,r+=e.manuallyCompleted?1:0})),{totalQueueTime:n,totalQueueCount:o,manuallyCompletedCount:r}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var n=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(o,r){n.logger.trace("PerformanceClient: Emitting event to callback "+r,t),o.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"===typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),$D=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),WD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new $D},t.prototype.startPerformanceMeasurement=function(){return new $D},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,n){},t.prototype.setPreQueueTime=function(e,t){},t}(GD),QD={createNewGuid:function(){throw iP.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw iP.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw iP.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",iP.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",iP.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",iP.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",iP.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",iP.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Crypto interface - hashString() has not been implemented",iP.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},YD=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case TR.ID_TOKEN:return IR.ID_TOKEN;case TR.ACCESS_TOKEN:case TR.ACCESS_TOKEN_WITH_AUTH_SCHEME:return IR.ACCESS_TOKEN;case TR.REFRESH_TOKEN:return IR.REFRESH_TOKEN;default:throw AO.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,n,o,r,i,s,a,l){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(n,o,r,s),this.generateTargetForCacheKey(i),this.generateClaimsHashForCacheKey(l),this.generateSchemeForCacheKey(a)].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,n,o){return[e,e===TR.REFRESH_TOKEN&&o||t,n||mR.EMPTY_STRING].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||mR.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||mR.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==MR.BEARER.toLowerCase()?e.toLowerCase():mR.EMPTY_STRING},e}(),ZD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.createIdTokenEntity=function(e,n,o,r,i){var s=new t;return s.credentialType=TR.ID_TOKEN,s.homeAccountId=e,s.environment=n,s.clientId=r,s.secret=o,s.realm=i,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===TR.ID_TOKEN)},t}(YD),JD={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},XD={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},eM={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},tM={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},nM={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},oM={code:"empty_url_error",desc:"URL was empty or null."},rM={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},iM={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},sM={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},aM={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},lM={code:"token_request_empty",desc:"Token request was empty and not found in cache."},cM={code:"logout_request_empty",desc:"The logout request was null or undefined."},dM={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},uM={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},hM={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},pM={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},fM={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},gM={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},vM={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},mM={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},yM={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},bM={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},wM={code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},kM=function(e){function t(n,o){var r=e.call(this,n,o)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,t.prototype),r}return aR(t,e),t.createRedirectUriEmptyError=function(){return new t(JD.code,JD.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(XD.code,XD.desc)},t.createClaimsRequestParsingError=function(e){return new t(eM.code,eM.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(tM.code,tM.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(nM.code,nM.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(oM.code,oM.desc)},t.createEmptyScopesArrayError=function(){return new t(rM.code,""+rM.desc)},t.createClientIdSingleScopeError=function(e){return new t(iM.code,iM.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(sM.code,sM.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(aM.code,aM.desc)},t.createEmptyLogoutRequestError=function(){return new t(cM.code,cM.desc)},t.createEmptyTokenRequestError=function(){return new t(lM.code,lM.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(dM.code,dM.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(uM.code,uM.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(hM.code,hM.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(pM.code,pM.desc)},t.createUntrustedAuthorityError=function(){return new t(fM.code,fM.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(gM.code,gM.desc)},t.createMissingSshJwkError=function(){return new t(vM.code,vM.desc)},t.createMissingSshKidError=function(){return new t(mM.code,mM.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(yM.code,yM.desc)},t.createInvalidAuthenticationHeaderError=function(e,n){return new t(bM.code,bM.desc+". Invalid header: "+e+". Details: "+n)},t.createAuthorityMismatchError=function(){return new t(wM.code,wM.desc)},t}(AO),xM=function(){function e(e){var t=this,n=e?RO.trimArrayEntries(uR(e)):[],o=n?RO.removeEmptyStringsFromArray(n):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||mR.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var n=new e(t);return n.containsOnlyOIDCScopes()?n.removeScope(mR.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw kM.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var n=new e(this.printScopesLowerCase().split(" "));return!RO.isEmpty(t)&&n.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return bR.forEach((function(n){e.containsScope(n)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){RO.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(sL){throw AO.createAppendScopeSetError(sL)}},e.prototype.removeScope=function(e){if(RO.isEmpty(e))throw AO.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;bR.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw AO.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw AO.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),n=e.getScopeCount(),o=this.getScopeCount();return t.size<o+n},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):mR.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function CM(e,t){if(RO.isEmpty(e))throw AO.createClientInfoEmptyError();try{var n=t.base64Decode(e);return JSON.parse(n)}catch(sL){throw AO.createClientInfoDecodingError(sL.message)}}function _M(e){if(RO.isEmpty(e))throw AO.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(SR.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?mR.EMPTY_STRING:t[1]}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(jD||(jD={}));var SM,TM=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case _R.ADFS_ACCOUNT_TYPE:return IR.ADFS;case _R.MSAV1_ACCOUNT_TYPE:return IR.MSA;case _R.MSSTS_ACCOUNT_TYPE:return IR.MSSTS;case _R.GENERIC_ACCOUNT_TYPE:return IR.GENERIC;default:throw AO.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||mR.EMPTY_STRING,e.tenantId||mR.EMPTY_STRING].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,n,o,r,i,s,a,l){var c,d,u,h,p,f,g=new e;g.authorityType=_R.MSSTS_ACCOUNT_TYPE,g.clientInfo=t,g.homeAccountId=n,g.nativeAccountId=l;var v=a||r&&r.getPreferredCache();if(!v)throw AO.createInvalidCacheEnvironmentError();if(g.environment=v,g.realm=(null===(c=null===o||void 0===o?void 0:o.claims)||void 0===c?void 0:c.tid)||mR.EMPTY_STRING,o){g.idTokenClaims=o.claims,g.localAccountId=(null===(d=null===o||void 0===o?void 0:o.claims)||void 0===d?void 0:d.oid)||(null===(u=null===o||void 0===o?void 0:o.claims)||void 0===u?void 0:u.sub)||mR.EMPTY_STRING;var m=null===(h=null===o||void 0===o?void 0:o.claims)||void 0===h?void 0:h.preferred_username,y=(null===(p=null===o||void 0===o?void 0:o.claims)||void 0===p?void 0:p.emails)?o.claims.emails[0]:null;g.username=m||y||mR.EMPTY_STRING,g.name=null===(f=null===o||void 0===o?void 0:o.claims)||void 0===f?void 0:f.name}return g.cloudGraphHostName=i,g.msGraphHost=s,g},e.createGenericAccount=function(t,n,o,r,i,s){var a,l,c,d,u=new e;u.authorityType=o&&o.authorityType===jD.Adfs?_R.ADFS_ACCOUNT_TYPE:_R.GENERIC_ACCOUNT_TYPE,u.homeAccountId=t,u.realm=mR.EMPTY_STRING;var h=s||o&&o.getPreferredCache();if(!h)throw AO.createInvalidCacheEnvironmentError();return n&&(u.localAccountId=(null===(a=null===n||void 0===n?void 0:n.claims)||void 0===a?void 0:a.oid)||(null===(l=null===n||void 0===n?void 0:n.claims)||void 0===l?void 0:l.sub)||mR.EMPTY_STRING,u.username=(null===(c=null===n||void 0===n?void 0:n.claims)||void 0===c?void 0:c.upn)||mR.EMPTY_STRING,u.name=(null===(d=null===n||void 0===n?void 0:n.claims)||void 0===d?void 0:d.name)||mR.EMPTY_STRING,u.idTokenClaims=null===n||void 0===n?void 0:n.claims),u.environment=h,u.cloudGraphHostName=r,u.msGraphHost=i,u},e.generateHomeAccountId=function(e,t,n,o,r){var i,s=(null===(i=null===r||void 0===r?void 0:r.claims)||void 0===i?void 0:i.sub)?r.claims.sub:mR.EMPTY_STRING;if(t===jD.Adfs||t===jD.Dsts)return s;if(e)try{var a=CM(e,o);if(!RO.isEmpty(a.uid)&&!RO.isEmpty(a.utid))return""+a.uid+SR.CLIENT_INFO_SEPARATOR+a.utid}catch(sL){}return n.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,n){if(!e||!t)return!1;var o=!0;if(n){var r=e.idTokenClaims||{},i=t.idTokenClaims||{};o=r.iat===i.iat&&r.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o},e}(),IM=function(){function e(t,n){if(RO.isEmpty(t))throw AO.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,n)}return e.extractTokenClaims=function(e,t){var n=RO.decodeAuthToken(e);try{var o=n.JWSPayload,r=t.base64Decode(o);return JSON.parse(r)}catch(i){throw AO.createTokenParsingError(i)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw AO.createMaxAgeTranspiredError()},e}(),EM="@azure/msal-common",AM="13.3.1",RM=function(){function e(e,t,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(EM,AM)}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var n=t.reduce((function(t,n){var o=e.getAccount(n);return o?(t.push(o),t):t}),[]);return n.length<1?[]:n.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},e.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),n=this.getIdToken(t);return n&&(t.idToken=n.secret,t.idTokenClaims=new IM(n.secret,this.cryptoImpl).claims),t},e.prototype.saveCacheRecord=function(e){return cR(this,void 0,void 0,(function(){return dR(this,(function(t){switch(t.label){case 0:if(!e)throw AO.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return cR(this,void 0,void 0,(function(){var t,n,o,r,i=this;return dR(this,(function(s){switch(s.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=xM.fromString(e.target),r=[],n.accessToken.forEach((function(e){if(i.accessTokenKeyMatchesFilter(e,t,!1)){var n=i.getAccessTokenCredential(e);if(n&&i.credentialMatchesFilter(n,t))xM.fromString(n.target).intersectingScopeSets(o)&&r.push(i.removeAccessToken(e))}})),[4,Promise.all(r)];case 1:return s.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,n=this.getAccountKeys(),o=[];return n.forEach((function(n){if(t.isAccountKey(n,e.homeAccountId,e.realm)){var r=t.getAccount(n);r&&(e.homeAccountId&&!t.matchHomeAccountId(r,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(r,e.localAccountId)||e.username&&!t.matchUsername(r,e.username)||e.environment&&!t.matchEnvironment(r,e.environment)||e.realm&&!t.matchRealm(r,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(r,e.nativeAccountId)||o.push(r))}})),o},e.prototype.isAccountKey=function(e,t,n){return!(e.split(SR.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(n&&!e.toLowerCase().includes(n.toLowerCase())))},e.prototype.isCredentialKey=function(e){if(e.split(SR.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(TR.ID_TOKEN.toLowerCase())&&-1===t.indexOf(TR.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(TR.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(TR.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(TR.REFRESH_TOKEN.toLowerCase())>-1){var n=""+TR.REFRESH_TOKEN+SR.CACHE_KEY_SEPARATOR+this.clientId+SR.CACHE_KEY_SEPARATOR,o=""+TR.REFRESH_TOKEN+SR.CACHE_KEY_SEPARATOR+PR+SR.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(n.toLowerCase())&&-1===t.indexOf(o.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===TR.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===MR.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var n=this,o=this.getKeys(),r={};return o.forEach((function(o){if(n.isAppMetadata(o)){var i=n.getAppMetadata(o);i&&(e&&!n.matchEnvironment(i,e)||t&&!n.matchClientId(i,t)||(r[o]=i))}})),r},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,n=this.getAuthorityMetadataKeys(),o=null;return n.forEach((function(n){if(t.isAuthorityMetadata(n)&&-1!==n.indexOf(t.clientId)){var r=t.getAuthorityMetadata(n);r&&-1!==r.aliases.indexOf(e)&&(o=r)}})),o},e.prototype.removeAllAccounts=function(){return cR(this,void 0,void 0,(function(){var e,t,n=this;return dR(this,(function(o){switch(o.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(n.removeAccount(e))})),[4,Promise.all(t)];case 1:return o.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return cR(this,void 0,void 0,(function(){var t;return dR(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccount(e)))throw AO.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return n.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return cR(this,void 0,void 0,(function(){var t,n,o,r=this;return dR(this,(function(i){switch(i.label){case 0:return t=this.getTokenKeys(),n=e.generateAccountId(),o=[],t.idToken.forEach((function(e){0===e.indexOf(n)&&r.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(n)&&o.push(r.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(n)&&r.removeRefreshToken(e)})),[4,Promise.all(o)];case 1:return i.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return cR(this,void 0,void 0,(function(){var t,n;return dR(this,(function(o){switch(o.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==TR.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==MR.POP)return[3,4];if(!(n=t.keyId))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(n)];case 2:return o.sent(),[3,4];case 3:throw o.sent(),AO.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,n){var o=this.getTokenKeys(),r=this.readAccountFromCache(e),i=this.getIdToken(e,o),s=this.getAccessToken(e,t,o),a=this.getRefreshToken(e,!1,o),l=this.readAppMetadataFromCache(n);return r&&i&&(r.idTokenClaims=new IM(i.secret,this.cryptoImpl).claims),{account:r,idToken:i,accessToken:s,refreshToken:a,appMetadata:l}},e.prototype.readAccountFromCache=function(e){var t=TM.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.getIdToken=function(e,t){var n=this;this.commonLogger.trace("CacheManager - getIdToken called");var o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:TR.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},r=this.getIdTokensByFilter(o,t),i=r.length;return i<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):i>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),r.forEach((function(e){n.removeIdToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),r[0])},e.prototype.getIdTokensByFilter=function(e,t){var n=this,o=t&&t.idToken||this.getTokenKeys().idToken,r=[];return o.forEach((function(t){if(n.idTokenKeyMatchesFilter(t,lR({clientId:n.clientId},e))){var o=n.getIdTokenCredential(t);o&&n.credentialMatchesFilter(o,e)&&r.push(o)}})),r},e.prototype.idTokenKeyMatchesFilter=function(e,t){var n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,n){var o=this;this.commonLogger.trace("CacheManager - getAccessToken called");var r=xM.createSearchScopes(t.scopes),i=t.authenticationScheme||MR.BEARER,s=i&&i.toLowerCase()!==MR.BEARER.toLowerCase()?TR.ACCESS_TOKEN_WITH_AUTH_SCHEME:TR.ACCESS_TOKEN,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:e.tenantId,target:r,tokenType:i,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=n&&n.accessToken||this.getTokenKeys().accessToken,c=[];l.forEach((function(e){if(o.accessTokenKeyMatchesFilter(e,a,!0)){var t=o.getAccessTokenCredential(e);t&&o.credentialMatchesFilter(t,a)&&c.push(t)}}));var d=c.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),c.forEach((function(e){o.removeAccessToken(e.generateCredentialKey())})),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),c[0])},e.prototype.accessTokenKeyMatchesFilter=function(e,t,n){var o=e.toLowerCase();if(t.clientId&&-1===o.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===o.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===o.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===o.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var r=t.target.asArray(),i=0;i<r.length;i++){if(n&&!o.includes(r[i].toLowerCase()))return!1;if(!n&&o.includes(r[i].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,n=this.getTokenKeys(),o=[];return n.accessToken.forEach((function(n){if(t.accessTokenKeyMatchesFilter(n,e,!0)){var r=t.getAccessTokenCredential(n);r&&t.credentialMatchesFilter(r,e)&&o.push(r)}})),o},e.prototype.getRefreshToken=function(e,t,n){var o=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var r=t?PR:void 0,i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:TR.REFRESH_TOKEN,clientId:this.clientId,familyId:r},s=n&&n.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((function(e){if(o.refreshTokenKeyMatchesFilter(e,i)){var t=o.getRefreshTokenCredential(e);t&&o.credentialMatchesFilter(t,i)&&a.push(t)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){var n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))},e.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),o=Object.keys(n).map((function(e){return n[e]})),r=o.length;if(r<1)return null;if(r>1)throw AO.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==PR)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!==typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!==typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==TR.ACCESS_TOKEN&&e.credentialType!==TR.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&xM.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(RR)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(OR)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return OR+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var n in t)e[n]=t[n];return e},e}(),PM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.prototype.setAccount=function(){throw iP.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw iP.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw iP.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw iP.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw iP.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw iP.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw iP.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw iP.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw iP.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw iP.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw iP.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw iP.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw iP.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw iP.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw iP.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw iP.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw iP.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",iP.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw iP.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(RM),OM=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,n){var o=Number(t)||0;return e.nowSeconds()+n>o},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))},e}(),DM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.createAccessTokenEntity=function(e,n,o,r,i,s,a,l,c,d,u,h,p,f,g){var v,m,y=new t;y.homeAccountId=e,y.credentialType=TR.ACCESS_TOKEN,y.secret=o;var b=OM.nowSeconds();if(y.cachedAt=b.toString(),y.expiresOn=a.toString(),y.extendedExpiresOn=l.toString(),d&&(y.refreshOn=d.toString()),y.environment=n,y.clientId=r,y.realm=i,y.target=s,y.userAssertionHash=h,y.tokenType=RO.isEmpty(u)?MR.BEARER:u,f&&(y.requestedClaims=f,y.requestedClaimsHash=g),(null===(v=y.tokenType)||void 0===v?void 0:v.toLowerCase())!==MR.BEARER.toLowerCase())switch(y.credentialType=TR.ACCESS_TOKEN_WITH_AUTH_SCHEME,y.tokenType){case MR.POP:var w=IM.extractTokenClaims(o,c);if(!(null===(m=null===w||void 0===w?void 0:w.cnf)||void 0===m?void 0:m.kid))throw AO.createTokenClaimsRequiredError();y.keyId=w.cnf.kid;break;case MR.SSH:y.keyId=p}return y},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===TR.ACCESS_TOKEN||e.credentialType===TR.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(YD),MM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aR(t,e),t.createRefreshTokenEntity=function(e,n,o,r,i,s){var a=new t;return a.clientId=r,a.credentialType=TR.REFRESH_TOKEN,a.environment=n,a.homeAccountId=e,a.secret=o,a.userAssertionHash=s,i&&(a.familyId=i),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===TR.REFRESH_TOKEN)},t}(YD),NM=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[RR,e,t].join(SR.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,n,o){var r=new e;return r.clientId=t,r.environment=n,o&&(r.familyId=o),r},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(RR)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),LM=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var n=0===e.indexOf(NR.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&o},e}(),FM=function(){function e(){this.expiresAt=OM.nowSeconds()+DR}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=OM.nowSeconds()+DR},e.prototype.isExpired=function(){return this.expiresAt<=OM.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(OR)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}(),UM=function(){function e(){}return e.isThrottlingEntity=function(e,t){var n=!1;e&&(n=0===e.indexOf(jR));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),n&&o},e}(),zM=function(){function e(){}return e.setRequestState=function(t,n,o){var r=e.generateLibraryState(t,o);return RO.isEmpty(n)?r:""+r+mR.RESOURCE_DELIM+n},e.generateLibraryState=function(e,t){if(!e)throw AO.createNoCryptoObjectError("generateLibraryState");var n={id:e.createNewGuid()};t&&(n.meta=t);var o=JSON.stringify(n);return e.base64Encode(o)},e.parseRequestState=function(e,t){if(!e)throw AO.createNoCryptoObjectError("parseRequestState");if(RO.isEmpty(t))throw AO.createInvalidStateError(t,"Null, undefined or empty state");try{var n=t.split(mR.RESOURCE_DELIM),o=n[0],r=n.length>1?n.slice(1).join(mR.RESOURCE_DELIM):mR.EMPTY_STRING,i=e.base64Decode(o),s=JSON.parse(i);return{userRequestState:RO.isEmpty(r)?mR.EMPTY_STRING:r,libraryState:s}}catch(sL){throw AO.createInvalidStateError(t,sL)}},e}();!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(SM||(SM={}));var HM,qM,BM=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==QR.LocalStorage&&e!==QR.SessionStorage)throw MD.createStorageNotSupportedError(e);if(!!!window[e])throw MD.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),VM=function(){function e(t){if(this._urlString=t,RO.isEmpty(this._urlString))throw kM.createUrlEmptyError();RO.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return RO.endsWith(t,"?")?t=t.slice(0,-1):RO.endsWith(t,"?/")&&(t=t.slice(0,-2)),RO.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(sL){throw kM.createUrlParseError(sL)}if(!e.HostNameAndPort||!e.PathSegments)throw kM.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw kM.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return RO.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var n=this.getUrlComponents(),o=n.PathSegments;return!t||0===o.length||o[0]!==fR.COMMON&&o[0]!==fR.ORGANIZATIONS||(o[0]=t),e.constructAuthorityUriFromObject(n)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw kM.createUrlParseError("Given url string: "+this.urlString);var n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,!RO.isEmpty(n.QueryString)&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw kM.createUrlParseError("Given url string: "+e);return n[2]},e.getAbsoluteUrl=function(t,n){if(t[0]===mR.FORWARD_SLASH){var o=new e(n).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):mR.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),n=e.indexOf("/?");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):mR.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(RO.isEmpty(t))return{};var n=e.parseHash(t),o=RO.queryStringToObject(RO.isEmpty(n)?t:n);if(!o)throw AO.createHashNotDeserializedError(JSON.stringify(o));return o},e.getDeserializedQueryString=function(t){if(RO.isEmpty(t))return{};var n=e.parseQueryString(t),o=RO.queryStringToObject(RO.isEmpty(n)?t:n);if(!o)throw AO.createHashNotDeserializedError(JSON.stringify(o));return o},e.hashContainsKnownProperties=function(t){if(RO.isEmpty(t)||t.indexOf("=")<0)return!1;var n=e.getDeserializedHash(t);return!!(n.code||n.error_description||n.error||n.state)},e}(),jM=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(RO.isEmpty(t))return null;try{return zM.parseRequestState(e,t).libraryState.meta}catch(sL){throw AO.createInvalidStateError(t,sL)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new VM(e);return VM.getDeserializedHash(t.getHash())},e}(),KM=function(e){function t(t,n,o,r){var i=e.call(this,t,o,r)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=n,i.logger=r,i.internalStorage=new zD,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.temporaryCacheLocation,i.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return YA(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case QR.LocalStorage:case QR.SessionStorage:try{return new BM(e)}catch(sL){this.logger.verbose(sL);break}}return this.cacheConfig.cacheLocation=QR.MemoryStorage,new zD},t.prototype.setupTemporaryCacheStorage=function(e,t){switch(t){case QR.LocalStorage:case QR.SessionStorage:try{return new BM(e||QR.SessionStorage)}catch(sL){return this.logger.verbose(sL),this.internalStorage}case QR.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=mR.CACHE_PREFIX+"."+pR.ID_TOKEN,n=mR.CACHE_PREFIX+"."+pR.CLIENT_INFO,o=mR.CACHE_PREFIX+"."+pR.ERROR,r=mR.CACHE_PREFIX+"."+pR.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(n),this.browserStorage.getItem(o),this.browserStorage.getItem(r)];[pR.ID_TOKEN,pR.CLIENT_INFO,pR.ERROR,pR.ERROR_DESC].forEach((function(t,n){return e.migrateCacheEntry(t,i[n])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(JR.ACCOUNT_KEYS),n=this.getItem(JR.TOKEN_KEYS+"."+this.clientId);t&&n?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var n;if(e.isCredentialKey(t)&&(n=e.getItem(t))){var o=e.validateAndParseJson(n);if(o&&o.hasOwnProperty("credentialType"))switch(o.credentialType){case TR.ID_TOKEN:if(ZD.isIdTokenEntity(o)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var r=RM.toObject(new ZD,o),i=e.updateCredentialCacheKey(t,r);return void e.addTokenKey(i,TR.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case TR.ACCESS_TOKEN:case TR.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(DM.isAccessTokenEntity(o)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var s=RM.toObject(new DM,o);i=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(i,TR.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case TR.REFRESH_TOKEN:if(MM.isRefreshTokenEntity(o)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var a=RM.toObject(new MM,o);i=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(i,TR.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(n=e.getItem(t))){var l=e.validateAndParseJson(n);l&&TM.isAccountEntity(l)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(n){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var n=this.validateAndParseJson(t);return n&&TM.isAccountEntity(n)?RM.toObject(new TM,n):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(JR.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(JR.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(JR.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,TR.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,TR.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,TR.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(JR.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var n=this.getTokenKeys();switch(t){case TR.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case TR.ACCESS_TOKEN:-1===n.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case TR.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),AO.createUnexpectedCredentialTypeError()}this.setItem(JR.TOKEN_KEYS+"."+this.clientId,JSON.stringify(n))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var n=this.getTokenKeys();switch(t){case TR.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var o=n.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case TR.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var r=n.accessToken.indexOf(e);r>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(r,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case TR.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var i=n.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),AO.createUnexpectedCredentialTypeError()}this.setItem(JR.TOKEN_KEYS+"."+this.clientId,JSON.stringify(n))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.ID_TOKEN),null;var n=this.validateAndParseJson(t);return n&&ZD.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),RM.toObject(new ZD,n)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,TR.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.ACCESS_TOKEN),null;var n=this.validateAndParseJson(t);return n&&DM.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),RM.toObject(new DM,n)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,TR.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.REFRESH_TOKEN),null;var n=this.validateAndParseJson(t);return n&&MM.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),RM.toObject(new MM,n)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,TR.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,TR.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&NM.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),RM.toObject(new NM,n)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&LM.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),RM.toObject(new LM,n)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&FM.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),RM.toObject(new FM,n)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(XR.WRAPPER_SKU,e),this.internalStorage.setItem(XR.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(XR.WRAPPER_SKU)||mR.EMPTY_STRING,this.internalStorage.getItem(XR.WRAPPER_VER)||mR.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(pR.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var n=this.generateCacheKey(pR.ACTIVE_ACCOUNT),o=this.getItem(n);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var r=this.getAccountInfoByFilter({localAccountId:o})[0]||null;return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(r),r):null}var i=this.validateAndParseJson(t);return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(pR.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(pR.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(o)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var n=this.getAllAccounts().filter((function(n){if(t){var o=n.idTokenClaims&&n.idTokenClaims.sid;return t===o}return!!e&&e===n.username}));if(1===n.length)return n[0];if(n.length>1)throw AO.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var n=this.validateAndParseJson(t);return n&&UM.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),RM.toObject(new UM,n)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var o=this.getItemCookie(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}var r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===QR.LocalStorage){var i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r},t.prototype.setTemporaryCache=function(e,t,n){var o=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return rR(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return tR(this,void 0,void 0,(function(){var e=this;return nR(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(mR.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.clearTokensAndKeysWithClaims=function(){return tR(this,void 0,void 0,(function(){var e,t,n=this;return nR(this,(function(o){switch(o.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),e=this.getTokenKeys(),t=[],e.accessToken.forEach((function(e){var o=n.getAccessTokenCredential(e);(null===o||void 0===o?void 0:o.requestedClaimsHash)&&e.includes(o.requestedClaimsHash.toLowerCase())&&t.push(n.removeAccessToken(e))})),[4,Promise.all(t)];case 1:return o.sent(),t.length>0&&this.logger.warning(t.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}}))}))},t.prototype.setItemCookie=function(e,t,n){var o=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";n&&(o+="expires="+this.getCookieExpirationTime(n)+";");this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return mR.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=mR.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(n){for(;" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t)){var o=n.split("=")[0];e.clearItemCookie(o)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,mR.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):RO.startsWith(e,mR.CACHE_PREFIX)||RO.startsWith(e,pR.ADAL_ID_TOKEN)?e:mR.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=zM.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ZR.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=zM.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ZR.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=zM.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(ZR.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;var o=this.generateAuthorityKey(n);return this.getTemporaryCache(o)},t.prototype.updateCacheEntries=function(e,t,n,o,r){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,n,!1),r){var l={credential:r.homeAccountId,type:SM.HOME_ACCOUNT_ID};this.setTemporaryCache(ZR.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(!RO.isEmpty(o)){l={credential:o,type:SM.UPN};this.setTemporaryCache(ZR.CCS_CREDENTIAL,JSON.stringify(l),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),RO.isEmpty(e)||this.getKeys().forEach((function(n){-1!==n.indexOf(e)&&t.removeItem(n)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(ZR.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(ZR.ORIGIN_URI)),this.removeItem(this.generateCacheKey(ZR.URL_HASH)),this.removeItem(this.generateCacheKey(ZR.CORRELATION_ID)),this.removeItem(this.generateCacheKey(ZR.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(ZR.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+n),this.resetRequestCache(n||mR.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(n){if(-1!==n.indexOf(ZR.REQUEST_STATE)){var o=t.temporaryCacheStorage.getItem(n);if(o){var r=jM.extractBrowserRequestState(t.cryptoImpl,o);r&&r.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+o),t.resetRequestCache(o))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var n=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(ZR.REQUEST_PARAMS,n,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var n=this.getTemporaryCache(ZR.REQUEST_PARAMS,!0);if(!n)throw xD.createNoTokenRequestCacheError();var o=this.validateAndParseJson(t.base64Decode(n));if(!o)throw xD.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(ZR.REQUEST_PARAMS)),RO.isEmpty(o.authority)){var r=this.generateAuthorityKey(e),i=this.getTemporaryCache(r);if(!i)throw xD.createNoCachedAuthorityError();o.authority=i}return o},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(ZR.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=mR.CACHE_PREFIX+"."+ZR.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=mR.CACHE_PREFIX+"."+ZR.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw xD.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(pR.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(pR.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(pR.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(pR.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var n=t||e;if(n){var o=new IM(n,this.cryptoImpl);if(o.claims&&o.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.claims.preferred_username;if(o.claims&&o.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var n=t.generateCredentialKey();if(e!==n){var o=this.getItem(e);if(o)return this.removeItem(e),this.setItem(n,o),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),n;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(ZR.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(ZR.REDIRECT_CONTEXT,e,!0)},t}(RM);!function(e){e.AAD="AAD",e.OIDC="OIDC"}(HM||(HM={})),function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(qM||(qM={}));var GM={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},$M={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:qD.Info,correlationId:mR.EMPTY_STRING},WM={claimsBasedCachingEnabled:!0},QM={sendGetRequestAsync:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",iP.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return cR(this,void 0,void 0,(function(){return dR(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",iP.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},YM={sku:mR.SKU,version:AM,cpu:mR.EMPTY_STRING,os:mR.EMPTY_STRING},ZM={clientSecret:mR.EMPTY_STRING,clientAssertion:void 0},JM={azureCloudInstance:qM.None,tenant:""+mR.DEFAULT_COMMON_TENANT},XM={application:{appName:"",appVersion:""}};var eN={sendGetRequestAsync:function(){return Promise.reject(iP.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(iP.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},tN=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return tR(this,void 0,void 0,(function(){var n,o,r;return nR(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:YR.GET,headers:this.getFetchHeaders(t)})];case 1:return n=i.sent(),[3,3];case 2:throw o=i.sent(),window.navigator.onLine?xD.createGetRequestFailedError(o,e):xD.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),r={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 4:return[2,(r.body=i.sent(),r.status=n.status,r)];case 5:throw i.sent(),xD.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return tR(this,void 0,void 0,(function(){var n,o,r,i;return nR(this,(function(s){switch(s.label){case 0:n=t&&t.body||mR.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:YR.POST,headers:this.getFetchHeaders(t),body:n})];case 2:return o=s.sent(),[3,4];case 3:throw r=s.sent(),window.navigator.onLine?xD.createPostRequestFailedError(r,e):xD.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),i={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 5:return[2,(i.body=s.sent(),i.status=o.status,i)];case 6:throw s.sent(),xD.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var n=e.headers;return Object.keys(n).forEach((function(e){t.append(e,n[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t},e}(),nN=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,this.sendRequestAsync(e,YR.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){return[2,this.sendRequestAsync(e,YR.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,n){var o=this;return new Promise((function(r,i){var s=new XMLHttpRequest;if(s.open(t,e,!0),o.setXhrHeaders(s,n),s.onload=function(){(s.status<200||s.status>=300)&&(t===YR.POST?i(xD.createPostRequestFailedError("Failed with status "+s.status,e)):i(xD.createGetRequestFailedError("Failed with status "+s.status,e)));try{var n=JSON.parse(s.responseText),a={headers:o.getHeaderDict(s),body:n,status:s.status};r(a)}catch(sL){i(xD.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===YR.POST?i(xD.createPostRequestFailedError("Failed with status "+s.status,e)):i(xD.createGetRequestFailedError("Failed with status "+s.status,e)):i(xD.createNoNetworkConnectivityError())},t===YR.POST&&n&&n.body)s.send(n.body);else{if(t!==YR.GET)throw xD.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var n=t.headers;Object.keys(n).forEach((function(t){e.setRequestHeader(t,n[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};return t.forEach((function(e){var t=e.split(": "),o=t.shift(),r=t.join(": ");o&&r&&(n[o]=r)})),n},e}(),oN=function(){function e(){}return e.clearHash=function(e){e.location.hash=mR.EMPTY_STRING,"function"===typeof e.history.replaceState&&e.history.replaceState(null,mR.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):mR.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!==typeof window&&!!window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf(gP+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new VM(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new tN:new nN},e.blockReloadInHiddenIframes=function(){if(VM.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw xD.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,n){var o=e.isInIframe();if(t===tP.Redirect&&o&&!n)throw xD.createRedirectInIframeError(o)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw xD.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw xD.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw xD.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),o=e.indexOf("Edge/");return t>0||n>0||o>0},e}(),rN=function(){function e(){}return e.prototype.navigateInternal=function(t,n){return e.defaultNavigateWindow(t,n)},e.prototype.navigateExternal=function(t,n){return e.defaultNavigateWindow(t,n)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),iN=6e3;var sN,aN="@azure/msal-browser",lN="2.38.3";!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd",e.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"}(sN||(sN={}));var cN,dN=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!==typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,n,o){var r=this;if("undefined"!==typeof window){var i={eventType:e,interactionType:t||null,payload:n||null,error:o||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,n){r.logger.verbose("Emitting event to callback "+n+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var n=JSON.parse(t);if("object"!==typeof n||!TM.isAccountEntity(n))return;var o=RM.toObject(new TM,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(sN.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(sN.ACCOUNT_REMOVED,void 0,o))}catch(e){return}},e}(),uN=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return jR+"."+JSON.stringify(e)},e.preProcess=function(t,n){var o,r=e.generateThrottlingStorageKey(n),i=t.getThrottlingCache(r);if(i){if(i.throttleTime<Date.now())return void t.removeItem(r);throw new sP((null===(o=i.errorCodes)||void 0===o?void 0:o.join(" "))||mR.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,n,o){if(e.checkResponseStatus(o)||e.checkResponseForRetryAfter(o)){var r={throttleTime:e.calculateThrottleTime(parseInt(o.headers[hR.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(n),r)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(hR.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||BR),n+VR))},e.removeThrottle=function(e,t,n,o){var r={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:o,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},i=this.generateThrottlingStorageKey(r);e.removeItem(i)},e}(),hN=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,n){return cR(this,void 0,void 0,(function(){var o,r;return dR(this,(function(i){switch(i.label){case 0:uN.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,n)];case 2:return o=i.sent(),[3,4];case 3:throw(r=i.sent())instanceof iP?r:AO.createNetworkError(t,r);case 4:return uN.postProcess(this.cacheManager,e,o),[2,o]}}))}))},e}(),pN=function(){function e(){}return e.validateRedirectUri=function(e){if(RO.isEmpty(e))throw kM.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var n in kR)t.push(kR[n]);if(t.indexOf(e)<0)throw kM.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(sL){throw kM.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(RO.isEmpty(e)||RO.isEmpty(t))throw kM.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([ER.PLAIN,ER.S256].indexOf(e)<0)throw kM.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,n){e[n]&&delete e[n]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),fN=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(gR.RESPONSE_TYPE,encodeURIComponent(mR.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(gR.RESPONSE_TYPE,encodeURIComponent(mR.TOKEN_RESPONSE_TYPE+" "+mR.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(gR.RESPONSE_MODE,encodeURIComponent(e||xR.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(gR.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var n=t?uR(e||[],yR):e||[],o=new xM(n);this.parameters.set(gR.SCOPE,encodeURIComponent(o.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(gR.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){pN.validateRedirectUri(e),this.parameters.set(gR.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){pN.validateRedirectUri(e),this.parameters.set(gR.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(gR.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(wR.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(wR.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(hR.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(hR.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(wR.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var n=this.addClientCapabilitiesToClaims(e,t);pN.validateClaims(n),this.parameters.set(gR.CLAIMS,encodeURIComponent(n))},e.prototype.addCorrelationId=function(e){this.parameters.set(gR.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(gR.X_CLIENT_SKU,e.sku),this.parameters.set(gR.X_CLIENT_VER,e.version),e.os&&this.parameters.set(gR.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(gR.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null===e||void 0===e?void 0:e.appName)&&this.parameters.set(gR.X_APP_NAME,e.appName),(null===e||void 0===e?void 0:e.appVersion)&&this.parameters.set(gR.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){pN.validatePrompt(e),this.parameters.set(""+gR.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){RO.isEmpty(e)||this.parameters.set(gR.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(gR.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(pN.validateCodeChallengeParams(e,t),!e||!t)throw kM.createInvalidCodeChallengeParamsError();this.parameters.set(gR.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(gR.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(gR.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(gR.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(gR.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(gR.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(gR.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){RO.isEmpty(e)||this.parameters.set(gR.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){RO.isEmpty(e)||this.parameters.set(gR.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(gR.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(gR.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(gR.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,n=pN.sanitizeEQParams(e,this.parameters);Object.keys(n).forEach((function(n){t.parameters.set(n,e[n])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var n;if(e)try{n=JSON.parse(e)}catch(sL){throw kM.createInvalidClaimsRequestError()}else n={};return t&&t.length>0&&(n.hasOwnProperty(vR.ACCESS_TOKEN)||(n[vR.ACCESS_TOKEN]={}),n[vR.ACCESS_TOKEN][vR.XMS_CC]={values:t}),JSON.stringify(n)},e.prototype.addUsername=function(e){this.parameters.set(LR.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(LR.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){RO.isEmpty(e)||(this.parameters.set(gR.TOKEN_TYPE,MR.POP),this.parameters.set(gR.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){RO.isEmpty(e)||(this.parameters.set(gR.TOKEN_TYPE,MR.SSH),this.parameters.set(gR.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(gR.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(gR.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(gR.X_MS_LIB_CAPABILITY,KR)},e.prototype.addLogoutHint=function(e){this.parameters.set(gR.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,n){e.push(n+"="+t)})),e.join("&")},e}(),gN=function(){function e(e,t){this.config=function(e){var t,n=e.authOptions,o=e.systemOptions,r=e.loggerOptions,i=e.cacheOptions,s=e.storageInterface,a=e.networkInterface,l=e.cryptoInterface,c=e.clientCredentials,d=e.libraryInfo,u=e.telemetry,h=e.serverTelemetryManager,p=e.persistencePlugin,f=e.serializableCache,g=lR(lR({},$M),r);return{authOptions:(t=n,lR({clientCapabilities:[],azureCloudOptions:JM,skipAuthorityMetadataCache:!1},t)),systemOptions:lR(lR({},GM),o),loggerOptions:g,cacheOptions:lR(lR({},WM),i),storageInterface:s||new PM(n.clientId,QD,new KD(g)),networkInterface:a||QM,cryptoInterface:l||QD,clientCredentials:c||ZM,libraryInfo:lR(lR({},YM),d),telemetry:lR(lR({},XM),u),serverTelemetryManager:h||null,persistencePlugin:p||null,serializableCache:f||null}}(e),this.logger=new KD(this.config.loggerOptions,EM,AM),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new hN(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[hR.CONTENT_TYPE]=mR.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case SM.HOME_ACCOUNT_ID:try{var n=_M(e.credential);t[hR.CCS_HEADER]="Oid:"+n.uid+"@"+n.utid}catch(sL){this.logger.verbose("Could not parse home account ID for CCS Header: "+sL)}break;case SM.UPN:t[hR.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,n,o){return cR(this,void 0,void 0,(function(){var r;return dR(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:n})];case 1:return r=i.sent(),this.config.serverTelemetryManager&&r.status<500&&429!==r.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,r]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw AO.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new fN;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),vN=function(e,t,n,o,r){this.account=e||null,this.idToken=t||null,this.accessToken=n||null,this.refreshToken=o||null,this.appMetadata=r||null};!function(e){e.SW="sw",e.UHW="uhw"}(cN||(cN={}));var mN=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,n;return cR(this,void 0,void 0,(function(){var o,r,i;return dR(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.PopTokenGenerateCnf,e.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return o=s.sent(),r=this.cryptoUtils.base64Encode(JSON.stringify(o)),i={kid:o.kid,reqCnfString:r},[4,this.cryptoUtils.hashString(r)];case 2:return[2,(i.reqCnfHash=s.sent(),i)]}}))}))},e.prototype.generateKid=function(e){var t;return cR(this,void 0,void 0,(function(){return dR(this,(function(n){switch(n.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:n.sent(),xms_ksl:cN.SW}]}}))}))},e.prototype.signPopToken=function(e,t,n){return cR(this,void 0,void 0,(function(){return dR(this,(function(o){return[2,this.signPayload(e,t,n)]}))}))},e.prototype.signPayload=function(e,t,n,o){return cR(this,void 0,void 0,(function(){var r,i,s,a,l,c;return dR(this,(function(d){switch(d.label){case 0:return r=n.resourceRequestMethod,i=n.resourceRequestUri,s=n.shrClaims,a=n.shrNonce,l=i?new VM(i):void 0,c=null===l||void 0===l?void 0:l.getUrlComponents(),[4,this.cryptoUtils.signJwt(lR({at:e,ts:OM.nowSeconds(),m:null===r||void 0===r?void 0:r.toUpperCase(),u:null===c||void 0===c?void 0:c.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null===c||void 0===c?void 0:c.AbsolutePath,q:(null===c||void 0===c?void 0:c.QueryString)?[[],c.QueryString]:void 0,client_claims:s||void 0},o),t,n.correlationId)];case 1:return[2,d.sent()]}}))}))},e}(),yN=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),bN=function(){function e(e,t,n,o,r,i,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=o,this.serializableCache=r,this.persistencePlugin=i,this.performanceClient=s}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,n){if(!e.state||!t)throw e.state?AO.createStateNotFoundError("Cached State"):AO.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw AO.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(uP.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new uP(e.error||mR.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||mR.EMPTY_STRING,e.trace_id||mR.EMPTY_STRING,e.correlation_id||mR.EMPTY_STRING,e.claims||mR.EMPTY_STRING);throw new sP(e.error||mR.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&CM(e.client_info,n)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(uP.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new uP(e.error,e.error_description,e.suberror,e.timestamp||mR.EMPTY_STRING,e.trace_id||mR.EMPTY_STRING,e.correlation_id||mR.EMPTY_STRING,e.claims||mR.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new sP(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,n,o,r,i,s,a,l,c){var d;return cR(this,void 0,void 0,(function(){var u,h,p,f,g,v;return dR(this,(function(m){switch(m.label){case 0:if(null===(d=this.performanceClient)||void 0===d||d.addQueueMeasurement(ZA.HandleServerTokenResponse,t.correlation_id),t.id_token){if(u=new IM(t.id_token||mR.EMPTY_STRING,this.cryptoObj),i&&!RO.isEmpty(i.nonce)&&u.claims.nonce!==i.nonce)throw AO.createNonceMismatchError();if(r.maxAge||0===r.maxAge){if(!(h=u.claims.auth_time))throw AO.createAuthTimeNotFoundError();IM.checkMaxAge(h,r.maxAge)}}this.homeAccountIdentifier=TM.generateHomeAccountId(t.client_info||mR.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,u),i&&i.state&&(p=zM.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||r.sshKid||void 0,f=this.generateCacheRecord(t,n,o,r,u,s,i),m.label=1;case 1:return m.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new yN(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(g)]):[3,3];case 2:m.sent(),m.label=3;case 3:return!a||l||!f.account||(v=f.account.generateAccountKey(),this.cacheStorage.getAccount(v))?[4,this.cacheStorage.saveCacheRecord(f)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,n,f,!1,r,u,p,void 0,c)]);case 4:return m.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&g?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(g)]):[3,7];case 6:m.sent(),m.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,n,f,!1,r,u,p,t,c)]}}))}))},e.prototype.generateCacheRecord=function(e,t,n,o,r,i,s){var a,l,c=t.getPreferredCache();if(RO.isEmpty(c))throw AO.createInvalidCacheEnvironmentError();!RO.isEmpty(e.id_token)&&r&&(a=ZD.createIdTokenEntity(this.homeAccountIdentifier,c,e.id_token||mR.EMPTY_STRING,this.clientId,r.claims.tid||mR.EMPTY_STRING),l=this.generateAccountEntity(e,r,t,s));var d=null;if(!RO.isEmpty(e.access_token)){var u=e.scope?xM.fromString(e.scope):new xM(o.scopes||[]),h=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=n+h,v=g+p,m=f&&f>0?n+f:void 0;d=DM.createAccessTokenEntity(this.homeAccountIdentifier,c,e.access_token||mR.EMPTY_STRING,this.clientId,r?r.claims.tid||mR.EMPTY_STRING:t.tenant,u.printScopes(),g,v,this.cryptoObj,m,e.token_type,i,e.key_id,o.claims,o.requestedClaimsHash)}var y=null;RO.isEmpty(e.refresh_token)||(y=MM.createRefreshTokenEntity(this.homeAccountIdentifier,c,e.refresh_token||mR.EMPTY_STRING,this.clientId,e.foci,i));var b=null;return RO.isEmpty(e.foci)||(b=NM.createAppMetadataEntity(this.clientId,c,e.foci)),new vN(l,a,d,y,b)},e.prototype.generateAccountEntity=function(e,t,n,o){var r=n.authorityType,i=o?o.cloud_graph_host_name:mR.EMPTY_STRING,s=o?o.msgraph_host:mR.EMPTY_STRING;if(r===jD.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),TM.createGenericAccount(this.homeAccountIdentifier,t,n,i,s);if(RO.isEmpty(e.client_info)&&"AAD"===n.protocolMode)throw AO.createClientInfoEmptyError();return e.client_info?TM.createAccount(e.client_info,this.homeAccountIdentifier,t,n,i,s):TM.createGenericAccount(this.homeAccountIdentifier,t,n,i,s)},e.generateAuthenticationResult=function(e,t,n,o,r,i,s,a,l){var c,d,u;return cR(this,void 0,void 0,(function(){var h,p,f,g,v,m,y,b,w,k,x;return dR(this,(function(C){switch(C.label){case 0:if(h=mR.EMPTY_STRING,p=[],f=null,v=mR.EMPTY_STRING,!n.accessToken)return[3,4];if(n.accessToken.tokenType!==MR.POP)return[3,2];if(m=new mN(e),y=n.accessToken,b=y.secret,!(w=y.keyId))throw AO.createKeyIdMissingError();return[4,m.signPopToken(b,w,r)];case 1:return h=C.sent(),[3,3];case 2:h=n.accessToken.secret,C.label=3;case 3:p=xM.fromString(n.accessToken.target).asArray(),f=new Date(1e3*Number(n.accessToken.expiresOn)),g=new Date(1e3*Number(n.accessToken.extendedExpiresOn)),C.label=4;case 4:return n.appMetadata&&(v=n.appMetadata.familyId===PR?PR:mR.EMPTY_STRING),k=(null===i||void 0===i?void 0:i.claims.oid)||(null===i||void 0===i?void 0:i.claims.sub)||mR.EMPTY_STRING,x=(null===i||void 0===i?void 0:i.claims.tid)||mR.EMPTY_STRING,(null===a||void 0===a?void 0:a.spa_accountid)&&n.account&&(n.account.nativeAccountId=null===a||void 0===a?void 0:a.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:k,tenantId:x,scopes:p,account:n.account?n.account.getAccountInfo():null,idToken:i?i.rawToken:mR.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:h,fromCache:o,expiresOn:f,correlationId:r.correlationId,requestId:l||mR.EMPTY_STRING,extExpiresOn:g,familyId:v,tokenType:(null===(c=n.accessToken)||void 0===c?void 0:c.tokenType)||mR.EMPTY_STRING,state:s?s.userRequestState:mR.EMPTY_STRING,cloudGraphHostName:(null===(d=n.account)||void 0===d?void 0:d.cloudGraphHostName)||mR.EMPTY_STRING,msGraphHost:(null===(u=n.account)||void 0===u?void 0:u.msGraphHost)||mR.EMPTY_STRING,code:null===a||void 0===a?void 0:a.spa_code,fromNativeBroker:!1}]}}))}))},e}(),wN=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.includeRedirectUri=!0,o}return aR(t,e),t.prototype.getAuthCodeUrl=function(e){var t,n;return cR(this,void 0,void 0,(function(){var o;return dR(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.GetAuthCodeUrl,e.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return o=r.sent(),[2,VM.appendQueryString(this.authority.authorizationEndpoint,o)]}}))}))},t.prototype.acquireToken=function(e,t){var n,o,r,i,s,a;return cR(this,void 0,void 0,(function(){var l,c,d,u,h,p,f=this;return dR(this,(function(g){switch(g.label){case 0:if(!e||!e.code)throw AO.createTokenRequestCannotBeMadeError();return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.AuthClientAcquireToken,e.correlationId),l=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),c=OM.nowSeconds(),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return d=g.sent(),u=null===(i=d.headers)||void 0===i?void 0:i[hR.X_MS_REQUEST_ID],(h=null===(s=d.headers)||void 0===s?void 0:s[hR.X_MS_HTTP_VERSION])&&(null===l||void 0===l||l.addStaticFields({httpVerAuthority:h})),(p=new bN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(d.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(ZA.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(d.body,this.authority,c,e,t,void 0,void 0,void 0,u).then((function(e){return null===l||void 0===l||l.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching token in ACC",e.correlationId),null===l||void 0===l||l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var n=new bN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new VM(e),r=VM.getDeserializedHash(o.getHash());if(n.validateServerAuthorizationCodeResponse(r,t,this.cryptoUtils),!r.code)throw AO.createNoAuthCodeInServerResponseError();return lR(lR({},r),{code:r.code})},t.prototype.getLogoutUri=function(e){if(!e)throw kM.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return VM.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var n,o;return cR(this,void 0,void 0,(function(){var r,i,s,a,l,c,d;return dR(this,(function(u){switch(u.label){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.AuthClientExecuteTokenRequest,t.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(ZA.AuthClientCreateTokenRequestBody,t.correlationId),r=this.createTokenQueryParameters(t),i=VM.appendQueryString(e.tokenEndpoint,r),[4,this.createTokenRequestBody(t)];case 1:if(s=u.sent(),a=void 0,t.clientInfo)try{l=CM(t.clientInfo,this.cryptoUtils),a={credential:""+l.uid+SR.CLIENT_INFO_SEPARATOR+l.utid,type:SM.HOME_ACCOUNT_ID}}catch(sL){this.logger.verbose("Could not parse client info for CCS Header: "+sL)}return c=this.createTokenRequestHeaders(a||t.ccsCredential),d={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(i,s,c,d)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,n;return cR(this,void 0,void 0,(function(){var o,r,i,s,a,l,c,d;return dR(this,(function(u){switch(u.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.AuthClientCreateTokenRequestBody,e.correlationId),(o=new fN).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?o.addRedirectUri(e.redirectUri):pN.validateRedirectUri(e.redirectUri),o.addScopes(e.scopes),o.addAuthorizationCode(e.code),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addThrottling(),this.serverTelemetryManager&&o.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&o.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&o.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,o.addClientAssertion(r.assertion),o.addClientAssertionType(r.assertionType)),o.addGrantType(CR.AUTHORIZATION_CODE_GRANT),o.addClientInfo(),e.authenticationScheme!==MR.POP?[3,2]:(i=new mN(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.PopTokenGenerateCnf,e.correlationId),[4,i.generateCnf(e)]);case 1:return s=u.sent(),o.addPopToken(s.reqCnfString),[3,3];case 2:if(e.authenticationScheme===MR.SSH){if(!e.sshJwk)throw kM.createMissingSshJwkError();o.addSshJwk(e.sshJwk)}u.label=3;case 3:if(a=e.correlationId||this.config.cryptoInterface.createNewGuid(),o.addCorrelationId(a),(!RO.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(e.claims,this.config.authOptions.clientCapabilities),l=void 0,e.clientInfo)try{c=CM(e.clientInfo,this.cryptoUtils),l={credential:""+c.uid+SR.CLIENT_INFO_SEPARATOR+c.utid,type:SM.HOME_ACCOUNT_ID}}catch(sL){this.logger.verbose("Could not parse client info for CCS Header: "+sL)}else l=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&l)switch(l.type){case SM.HOME_ACCOUNT_ID:try{c=_M(l.credential),o.addCcsOid(c)}catch(sL){this.logger.verbose("Could not parse home account ID for CCS Header: "+sL)}break;case SM.UPN:o.addCcsUpn(l.credential)}return e.tokenBodyParameters&&o.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[gR.RETURN_SPA_CODE]||o.addExtraQueryParameters(((d={})[gR.RETURN_SPA_CODE]="1",d)),[2,o.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return cR(this,void 0,void 0,(function(){var n,o,r,i,s,a,l;return dR(this,(function(c){switch(c.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.AuthClientCreateQueryString,e.correlationId),(n=new fN).addClientId(this.config.authOptions.clientId),o=uR(e.scopes||[],e.extraScopesToConsent||[]),n.addScopes(o),n.addRedirectUri(e.redirectUri),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(r),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==kR.SELECT_ACCOUNT)if(e.sid&&e.prompt===kR.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){if(i=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(s);try{a=_M(e.account.homeAccountId),n.addCcsOid(a)}catch(sL){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===kR.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(i);try{a=_M(e.account.homeAccountId),n.addCcsOid(a)}catch(sL){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{a=_M(e.account.homeAccountId),n.addCcsOid(a)}catch(sL){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(!RO.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(n.addNativeBroker(),e.authenticationScheme!==MR.POP?[3,2]:[4,new mN(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:l=c.sent(),n.addPopToken(l.reqCnfString),c.label=2;case 2:return[2,n.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new fN;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(gN);function kN(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var xN={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},CN={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};var _N,SN=function(){function e(e,t,n){this.networkInterface=e,this.performanceClient=t,this.correlationId=n}return e.prototype.detectRegion=function(t,n){var o,r,i,s;return cR(this,void 0,void 0,(function(){var a,l,c,d,u;return dR(this,(function(h){switch(h.label){case 0:if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(ZA.RegionDiscoveryDetectRegion,this.correlationId),a=t)return[3,8];l=e.IMDS_OPTIONS,h.label=1;case 1:return h.trys.push([1,6,,7]),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(mR.IMDS_VERSION,l)];case 2:return(c=h.sent()).status===FR.httpSuccess&&(a=c.body,n.region_source=UR.IMDS),c.status!==FR.httpBadRequest?[3,5]:(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(ZA.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(l)]);case 3:return(d=h.sent())?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(ZA.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(d,l)]):(n.region_source=UR.FAILED_AUTO_DETECTION,[2,null]);case 4:(u=h.sent()).status===FR.httpSuccess&&(a=u.body,n.region_source=UR.IMDS),h.label=5;case 5:return[3,7];case 6:return h.sent(),n.region_source=UR.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:n.region_source=UR.ENVIRONMENT_VARIABLE,h.label=9;case 9:return a||(n.region_source=UR.FAILED_AUTO_DETECTION),[2,a||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var n;return cR(this,void 0,void 0,(function(){return dR(this,(function(o){return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(mR.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,mR.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return cR(this,void 0,void 0,(function(){var n;return dR(this,(function(o){switch(o.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.RegionDiscoveryGetCurrentVersion,this.correlationId),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(mR.IMDS_ENDPOINT+"?format=json",e)];case 2:return(n=o.sent()).status===FR.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?[2,n.body["newest-versions"][0]]:[2,null];case 3:return o.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),TN=function(){function e(e,t,n,o,r,i,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=r,this.performanceClient=i,this.correlationId=s,this.regionDiscovery=new SN(t,this.performanceClient,this.correlationId)}return e.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(mR.CIAM_AUTH_URL))return jD.Ciam;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case mR.ADFS:return jD.Adfs;case mR.DSTS:return jD.Dsts}return jD.Default},Object.defineProperty(e.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new VM(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw AO.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.canReplaceTenant=function(t){return 1===t.PathSegments.length&&!e.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===jD.Default&&this.protocolMode===HM.AAD},e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=this,n=e,o=new VM(this.metadata.canonical_authority).getUrlComponents(),r=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,i){var s=r[i];if(0===i&&t.canReplaceTenant(o)){var a=new VM(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];s!==a&&(t.logger.verbose("Replacing tenant domain name "+s+" with id "+a),s=a)}e!==s&&(n=n.replace("/"+s+"/","/"+e+"/"))})),this.replaceTenant(n)},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===jD.Adfs||this.authorityType===jD.Dsts||this.protocolMode===HM.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,n;return cR(this,void 0,void 0,(function(){var o,r,i,s;return dR(this,(function(a){switch(a.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(ZA.AuthorityResolveEndpointsAsync,this.correlationId),(o=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(o=new FM).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(ZA.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(o)];case 1:return r=a.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,o.preferred_network),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(o)];case 2:return i=a.sent(),r!==AR.CACHE&&i!==AR.CACHE&&(o.resetExpiresAt(),o.updateCanonicalAuthority(this.canonicalAuthority)),s=this.cacheManager.generateAuthorityMetadataCacheKey(o.preferred_cache),this.cacheManager.setAuthorityMetadata(s,o),this.metadata=o,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,n,o,r,i,s;return cR(this,void 0,void 0,(function(){var a,l;return dR(this,(function(c){switch(c.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.AuthorityUpdateEndpointMetadata,this.correlationId),(a=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(a,!1),[2,AR.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,AR.CACHE]:(null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(a=c.sent())?(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)?(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(a)]):[3,3]:[3,4];case 2:a=c.sent(),c.label=3;case 3:return e.updateEndpointMetadata(a,!0),[2,AR.NETWORK];case 4:return!(l=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(ZA.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(l)]):[3,6];case 5:l=c.sent(),c.label=6;case 6:return e.updateEndpointMetadata(l,!1),[2,AR.HARDCODED_VALUES];case 7:throw AO.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new VM(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(sL){throw kM.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return cR(this,void 0,void 0,(function(){var t,n;return dR(this,(function(o){switch(o.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(ZA.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,kN((n=o.sent()).body)?n.body:null];case 3:return o.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in xN?xN[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var n,o,r,i;return cR(this,void 0,void 0,(function(){var s,a;return dR(this,(function(l){switch(l.label){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),(s=null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)?s!==mR.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=zR.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=s,[2,e.replaceWithRegionalInformation(t,s)]):(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(a=l.sent())return this.regionDiscoveryMetadata.region_outcome=zR.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,[2,e.replaceWithRegionalInformation(t,a)];this.regionDiscoveryMetadata.region_outcome=zR.AUTO_DETECTION_REQUESTED_FAILED,l.label=2;case 2:return[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,n;return cR(this,void 0,void 0,(function(){var o,r,i;return dR(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||mR.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||mR.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||mR.NOT_APPLICABLE)),(o=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(o,!1),[2,AR.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),r=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found metadata in the cache."),[2,AR.CACHE]):(r&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(o=s.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(o,!0),[2,AR.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(i=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(i,!1),[2,AR.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),kM.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===jD.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(sL){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),kM.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return cR(this,void 0,void 0,(function(){var n,o,r,i,s,a,l,c;return dR(this,(function(d){switch(d.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),n=""+mR.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},r=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(n,o)];case 2:if(i=d.sent(),s=void 0,a=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(i.body))s=i.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(i.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+i.status),(s=i.body).error===mR.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=e.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return(l=d.sent())instanceof iP?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+l.errorCode+"\nError Description: "+l.errorMessage):(c=l,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+c.name+"\nError Description: "+c.message)),[2,null];case 4:return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in CN?CN[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return VM.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var n;if(t&&t.azureCloudInstance!==qM.None){var o=t.tenant?t.tenant:mR.DEFAULT_COMMON_TENANT;n=t.azureCloudInstance+"/"+o+"/"}return n||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.aliases.indexOf(t)>-1)return o}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw AO.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return mR.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,n){var o=new VM(e);o.validateAsUri();var r=o.getUrlComponents(),i=t+"."+r.HostNameAndPort;this.isPublicCloudAuthority(r.HostNameAndPort)&&(i=t+"."+mR.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=VM.constructAuthorityUriFromObject(lR(lR({},o.getUrlComponents()),{HostNameAndPort:i})).urlString;return n?s+"?"+n:s},e.replaceWithRegionalInformation=function(t,n){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,n),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,n,mR.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,n)),t},e.transformCIAMAuthority=function(e){var t=e.endsWith(mR.FORWARD_SLASH)?e:""+e+mR.FORWARD_SLASH,n=new VM(e).getUrlComponents();0===n.PathSegments.length&&n.HostNameAndPort.endsWith(mR.CIAM_AUTH_URL)&&(t=""+t+n.HostNameAndPort.split(".")[0]+mR.AAD_TENANT_DOMAIN_SUFFIX);return t},e.reservedTenantDomains=new Set(["{tenant}","{tenantid}",fR.COMMON,fR.CONSUMERS,fR.ORGANIZATIONS]),e}(),IN=function(){function e(){}return e.createDiscoveredInstance=function(t,n,o,r,i,s,a){return cR(this,void 0,void 0,(function(){var l,c,d;return dR(this,(function(u){switch(u.label){case 0:null===s||void 0===s||s.addQueueMeasurement(ZA.AuthorityFactoryCreateDiscoveredInstance,a),l=TN.transformCIAMAuthority(t),c=e.createInstance(l,n,o,r,i,s,a),u.label=1;case 1:return u.trys.push([1,3,,4]),null===s||void 0===s||s.setPreQueueTime(ZA.AuthorityResolveEndpointsAsync,a),[4,c.resolveEndpointsAsync()];case 2:return u.sent(),[2,c];case 3:throw d=u.sent(),AO.createEndpointDiscoveryIncompleteError(d);case 4:return[2]}}))}))},e.createInstance=function(e,t,n,o,r,i,s){if(RO.isEmpty(e))throw kM.createUrlEmptyError();return new TN(e,t,n,o,r,i,s)},e}(),EN=function(){function e(e,t){this.cacheOutcome=HR.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||mR.EMPTY_STRING,this.wrapperVer=e.wrapperVer||mR.EMPTY_STRING,this.telemetryCacheKey=NR.CACHE_KEY+SR.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+NR.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(NR.VALUE_SEPARATOR),n=[e,this.getRegionDiscoveryFields()].join(NR.VALUE_SEPARATOR);return[NR.SCHEMA_VERSION,n,t].join(NR.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t),o=t.failedRequests.slice(0,2*n).join(NR.VALUE_SEPARATOR),r=t.errors.slice(0,n).join(NR.VALUE_SEPARATOR),i=t.errors.length,s=[i,n<i?NR.OVERFLOW_TRUE:NR.OVERFLOW_FALSE].join(NR.VALUE_SEPARATOR);return[NR.SCHEMA_VERSION,t.cacheHits,o,r,s].join(NR.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=NR.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),RO.isEmpty(e.subError)?RO.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(NR.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new LM;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),n=e.maxErrorsToSend(t);if(n===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var o=new LM;o.failedRequests=t.failedRequests.slice(2*n),o.errors=t.errors.slice(n),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}},e.maxErrorsToSend=function(e){var t,n=0,o=0,r=e.errors.length;for(t=0;t<r;t++){var i=e.failedRequests[2*t]||mR.EMPTY_STRING,s=e.failedRequests[2*t+1]||mR.EMPTY_STRING,a=e.errors[t]||mR.EMPTY_STRING;if(!((o+=i.toString().length+s.toString().length+a.length+3)<NR.MAX_LAST_HEADER_BYTES))break;n+=1}return n},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||mR.EMPTY_STRING),e.push(this.regionSource||mR.EMPTY_STRING),e.push(this.regionOutcome||mR.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),AN=function(){function e(e,t,n,o,r,i,s,a,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=r,this.navigationClient=i,this.nativeMessageHandler=a,this.correlationId=l||this.browserCrypto.createNewGuid(),this.logger=o.clone(mP,lN,this.correlationId),this.performanceClient=s}return e.prototype.clearCacheOnLogout=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];TM.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(TM.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e,t){return tR(this,void 0,void 0,(function(){var n,o,r,i;return nR(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),n=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(n,t)]:[3,2];case 1:s.sent(),s.label=2;case 2:if(o=rR(e&&e.scopes||[]),(r=XA(XA({},e),{correlationId:this.correlationId,authority:n,scopes:o})).authenticationScheme){if(r.authenticationScheme===MR.SSH){if(!e.sshJwk)throw kM.createMissingSshJwkError();if(!e.sshKid)throw kM.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+r.authenticationScheme+'" as configured in Auth request')}else r.authenticationScheme=MR.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!RO.isEmptyObj(e.claims)?(i=r,[4,this.browserCrypto.hashString(e.claims)]):[3,4];case 3:i.requestedClaimsHash=s.sent(),s.label=4;case 4:return[2,r]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||oN.getCurrentUri();return VM.getAbsoluteUrl(t,oN.getCurrentUri())},e.prototype.validateRequestAuthority=function(e,t){return tR(this,void 0,void 0,(function(){return nR(this,(function(n){switch(n.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(!n.sent().isAlias(t.environment))throw kM.createAuthorityMismatchError();return[2]}}))}))},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new EN(n,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){switch(n.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,IN.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:case 3:return[2,n.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,IN.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)]}}))}))},e}(),RN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return YA(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return tR(this,void 0,void 0,(function(){var t,n;return nR(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=o.sent(),n=XA(XA({},e),{redirectUri:e.redirectUri,code:mR.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=mR.S256_CODE_CHALLENGE_METHOD,[2,n]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);var t=XA({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=VM.getAbsoluteUrl(e.postLogoutRedirectUri,oN.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=VM.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,oN.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=VM.getAbsoluteUrl(oN.getCurrentUri(),oN.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,n){return tR(this,void 0,void 0,(function(){var o;return nR(this,(function(r){switch(r.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,n)];case 1:return o=r.sent(),[2,new wN(o,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,n){return tR(this,void 0,void 0,(function(){var o,r;return nR(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,n)];case 1:return o=i.sent(),r=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:r.loggerCallback,piiLoggingEnabled:r.piiLoggingEnabled,logLevel:r.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:mP,version:lN,cpu:mR.EMPTY_STRING,os:mR.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,n){if(this.logger.verbose("validateAndExtractStateFromHash called",n),!e.state)throw xD.createHashDoesNotContainStateError();var o=jM.extractBrowserRequestState(this.browserCrypto,e.state);if(!o)throw xD.createUnableToParseStateError();if(o.interactionType!==t)throw xD.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",n),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var n;return tR(this,void 0,void 0,(function(){var o,r,i,s;return nR(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(ZA.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,s=TN.generateAuthority(i,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(ZA.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,IN.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,r,this.logger,this.performanceClient,this.correlationId).then((function(e){return o.endMeasurement({success:!0}),e})).catch((function(e){throw o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,a.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return tR(this,void 0,void 0,(function(){var n,o,r,i,s,a,l;return nR(this,(function(c){switch(c.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),n=this.getRedirectUri(e.redirectUri),o={interactionType:t},r=zM.setRequestState(this.browserCrypto,e&&e.state||mR.EMPTY_STRING,o),this.performanceClient.setPreQueueTime(ZA.InitializeBaseRequest,this.correlationId),s=[{}],[4,this.initializeBaseRequest(e)];case 1:return i=XA.apply(void 0,[XA.apply(void 0,s.concat([c.sent()])),{redirectUri:n,state:r,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:xR.FRAGMENT}]),(a=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+a.homeAccountId,this.correlationId),i.account=a),RO.isEmpty(i.loginHint)&&!a&&(l=this.browserStorage.getLegacyLoginHint())&&(i.loginHint=l),[2,i]}}))}))},t}(AN);!function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(_N||(_N={}));var PN,ON={code:"ContentError"},DN={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},MN={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},NN=function(e){function t(n,o,r){var i=e.call(this,n,o)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=r,i}return YA(t,e),t.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==_N.PERSISTENT_ERROR&&this.ext.status!==_N.DISABLED)||this.errorCode===ON.code},t.createError=function(e,n,o){if(o&&o.status)switch(o.status){case _N.ACCOUNT_UNAVAILABLE:return uP.createNativeAccountUnavailableError();case _N.USER_INTERACTION_REQUIRED:return new uP(e,n);case _N.USER_CANCEL:return xD.createUserCancelledError();case _N.NO_NETWORK:return xD.createNoNetworkConnectivityError()}return new t(e,n,o)},t.createUserSwitchError=function(){return new t(DN.code,DN.desc)},t.createTokensNotFoundInCacheError=function(){return new t(MN.code,MN.desc)},t}(iP),LN=function(e){function t(t,n){return e.call(this,t,n)||this}return aR(t,e),t.prototype.acquireToken=function(e){var t,n,o,r,i,s,a;return cR(this,void 0,void 0,(function(){var l,c,d,u,h,p,f=this;return dR(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.RefreshTokenClientAcquireToken,e.correlationId),l=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(ZA.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),c=OM.nowSeconds(),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(ZA.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return d=g.sent(),u=null===(r=d.headers)||void 0===r?void 0:r[hR.X_MS_HTTP_VERSION],null===l||void 0===l||l.addStaticFields({refreshTokenSize:(null===(i=d.body.refresh_token)||void 0===i?void 0:i.length)||0}),u&&(null===l||void 0===l||l.addStaticFields({httpVerToken:u})),h=null===(s=d.headers)||void 0===s?void 0:s[hR.X_MS_REQUEST_ID],(p=new bN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(d.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(ZA.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(d.body,this.authority,c,e,void 0,void 0,!0,e.forceCache,h).then((function(e){return null===l||void 0===l||l.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching refresh token",e.correlationId),null===l||void 0===l||l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,n,o,r;return cR(this,void 0,void 0,(function(){var i,s;return dR(this,(function(a){if(!e)throw kM.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw AO.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(ZA.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(sL){if(i=sL instanceof uP&&sL.errorCode===cP.code,s=sL instanceof sP&&sL.errorCode===GR&&sL.subError===$R,i||s)return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(ZA.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw sL}return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var n,o,r;return cR(this,void 0,void 0,(function(){var i,s,a;return dR(this,(function(l){if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ZA.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(s=this.cacheManager.getRefreshToken(e.account,t)))throw null===i||void 0===i||i.discardMeasurement(),uP.createNoTokensFoundError();return null===i||void 0===i||i.endMeasurement({success:!0}),a=lR(lR({},e),{refreshToken:s.secret,authenticationScheme:e.authenticationScheme||MR.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:SM.HOME_ACCOUNT_ID}}),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(a)]}))}))},t.prototype.executeTokenRequest=function(e,t){var n,o,r;return cR(this,void 0,void 0,(function(){var i,s,a,l,c,d;return dR(this,(function(u){switch(u.label){case 0:return null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(ZA.RefreshTokenClientExecuteTokenRequest,e.correlationId),i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(ZA.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(ZA.RefreshTokenClientCreateTokenRequestBody,e.correlationId),s=this.createTokenQueryParameters(e),a=VM.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(e)];case 1:return l=u.sent(),c=this.createTokenRequestHeaders(e.ccsCredential),d={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(a,l,c,d).then((function(e){return null===i||void 0===i||i.endMeasurement({success:!0}),e})).catch((function(e){throw null===i||void 0===i||i.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,n,o;return cR(this,void 0,void 0,(function(){var r,i,s,a,l,c,d;return dR(this,(function(u){switch(u.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(ZA.RefreshTokenClientCreateTokenRequestBody,e.correlationId),r=e.correlationId,i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(ZA.BaseClientCreateTokenRequestHeaders,r),(s=new fN).addClientId(this.config.authOptions.clientId),s.addScopes(e.scopes),s.addGrantType(CR.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(r),s.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(a=this.config.clientCredentials.clientAssertion,s.addClientAssertion(a.assertion),s.addClientAssertionType(a.assertionType)),e.authenticationScheme!==MR.POP?[3,2]:(l=new mN(this.cryptoUtils,this.performanceClient),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(ZA.PopTokenGenerateCnf,e.correlationId),[4,l.generateCnf(e)]);case 1:return c=u.sent(),s.addPopToken(c.reqCnfString),[3,3];case 2:if(e.authenticationScheme===MR.SSH){if(!e.sshJwk)throw null===i||void 0===i||i.endMeasurement({success:!1}),kM.createMissingSshJwkError();s.addSshJwk(e.sshJwk)}u.label=3;case 3:if((!RO.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case SM.HOME_ACCOUNT_ID:try{d=_M(e.ccsCredential.credential),s.addCcsOid(d)}catch(sL){this.logger.verbose("Could not parse home account ID for CCS Header: "+sL)}break;case SM.UPN:s.addCcsUpn(e.ccsCredential.credential)}return null===i||void 0===i||i.endMeasurement({success:!0}),[2,s.createQueryString()]}}))}))},t}(gN),FN=function(e){function t(t,n){return e.call(this,t,n)||this}return aR(t,e),t.prototype.acquireToken=function(e){return cR(this,void 0,void 0,(function(){var t;return dR(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,n.sent()];case 2:if((t=n.sent())instanceof AO&&t.errorCode===wO.code)return[2,new LN(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,n,o,r,i;return cR(this,void 0,void 0,(function(){var s,a;return dR(this,(function(l){switch(l.label){case 0:if(!e)throw kM.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(HR.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),AO.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!RO.isEmptyObj(e.claims))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(HR.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),AO.createRefreshRequiredError();if(!e.account)throw AO.createNoAccountInSilentRequestError();if(s=e.authority||this.authority.getPreferredCache(),!(a=this.cacheManager.readCacheRecord(e.account,e,s)).accessToken)throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(HR.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),AO.createRefreshRequiredError();if(OM.wasClockTurnedBack(a.accessToken.cachedAt)||OM.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(HR.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),AO.createRefreshRequiredError();if(a.accessToken.refreshOn&&OM.isTokenExpired(a.accessToken.refreshOn,0))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(HR.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),AO.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(a,e)];case 1:return[2,l.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return cR(this,void 0,void 0,(function(){var n,o;return dR(this,(function(r){switch(r.label){case 0:if(e.idToken&&(n=new IM(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(o=null===n||void 0===n?void 0:n.claims.auth_time))throw AO.createAuthTimeNotFoundError();IM.checkMaxAge(o,t.maxAge)}return[4,bN.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)];case 1:return[2,r.sent()]}}))}))},t}(gN),UN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i;return nR(this,(function(s){switch(s.label){case 0:return t=this.performanceClient.startMeasurement(ZA.SilentCacheClientAcquireToken,e.correlationId),n=this.initializeServerTelemetryManager(eP.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(n,e.authority,e.azureCloudOptions)];case 1:o=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,o.acquireCachedToken(e)];case 3:return r=s.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,r];case 4:throw(i=s.sent())instanceof xD&&i.errorCode===uD.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:i instanceof iP&&i.errorCode||void 0,subErrorCode:i instanceof iP&&i.subError||void 0,success:!1}),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(xD.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,n){return tR(this,void 0,void 0,(function(){var o;return nR(this,(function(r){switch(r.label){case 0:return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,n)];case 1:return o=r.sent(),[2,new FN(o,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return tR(this,void 0,void 0,(function(){var n;return nR(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(ZA.InitializeBaseRequest,this.correlationId),n=[XA({},e)],[4,this.initializeBaseRequest(e,t)];case 1:return[2,XA.apply(void 0,[XA.apply(void 0,n.concat([o.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(RN),zN=function(e){function t(t,n,o,r,i,s,a,l,c,d,u,h){var p=e.call(this,t,n,o,r,i,s,l,c,h)||this;return p.apiId=a,p.accountId=d,p.nativeMessageHandler=c,p.nativeStorageManager=u,p.silentCacheClient=new UN(t,p.nativeStorageManager,o,r,i,s,l,c,h),p}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a;return nR(this,(function(l){switch(l.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(ZA.NativeInteractionClientAcquireToken,e.correlationId),n=OM.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:o=l.sent(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,o)];case 3:return r=l.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,r];case 4:return l.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return i={method:WR.GetToken,request:o},[4,this.nativeMessageHandler.sendMessage(i)];case 6:return s=l.sent(),a=this.validateNativeResponse(s),[2,this.handleNativeResponse(a,o,n).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:xM.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return tR(this,void 0,void 0,(function(){var n,o;return nR(this,(function(r){switch(r.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),AO.createNoAccountFoundError();if(!(n=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw AO.createNoAccountFoundError();r.label=1;case 1:return r.trys.push([1,3,,4]),o=this.createSilentCacheRequest(t,n),[4,this.silentCacheClient.acquireToken(o)];case 2:return[2,r.sent()];case 3:throw r.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s;return nR(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),n={method:WR.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(n)];case 3:return o=a.sent(),this.validateNativeResponse(o),[3,5];case 4:if((r=a.sent())instanceof NN&&r.isFatal())throw r;return[3,5];case 5:return this.browserStorage.setTemporaryCache(ZR.NATIVE_REQUEST,JSON.stringify(t),!0),i={apiId:eP.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(s,i)];case 6:return a.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return tR(this,void 0,void 0,(function(){var e,t,n,o,r,i,s,a;return nR(this,(function(l){switch(l.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,n=eR(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ZR.NATIVE_REQUEST)),o={method:WR.GetToken,request:n},r=OM.nowSeconds(),l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(o)];case 2:return i=l.sent(),this.validateNativeResponse(i),s=this.handleNativeResponse(i,n,r),this.browserStorage.setInteractionInProgress(!1),[2,s];case 3:throw a=l.sent(),this.browserStorage.setInteractionInProgress(!1),a;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,n){return tR(this,void 0,void 0,(function(){var o,r,i,s,a,l;return nR(this,(function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw NN.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return o=c.sent(),r=o.getPreferredCache(),i=this.createIdTokenObj(e),s=this.createHomeAccountIdentifier(e,i),a=this.createAccountEntity(e,s,i,r),[4,this.generateAuthenticationResult(e,t,i,a,o.canonicalAuthority,n)];case 2:return l=c.sent(),this.cacheAccount(a),this.cacheNativeTokens(e,t,s,a,i,l.accessToken,l.tenantId,n),[2,l]}}))}))},t.prototype.createIdTokenObj=function(e){return new IM(e.id_token||mR.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return TM.generateHomeAccountId(e.client_info||mR.EMPTY_STRING,jD.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,n,o){return TM.createAccount(e.client_info,t,n,void 0,void 0,void 0,o,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?xM.fromString(e.scope):xM.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return tR(this,void 0,void 0,(function(){var n,o;return nR(this,(function(r){switch(r.label){case 0:if(t.tokenType!==MR.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(n=new mN(this.browserCrypto),o={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw AO.createKeyIdMissingError();return[4,n.signPopToken(e.access_token,t.keyId,o)];case 1:return[2,r.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,n,o,r,i){return tR(this,void 0,void 0,(function(){var s,a,l,c,d,u,h;return nR(this,(function(p){switch(p.label){case 0:return s=this.addTelemetryFromNativeResponse(e),a=e.scope?xM.fromString(e.scope):xM.fromString(t.scope),l=e.account.properties||{},c=l.UID||n.claims.oid||n.claims.sub||mR.EMPTY_STRING,d=l.TenantId||n.claims.tid||mR.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return u=p.sent(),h=t.tokenType===MR.POP?MR.POP:MR.BEARER,[2,{authority:r,uniqueId:c,tenantId:d,scopes:a.asArray(),account:o.getAccountInfo(),idToken:e.id_token,idTokenClaims:n.claims,accessToken:u,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:h,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,n,o,r,i,s,a){var l=ZD.createIdTokenEntity(n,t.authority,e.id_token||mR.EMPTY_STRING,t.clientId,r.claims.tid||mR.EMPTY_STRING),c=a+(t.tokenType===MR.POP?mR.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),d=this.generateScopes(e,t),u=DM.createAccessTokenEntity(n,t.authority,i,t.clientId,r?r.claims.tid||mR.EMPTY_STRING:s,d.printScopes(),c,0,this.browserCrypto),h=new vN(o,l,u);this.nativeStorageManager.saveCacheRecord(h)},t.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw NN.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(sL){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a,l,c,d=this;return nR(this,(function(u){switch(u.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,e.account?[4,this.validateRequestAuthority(t,e.account)]:[3,2];case 1:u.sent(),u.label=2;case 2:return(n=new VM(t)).validateAsUri(),o=e.scopes,r=eR(e,["scopes"]),(i=new xM(o||[])).appendScopes(yR),s=function(){switch(d.apiId){case eP.ssoSilent:case eP.acquireTokenSilent_silentFlow:return d.logger.trace("initializeNativeRequest: silent request sets prompt to none"),kR.NONE}if(e.prompt)switch(e.prompt){case kR.NONE:case kR.CONSENT:case kR.LOGIN:return d.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw d.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),xD.createNativePromptParameterNotSupportedError()}else d.logger.trace("initializeNativeRequest: prompt was not provided")},a=XA(XA({},r),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:XA(XA(XA({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:wP}),extendedExpiryToken:!1}),e.authenticationScheme!==MR.POP?[3,4]:(l={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new mN(this.browserCrypto).generateCnf(l)]);case 3:c=u.sent(),a.reqCnf=c.reqCnfString,a.keyId=c.kid,u.label=4;case 4:return[2,a]}}))}))},t}(AN),HN=function(){function e(e,t,n,o){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(ZA.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return tR(this,void 0,void 0,(function(){var t,n=this;return nR(this,(function(o){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:yP,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,o){n.resolvers.set(t.responseId,{resolve:e,reject:o})}))]}))}))},e.createProvider=function(t,n,o){return tR(this,void 0,void 0,(function(){var r,i;return nR(this,(function(s){switch(s.label){case 0:t.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),[4,(r=new e(t,n,o,bP)).sendHandshakeRequest()];case 2:return s.sent(),[2,r];case 3:return s.sent(),[4,(i=new e(t,n,o)).sendHandshakeRequest()];case 4:return s.sent(),[2,i];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return tR(this,void 0,void 0,(function(){var e,t=this;return nR(this,(function(n){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:yP,extensionId:this.extensionId,responseId:this.responseId++,body:{method:WR.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(n,o){t.handshakeResolvers.set(e.responseId,{resolve:n,reject:o}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),o(xD.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===yP&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===WR.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var n=this.handshakeResolvers.get(t.responseId);n&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),n.reject(xD.createNativeExtensionNotInstalledError()))}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,n=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{var r=t.body.method;if(r===WR.Response){if(!n)return;var i=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(i)),"Success"!==i.status)n.reject(NN.createError(i.code,i.description,i.ext));else{if(!i.result)throw iP.createUnexpectedError("Event does not contain result.");i.result.code&&i.result.description?n.reject(NN.createError(i.result.code,i.result.description,i.result.ext)):n.resolve(i.result)}this.resolvers.delete(t.responseId)}else if(r===WR.HandshakeResponse){if(!o)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+s.toString()),this.logger.errorPii("Unable to parse "+e),n?n.reject(s):o&&o.reject(s)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,n,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case MR.BEARER:case MR.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),qN=function(){function e(e,t,n,o,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=o,this.performanceClient=r}return e.prototype.handleCodeResponseFromHash=function(e,t,n,o){return tR(this,void 0,void 0,(function(){var r,i,s;return nR(this,(function(a){if(this.performanceClient.addQueueMeasurement(ZA.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),RO.isEmpty(e))throw xD.createEmptyHashError(e);if(r=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(r)))throw AO.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(sL){throw sL instanceof sP&&sL.subError===VO.code?xD.createUserCancelledError():sL}return this.performanceClient.setPreQueueTime(ZA.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(s,t,n,o)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,n,o,r){return void 0===r&&(r=!0),tR(this,void 0,void 0,(function(){var i,s,a,l,c,d;return nR(this,(function(u){switch(u.label){case 0:if(this.performanceClient.addQueueMeasurement(ZA.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),i=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(i)))throw AO.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),l=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(ZA.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,n,o)]):[3,2];case 1:u.sent(),u.label=2;case 2:return r&&(e.nonce=l||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(c=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=c),this.performanceClient.setPreQueueTime(ZA.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return d=u.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,n){return tR(this,void 0,void 0,(function(){var o,r;return nR(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),o="https://"+e+"/"+t.tenant+"/",[4,IN.createDiscoveredInstance(o,n,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return r=i.sent(),this.authModule.updateAuthority(r),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(ZR.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(sL){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),BN=function(e){function t(t,n,o,r,i,s,a,l,c,d){var u=e.call(this,t,n,o,r,i,s,a,c,d)||this;return u.unloadWindow=u.unloadWindow.bind(u),u.nativeStorage=l,u}return YA(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||yR,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,n);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var o=this.openSizedPopup("about:blank",t,n);return this.acquireTokenPopupAsync(e,t,n,o)}catch(sL){return Promise.reject(sL)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(t),o=e&&e.authority,r=e&&e.mainWindowRedirectUri,i=(null===e||void 0===e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,i,o,void 0,r);this.logger.verbose("asyncPopup set to false, opening popup");var s=this.openSizedPopup("about:blank",n,i);return this.logoutPopupAsync(t,n,i,o,s,r)}catch(sL){return Promise.reject(sL)}},t.prototype.acquireTokenPopupAsync=function(e,t,n,o){return tR(this,void 0,void 0,(function(){var r,i,s,a,l,c,d,u,h,p,f,g,v,m,y,b,w=this;return nR(this,(function(k){switch(k.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),r=this.initializeServerTelemetryManager(eP.acquireTokenPopup),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,tP.Popup)];case 1:i=k.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||mR.EMPTY_STRING,i.account||null),k.label=2;case 2:return k.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(i)];case 3:return s=k.sent(),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,i.authority,i.azureCloudOptions)];case 4:return a=k.sent(),this.logger.verbose("Auth code client created"),l=HN.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),c=void 0,l&&(c=this.performanceClient.startMeasurement(ZA.FetchAccountIdWithNativeBroker,e.correlationId)),[4,a.getAuthCodeUrl(XA(XA({},i),{nativeBroker:l}))];case 5:return d=k.sent(),u=new qN(a,this.browserStorage,s,this.logger,this.performanceClient),h={popup:o,popupName:t,popupWindowAttributes:n},p=this.initiateAuthRequest(d,h),this.eventHandler.emitEvent(sN.POPUP_OPENED,tP.Popup,{popupWindow:p},null),[4,this.monitorPopupForHash(p)];case 6:if(f=k.sent(),g=VM.getDeserializedHash(f),v=this.validateAndExtractStateFromHash(g,tP.Popup,i.correlationId),uN.removeThrottle(this.browserStorage,this.config.auth.clientId,s),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw xD.createNativeConnectionNotEstablishedError();return m=new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,i.correlationId),y=zM.parseRequestState(this.browserCrypto,v).userRequestState,[2,m.acquireToken(XA(XA({},i),{state:y,prompt:void 0})).finally((function(){w.browserStorage.cleanRequestByState(v)}))]}return[4,u.handleCodeResponseFromHash(f,v,a.authority,this.networkClient)];case 7:return[2,k.sent()];case 8:throw b=k.sent(),o&&o.close(),b instanceof iP&&b.setCorrelationId(this.correlationId),r.cacheFailedRequest(b),this.browserStorage.cleanRequestByState(i.state),b;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,n,o,r,i){return tR(this,void 0,void 0,(function(){var s,a,l,c,d,u,h;return nR(this,(function(p){switch(p.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(sN.LOGOUT_START,tP.Popup,e),s=this.initializeServerTelemetryManager(eP.logoutPopup),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return p.sent(),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(s,o)];case 3:return a=p.sent(),this.logger.verbose("Auth code client created"),l=a.getLogoutUri(e),this.eventHandler.emitEvent(sN.LOGOUT_SUCCESS,tP.Popup,e),c=this.openPopup(l,{popupName:t,popupWindowAttributes:n,popup:r}),this.eventHandler.emitEvent(sN.POPUP_OPENED,tP.Popup,{popupWindow:c},null),[4,this.waitForLogoutPopup(c)];case 4:return p.sent(),i?(d={apiId:eP.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=VM.getAbsoluteUrl(i,oN.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+u),this.navigationClient.navigateInternal(u,d)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw h=p.sent(),r&&r.close(),h instanceof iP&&h.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(sN.LOGOUT_FAILURE,tP.Popup,null,h),this.eventHandler.emitEvent(sN.LOGOUT_END,tP.Popup),s.cacheFailedRequest(h),h;case 6:return this.eventHandler.emitEvent(sN.LOGOUT_END,tP.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(RO.isEmpty(e))throw this.logger.error("Navigate url is empty"),xD.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(n,o){var r=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,i=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var s=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(s),void o(xD.createUserCancelledError());var a=mR.EMPTY_STRING,l=mR.EMPTY_STRING;try{a=e.location.href,l=e.location.hash}catch(sL){}RO.isEmpty(a)||"about:blank"===a||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),i++,l?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(s),t.cleanPopup(e),VM.hashContainsKnownProperties(l)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),n(l)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+l),o(xD.createHashDoesNotContainKnownPropertiesError()))):i>r&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(s),o(xD.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(n){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var o=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(o),n());var r=mR.EMPTY_STRING;try{r=e.location.href}catch(sL){}RO.isEmpty(r)||"about:blank"===r||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(o),t.cleanPopup(e),n())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var n=void 0;if(t.popup?(n=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),n=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!n)throw xD.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(sL){throw this.logger.error("error opening popup "+sL.message),this.browserStorage.setInteractionInProgress(!1),xD.createPopupWindowError(sL.toString())}},t.prototype.openSizedPopup=function(e,t,n){var o,r,i,s,a=window.screenLeft?window.screenLeft:window.screenX,l=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=null===(o=n.popupSize)||void 0===o?void 0:o.width,h=null===(r=n.popupSize)||void 0===r?void 0:r.height,p=null===(i=n.popupPosition)||void 0===i?void 0:i.top,f=null===(s=n.popupPosition)||void 0===s?void 0:s.left;return(!u||u<0||u>c)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=pP),(!h||h<0||h>d)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=fP),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,d/2-fP/2+l)),(!f||f<0||f>c)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,c/2-pP/2+a)),window.open(e,t,"width="+u+", height="+h+", top="+p+", left="+f+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(tP.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return gP+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return gP+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}(RN),VN=function(e){function t(t,n,o,r,i,s){var a=e.call(this,t,n,o,r,s)||this;return a.browserCrypto=i,a}return YA(t,e),t.prototype.initiateAuthRequest=function(e,t){return tR(this,void 0,void 0,(function(){var n;return nR(this,(function(o){switch(o.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),RO.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ZR.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ZR.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),n={apiId:eP.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!==typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,n)])));case 1:case 5:return o.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,n)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),xD.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,n,o){return tR(this,void 0,void 0,(function(){var r,i,s,a,l,c,d;return nR(this,(function(u){switch(u.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),RO.isEmpty(e))throw xD.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),r=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(r)))throw AO.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,i)}catch(sL){throw sL instanceof sP&&sL.subError===VO.code?xD.createUserCancelledError():sL}return a=this.browserStorage.generateNonceKey(i),l=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,n,o)]:[3,2];case 1:u.sent(),u.label=2;case 2:return s.nonce=l||void 0,s.state=i,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(c=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=c),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return d=u.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},t}(qN),jN=function(e){function t(t,n,o,r,i,s,a,l,c,d){var u=e.call(this,t,n,o,r,i,s,a,c,d)||this;return u.nativeStorage=l,u}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a,l,c,d=this;return nR(this,(function(u){switch(u.label){case 0:return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,tP.Redirect)];case 1:t=u.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||mR.EMPTY_STRING,t.account||null),n=this.initializeServerTelemetryManager(eP.acquireTokenRedirect),o=function(e){e.persisted&&(d.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),d.browserStorage.cleanRequestByState(t.state),d.eventHandler.emitEvent(sN.RESTORE_FROM_BFCACHE,tP.Redirect))},u.label=2;case 2:return u.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return r=u.sent(),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,t.authority,t.azureCloudOptions)];case 4:return i=u.sent(),this.logger.verbose("Auth code client created"),s=new VN(i,this.browserStorage,r,this.logger,this.browserCrypto,this.performanceClient),[4,i.getAuthCodeUrl(XA(XA({},t),{nativeBroker:HN.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return a=u.sent(),l=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+l),window.addEventListener("pageshow",o),[4,s.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,u.sent()];case 7:throw(c=u.sent())instanceof iP&&c.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",o),n.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a,l,c,d,u,h;return nR(this,(function(p){switch(p.label){case 0:t=this.initializeServerTelemetryManager(eP.handleRedirectPromise),p.label=1;case 1:if(p.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(n=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(tP.Redirect),[2,null];o=void 0;try{r=VM.getDeserializedHash(n),o=this.validateAndExtractStateFromHash(r,tP.Redirect),this.logger.verbose("State extracted from hash")}catch(sL){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+sL),this.browserStorage.cleanRequestByInteractionType(tP.Redirect),[2,null]}return i=this.browserStorage.getTemporaryCache(ZR.ORIGIN_URI,!0)||mR.EMPTY_STRING,s=VM.removeHashFromUrl(i),a=VM.removeHashFromUrl(window.location.href),s===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(n,o,t)]):[3,3];case 2:return l=p.sent(),i.indexOf("#")>-1&&oN.replaceHash(i),[2,l];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(n,o,t)]);case 4:return oN.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(ZR.URL_HASH,n,!0),c={apiId:eP.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},d=!0,i&&"null"!==i?[3,6]:(u=oN.getHomepage(),this.browserStorage.setTemporaryCache(ZR.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(u,c)]));case 5:return d=p.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+i),[4,this.navigationClient.navigateInternal(i,c)];case 7:d=p.sent(),p.label=8;case 8:if(!d)return[2,this.handleHash(n,o,t)];p.label=9;case 9:return[2,null];case 10:throw(h=p.sent())instanceof iP&&h.setCorrelationId(this.correlationId),t.cacheFailedRequest(h),this.browserStorage.cleanRequestByInteractionType(tP.Redirect),h;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),VM.hashContainsKnownProperties(e))return oN.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(ZR.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ZR.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,n){return tR(this,void 0,void 0,(function(){var o,r,i,s,a,l,c=this;return nR(this,(function(d){switch(d.label){case 0:if(o=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(r=VM.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw xD.createNativeConnectionNotEstablishedError();return i=new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,r.accountId,this.nativeStorage,o.correlationId),s=zM.parseRequestState(this.browserCrypto,t).userRequestState,[2,i.acquireToken(XA(XA({},o),{state:s,prompt:void 0})).finally((function(){c.browserStorage.cleanRequestByState(t)}))]}if(!(a=this.browserStorage.getCachedAuthority(t)))throw xD.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(n,a)];case 1:return l=d.sent(),this.logger.verbose("Auth code client created"),uN.removeThrottle(this.browserStorage,this.config.auth.clientId,o),[4,new VN(l,this.browserStorage,o,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,l.authority,this.networkClient)];case 2:return[2,d.sent()]}}))}))},t.prototype.logout=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s;return nR(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(eP.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(sN.LOGOUT_START,tP.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),o={apiId:eP.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(n,e&&e.authority)];case 3:return r=a.sent(),this.logger.verbose("Auth code client created"),i=r.getLogoutUri(t),this.eventHandler.emitEvent(sN.LOGOUT_SUCCESS,tP.Redirect,t),e&&"function"===typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,o)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(i,o)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof iP&&s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s),this.eventHandler.emitEvent(sN.LOGOUT_FAILURE,tP.Redirect,null,s),this.eventHandler.emitEvent(sN.LOGOUT_END,tP.Redirect),s;case 11:return this.eventHandler.emitEvent(sN.LOGOUT_END,tP.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return VM.getAbsoluteUrl(t,oN.getCurrentUri())},t}(RN),KN=function(e){function t(t,n,o,r,i,s){var a=e.call(this,t,n,o,r,s)||this;return a.navigateFrameWait=i.navigateFrameWait,a.pollIntervalMilliseconds=i.pollIntervalMilliseconds,a}return YA(t,e),t.prototype.initiateAuthRequest=function(e){return tR(this,void 0,void 0,(function(){return nR(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(ZA.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),RO.isEmpty(e))throw this.logger.info("Navigate url is empty"),xD.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(ZA.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var n=this;return this.performanceClient.addQueueMeasurement(ZA.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(o,r){t<iN&&n.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+iN+"ms). This may result in timeouts.");var i=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>i)return n.removeHiddenIframe(e),clearInterval(s),void r(xD.createMonitorIframeTimeoutError());var t=mR.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:mR.EMPTY_STRING}catch(sL){}if(!RO.isEmpty(t)){var l=a?a.location.hash:mR.EMPTY_STRING;return VM.hashContainsKnownProperties(l)?(n.removeHiddenIframe(e),clearInterval(s),void o(l)):void 0}}),n.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(ZA.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(n,o){var r=t.createHiddenIframe();setTimeout((function(){r?(r.src=e,n(r)):o("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(qN),GN=function(e){function t(t,n,o,r,i,s,a,l,c,d,u){var h=e.call(this,t,n,o,r,i,s,l,d,u)||this;return h.apiId=a,h.nativeStorage=c,h}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i;return nR(this,(function(s){switch(s.label){case 0:if(this.performanceClient.addQueueMeasurement(ZA.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(ZA.SilentIframeClientAcquireToken,e.correlationId),RO.isEmpty(e.loginHint)&&RO.isEmpty(e.sid)&&(!e.account||RO.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==kR.NONE&&e.prompt!==kR.NO_SESSION)throw t.endMeasurement({success:!1}),xD.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(XA(XA({},e),{prompt:e.prompt||kR.NONE}),tP.Silent)];case 1:n=s.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||mR.EMPTY_STRING,n.account||null),o=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(o,n.authority,n.azureCloudOptions)];case 3:return r=s.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(ZA.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(r,n).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,s.sent()];case 5:throw(i=s.sent())instanceof iP&&i.setCorrelationId(this.correlationId),o.cacheFailedRequest(i),this.browserStorage.cleanRequestByState(n.state),t.endMeasurement({errorCode:i instanceof iP&&i.errorCode||void 0,subErrorCode:i instanceof iP&&i.subError||void 0,success:!1}),i;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(xD.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return tR(this,void 0,void 0,(function(){var n,o,r,i,s,a,l,c,d,u=this;return nR(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return n=h.sent(),this.performanceClient.setPreQueueTime(ZA.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(XA(XA({},t),{nativeBroker:HN.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return o=h.sent(),r=new KN(e,this.browserStorage,n,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(ZA.SilentHandlerInitiateAuthRequest,t.correlationId),[4,r.initiateAuthRequest(o)];case 3:return i=h.sent(),this.performanceClient.setPreQueueTime(ZA.SilentHandlerMonitorIframeForHash,t.correlationId),[4,r.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 4:if(s=h.sent(),a=VM.getDeserializedHash(s),l=this.validateAndExtractStateFromHash(a,tP.Silent,n.correlationId),a.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw xD.createNativeConnectionNotEstablishedError();return c=new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,a.accountId,this.browserStorage,this.correlationId),d=zM.parseRequestState(this.browserCrypto,l).userRequestState,[2,c.acquireToken(XA(XA({},t),{state:d,prompt:t.prompt||kR.NONE})).finally((function(){u.browserStorage.cleanRequestByState(l)}))]}return this.performanceClient.setPreQueueTime(ZA.HandleCodeResponseFromHash,t.correlationId),[2,r.handleCodeResponseFromHash(s,l,e.authority,this.networkClient)]}}))}))},t}(RN),$N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s=this;return nR(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(ZA.InitializeBaseRequest,e.correlationId),n=[XA({},e)],[4,this.initializeBaseRequest(e,e.account)];case 1:return t=XA.apply(void 0,n.concat([a.sent()])),o=this.performanceClient.startMeasurement(ZA.SilentRefreshClientAcquireToken,t.correlationId),r=this.initializeServerTelemetryManager(eP.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(r,t.authority,t.azureCloudOptions)];case 2:return i=a.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(ZA.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,i.acquireTokenByRefreshToken(t).then((function(e){return o.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof iP&&e.setCorrelationId(s.correlationId),r.cacheFailedRequest(e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(xD.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,n){return tR(this,void 0,void 0,(function(){var o;return nR(this,(function(r){switch(r.label){case 0:return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,n)];case 1:return o=r.sent(),[2,new LN(o,this.performanceClient)]}}))}))},t}(RN),WN=function(){function e(e,t,n,o){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=o}return e.prototype.loadExternalTokens=function(e,t,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw xD.createUnableToLoadTokenError("Please ensure server response includes id token.");var o,r,i=new IM(t.id_token,this.cryptoObj);if(e.account){var s=this.loadAccount(i,e.account.environment,void 0,void 0,e.account.homeAccountId);o=new vN(s,this.loadIdToken(i,s.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,s.homeAccountId,e.account.environment,e.account.tenantId,n),this.loadRefreshToken(e,t,s.homeAccountId,e.account.environment))}else{if(!e.authority)throw xD.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var a=TN.generateAuthority(e.authority,e.azureCloudOptions),l={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(r=new TN(a,this.config.system.networkClient,this.storage,l,this.logger),n.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");s=this.loadAccount(i,r.hostnameAndPort,n.clientInfo,r.authorityType);o=new vN(s,this.loadIdToken(i,s.homeAccountId,r.hostnameAndPort,r.tenant),this.loadAccessToken(e,t,s.homeAccountId,r.hostnameAndPort,r.tenant,n),this.loadRefreshToken(e,t,s.homeAccountId,r.hostnameAndPort))}else{if(!t.client_info)throw xD.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");s=this.loadAccount(i,r.hostnameAndPort,t.client_info,r.authorityType);o=new vN(s,this.loadIdToken(i,s.homeAccountId,r.hostnameAndPort,r.tenant),this.loadAccessToken(e,t,s.homeAccountId,r.hostnameAndPort,r.tenant,n),this.loadRefreshToken(e,t,s.homeAccountId,r.hostnameAndPort))}}return this.generateAuthenticationResult(e,i,o,r)},e.prototype.loadAccount=function(e,t,n,o,r){var i;if(r?i=r:void 0!==o&&n&&(i=TM.generateHomeAccountId(n,o,this.logger,this.cryptoObj,e)),!i)throw xD.createUnableToLoadTokenError("Unexpected missing homeAccountId");var s=n?TM.createAccount(n,i,e,void 0,void 0,void 0,t):TM.createGenericAccount(i,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(s),s;throw xD.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,n,o){var r=ZD.createIdTokenEntity(t,n,e.rawToken,this.config.auth.clientId,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(r),r;throw xD.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,n,o,r,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw xD.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw xD.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new xM(e.scopes).printScopes(),a=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,l=i.extendedExpiresOn,c=DM.createAccessTokenEntity(n,o,t.access_token,this.config.auth.clientId,r,s,a,l,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(c),c;throw xD.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,n,o){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var r=MM.createRefreshTokenEntity(n,o,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(r),r;throw xD.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,n,o){var r,i,s,a,l=mR.EMPTY_STRING,c=[],d=null;(null===n||void 0===n?void 0:n.accessToken)&&(l=n.accessToken.secret,c=xM.fromString(n.accessToken.target).asArray(),d=new Date(1e3*Number(n.accessToken.expiresOn)),a=new Date(1e3*Number(n.accessToken.extendedExpiresOn)));var u=(null===t||void 0===t?void 0:t.claims.oid)||(null===t||void 0===t?void 0:t.claims.sub)||mR.EMPTY_STRING,h=(null===t||void 0===t?void 0:t.claims.tid)||mR.EMPTY_STRING;return{authority:o?o.canonicalAuthority:mR.EMPTY_STRING,uniqueId:u,tenantId:h,scopes:c,account:(null===n||void 0===n?void 0:n.account)?n.account.getAccountInfo():null,idToken:t?t.rawToken:mR.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:l,fromCache:!0,expiresOn:d,correlationId:e.correlationId||mR.EMPTY_STRING,requestId:mR.EMPTY_STRING,extExpiresOn:a,familyId:mR.EMPTY_STRING,tokenType:(null===(r=null===n||void 0===n?void 0:n.accessToken)||void 0===r?void 0:r.tokenType)||mR.EMPTY_STRING,state:mR.EMPTY_STRING,cloudGraphHostName:(null===(i=null===n||void 0===n?void 0:n.account)||void 0===i?void 0:i.cloudGraphHostName)||mR.EMPTY_STRING,msGraphHost:(null===(s=null===n||void 0===n?void 0:n.account)||void 0===s?void 0:s.msGraphHost)||mR.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),QN=function(e){function t(t){var n=e.call(this,t)||this;return n.includeRedirectUri=!1,n}return YA(t,e),t}(wN),YN=function(e){function t(t,n,o,r,i,s,a,l,c,d){var u=e.call(this,t,n,o,r,i,s,l,c,d)||this;return u.apiId=a,u}return YA(t,e),t.prototype.acquireToken=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s;return nR(this,(function(a){switch(a.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw xD.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,tP.Silent)];case 1:t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||mR.EMPTY_STRING,t.account||null),n=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,4,,5]),o=XA(XA({},t),{code:e.code}),this.performanceClient.setPreQueueTime(ZA.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(n,t.authority)];case 3:return r=a.sent(),i=new QN(r),this.logger.verbose("Auth code client created"),[2,new KN(i,this.browserStorage,o,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,i.authority,this.networkClient,!1)];case 4:throw(s=a.sent())instanceof iP&&s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(xD.createSilentLogoutUnsupportedError())},t}(RN),ZN=function(){function e(t,n){this.correlationId=n,this.measureName=e.makeMeasureName(t,n),this.startMark=e.makeStartMark(t,n),this.endMark=e.makeEndMark(t,n)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.performance&&"function"===typeof window.performance.mark&&"function"===typeof window.performance.measure&&"function"===typeof window.performance.clearMarks&&"function"===typeof window.performance.clearMeasures&&"function"===typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,n){if(e.supportsBrowserPerformance())try{n.forEach((function(n){var o=e.makeMeasureName(n.name,t);window.performance.getEntriesByName(o,"measure").length>0&&(window.performance.clearMeasures(o),window.performance.clearMarks(e.makeStartMark(o,t)),window.performance.clearMarks(e.makeEndMark(o,t)))}))}catch(sL){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(sL){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(sL){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var n=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),n}}catch(sL){}return null},e}(),JN=function(e){function t(t,n,o,r,i,s,a){var l=e.call(this,t,n,o,r,i,s)||this;return l.browserCrypto=new FD(l.logger,a),l.guidGenerator=new DP(l.browserCrypto),l}return YA(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new ZN(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),n=t&&t.eventId===e.event.eventId,o=[];n&&(null===t||void 0===t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){o.push(XA({},e))})),o.length>0&&ZN.flushMeasurements(e.event.correlationId,o)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.performance&&"function"===typeof window.performance.now},t.prototype.startMeasurement=function(t,n){var o=this,r=this.getPageVisibility(),i=e.prototype.startMeasurement.call(this,t,n);return XA(XA({},i),{endMeasurement:function(e){var t=i.endMeasurement(XA({startPageVisibility:r,endPageVisibility:o.getPageVisibility()},e));return o.deleteIncompleteSubMeasurements(i),t},discardMeasurement:function(){i.discardMeasurement(),o.deleteIncompleteSubMeasurements(i),i.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var n=this.preQueueTimeByCorrelationId.get(t);n&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+n.name+" found",t),this.addQueueMeasurement(n.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,n,o,r){if(this.supportsBrowserPerformanceNow())if(n){var i=e.prototype.getPreQueueTime.call(this,t,n);if(i){var s=window.performance.now(),a=o||e.prototype.calculateQueuedTime.call(this,i,s);return e.prototype.addQueueMeasurement.call(this,t,n,a,r)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(GD),XN=function(){function e(e){this.isBrowserEnvironment="undefined"!==typeof window,this.config=function(e,t){var n=e.auth,o=e.cache,r=e.system,i=e.telemetry,s={clientId:mR.EMPTY_STRING,authority:""+mR.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:mR.EMPTY_STRING,authorityMetadata:mR.EMPTY_STRING,redirectUri:mR.EMPTY_STRING,postLogoutRedirectUri:mR.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:HM.AAD,azureCloudOptions:{azureCloudInstance:qM.None,tenant:mR.EMPTY_STRING},skipAuthorityMetadataCache:!1},a={cacheLocation:QR.SessionStorage,temporaryCacheLocation:QR.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!o||o.cacheLocation!==QR.LocalStorage),claimsBasedCachingEnabled:!0},l={loggerCallback:function(){},logLevel:qD.Info,piiLoggingEnabled:!1},c=XA(XA({},GM),{loggerOptions:l,networkClient:t?oN.getBrowserNetworkClient():eN,navigationClient:new rN,loadFrameTimeout:0,windowHashTimeout:(null===r||void 0===r?void 0:r.loadFrameTimeout)||6e4,iframeHashTimeout:(null===r||void 0===r?void 0:r.loadFrameTimeout)||iN,navigateFrameWait:t&&oN.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null===r||void 0===r?void 0:r.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:vP,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),d=XA(XA({},r),{loggerOptions:(null===r||void 0===r?void 0:r.loggerOptions)||l}),u={application:{appName:mR.EMPTY_STRING,appVersion:mR.EMPTY_STRING}};return{auth:XA(XA({},s),n),cache:XA(XA({},a),o),system:XA(XA({},c),d),telemetry:XA(XA({},u),i)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new KD(this.config.system.loggerOptions,aN,lN),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new JN(this.config.auth.clientId,this.config.auth.authority,this.logger,aN,lN,this.config.telemetry.application,this.config.system.cryptoOptions):new WD(this.config.auth.clientId,this.config.auth.authority,this.logger,aN,lN,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new VD(this.logger,this.performanceClient,this.config.system.cryptoOptions):QD,this.eventHandler=new dN(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new KM(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(e,t){var n={cacheLocation:QR.MemoryStorage,temporaryCacheLocation:QR.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};return new KM(e,n,QD,t)}(this.config.auth.clientId,this.logger);var t={cacheLocation:QR.MemoryStorage,temporaryCacheLocation:QR.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};this.nativeInternalStorage=new KM(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new WN(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return tR(this,void 0,void 0,(function(){var e,t,n,o,r;return nR(this,(function(i){switch(i.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(ZA.InitializeClientApplication),this.eventHandler.emitEvent(sN.INITIALIZE_START),!e)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),n=this,[4,HN.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return n.nativeExtensionProvider=i.sent(),[3,4];case 3:return o=i.sent(),this.logger.verbose(o),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),r=this.performanceClient.startMeasurement(ZA.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:i.sent(),r.endMeasurement({success:!0}),i.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(sN.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a,l,c=this;return nR(this,(function(d){return this.logger.verbose("handleRedirectPromise called"),oN.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(n=e||mR.EMPTY_STRING,"undefined"===typeof(o=this.redirectResponse.get(n))?(this.eventHandler.emitEvent(sN.HANDLE_REDIRECT_START,tP.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),r=this.browserStorage.getCachedNativeRequest(),i=void 0,r&&HN.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId),i=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),a=this.browserStorage.getTemporaryCache(ZR.CORRELATION_ID,!0)||mR.EMPTY_STRING,l=this.createRedirectClient(a),i=l.handleRedirectPromise(e)),o=i.then((function(e){e&&(t.length<c.getAllAccounts().length?(c.eventHandler.emitEvent(sN.LOGIN_SUCCESS,tP.Redirect,e),c.logger.verbose("handleRedirectResponse returned result, login success")):(c.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_SUCCESS,tP.Redirect,e),c.logger.verbose("handleRedirectResponse returned result, acquire token success")));return c.eventHandler.emitEvent(sN.HANDLE_REDIRECT_END,tP.Redirect),e})).catch((function(e){throw t.length>0?c.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_FAILURE,tP.Redirect,null,e):c.eventHandler.emitEvent(sN.LOGIN_FAILURE,tP.Redirect,null,e),c.eventHandler.emitEvent(sN.HANDLE_REDIRECT_END,tP.Redirect),e})),this.redirectResponse.set(n,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s=this;return nR(this,(function(a){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(tP.Redirect),(n=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_START,tP.Redirect,e):this.eventHandler.emitEvent(sN.LOGIN_START,tP.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(r=new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),o=r.acquireTokenRedirect(e).catch((function(t){if(t instanceof NN&&t.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof uP)return s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),s.createRedirectClient(e.correlationId).acquireToken(e);throw s.browserStorage.setInteractionInProgress(!1),t}))):(i=this.createRedirectClient(e.correlationId),o=i.acquireToken(e)),[2,o.catch((function(e){throw n?s.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_FAILURE,tP.Redirect,null,e):s.eventHandler.emitEvent(sN.LOGIN_FAILURE,tP.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,n=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement(ZA.AcquireTokenPopup,n);try{this.logger.verbose("acquireTokenPopup called",n),this.preflightBrowserEnvironmentCheck(tP.Popup)}catch(sL){return Promise.reject(sL)}var r,i=this.getAllAccounts();(i.length>0?this.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_START,tP.Popup,e):this.eventHandler.emitEvent(sN.LOGIN_START,tP.Popup,e),this.canUseNative(e))?r=this.acquireTokenNative(e,eP.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),o.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(n){if(n instanceof NN&&n.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(n instanceof uP)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),n})):r=this.createPopupClient(e.correlationId).acquireToken(e);return r.then((function(e){return i.length<t.getAllAccounts().length?t.eventHandler.emitEvent(sN.LOGIN_SUCCESS,tP.Popup,e):t.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_SUCCESS,tP.Popup,e),o.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),o.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return i.length>0?t.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_FAILURE,tP.Popup,null,e):t.eventHandler.emitEvent(sN.LOGIN_FAILURE,tP.Popup,null,e),o.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return tR(this,void 0,void 0,(function(){var n,o,r,i,s=this;return nR(this,(function(a){return n=this.getRequestCorrelationId(e),o=XA(XA({},e),{prompt:e.prompt,correlationId:n}),this.preflightBrowserEnvironmentCheck(tP.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(ZA.SsoSilent,n),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(sN.SSO_SILENT_START,tP.Silent,o),this.canUseNative(o)?r=this.acquireTokenNative(o,eP.ssoSilent).catch((function(e){if(e instanceof NN&&e.isFatal())return s.nativeExtensionProvider=void 0,s.createSilentIframeClient(o.correlationId).acquireToken(o);throw e})):(i=this.createSilentIframeClient(o.correlationId),r=i.acquireToken(o)),[2,r.then((function(e){var t,n;return s.eventHandler.emitEvent(sN.SSO_SILENT_SUCCESS,tP.Silent,e),null===(t=s.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(n=s.ssoSilentMeasurement)||void 0===n||n.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw s.eventHandler.emitEvent(sN.SSO_SILENT_FAILURE,tP.Silent,null,e),null===(t=s.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i=this;return nR(this,(function(s){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(tP.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_BY_CODE_START,tP.Silent,e),n=this.performanceClient.startMeasurement(ZA.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw xD.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return o=e.code,(r=this.hybridAuthCodeResponses.get(o))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),n.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),r=this.acquireTokenByCodeAsync(XA(XA({},e),{correlationId:t})).then((function(e){return i.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_BY_CODE_SUCCESS,tP.Silent,e),i.hybridAuthCodeResponses.delete(o),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw i.hybridAuthCodeResponses.delete(o),i.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_BY_CODE_FAILURE,tP.Silent,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(o,r)),[2,r];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,eP.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof NN&&e.isFatal()&&(i.nativeExtensionProvider=void 0),e}))];throw xD.createUnableToAcquireTokenFromNativePlatformError()}throw xD.createAuthCodeOrNativeAccountIdRequiredError()}catch(sL){throw this.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_BY_CODE_FAILURE,tP.Silent,null,sL),n.endMeasurement({errorCode:sL instanceof iP&&sL.errorCode||void 0,subErrorCode:sL instanceof iP&&sL.subError||void 0,success:!1}),sL}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return tR(this,void 0,void 0,(function(){var n=this;return nR(this,(function(o){switch(o.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(ZA.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=n.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=n.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)}))];case 1:return[2,o.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){switch(this.performanceClient.addQueueMeasurement(ZA.AcquireTokenFromCache,t.correlationId),n.cacheLookupPolicy){case _P.Default:case _P.AccessToken:case _P.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw AO.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return tR(this,void 0,void 0,(function(){var n;return nR(this,(function(o){switch(this.performanceClient.addQueueMeasurement(ZA.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case _P.Default:case _P.AccessTokenAndRefreshToken:case _P.RefreshToken:case _P.RefreshTokenAndNetwork:return n=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(ZA.SilentRefreshClientAcquireToken,e.correlationId),[2,n.acquireToken(e)];default:throw AO.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){return this.performanceClient.addQueueMeasurement(ZA.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(ZA.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(XA({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(tP.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(tP.Popup),this.createPopupClient(t).logout(e)}catch(sL){return Promise.reject(sL)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),oN.blockNonBrowserEnvironment(this.isBrowserEnvironment),oN.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),oN.blockReloadInHiddenIframes(),oN.blockAcquireTokenInPopups(),oN.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===tP.Redirect&&this.config.cache.cacheLocation===QR.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw MD.createInMemoryRedirectUnavailableError();e!==tP.Redirect&&e!==tP.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),oN.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,n){return tR(this,void 0,void 0,(function(){return nR(this,(function(o){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw xD.createNativeConnectionNotEstablishedError();return[2,new zN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!HN.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case kR.NONE:case kR.CONSENT:case kR.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new BN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new jN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new GN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new UN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new $N(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new YN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,eP.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null===e||void 0===e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():mR.EMPTY_STRING},e}(),eL=function(e){function t(t){var n=e.call(this,t)||this;return n.astsAsyncMeasurement=void 0,n.activeSilentTokenRequests=new Map,n.trackPageVisibility=n.trackPageVisibility.bind(n),n}return YA(t,e),t.prototype.loginRedirect=function(e){return tR(this,void 0,void 0,(function(){var t;return nR(this,(function(n){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(XA({correlationId:t},e||xP))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(XA({correlationId:t},e||xP))},t.prototype.acquireTokenSilent=function(e){return tR(this,void 0,void 0,(function(){var t,n,o,r,i,s,a,l=this;return nR(this,(function(c){if(t=this.getRequestCorrelationId(e),(n=this.performanceClient.startMeasurement(ZA.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(tP.Silent),this.logger.verbose("acquireTokenSilent called",t),!(o=e.account||this.getActiveAccount()))throw xD.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:e.authority||mR.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},i=JSON.stringify(r),"undefined"===typeof(s=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(ZA.AcquireTokenSilentAsync,t),a=this.acquireTokenSilentAsync(XA(XA({},e),{correlationId:t}),o).then((function(t){return l.activeSilentTokenRequests.delete(i),n.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),n.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw l.activeSilentTokenRequests.delete(i),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(i,a),[2,a]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discardMeasurement(),[2,s])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var n;return tR(this,void 0,void 0,(function(){var o,r,i,s,a,l=this;return nR(this,(function(c){switch(c.label){case 0:return this.performanceClient.addQueueMeasurement(ZA.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_START,tP.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(ZA.AcquireTokenSilentAsync,e.correlationId),null===(n=this.astsAsyncMeasurement)||void 0===n||n.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),HN.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),r=XA(XA({},e),{account:t}),o=this.acquireTokenNative(r,eP.acquireTokenSilent_silentFlow).catch((function(t){return tR(l,void 0,void 0,(function(){return nR(this,(function(n){if(t instanceof NN&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),i=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(ZA.InitializeSilentRequest,e.correlationId),[4,i.initializeSilentRequest(e,t)];case 2:s=c.sent(),a=XA(XA({},e),{cacheLookupPolicy:e.cacheLookupPolicy||_P.Default}),this.performanceClient.setPreQueueTime(ZA.AcquireTokenFromCache,s.correlationId),o=this.acquireTokenFromCache(i,s,a).catch((function(t){if(a.cacheLookupPolicy===_P.AccessToken)throw t;return oN.blockReloadInHiddenIframes(),l.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_NETWORK_START,tP.Silent,s),l.performanceClient.setPreQueueTime(ZA.AcquireTokenByRefreshToken,s.correlationId),l.acquireTokenByRefreshToken(s,a).catch((function(t){var n=t instanceof sP,o=t instanceof uP,r=t.errorCode===cP.code,i=t.errorCode===hP;if((!n||!i||o||a.cacheLookupPolicy===_P.AccessTokenAndRefreshToken||a.cacheLookupPolicy===_P.RefreshToken)&&a.cacheLookupPolicy!==_P.Skip&&!r)throw t;return l.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),l.performanceClient.setPreQueueTime(ZA.AcquireTokenBySilentIframe,s.correlationId),l.acquireTokenBySilentIframe(s)}))})),c.label=3;case 3:return[2,o.then((function(e){var t;return l.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_SUCCESS,tP.Silent,e),null===(t=l.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw l.eventHandler.emitEvent(sN.ACQUIRE_TOKEN_FAILURE,tP.Silent,null,e),null===(t=l.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",l.trackPageVisibility)}))]}}))}))},t}(XN),tL=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{l(o.next(e))}catch(sL){i(sL)}}function a(e){try{l(o.throw(e))}catch(sL){i(sL)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e.SELECT_ACCOUNT="select_account",e.LOGIN="login",e.CONSENT="consent"}(PN||(PN={}));class nL extends X{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(e){this.isMultipleAccountEnabled=!e}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(e){super(),this.isMultipleAccountEnabled=!0,this.initProvider(e)}initProvider(e){return tL(this,void 0,void 0,(function*(){const t=e.options||{auth:{clientId:""}};if(this.ms_config=t,this.ms_config.cache=t.cache||{},this.ms_config.cache.cacheLocation=t.cache.cacheLocation||"localStorage","undefined"!==typeof this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,e.authority&&(this.ms_config.auth.authority=e.authority),e.redirectUri&&(this.ms_config.auth.redirectUri=e.redirectUri),"clientId"in e){if(!e.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=e.clientId,this._publicClientApplication=new eL(this.ms_config)}else{if(!("publicClientApplication"in e))throw new Error("either clientId or publicClientApplication must be provided");if(!e.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=e.publicClientApplication}yield this._publicClientApplication.initialize(),this.ms_config.system=t.system||{},this.ms_config.system.iframeHashTimeout=t.system.iframeHashTimeout||1e4,this._loginType="undefined"!==typeof e.loginType?e.loginType:ee.Redirect,this._loginHint="undefined"!==typeof e.loginHint?e.loginHint:null,this._sid="undefined"!==typeof e.sid?e.sid:null,this.isIncrementalConsentDisabled="undefined"!==typeof e.isIncrementalConsentDisabled&&e.isIncrementalConsentDisabled,this._domainHint="undefined"!==typeof e.domainHint?e.domainHint:null,this.scopes="undefined"!==typeof e.scopes?e.scopes:["user.read"],this._prompt="undefined"!==typeof e.prompt?e.prompt:PN.SELECT_ACCOUNT;const n=e;this.isMultipleAccountEnabled="undefined"===typeof n.isMultiAccountEnabled||n.isMultiAccountEnabled,this.baseURL="undefined"!==typeof n.baseURL?n.baseURL:this.baseURL,this.customHosts=n.customHosts,this.graph=((e,t,n)=>{const r=[new _(e),new I(new T),new R,new pe(fe,e.name),new S],i=e.baseURL?e.baseURL:o,s=Q.initWithMiddleware({middleware:se(...r),customHosts:e.customHosts?new Set(e.customHosts):null,baseUrl:i}),a=new ve(s,t);return n?a.forComponent(n):a})(this);try{const e=yield this._publicClientApplication.handleRedirectPromise();null!==e?this.handleResponse(null===e||void 0===e?void 0:e.account):yield this.trySilentSignIn()}catch(sL){throw console.error("\ud83e\udd92: Problem attempting to sign in",sL),sL}}))}trySilentSignIn(){return tL(this,void 0,void 0,(function*(){const e={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){e.sid=this._sid,e.loginHint=this._loginHint;try{this.setState(te.Loading);const t=yield this._publicClientApplication.ssoSilent(e);t&&this.handleResponse(null===t||void 0===t?void 0:t.account)}catch(sL){this.setState(te.SignedOut)}}else{const e=this.getAccount();if(e&&(yield this.getAccessToken(null)))return void this.handleResponse(e);this.setState(te.SignedOut)}}))}login(){return tL(this,void 0,void 0,(function*(){const e={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===ee.Popup){const t=yield this._publicClientApplication.loginPopup(e);this.handleResponse(null===t||void 0===t?void 0:t.account)}else{const t=Object.assign({},e);yield this._publicClientApplication.loginRedirect(t)}}))}getAllAccounts(){const e=[];return this._publicClientApplication.getAllAccounts().forEach((t=>{e.push({name:t.name,mail:t.username,id:t.homeAccountId})})),e}setActiveAccount(e){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(e.id)),this.setStoredAccount(),super.setActiveAccount(e)}getActiveAccount(){const e=this._publicClientApplication.getActiveAccount();return{name:e.name,mail:e.username,id:e.homeAccountId,tenantId:e.tenantId}}handleResponse(e){null!==e?(this.setActiveAccount({name:e.name,id:e.homeAccountId,mail:e.username}),this.setState(te.SignedIn)):this.setState(te.SignedOut),this.clearRequestedScopes()}storage(){return"localStorage"===this.ms_config.cache.cacheLocation?window.localStorage:window.sessionStorage}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){const e=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(e)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}addDeniedScopes(e){if(e){let t=this.getDeniedScopes()||[];t=t.concat(e);let n=t.indexOf("openid");-1!==n&&t.splice(n,1),n=t.indexOf("profile"),-1!==n&&t.splice(n,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}getDeniedScopes(){const e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}areScopesDenied(e){if(e){const t=this.getDeniedScopes();if(t&&t.filter((t=>-1!==e.indexOf(t))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const e=this.getStoredAccount();return e||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return tL(this,void 0,void 0,(function*(){const e={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===ee.Redirect?(this.setState(te.SignedOut),yield this._publicClientApplication.logoutRedirect(e)):(yield this._publicClientApplication.logoutPopup(Object.assign({},e)),1!==this._publicClientApplication.getAllAccounts.length&&this.isMultipleAccountEnabled?yield this.trySilentSignIn():this.setState(te.SignedOut))}))}getAccessToken(e){return tL(this,void 0,void 0,(function*(){const t=e&&e.scopes||this.scopes,n={scopes:t,account:this.getAccount()};try{const e=n;return(yield this._publicClientApplication.acquireTokenSilent(e)).accessToken}catch(sL){if(sL instanceof uP){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===ee.Redirect){if(this.areScopesDenied(t))throw sL;this.setRequestedScopes(t),yield this._publicClientApplication.acquireTokenRedirect(n)}else try{return(yield this._publicClientApplication.acquireTokenPopup(n)).accessToken}catch(o){throw console.error("\ud83e\udd92: problem with pop-up sign in",o),o}}else this.setState(te.SignedOut)}throw null}))}}var oL=function(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},rL=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let iL=class extends zt{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const e={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);const n=ee[t];e.loginType=n}if(this.authority&&(e.authority=this.authority),this.scopes){const t=this.scopes.split(",");t&&t.length>0&&(e.scopes=t)}if(this.redirectUri&&(e.redirectUri=this.redirectUri),this.loginHint&&(e.loginHint=this.loginHint),this.domainHint&&(e.domainHint=this.domainHint),this.prompt){const t=this.prompt.toUpperCase(),n=PN[t];e.prompt=n}this.isIncrementalConsentDisabled&&(e.isIncrementalConsentDisabled=!0),this.isMultiAccountDisabled&&(e.isMultiAccountEnabled=!1),this.baseUrl&&(e.baseURL=this.baseUrl),this.customHosts&&(e.customHosts=this.customHosts),this.provider=new nL(e),re.globalProvider=this.provider}}};oL([Et({attribute:"client-id",type:String}),rL("design:type",Object)],iL.prototype,"clientId",void 0),oL([Et({attribute:"login-hint",type:String}),rL("design:type",String)],iL.prototype,"loginHint",void 0),oL([Et({attribute:"domain-hint",type:String}),rL("design:type",String)],iL.prototype,"domainHint",void 0),oL([Et({attribute:"login-type",type:String}),rL("design:type",String)],iL.prototype,"loginType",void 0),oL([Et(),rL("design:type",String)],iL.prototype,"authority",void 0),oL([Et({attribute:"scopes",type:String}),rL("design:type",String)],iL.prototype,"scopes",void 0),oL([Et({attribute:"redirect-uri",type:String}),rL("design:type",String)],iL.prototype,"redirectUri",void 0),oL([Et({attribute:"prompt",type:String}),rL("design:type",String)],iL.prototype,"prompt",void 0),oL([Et({attribute:"incremental-consent-disabled",type:Boolean}),rL("design:type",Boolean)],iL.prototype,"isIncrementalConsentDisabled",void 0),oL([Et({attribute:"multi-account-disabled",type:Boolean}),rL("design:type",Object)],iL.prototype,"isMultiAccountDisabled",void 0),iL=oL([Tn("msal2-provider")],iL),re.globalProvider=new nL({clientId:"63404d54-f1ed-493e-a065-53d7c8a108a7",scopes:["calendars.read","user.read","openid","profile","people.read","user.readbasic.all"]});t.createRoot(document.getElementById("root")).render((0,GA.jsx)(e.StrictMode,{children:(0,GA.jsx)($A,{})})),WA()})()})();
//# sourceMappingURL=main.77c2e7c4.js.map